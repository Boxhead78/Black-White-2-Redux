///////////////////////////////////////////////////////////////////////////////
//          Town Influence Extender
//    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
//
//    This script makes town influence extending, depending on how many 
//    villagers are living in the specified town.
//
///////////////////////////////////////////////////////////////////////////////

define InfluenceBaseValue = 5
define InfluenceBonusLevel1 = 0.25
define InfluenceBonusLevel2 = 0.5
define InfluenceBonusLevel3 = 1.0
define InfluenceBonusLevel4 = 1.75
define InfluenceBonusLevel5 = 2.75

define script TownInfluenceExtender
define script TownInfluenceScriptmanager

run script TownInfluenceScriptmanager


begin script TownInfluenceScriptmanager

start

    run background script TownInfluenceExtender

end script TownInfluenceScriptmanager


begin script TownInfluenceExtender

    InfluenceBuildingsLevel = 0
    PlayerThreshold = 0
    PlayerThresholdPrev = 0
    TownCounter = 0
    InfluenceMultiplicator[MAX_TOWNS]
    InfluenceDivider = 1.5 // Nerf it since buildings extend influence again
    Town[MAX_TOWNS]
    TownInfluence[MAX_TOWNS]
    TownEnemyInfluence[MAX_TOWNS]
    TownSize = 0

start

begin loop

    if TownCounter >= MAX_TOWNS
        TownCounter = 0
    end if

    if get total of stat STATS_EVT_BUILDINGS_BUILT > 5 and InfluenceBuildingsLevel == 0
        InfluenceBuildingsLevel = 1
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 10 and InfluenceBuildingsLevel == 1
        InfluenceBuildingsLevel = 2
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 15 and InfluenceBuildingsLevel == 2
        InfluenceBuildingsLevel = 3
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 20 and InfluenceBuildingsLevel == 3
        InfluenceBuildingsLevel = 4
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 25 and InfluenceBuildingsLevel == 4
        InfluenceBuildingsLevel = 5
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 30 and InfluenceBuildingsLevel == 5
        InfluenceBuildingsLevel = 6
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 35 and InfluenceBuildingsLevel == 6
        InfluenceBuildingsLevel = 7
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 40 and InfluenceBuildingsLevel == 7
        InfluenceBuildingsLevel = 8
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 45 and InfluenceBuildingsLevel == 8
        InfluenceBuildingsLevel = 9
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 50 and InfluenceBuildingsLevel == 9
        InfluenceBuildingsLevel = 10
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 55 and InfluenceBuildingsLevel == 10
        InfluenceBuildingsLevel = 11
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 60 and InfluenceBuildingsLevel == 11
        InfluenceBuildingsLevel = 12
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 65 and InfluenceBuildingsLevel == 12
        InfluenceBuildingsLevel = 13
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 70 and InfluenceBuildingsLevel == 13
        InfluenceBuildingsLevel = 14
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 75 and InfluenceBuildingsLevel == 14
        InfluenceBuildingsLevel = 15
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 80 and InfluenceBuildingsLevel == 15
        InfluenceBuildingsLevel = 16
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 85 and InfluenceBuildingsLevel == 16
        InfluenceBuildingsLevel = 17
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 90 and InfluenceBuildingsLevel == 17
        InfluenceBuildingsLevel = 18
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 95 and InfluenceBuildingsLevel == 18
        InfluenceBuildingsLevel = 19
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 100 and InfluenceBuildingsLevel == 19
        InfluenceBuildingsLevel = 20
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 105 and InfluenceBuildingsLevel == 20
        InfluenceBuildingsLevel = 21
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 110 and InfluenceBuildingsLevel == 21
        InfluenceBuildingsLevel = 22
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 115 and InfluenceBuildingsLevel == 22
        InfluenceBuildingsLevel = 23
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 120 and InfluenceBuildingsLevel == 23
        InfluenceBuildingsLevel = 24
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 125 and InfluenceBuildingsLevel == 24
        InfluenceBuildingsLevel = 25
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 130 and InfluenceBuildingsLevel == 25
        InfluenceBuildingsLevel = 26
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 135 and InfluenceBuildingsLevel == 26
        InfluenceBuildingsLevel = 27
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 140 and InfluenceBuildingsLevel == 27
        InfluenceBuildingsLevel = 28
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 145 and InfluenceBuildingsLevel == 28
        InfluenceBuildingsLevel = 29
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 150 and InfluenceBuildingsLevel == 29
        InfluenceBuildingsLevel = 30
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 155 and InfluenceBuildingsLevel == 30
        InfluenceBuildingsLevel = 31
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 160 and InfluenceBuildingsLevel == 31
        InfluenceBuildingsLevel = 32
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 165 and InfluenceBuildingsLevel == 32
        InfluenceBuildingsLevel = 33
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 170 and InfluenceBuildingsLevel == 33
        InfluenceBuildingsLevel = 34
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 175 and InfluenceBuildingsLevel == 34
        InfluenceBuildingsLevel = 35
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 180 and InfluenceBuildingsLevel == 35
        InfluenceBuildingsLevel = 36
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 185 and InfluenceBuildingsLevel == 36
        InfluenceBuildingsLevel = 37
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 190 and InfluenceBuildingsLevel == 37
        InfluenceBuildingsLevel = 38
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 195 and InfluenceBuildingsLevel == 38
        InfluenceBuildingsLevel = 39
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 200 and InfluenceBuildingsLevel == 39
        InfluenceBuildingsLevel = 40
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 205 and InfluenceBuildingsLevel == 40
        InfluenceBuildingsLevel = 41
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 210 and InfluenceBuildingsLevel == 41
        InfluenceBuildingsLevel = 42
        PlayerThreshold += 1.25
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 215 and InfluenceBuildingsLevel == 42
        InfluenceBuildingsLevel = 43
        PlayerThreshold += 1.25
    end if

    Town[TownCounter] = get town with id TownCounter
    if PLAYER of Town[TownCounter] == 0
        if size of Town[TownCounter] >= 15 and TownInfluence[TownCounter] == 0 //1
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += 1
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 15) and TownInfluence[TownCounter] == 1
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= 1
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 30 and TownInfluence[TownCounter] == 1 //2
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel1
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 30) and TownInfluence[TownCounter] == 2
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel1
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 45 and TownInfluence[TownCounter] == 2 //3
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel1
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 45) and TownInfluence[TownCounter] == 3
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel1
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 60 and TownInfluence[TownCounter] == 3 //4
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel1
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 60) and TownInfluence[TownCounter] == 4
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel1
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 75 and TownInfluence[TownCounter] == 4 //5
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel1
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 75) and TownInfluence[TownCounter] == 5
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel1
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 90 and TownInfluence[TownCounter] == 5 //6
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel2
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 90) and TownInfluence[TownCounter] == 6
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel2
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if
    
        if size of Town[TownCounter] >= 105 and TownInfluence[TownCounter] == 6 //7
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel2
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 105) and TownInfluence[TownCounter] == 7
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel2
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 120 and TownInfluence[TownCounter] == 7 //8
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel2
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 120) and TownInfluence[TownCounter] == 8
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel2
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 135 and TownInfluence[TownCounter] == 8 //9
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel2
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 135) and TownInfluence[TownCounter] == 9
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel2
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 150 and TownInfluence[TownCounter] == 9 //10
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel2
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 150) and TownInfluence[TownCounter] == 10
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel2
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 165 and TownInfluence[TownCounter] == 10 //11
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel2
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 165) and TownInfluence[TownCounter] == 11
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel2
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 180 and TownInfluence[TownCounter] == 11 //12
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel3
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 180) and TownInfluence[TownCounter] == 12
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel3
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 195 and TownInfluence[TownCounter] == 12 //13
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel3
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 195) and TownInfluence[TownCounter] == 13
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel3
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 210 and TownInfluence[TownCounter] == 13 //14
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel3
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 210) and TownInfluence[TownCounter] == 14
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel3
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 225 and TownInfluence[TownCounter] == 14 //15
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel3
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 225) and TownInfluence[TownCounter] == 15
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel3
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if
    
        if size of Town[TownCounter] >= 240 and TownInfluence[TownCounter] == 15 //16
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel3
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 240) and TownInfluence[TownCounter] == 16
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel3
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 255 and TownInfluence[TownCounter] == 16 //17
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel3
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 255) and TownInfluence[TownCounter] == 17
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel3
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 270 and TownInfluence[TownCounter] == 17 //18
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel3
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 270) and TownInfluence[TownCounter] == 18
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel3
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 285 and TownInfluence[TownCounter] == 18 //19
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel3
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 285) and TownInfluence[TownCounter] == 19
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel3
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 300 and TownInfluence[TownCounter] == 19 //20
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel4
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 300) and TownInfluence[TownCounter] == 20
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel4
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 315 and TownInfluence[TownCounter] == 20 //21
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel4
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 315) and TownInfluence[TownCounter] == 21
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel4
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 330 and TownInfluence[TownCounter] == 21 //22
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel4
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 330) and TownInfluence[TownCounter] == 22
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel4
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 345 and TownInfluence[TownCounter] == 22 //23
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel4
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 345) and TownInfluence[TownCounter] == 23
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel4
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 360 and TownInfluence[TownCounter] == 23 //24
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel4
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 360) and TownInfluence[TownCounter] == 24
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel4
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 375 and TownInfluence[TownCounter] == 24 //25
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel4
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 375) and TownInfluence[TownCounter] == 25
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel4
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 390 and TownInfluence[TownCounter] == 25 //26
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel4
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 390) and TownInfluence[TownCounter] == 26
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel4
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 405 and TownInfluence[TownCounter] == 26 //27
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel4
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 405) and TownInfluence[TownCounter] == 27
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel4
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 420 and TownInfluence[TownCounter] == 27 //28
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel4
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 420) and TownInfluence[TownCounter] == 28
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel4
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 435 and TownInfluence[TownCounter] == 28 //29
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel4
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 435) and TownInfluence[TownCounter] == 29
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel4
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 450 and TownInfluence[TownCounter] == 29 //30
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 450) and TownInfluence[TownCounter] == 30
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 465 and TownInfluence[TownCounter] == 30 //31
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 465) and TownInfluence[TownCounter] == 31
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 480 and TownInfluence[TownCounter] == 31 //32
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 480) and TownInfluence[TownCounter] == 32
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 495 and TownInfluence[TownCounter] == 32 //33
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 495) and TownInfluence[TownCounter] == 33
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 510 and TownInfluence[TownCounter] == 33 //34
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 510) and TownInfluence[TownCounter] == 34
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 525 and TownInfluence[TownCounter] == 34 //35
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 525) and TownInfluence[TownCounter] == 35
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 540 and TownInfluence[TownCounter] == 35 //36
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 540) and TownInfluence[TownCounter] == 36
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 555 and TownInfluence[TownCounter] == 36 //37
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 555) and TownInfluence[TownCounter] == 37
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 570 and TownInfluence[TownCounter] == 37 //38
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 570) and TownInfluence[TownCounter] == 38
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 585 and TownInfluence[TownCounter] == 38 //39
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 585) and TownInfluence[TownCounter] == 39
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 600 and TownInfluence[TownCounter] == 39 //40
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 600) and TownInfluence[TownCounter] == 40
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 615 and TownInfluence[TownCounter] == 40 //41
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 615) and TownInfluence[TownCounter] == 41
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 630 and TownInfluence[TownCounter] == 41 //42
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 630) and TownInfluence[TownCounter] == 42
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 645 and TownInfluence[TownCounter] == 42 //43
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 645) and TownInfluence[TownCounter] == 43
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 660 and TownInfluence[TownCounter] == 43 //44
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 660) and TownInfluence[TownCounter] == 44
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 675 and TownInfluence[TownCounter] == 44 //45
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 675) and TownInfluence[TownCounter] == 45
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 690 and TownInfluence[TownCounter] == 45 //46
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 690) and TownInfluence[TownCounter] == 46
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if size of Town[TownCounter] >= 705 and TownInfluence[TownCounter] == 46 //47
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 705) and TownInfluence[TownCounter] == 47
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if

        if (size of Town[TownCounter] >= 720 and TownInfluence[TownCounter] == 47) or (PlayerThreshold > PlayerThresholdPrev and TownInfluence[TownCounter] == 48) //48
            PlayerThresholdPrev = PlayerThreshold
            TownInfluence[TownCounter] = 48
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        elsif (size of Town[TownCounter] < 720) and TownInfluence[TownCounter] == 48
            TownInfluence[TownCounter] = 47
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            if CH_InfluenceCheatActivated == 0
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 1
            elsif CH_InfluenceCheatActivated == 1
                extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter] + PlayerThreshold) / InfluenceDivider) / 0.5
            end if

        end if
    elsif PLAYER of Town[TownCounter] >= 1 and PLAYER of Town[TownCounter] <= 8
        if size of Town[TownCounter] >= 15 and TownInfluence[TownCounter] == 0 //1
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += 1
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 15) and TownInfluence[TownCounter] == 1
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= 1
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 30  and TownInfluence[TownCounter] == 1 //2
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel1
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 30) and TownInfluence[TownCounter] == 2
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel1
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 45 and TownInfluence[TownCounter] == 2 //3
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel1
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 45) and TownInfluence[TownCounter] == 3
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel1
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 60 and TownInfluence[TownCounter] == 3 //4
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel1
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 60) and TownInfluence[TownCounter] == 4
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel1
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 75 and TownInfluence[TownCounter] == 4 //5
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel1
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 75) and TownInfluence[TownCounter] == 5
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel1
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 90 and TownInfluence[TownCounter] == 5 //6
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel2
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 90) and TownInfluence[TownCounter] == 6
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel2
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if
    
        if size of Town[TownCounter] >= 105 and TownInfluence[TownCounter] == 6 //7
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel2
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 105) and TownInfluence[TownCounter] == 7
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel2
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 120 and TownInfluence[TownCounter] == 7 //8
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel2
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 120) and TownInfluence[TownCounter] == 8
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel2
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 135 and TownInfluence[TownCounter] == 8 //9
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel2
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 135) and TownInfluence[TownCounter] == 9
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel2
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 150 and TownInfluence[TownCounter] == 9 //10
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel2
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 150) and TownInfluence[TownCounter] == 10
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel2
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 165 and TownInfluence[TownCounter] == 10 //11
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel2
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 165) and TownInfluence[TownCounter] == 11
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel2
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 180 and TownInfluence[TownCounter] == 11 //12
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel3
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 180) and TownInfluence[TownCounter] == 12
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel3
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 195 and TownInfluence[TownCounter] == 12 //13
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel3
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 195) and TownInfluence[TownCounter] == 13
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel3
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 210 and TownInfluence[TownCounter] == 13 //14
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel3
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 210) and TownInfluence[TownCounter] == 14
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel3
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 225 and TownInfluence[TownCounter] == 14 //15
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel3
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 225) and TownInfluence[TownCounter] == 15
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel3
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if
    
        if size of Town[TownCounter] >= 240 and TownInfluence[TownCounter] == 15 //16
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel3
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 240) and TownInfluence[TownCounter] == 16
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel3
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 255 and TownInfluence[TownCounter] == 16 //17
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel3
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 255) and TownInfluence[TownCounter] == 17
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel3
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 270 and TownInfluence[TownCounter] == 17 //18
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel3
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 270) and TownInfluence[TownCounter] == 18
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel3
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 285 and TownInfluence[TownCounter] == 18 //19
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel3
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 285) and TownInfluence[TownCounter] == 19
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel3
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 300 and TownInfluence[TownCounter] == 19 //20
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel4
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 300) and TownInfluence[TownCounter] == 20
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel4
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 315 and TownInfluence[TownCounter] == 20 //21
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel4
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 315) and TownInfluence[TownCounter] == 21
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel4
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 330 and TownInfluence[TownCounter] == 21 //22
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel4
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 330) and TownInfluence[TownCounter] == 22
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel4
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 345 and TownInfluence[TownCounter] == 22 //23
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel4
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 345) and TownInfluence[TownCounter] == 23
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel4
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 360 and TownInfluence[TownCounter] == 23 //24
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel4
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 360) and TownInfluence[TownCounter] == 24
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel4
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 375 and TownInfluence[TownCounter] == 24 //25
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel4
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 375) and TownInfluence[TownCounter] == 25
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel4
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 390 and TownInfluence[TownCounter] == 25 //26
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel4
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 390) and TownInfluence[TownCounter] == 26
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel4
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 405 and TownInfluence[TownCounter] == 26 //27
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel4
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 405) and TownInfluence[TownCounter] == 27
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel4
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 420 and TownInfluence[TownCounter] == 27 //28
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel4
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 420) and TownInfluence[TownCounter] == 28
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel4
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 435 and TownInfluence[TownCounter] == 28 //29
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel4
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 435) and TownInfluence[TownCounter] == 29
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel4
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 450 and TownInfluence[TownCounter] == 29 //30
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 450) and TownInfluence[TownCounter] == 30
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 465 and TownInfluence[TownCounter] == 30 //31
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 465) and TownInfluence[TownCounter] == 31
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 480 and TownInfluence[TownCounter] == 31 //32
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 480) and TownInfluence[TownCounter] == 32
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 495 and TownInfluence[TownCounter] == 32 //33
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 495) and TownInfluence[TownCounter] == 33
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 510 and TownInfluence[TownCounter] == 33 //34
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 510) and TownInfluence[TownCounter] == 34
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 525 and TownInfluence[TownCounter] == 34 //35
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 525) and TownInfluence[TownCounter] == 35
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 540 and TownInfluence[TownCounter] == 35 //36
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 540) and TownInfluence[TownCounter] == 36
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 555 and TownInfluence[TownCounter] == 36 //37
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 555) and TownInfluence[TownCounter] == 37
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 570 and TownInfluence[TownCounter] == 37 //38
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 570) and TownInfluence[TownCounter] == 38
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 585 and TownInfluence[TownCounter] == 38 //39
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 585) and TownInfluence[TownCounter] == 39
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 600 and TownInfluence[TownCounter] == 39 //40
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 600) and TownInfluence[TownCounter] == 40
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 615 and TownInfluence[TownCounter] == 40 //41
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 615) and TownInfluence[TownCounter] == 41
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 630 and TownInfluence[TownCounter] == 41 //42
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 630) and TownInfluence[TownCounter] == 42
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 645 and TownInfluence[TownCounter] == 42 //43
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 645) and TownInfluence[TownCounter] == 43
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 660 and TownInfluence[TownCounter] == 43 //44
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 660) and TownInfluence[TownCounter] == 44
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 675 and TownInfluence[TownCounter] == 44 //45
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 675) and TownInfluence[TownCounter] == 45
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 690 and TownInfluence[TownCounter] == 45 //46
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 690) and TownInfluence[TownCounter] == 46
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if size of Town[TownCounter] >= 705 and TownInfluence[TownCounter] == 46 //47
            TownInfluence[TownCounter] += 1
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 705) and TownInfluence[TownCounter] == 47
            TownInfluence[TownCounter] -= 1
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if

        if (size of Town[TownCounter] >= 720 and TownInfluence[TownCounter] == 47) //48
            TownInfluence[TownCounter] = 48
            InfluenceMultiplicator[TownCounter] += InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        elsif (size of Town[TownCounter] < 720) and TownInfluence[TownCounter] == 48
            TownInfluence[TownCounter] = 47
            InfluenceMultiplicator[TownCounter] -= InfluenceBonusLevel5
            extend town Town[TownCounter] influence by ((InfluenceBaseValue * InfluenceMultiplicator[TownCounter]) / InfluenceDivider) / 1

        end if
    else //Reset if town has been captured
        TownInfluence[TownCounter] = 0
    end if

    TownCounter++
end loop

end script TownInfluenceExtender