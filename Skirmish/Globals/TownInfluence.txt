///////////////////////////////////////////////////////////////////////////////
//          Town Influence Extender
//    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
//
//    This script makes town influence extending, depending on how many 
//    villagers are living in the specified town.
//
///////////////////////////////////////////////////////////////////////////////

define script TownInfluenceExtender

run script TownInfluenceExtender

begin script TownInfluenceExtender

    TownCounter = 0
    Town[15]//15 Towns max. supported
    TownInfluence[15]
    TownEnemyInfluence[15]
    TownSize = 0

start

begin loop

    if TownCounter >= 14
        TownCounter = 0
    end if

    Town[TownCounter] = get town with id TownCounter
    if PLAYER of Town[TownCounter] == 0
        if size of Town[TownCounter] >= 40 and TownInfluence[TownCounter] == 0
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 5

        elsif size of Town[TownCounter] < 40 and TownInfluence[TownCounter] == 1
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 0

        end if
        
        if size of Town[TownCounter] >= 80 and TownInfluence[TownCounter] == 1
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 10

        elsif size of Town[TownCounter] < 80 and TownInfluence[TownCounter] == 2
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 5

        end if

        if size of Town[TownCounter] >= 120 and TownInfluence[TownCounter] == 2
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 15

        elsif size of Town[TownCounter] < 120 and TownInfluence[TownCounter] == 3
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 10

        end if

        if size of Town[TownCounter] >= 160 and TownInfluence[TownCounter] == 3
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 20

        elsif size of Town[TownCounter] < 160 and TownInfluence[TownCounter] == 4
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 15

        end if

        if size of Town[TownCounter] >= 200 and TownInfluence[TownCounter] == 4
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 25

        elsif size of Town[TownCounter] < 200 and TownInfluence[TownCounter] == 5
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 20

        end if

        if size of Town[TownCounter] >= 240 and TownInfluence[TownCounter] == 5
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 30

        elsif size of Town[TownCounter] < 240 and TownInfluence[TownCounter] == 6
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 25

        end if
        
        if size of Town[TownCounter] >= 280 and TownInfluence[TownCounter] == 6
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 35

        elsif size of Town[TownCounter] < 280 and TownInfluence[TownCounter] == 7
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 30

        end if

        if size of Town[TownCounter] >= 320 and TownInfluence[TownCounter] == 7
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 40

        elsif size of Town[TownCounter] < 320 and TownInfluence[TownCounter] == 8
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 35

        end if

        if size of Town[TownCounter] >= 360 and TownInfluence[TownCounter] == 8
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 45

        elsif size of Town[TownCounter] < 360 and TownInfluence[TownCounter] == 9
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 40

        end if

        if size of Town[TownCounter] >= 400 and TownInfluence[TownCounter] == 9
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 50

        elsif size of Town[TownCounter] < 400 and TownInfluence[TownCounter] == 10
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 45

        end if

        if size of Town[TownCounter] >= 440 and TownInfluence[TownCounter] == 10
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 55

        elsif size of Town[TownCounter] < 440 and TownInfluence[TownCounter] == 11
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 50

        end if
        
        if size of Town[TownCounter] >= 480 and TownInfluence[TownCounter] == 11
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 60

        elsif size of Town[TownCounter] < 480 and TownInfluence[TownCounter] == 12
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 55

        end if

        if size of Town[TownCounter] >= 520 and TownInfluence[TownCounter] == 12
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 65

        elsif size of Town[TownCounter] < 520 and TownInfluence[TownCounter] == 13
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 60

        end if

        if size of Town[TownCounter] >= 560 and TownInfluence[TownCounter] == 13
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 70

        elsif size of Town[TownCounter] < 560 and TownInfluence[TownCounter] == 14
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 65

        end if

        if size of Town[TownCounter] >= 600 and TownInfluence[TownCounter] == 14
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 75

        elsif size of Town[TownCounter] < 600 and TownInfluence[TownCounter] == 15
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 70

        end if

        if size of Town[TownCounter] >= 640 and TownInfluence[TownCounter] == 14
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 80

        elsif size of Town[TownCounter] < 640 and TownInfluence[TownCounter] == 15
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 75

        end if

        if size of Town[TownCounter] >= 680 and TownInfluence[TownCounter] == 14
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 85

        elsif size of Town[TownCounter] < 680 and TownInfluence[TownCounter] == 15
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 80

        end if

        if size of Town[TownCounter] >= 720 and TownInfluence[TownCounter] == 14
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 90

        elsif size of Town[TownCounter] < 720 and TownInfluence[TownCounter] == 15
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 85

        end if
    else //Reset if town has been captured
        TownInfluence[TownCounter] = 0
    end if

    if PLAYER of Town[TownCounter] >= 1 and PLAYER of Town[TownCounter] < 7
        if size of Town[TownCounter] >= 40 and TownInfluence[TownCounter] == 0
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 5

        elsif size of Town[TownCounter] < 40 and TownInfluence[TownCounter] == 1
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 0

        end if
        
        if size of Town[TownCounter] >= 80 and TownInfluence[TownCounter] == 1
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 10

        elsif size of Town[TownCounter] < 80 and TownInfluence[TownCounter] == 2
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 5

        end if

        if size of Town[TownCounter] >= 120 and TownInfluence[TownCounter] == 2
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 15

        elsif size of Town[TownCounter] < 120 and TownInfluence[TownCounter] == 3
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 10

        end if

        if size of Town[TownCounter] >= 160 and TownInfluence[TownCounter] == 3
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 20

        elsif size of Town[TownCounter] < 160 and TownInfluence[TownCounter] == 4
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 15

        end if

        if size of Town[TownCounter] >= 200 and TownInfluence[TownCounter] == 4
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 25

        elsif size of Town[TownCounter] < 200 and TownInfluence[TownCounter] == 5
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 20

        end if

        if size of Town[TownCounter] >= 240 and TownInfluence[TownCounter] == 5
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 30

        elsif size of Town[TownCounter] < 240 and TownInfluence[TownCounter] == 6
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 25

        end if
        
        if size of Town[TownCounter] >= 280 and TownInfluence[TownCounter] == 6
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 35

        elsif size of Town[TownCounter] < 280 and TownInfluence[TownCounter] == 7
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 30

        end if

        if size of Town[TownCounter] >= 320 and TownInfluence[TownCounter] == 7
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 40

        elsif size of Town[TownCounter] < 320 and TownInfluence[TownCounter] == 8
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 35

        end if

        if size of Town[TownCounter] >= 360 and TownInfluence[TownCounter] == 8
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 45

        elsif size of Town[TownCounter] < 360 and TownInfluence[TownCounter] == 9
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 40

        end if

        if size of Town[TownCounter] >= 400 and TownInfluence[TownCounter] == 9
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 50

        elsif size of Town[TownCounter] < 400 and TownInfluence[TownCounter] == 10
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 45

        end if

        if size of Town[TownCounter] >= 440 and TownInfluence[TownCounter] == 10
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 55

        elsif size of Town[TownCounter] < 440 and TownInfluence[TownCounter] == 11
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 50

        end if
        
        if size of Town[TownCounter] >= 480 and TownInfluence[TownCounter] == 11
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 60

        elsif size of Town[TownCounter] < 480 and TownInfluence[TownCounter] == 12
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 55

        end if

        if size of Town[TownCounter] >= 520 and TownInfluence[TownCounter] == 12
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 65

        elsif size of Town[TownCounter] < 520 and TownInfluence[TownCounter] == 13
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 60

        end if

        if size of Town[TownCounter] >= 560 and TownInfluence[TownCounter] == 13
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 70

        elsif size of Town[TownCounter] < 560 and TownInfluence[TownCounter] == 14
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 65

        end if

        if size of Town[TownCounter] >= 600 and TownInfluence[TownCounter] == 14
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 75

        elsif size of Town[TownCounter] < 600 and TownInfluence[TownCounter] == 15
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 70

        end if

        if size of Town[TownCounter] >= 640 and TownInfluence[TownCounter] == 14
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 80

        elsif size of Town[TownCounter] < 640 and TownInfluence[TownCounter] == 15
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 75

        end if

        if size of Town[TownCounter] >= 680 and TownInfluence[TownCounter] == 14
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 85

        elsif size of Town[TownCounter] < 680 and TownInfluence[TownCounter] == 15
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 80

        end if

        if size of Town[TownCounter] >= 720 and TownInfluence[TownCounter] == 14
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 90

        elsif size of Town[TownCounter] < 720 and TownInfluence[TownCounter] == 15
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 85

        end if
    else //Reset if town has been captured
        TownEnemyInfluence[TownCounter] = 0
    end if

    TownCounter++
end loop

end script TownInfluenceExtender