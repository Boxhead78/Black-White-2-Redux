///////////////////////////////////////////////////////////////////////////////
//            Player Villagers
//    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
//
///////////////////////////////////////////////////////////////////////////////

define PLAYERVILLAGERSDELAY = 30

define script AAV_PlayerVillagers

run script AAV_PlayerVillagers

begin script AAV_PlayerVillagers

    PlayerTownLocal = 0
    HowManyVillagers = 0
    TownCentre = 0
    TownSize = 0
    TownCapacity = 0
    TownCounter = 0
    TownHouse = 0
    Villager = 0
    VillagerCounter = 0

start

begin loop

    if TownCounter > 16
        TownCounter = 0
    end if

    PlayerTownLocal = get town with id TownCounter
    TownCentre = get building ABODE_NUMBER_TOWN_CENTRE in PlayerTownLocal min built 1.0
    if PLAYER of PlayerTownLocal == 0 and TownCentre exists and variable get town PlayerTownLocal status != variable TOWN_STATUS_MIGRATION_STARTED
        TownSize = adult size of PlayerTownLocal
        TownCapacity = adult capacity of PlayerTownLocal
        VillagerCounter = 0
        if TownCapacity > TownSize * 1.5
            begin loop
                TownHouse = get random home in town PlayerTownLocal
                Villager = create random villager of tribe TRIBE_TYPE_GREEK at {TownHouse}
                attach Villager to PlayerTownLocal
                release Villager
                wait number from 5 to 7 seconds
                until VillagerCounter > TownSize * 1.25
            end loop
            wait PLAYERVILLAGERSDELAY seconds
        end if
    end if

    TownCounter++
end loop

end script AAV_PlayerVillagers