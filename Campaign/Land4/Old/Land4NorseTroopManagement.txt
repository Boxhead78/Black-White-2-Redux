///////////////////////////////////////////////////////////////////////////////
//    Land 4 Norse Troop-Management
//    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
//
//    Start date:         18.08.16            By: Boxhead
//    Update date:        05.02.17            By: Boxhead
///////////////////////////////////////////////////////////////////////////////

//-----------------------------------------------------------------------------
//    Globals
//-----------------------------------------------------------------------------

define LC4_NUM_OF_DEFENDERS                = 0 //Unused
define LC4_NUM_OF_PLATOONS                = 19 //37
define LC4_NUM_OF_SIEGE_CATAPULTS         = 3
define LC4_NUM_OF_WALL_ARCHERS            = 5

global LC4_Defender[LC4_NUM_OF_DEFENDERS]
global LC4_Platoon[LC4_NUM_OF_PLATOONS]
global LC4_SiegeCatapult[LC4_NUM_OF_SIEGE_CATAPULTS]
global LC4_WallArcher[LC4_NUM_OF_WALL_ARCHERS]

global PlatoonPos[7]
global AttackPos[7]
global SiegePlatoonPos[1]
global SiegeRoute1[3]
global Script1WP[2]
global PlayerWallPos = 0

//-----------------------------------------------------------------------------

//-----------------------------------------------------------------------------
//    Setting up waypoints for AI actions
//-----------------------------------------------------------------------------

run script Waypoints

begin script Waypoints

start

    PlayerWallPos = marker at {1230.47,121.51,758.87}

    PlatoonPos[0] = marker at {1215.43,298.98,1945.71}
    PlatoonPos[1] = marker at {1383.52,298.83,1895.26}
    PlatoonPos[2] = marker at {887.47,298.84,2077.57}
    PlatoonPos[3] = marker at {1312.52,256.05,1657.31}
    PlatoonPos[4] = marker at {1604.96,290.49,1983.51}
    PlatoonPos[5] = marker at {590.77,296.15,2006.85}
    PlatoonPos[6] = marker at {585.47,292.29,1939.63}
    
    AttackPos[0] = marker at {1229.49,125.41,819.19}
    AttackPos[1] = marker at {1154.31,130.97,858.11}
    AttackPos[2] = marker at {1322.59,129.45,867.83}
    AttackPos[3] = marker at {1459.62,72.91,577.49}
    AttackPos[4] = marker at {1228.28,124.31,811.12}
    AttackPos[5] = marker at {759.05,298.84,2053.61}
    AttackPos[6] = marker at {503.64,296.72,1814.50}
    
    SiegeRoute1[0] = marker at {1312.05,298.44,1834.22}
    SiegeRoute1[1] = marker at {1213.23,136.41,895.85}
    SiegeRoute1[2] = marker at {1139.83,126.14,805.10}
    
    SiegePlatoonPos[0] = marker at {1313.19,294.29,1797.43}
    
    Script1WP[0] = marker at {1345.16,298.65,1914.31}
    Script1WP[1] = marker at {1345.16,298.65,1914.31}

end script Waypoints

//-----------------------------------------------------------------------------

begin script LC4_Platoon0Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    PlayerSettlement = 0
    
start

begin loop

    wait until LC4_Platoon[0] exists
    
    PlayerCreature = get distance from {LC4_Platoon[0]} to {oCreature}
    if PlayerCreature <= 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC4_Platoon[0] can navigate to {oCreature}
        clear LC4_Platoon[0] action queue
        begin loop
            PlayerCreature = get distance from {LC4_Platoon[0]} to {oCreature}
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC4_Platoon[0] action queue
            NumPat1 = get number of villagers in platoon LC4_Platoon[0]
            until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC4_Platoon[0] can navigate to {oCreature} or PlayerCreature > 200
        end loop
        clear LC4_Platoon[0] action queue
    end if
    
    PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[0]} radius 200
    Catapult = get siege weapon of player 0 nearest {LC4_Platoon[0]} radius 155
    if PlayerPlatoon1 exists and LC4_Platoon[0] can navigate to {PlayerPlatoon1}
        clear LC4_Platoon[0] action queue
        begin loop
            PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[0]} radius 200
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC4_Platoon[0] action queue
            NumPat1 = get number of villagers in platoon LC4_Platoon[0]
            HeTeste1 = get number of villagers in platoon PlayerPlatoon1
            until NumPat1 == 0 or HeTeste1 == 0 or not LC4_Platoon[0] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
        end loop
        clear LC4_Platoon[0] action queue
    elsif Catapult exists and LC4_Platoon[0] can navigate to {Catapult}
        clear LC4_Platoon[0] action queue
        a = 0
        begin loop
            Catapult = get siege weapon of player 0 nearest {LC4_Platoon[0]} radius 155
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC4_Platoon[0] action queue
            NumPat1 = get number of villagers in platoon LC4_Platoon[0]
            PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[0]} radius 200
            if PlayerPlatoon1 exists and LC4_Platoon[0] can navigate to {PlayerPlatoon1}
                a = 1
            end if
            until NumPat1 == 0 or Catapult not exists or not LC4_Platoon[0] can navigate to {Catapult} or a == 1 or Catapult not exists
        end loop
        clear LC4_Platoon[0] action queue
        a = 0
    end if
    
    if get size of LC4_Platoon[0] action queue < 1 and {LC4_Platoon[0]} not near {PlatoonPos[0]} radius 25
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {PlatoonPos[0]} to LC4_Platoon[0] action queue
    end if

    if LC4_Platoon[0] not exists
        //PlatoonKilled = 1
        wait until LC4_Platoon[0] exists
    end if
    
end loop

end script LC4_Platoon0Actions

begin script LC4_Platoon1Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    PlayerSettlement = 0
    
start

begin loop

    wait until LC4_Platoon[1] exists
    
    PlayerCreature = get distance from {LC4_Platoon[1]} to {oCreature}
    if PlayerCreature <= 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC4_Platoon[1] can navigate to {oCreature}
        clear LC4_Platoon[1] action queue
        begin loop
            PlayerCreature = get distance from {LC4_Platoon[1]} to {oCreature}
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC4_Platoon[1] action queue
            NumPat1 = get number of villagers in platoon LC4_Platoon[1]
            until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC4_Platoon[1] can navigate to {oCreature} or PlayerCreature > 200
        end loop
        clear LC4_Platoon[1] action queue
    end if
    
    PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[1]} radius 200
    Catapult = get siege weapon of player 0 nearest {LC4_Platoon[1]} radius 155
    if PlayerPlatoon1 exists and LC4_Platoon[1] can navigate to {PlayerPlatoon1}
        clear LC4_Platoon[1] action queue
        begin loop
            PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[1]} radius 200
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC4_Platoon[1] action queue
            NumPat1 = get number of villagers in platoon LC4_Platoon[1]
            HeTeste1 = get number of villagers in platoon PlayerPlatoon1
            until NumPat1 == 0 or HeTeste1 == 0 or not LC4_Platoon[1] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
        end loop
        clear LC4_Platoon[1] action queue
    elsif Catapult exists and LC4_Platoon[1] can navigate to {Catapult}
        clear LC4_Platoon[1] action queue
        a = 0
        begin loop
            Catapult = get siege weapon of player 0 nearest {LC4_Platoon[1]} radius 155
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC4_Platoon[1] action queue
            NumPat1 = get number of villagers in platoon LC4_Platoon[1]
            PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[1]} radius 200
            if PlayerPlatoon1 exists and LC4_Platoon[1] can navigate to {PlayerPlatoon1}
                a = 1
            end if
            until NumPat1 == 0 or Catapult not exists or not LC4_Platoon[1] can navigate to {Catapult} or a == 1 or Catapult not exists
        end loop
        clear LC4_Platoon[1] action queue
        a = 0
    end if
    
    if get size of LC4_Platoon[1] action queue < 1 and {LC4_Platoon[1]} not near {PlatoonPos[1]} radius 25
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {PlatoonPos[1]} to LC4_Platoon[1] action queue
    end if

    if LC4_Platoon[1] not exists
        //PlatoonKilled = 1
        wait until LC4_Platoon[1] exists
    end if
    
end loop

end script LC4_Platoon1Actions

begin script LC4_Platoon2Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    PlayerSettlement = 0
    
start

begin loop

    wait until LC4_Platoon[2] exists
    
    PlayerCreature = get distance from {LC4_Platoon[2]} to {oCreature}
    if PlayerCreature <= 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC4_Platoon[2] can navigate to {oCreature}
        clear LC4_Platoon[2] action queue
        begin loop
            PlayerCreature = get distance from {LC4_Platoon[2]} to {oCreature}
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC4_Platoon[2] action queue
            NumPat1 = get number of villagers in platoon LC4_Platoon[2]
            until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC4_Platoon[2] can navigate to {oCreature} or PlayerCreature > 200
        end loop
        clear LC4_Platoon[2] action queue
    end if
    
    PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[2]} radius 200
    Catapult = get siege weapon of player 0 nearest {LC4_Platoon[2]} radius 155
    if PlayerPlatoon1 exists and LC4_Platoon[2] can navigate to {PlayerPlatoon1}
        clear LC4_Platoon[2] action queue
        begin loop
            PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[2]} radius 200
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC4_Platoon[2] action queue
            NumPat1 = get number of villagers in platoon LC4_Platoon[2]
            HeTeste1 = get number of villagers in platoon PlayerPlatoon1
            until NumPat1 == 0 or HeTeste1 == 0 or not LC4_Platoon[2] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
        end loop
        clear LC4_Platoon[2] action queue
    elsif Catapult exists and LC4_Platoon[2] can navigate to {Catapult}
        clear LC4_Platoon[2] action queue
        a = 0
        begin loop
            Catapult = get siege weapon of player 0 nearest {LC4_Platoon[2]} radius 155
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC4_Platoon[2] action queue
            NumPat1 = get number of villagers in platoon LC4_Platoon[2]
            PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[2]} radius 200
            if PlayerPlatoon1 exists and LC4_Platoon[2] can navigate to {PlayerPlatoon1}
                a = 1
            end if
            until NumPat1 == 0 or Catapult not exists or not LC4_Platoon[2] can navigate to {Catapult} or a == 1 or Catapult not exists
        end loop
        clear LC4_Platoon[2] action queue
        a = 0
    end if
    
    if get size of LC4_Platoon[2] action queue < 1 and {LC4_Platoon[2]} not near {PlatoonPos[2]} radius 25
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {PlatoonPos[2]} to LC4_Platoon[2] action queue
    end if

    if LC4_Platoon[2] not exists
        //PlatoonKilled = 1
        wait until LC4_Platoon[2] exists
    end if
    
end loop

end script LC4_Platoon2Actions

begin script LC4_Platoon3Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    PlayerSettlement = 0
    
start

begin loop

    wait until LC4_Platoon[3] exists
    
    PlayerCreature = get distance from {LC4_Platoon[3]} to {oCreature}
    if PlayerCreature <= 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC4_Platoon[3] can navigate to {oCreature}
        clear LC4_Platoon[3] action queue
        begin loop
            PlayerCreature = get distance from {LC4_Platoon[3]} to {oCreature}
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC4_Platoon[3] action queue
            NumPat1 = get number of villagers in platoon LC4_Platoon[3]
            until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC4_Platoon[3] can navigate to {oCreature} or PlayerCreature > 200
        end loop
        clear LC4_Platoon[3] action queue
    end if
    
    PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[3]} radius 200
    Catapult = get siege weapon of player 0 nearest {LC4_Platoon[3]} radius 155
    if PlayerPlatoon1 exists and LC4_Platoon[3] can navigate to {PlayerPlatoon1}
        clear LC4_Platoon[3] action queue
        begin loop
            PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[3]} radius 200
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC4_Platoon[3] action queue
            NumPat1 = get number of villagers in platoon LC4_Platoon[3]
            HeTeste1 = get number of villagers in platoon PlayerPlatoon1
            until NumPat1 == 0 or HeTeste1 == 0 or not LC4_Platoon[3] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
        end loop
        clear LC4_Platoon[3] action queue
    elsif Catapult exists and LC4_Platoon[3] can navigate to {Catapult}
        clear LC4_Platoon[3] action queue
        a = 0
        begin loop
            Catapult = get siege weapon of player 0 nearest {LC4_Platoon[3]} radius 155
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC4_Platoon[3] action queue
            NumPat1 = get number of villagers in platoon LC4_Platoon[3]
            PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[3]} radius 200
            if PlayerPlatoon1 exists and LC4_Platoon[3] can navigate to {PlayerPlatoon1}
                a = 1
            end if
            until NumPat1 == 0 or Catapult not exists or not LC4_Platoon[3] can navigate to {Catapult} or a == 1 or Catapult not exists
        end loop
        clear LC4_Platoon[3] action queue
        a = 0
    end if
    
    if get size of LC4_Platoon[3] action queue < 1 and {LC4_Platoon[3]} not near {PlatoonPos[3]} radius 25
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {PlatoonPos[3]} to LC4_Platoon[3] action queue
    end if

    if LC4_Platoon[3] not exists
        //PlatoonKilled = 1
        wait until LC4_Platoon[3] exists
    end if
    
end loop

end script LC4_Platoon3Actions

begin script LC4_Platoon4Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    PlayerSettlement = 0
    
start

begin loop

    wait until LC4_Platoon[4] exists
    
    PlayerCreature = get distance from {LC4_Platoon[4]} to {oCreature}
    if PlayerCreature <= 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC4_Platoon[4] can navigate to {oCreature}
        clear LC4_Platoon[4] action queue
        begin loop
            PlayerCreature = get distance from {LC4_Platoon[4]} to {oCreature}
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC4_Platoon[4] action queue
            NumPat1 = get number of villagers in platoon LC4_Platoon[4]
            until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC4_Platoon[4] can navigate to {oCreature} or PlayerCreature > 200
        end loop
        clear LC4_Platoon[4] action queue
    end if
    
    PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[4]} radius 200
    Catapult = get siege weapon of player 0 nearest {LC4_Platoon[4]} radius 155
    if PlayerPlatoon1 exists and LC4_Platoon[4] can navigate to {PlayerPlatoon1}
        clear LC4_Platoon[4] action queue
        begin loop
            PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[4]} radius 200
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC4_Platoon[4] action queue
            NumPat1 = get number of villagers in platoon LC4_Platoon[4]
            HeTeste1 = get number of villagers in platoon PlayerPlatoon1
            until NumPat1 == 0 or HeTeste1 == 0 or not LC4_Platoon[4] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
        end loop
        clear LC4_Platoon[4] action queue
    elsif Catapult exists and LC4_Platoon[4] can navigate to {Catapult}
        clear LC4_Platoon[4] action queue
        a = 0
        begin loop
            Catapult = get siege weapon of player 0 nearest {LC4_Platoon[4]} radius 155
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC4_Platoon[4] action queue
            NumPat1 = get number of villagers in platoon LC4_Platoon[4]
            PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[4]} radius 200
            if PlayerPlatoon1 exists and LC4_Platoon[4] can navigate to {PlayerPlatoon1}
                a = 1
            end if
            until NumPat1 == 0 or Catapult not exists or not LC4_Platoon[4] can navigate to {Catapult} or a == 1 or Catapult not exists
        end loop
        clear LC4_Platoon[4] action queue
        a = 0
    end if
    
    if get size of LC4_Platoon[4] action queue < 1 and {LC4_Platoon[4]} not near {PlatoonPos[4]} radius 25
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {PlatoonPos[4]} to LC4_Platoon[4] action queue
    end if

    if LC4_Platoon[4] not exists
        //PlatoonKilled = 1
        wait until LC4_Platoon[4] exists
    end if
    
end loop

end script LC4_Platoon4Actions

begin script LC4_Platoon5Actions

    oCreature = get player 0 creature
    HeTeste3 = 0
    TestCreature2 = 0
    NumPat = 0
    NumPat5 = 0
    PlayerPlatoon1 = 0
    WorrNum = 0
    PlayerTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in PlayerTown min built 1.0
    ProPlatoonsLocation = 0
    AIPlatoon1 = 0
    Armory = 0
    Town8 = get town with id 8
    RandomActionP3 = 0
    a = 1
    Timer = create timer for 0 seconds
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    oWall = 0
    PlayerCatapult1 = 0
    PlayerPlatoonInRange = 0
    Number = 0
    NumPat1 = 0
    PlayerSettlement = 0
    PlayerCreature = 0
    AttackMode = 0
    Building = 0
    RecalculateTimer = create timer for 0 seconds

start

begin loop
    a = 1
    wait until LC4_Platoon[5] exists and LC4_Platoon[6] exists and LC4_Platoon[7] exists
    begin loop
        TestCreature2 = get distance from {LC4_Platoon[5]} to {oCreature}
        if TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC4_Platoon[5] can navigate to {oCreature}
            clear LC4_Platoon[5] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC4_Platoon[5] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[5]
                TestCreature2 = get distance from {LC4_Platoon[5]} to {oCreature}
                until NumPat5 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC4_Platoon[5] can navigate to {oCreature} or TestCreature2 > 150
            end loop
        end if
        PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[5]} radius 150
        PlayerCatapult1 = get siege weapon of player 0 nearest {LC4_Platoon[5]} radius 150
        if PlayerPlatoon1 exists and LC4_Platoon[5] can navigate to {PlayerPlatoon1}
            clear LC4_Platoon[5] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC4_Platoon[5] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[5]
                HeTeste3 = get number of villagers in platoon PlayerPlatoon1
                until NumPat5 == 0 or HeTeste3 == 0 or not LC4_Platoon[5] can navigate to {PlayerPlatoon1}
            end loop
        elsif PlayerCatapult1 exists and LC4_Platoon[5] can navigate to {PlayerCatapult1}
            clear LC4_Platoon[5] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using PlayerCatapult1 to LC4_Platoon[5] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[5]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[5]} radius 150
                if PlayerPlatoon1 exists and LC4_Platoon[5] can navigate to {PlayerPlatoon1}
                    PlayerPlatoonInRange = 1
                end if
                until NumPat5 == 0 or PlayerCatapult1 not exists or not LC4_Platoon[5] can navigate to {PlayerCatapult1} or PlayerPlatoonInRange == 1
            end loop
            PlayerPlatoonInRange = 0
        end if
        PlayerSettlement = get nearest town at {LC4_Platoon[5]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0
            if LC4_Platoon[5] can navigate to object Armory
                clear LC4_Platoon[5] action queue
                set LC4_Platoon[5] attack PlayerSettlement with severity 0.3 for takeover
                a = 1
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[5]} radius 150
                    PlayerCreature = get distance from {LC4_Platoon[5]} to {oCreature}
                    if PlayerPlatoon1 exists
                        a = 0
                    elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                        a = 0
                    elsif not LC4_Platoon[5] can navigate to object Armory
                        a = 0
                    elsif LC4_Platoon[5] not exists
                        a = 0
                    end if
                    until a == 0 or LC4_Platoon[5] not exists or PLAYER of PlayerSettlement == 1
                end loop
                clear LC4_Platoon[5] action queue
            end if
        end if
        if LC4_Platoon[5] can navigate to {AttackPos[0]} and get size of LC4_Platoon[5] action queue < 1
            clear LC4_Platoon[5] action queue
            add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[0]} to LC4_Platoon[5] action queue
        end if
        until LC4_Platoon[5] not exists or {LC4_Platoon[5]} near {AttackPos[0]}
    end loop
    
    begin loop //Attack
        TestCreature2 = get distance from {LC4_Platoon[5]} to {oCreature}
        if TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC4_Platoon[5] can navigate to {oCreature}
            clear LC4_Platoon[5] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC4_Platoon[5] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[5]
                TestCreature2 = get distance from {LC4_Platoon[5]} to {oCreature}
                until NumPat5 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC4_Platoon[5] can navigate to {oCreature} or TestCreature2 > 150
            end loop
        end if
        PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[5]} radius 150
        PlayerCatapult1 = get siege weapon of player 0 nearest {LC4_Platoon[5]} radius 150
        if PlayerPlatoon1 exists and LC4_Platoon[5] can navigate to {PlayerPlatoon1}
            clear LC4_Platoon[5] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC4_Platoon[5] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[5]
                HeTeste3 = get number of villagers in platoon PlayerPlatoon1
                until NumPat5 == 0 or HeTeste3 == 0 or not LC4_Platoon[5] can navigate to {PlayerPlatoon1}
            end loop
        elsif PlayerCatapult1 exists and LC4_Platoon[5] can navigate to {PlayerCatapult1}
            clear LC4_Platoon[5] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using PlayerCatapult1 to LC4_Platoon[5] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[5]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[5]} radius 150
                if PlayerPlatoon1 exists and LC4_Platoon[5] can navigate to {PlayerPlatoon1}
                    PlayerPlatoonInRange = 1
                end if
                until NumPat5 == 0 or PlayerCatapult1 not exists or not LC4_Platoon[5] can navigate to {PlayerCatapult1} or PlayerPlatoonInRange == 1
            end loop
            PlayerPlatoonInRange = 0
        end if
        PlayerSettlement = get nearest town at {LC4_Platoon[5]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0
            if LC4_Platoon[5] can navigate to object Armory
                clear LC4_Platoon[5] action queue
                set LC4_Platoon[5] attack PlayerSettlement with severity 0.3 for takeover
                a = 1
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[5]} radius 150
                    PlayerCreature = get distance from {LC4_Platoon[5]} to {oCreature}
                    if PlayerPlatoon1 exists
                        a = 0
                    elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                        a = 0
                    elsif not LC4_Platoon[5] can navigate to object Armory
                        a = 0
                    elsif LC4_Platoon[5] not exists
                        a = 0
                    end if
                    until a == 0 or LC4_Platoon[5] not exists or PLAYER of PlayerSettlement == 1
                end loop
                clear LC4_Platoon[5] action queue
            end if
        end if
        if LC4_Platoon[5] can navigate to object PlayerTownCentre
            //wait number from 5 to 25 seconds
            a = 1
            clear LC4_Platoon[5] action queue
            Number = number from 1 to 4
            if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                AttackMode = 1
                set LC4_Platoon[5] attack PlayerTown with severity 0.2
            elsif Number == 3 or Number == 4 //Destroy value buildings
                AttackMode = 2
                Building = 0
                Timer = create timer for 2 seconds
                begin loop
                    Number = number from 1 to 8
                    if Number == 1 or Number == 2 or Number == 3
                        Building = get building ALTAR in PlayerTown min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[5] action queue
                        else
                            Building = 0
                        end if
                    elsif Number == 4
                        Building = get building TEMPLE in PlayerTown min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[5] action queue
                        else
                            Building = 0
                        end if
                    elsif Number == 5
                        Building = get building CREATURE_PEN in PlayerTown min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[5] action queue
                        else
                            Building = 0
                        end if
                    elsif Number == 6
                        Building = get building UNIVERSITY in PlayerTown min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[5] action queue
                        else
                            Building = 0
                        end if
                    elsif Number == 7
                        Building = get building BATHHOUSE in PlayerTown min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[5] action queue
                        else
                            Building = 0
                        end if
                    elsif Number == 8
                        Building = get building AMPITHEATRE in PlayerTown min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[5] action queue
                        else
                            Building = 0
                        end if
                    end if
                    until Building != 0 or get Timer time remaining <= 0
                end loop
            else //Capture Town
                AttackMode = 0
                set LC4_Platoon[5] attack PlayerTown with severity 0.3 for takeover
            end if
            RecalculateTimer = create timer for 40 seconds //Recalculate every 40 seconds to prevent stucked platoons
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[5]} radius 150
                TestCreature2 = get distance from {LC4_Platoon[5]} to {MyCreature}
                NumPat1 = get number of villagers in platoon LC4_Platoon[5]
                //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC4_Platoon[5] can navigate to object PlayerTownCentre
                    if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                        a = 0
                    elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                        a = 0
                    elsif not LC4_Platoon[5] can navigate to object PlayerTownCentre
                        a = 0
                    elsif LC4_Platoon[5] not exists
                        a = 0
                    elsif AttackMode == 1 and HEALTH of MyCreature == 0
                        a = 0
                    elsif AttackMode == 2 and Building not exists
                        a = 0
                    elsif AttackMode == 2 and HEALTH of Building < 0.1
                        a = 0
                    elsif AttackMode == 2 and Building == 0
                        a = 0
                    elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                        a = 0
                    end if
                //end if
                until a == 0 or LC4_Platoon[5] not exists
            end loop
            clear LC4_Platoon[5] action queue
        elsif LC4_Platoon[5] can navigate to {AttackPos[0]}
            clear LC4_Platoon[5] action queue
            add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[0]} to LC4_Platoon[5] action queue
        end if
        until LC4_Platoon[5] not exists
    end loop
    if LC4_Platoon[5] not exists
        //PlatoonKilled = 1
        wait until LC4_Platoon[5] exists
    end if
end loop

end script LC4_Platoon5Actions

begin script LC4_Platoon6Actions

    oCreature = get player 0 creature
    HeTeste3 = 0
    TestCreature2 = 0
    NumPat = 0
    NumPat5 = 0
    PlayerPlatoon1 = 0
    WorrNum = 0
    PlayerTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in PlayerTown min built 1.0
    ProPlatoonsLocation = 0
    AIPlatoon1 = 0
    Armory = 0
    Town8 = get town with id 8
    RandomActionP3 = 0
    a = 1
    Timer = create timer for 0 seconds
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    oWall = 0
    PlayerCatapult1 = 0
    PlayerPlatoonInRange = 0
    Number = 0
    NumPat1 = 0
    PlayerSettlement = 0
    PlayerCreature = 0
    AttackMode = 0
    Building = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 1
    wait until LC4_Platoon[5] exists and LC4_Platoon[6] exists and LC4_Platoon[7] exists
    begin loop
        TestCreature2 = get distance from {LC4_Platoon[6]} to {oCreature}
        if TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC4_Platoon[6] can navigate to {oCreature}
            clear LC4_Platoon[6] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC4_Platoon[6] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[6]
                TestCreature2 = get distance from {LC4_Platoon[6]} to {oCreature}
                until NumPat5 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC4_Platoon[6] can navigate to {oCreature} or TestCreature2 > 150
            end loop
        end if
        PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[6]} radius 150
        PlayerCatapult1 = get siege weapon of player 0 nearest {LC4_Platoon[6]} radius 150
        if PlayerPlatoon1 exists and LC4_Platoon[6] can navigate to {PlayerPlatoon1}
            clear LC4_Platoon[6] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC4_Platoon[6] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[6]
                HeTeste3 = get number of villagers in platoon PlayerPlatoon1
                until NumPat5 == 0 or HeTeste3 == 0 or not LC4_Platoon[6] can navigate to {PlayerPlatoon1}
            end loop
        elsif PlayerCatapult1 exists and LC4_Platoon[6] can navigate to {PlayerCatapult1}
            clear LC4_Platoon[6] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using PlayerCatapult1 to LC4_Platoon[6] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[6]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[6]} radius 150
                if PlayerPlatoon1 exists and LC4_Platoon[6] can navigate to {PlayerPlatoon1}
                    PlayerPlatoonInRange = 1
                end if
                until NumPat5 == 0 or PlayerCatapult1 not exists or not LC4_Platoon[6] can navigate to {PlayerCatapult1} or PlayerPlatoonInRange == 1
            end loop
            PlayerPlatoonInRange = 0
        end if
        PlayerSettlement = get nearest town at {LC4_Platoon[6]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0
            if LC4_Platoon[6] can navigate to object Armory
                clear LC4_Platoon[6] action queue
                set LC4_Platoon[6] attack PlayerSettlement with severity 0.3 for takeover
                a = 1
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[6]} radius 150
                    PlayerCreature = get distance from {LC4_Platoon[6]} to {oCreature}
                    if PlayerPlatoon1 exists
                        a = 0
                    elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                        a = 0
                    elsif not LC4_Platoon[6] can navigate to object Armory
                        a = 0
                    elsif LC4_Platoon[6] not exists
                        a = 0
                    end if
                    until a == 0 or LC4_Platoon[6] not exists or PLAYER of PlayerSettlement == 1
                end loop
                clear LC4_Platoon[6] action queue
            end if
        end if
        if LC4_Platoon[6] can navigate to {AttackPos[1]} and get size of LC4_Platoon[6] action queue < 1
            clear LC4_Platoon[6] action queue
            add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[1]} to LC4_Platoon[6] action queue
        end if
        until LC4_Platoon[6] not exists or {LC4_Platoon[6]} near {AttackPos[1]}
    end loop
    
    begin loop //Attack
        TestCreature2 = get distance from {LC4_Platoon[6]} to {oCreature}
        if TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC4_Platoon[6] can navigate to {oCreature}
            clear LC4_Platoon[6] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC4_Platoon[6] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[6]
                TestCreature2 = get distance from {LC4_Platoon[6]} to {oCreature}
                until NumPat5 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC4_Platoon[6] can navigate to {oCreature} or TestCreature2 > 150
            end loop
        end if
        PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[6]} radius 150
        PlayerCatapult1 = get siege weapon of player 0 nearest {LC4_Platoon[6]} radius 150
        if PlayerPlatoon1 exists and LC4_Platoon[6] can navigate to {PlayerPlatoon1}
            clear LC4_Platoon[6] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC4_Platoon[6] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[6]
                HeTeste3 = get number of villagers in platoon PlayerPlatoon1
                until NumPat5 == 0 or HeTeste3 == 0 or not LC4_Platoon[6] can navigate to {PlayerPlatoon1}
            end loop
        elsif PlayerCatapult1 exists and LC4_Platoon[6] can navigate to {PlayerCatapult1}
            clear LC4_Platoon[6] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using PlayerCatapult1 to LC4_Platoon[6] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[6]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[6]} radius 150
                if PlayerPlatoon1 exists and LC4_Platoon[6] can navigate to {PlayerPlatoon1}
                    PlayerPlatoonInRange = 1
                end if
                until NumPat5 == 0 or PlayerCatapult1 not exists or not LC4_Platoon[6] can navigate to {PlayerCatapult1} or PlayerPlatoonInRange == 1
            end loop
            PlayerPlatoonInRange = 0
        end if
        PlayerSettlement = get nearest town at {LC4_Platoon[6]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0
            if LC4_Platoon[6] can navigate to object Armory
                clear LC4_Platoon[6] action queue
                set LC4_Platoon[6] attack PlayerSettlement with severity 0.3 for takeover
                a = 1
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[6]} radius 150
                    PlayerCreature = get distance from {LC4_Platoon[6]} to {oCreature}
                    if PlayerPlatoon1 exists
                        a = 0
                    elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                        a = 0
                    elsif not LC4_Platoon[6] can navigate to object Armory
                        a = 0
                    elsif LC4_Platoon[6] not exists
                        a = 0
                    end if
                    until a == 0 or LC4_Platoon[6] not exists or PLAYER of PlayerSettlement == 1
                end loop
                clear LC4_Platoon[6] action queue
            end if
        end if
        if LC4_Platoon[6] can navigate to object PlayerTownCentre
            //wait number from 5 to 25 seconds
            a = 1
            clear LC4_Platoon[6] action queue
            Number = number from 1 to 4
            if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                AttackMode = 1
                set LC4_Platoon[6] attack PlayerTown with severity 0.2
            elsif Number == 3 or Number == 4 //Destroy value buildings
                AttackMode = 2
                Building = 0
                Timer = create timer for 2 seconds
                begin loop
                    Number = number from 1 to 8
                    if Number == 1 or Number == 2 or Number == 3
                        Building = get building ALTAR in PlayerTown min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[6] action queue
                        else
                            Building = 0
                        end if
                    elsif Number == 4
                        Building = get building TEMPLE in PlayerTown min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[6] action queue
                        else
                            Building = 0
                        end if
                    elsif Number == 5
                        Building = get building CREATURE_PEN in PlayerTown min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[6] action queue
                        else
                            Building = 0
                        end if
                    elsif Number == 6
                        Building = get building UNIVERSITY in PlayerTown min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[6] action queue
                        else
                            Building = 0
                        end if
                    elsif Number == 7
                        Building = get building BATHHOUSE in PlayerTown min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[6] action queue
                        else
                            Building = 0
                        end if
                    elsif Number == 8
                        Building = get building AMPITHEATRE in PlayerTown min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[6] action queue
                        else
                            Building = 0
                        end if
                    end if
                    until Building != 0 or get Timer time remaining <= 0
                end loop
            else //Capture Town
                AttackMode = 0
                set LC4_Platoon[6] attack PlayerTown with severity 0.3 for takeover
            end if
            RecalculateTimer = create timer for 40 seconds //Recalculate every 40 seconds to prevent stucked platoons
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[6]} radius 150
                TestCreature2 = get distance from {LC4_Platoon[6]} to {MyCreature}
                NumPat1 = get number of villagers in platoon LC4_Platoon[6]
                //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC4_Platoon[6] can navigate to object PlayerTownCentre
                    if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                        a = 0
                    elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                        a = 0
                    elsif not LC4_Platoon[6] can navigate to object PlayerTownCentre
                        a = 0
                    elsif LC4_Platoon[6] not exists
                        a = 0
                    elsif AttackMode == 1 and HEALTH of MyCreature == 0
                        a = 0
                    elsif AttackMode == 2 and Building not exists
                        a = 0
                    elsif AttackMode == 2 and HEALTH of Building < 0.1
                        a = 0
                    elsif AttackMode == 2 and Building == 0
                        a = 0
                    elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                        a = 0
                    end if
                //end if
                until a == 0 or LC4_Platoon[6] not exists
            end loop
            clear LC4_Platoon[6] action queue
        elsif LC4_Platoon[6] can navigate to {AttackPos[1]}
            clear LC4_Platoon[6] action queue
            add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[1]} to LC4_Platoon[6] action queue
        end if
        until LC4_Platoon[6] not exists
    end loop
    if LC4_Platoon[6] not exists
        //PlatoonKilled = 1
        wait until LC4_Platoon[6] exists
    end if
end loop

end script LC4_Platoon6Actions

begin script LC4_Platoon7Actions

    oCreature = get player 0 creature
    HeTeste3 = 0
    TestCreature2 = 0
    NumPat = 0
    NumPat5 = 0
    PlayerPlatoon1 = 0
    WorrNum = 0
    PlayerTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in PlayerTown min built 1.0
    ProPlatoonsLocation = 0
    AIPlatoon1 = 0
    Armory = 0
    Town8 = get town with id 8
    RandomActionP3 = 0
    a = 1
    Timer = create timer for 0 seconds
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    oWall = 0
    PlayerCatapult1 = 0
    PlayerPlatoonInRange = 0
    Number = 0
    NumPat1 = 0
    PlayerSettlement = 0
    PlayerCreature = 0
    AttackMode = 0
    Building = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 1
    wait until LC4_Platoon[5] exists and LC4_Platoon[6] exists and LC4_Platoon[7] exists
    begin loop
        TestCreature2 = get distance from {LC4_Platoon[7]} to {oCreature}
        if TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC4_Platoon[7] can navigate to {oCreature}
            clear LC4_Platoon[7] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC4_Platoon[7] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[7]
                TestCreature2 = get distance from {LC4_Platoon[7]} to {oCreature}
                until NumPat5 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC4_Platoon[7] can navigate to {oCreature} or TestCreature2 > 150
            end loop
        end if
        PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[7]} radius 150
        PlayerCatapult1 = get siege weapon of player 0 nearest {LC4_Platoon[7]} radius 150
        if PlayerPlatoon1 exists and LC4_Platoon[7] can navigate to {PlayerPlatoon1}
            clear LC4_Platoon[7] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC4_Platoon[7] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[7]
                HeTeste3 = get number of villagers in platoon PlayerPlatoon1
                until NumPat5 == 0 or HeTeste3 == 0 or not LC4_Platoon[7] can navigate to {PlayerPlatoon1}
            end loop
        elsif PlayerCatapult1 exists and LC4_Platoon[7] can navigate to {PlayerCatapult1}
            clear LC4_Platoon[7] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using PlayerCatapult1 to LC4_Platoon[7] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[7]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[7]} radius 150
                if PlayerPlatoon1 exists and LC4_Platoon[7] can navigate to {PlayerPlatoon1}
                    PlayerPlatoonInRange = 1
                end if
                until NumPat5 == 0 or PlayerCatapult1 not exists or not LC4_Platoon[7] can navigate to {PlayerCatapult1} or PlayerPlatoonInRange == 1
            end loop
            PlayerPlatoonInRange = 0
        end if
        PlayerSettlement = get nearest town at {LC4_Platoon[7]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0
            if LC4_Platoon[7] can navigate to object Armory
                clear LC4_Platoon[7] action queue
                set LC4_Platoon[7] attack PlayerSettlement with severity 0.3 for takeover
                a = 1
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[7]} radius 150
                    PlayerCreature = get distance from {LC4_Platoon[7]} to {oCreature}
                    if PlayerPlatoon1 exists
                        a = 0
                    elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                        a = 0
                    elsif not LC4_Platoon[7] can navigate to object Armory
                        a = 0
                    elsif LC4_Platoon[7] not exists
                        a = 0
                    end if
                    until a == 0 or LC4_Platoon[7] not exists or PLAYER of PlayerSettlement == 1
                end loop
                clear LC4_Platoon[7] action queue
            end if
        end if
        if LC4_Platoon[7] can navigate to {AttackPos[2]} and get size of LC4_Platoon[7] action queue < 1
            clear LC4_Platoon[7] action queue
            add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[2]} to LC4_Platoon[7] action queue
        end if
        until LC4_Platoon[7] not exists or {LC4_Platoon[7]} near {AttackPos[2]}
    end loop
    
    begin loop //Attack
        TestCreature2 = get distance from {LC4_Platoon[7]} to {oCreature}
        if TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC4_Platoon[7] can navigate to {oCreature}
            clear LC4_Platoon[7] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC4_Platoon[7] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[7]
                TestCreature2 = get distance from {LC4_Platoon[7]} to {oCreature}
                until NumPat5 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC4_Platoon[7] can navigate to {oCreature} or TestCreature2 > 150
            end loop
        end if
        PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[7]} radius 150
        PlayerCatapult1 = get siege weapon of player 0 nearest {LC4_Platoon[7]} radius 150
        if PlayerPlatoon1 exists and LC4_Platoon[7] can navigate to {PlayerPlatoon1}
            clear LC4_Platoon[7] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC4_Platoon[7] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[7]
                HeTeste3 = get number of villagers in platoon PlayerPlatoon1
                until NumPat5 == 0 or HeTeste3 == 0 or not LC4_Platoon[7] can navigate to {PlayerPlatoon1}
            end loop
        elsif PlayerCatapult1 exists and LC4_Platoon[7] can navigate to {PlayerCatapult1}
            clear LC4_Platoon[7] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using PlayerCatapult1 to LC4_Platoon[7] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[7]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[7]} radius 150
                if PlayerPlatoon1 exists and LC4_Platoon[7] can navigate to {PlayerPlatoon1}
                    PlayerPlatoonInRange = 1
                end if
                until NumPat5 == 0 or PlayerCatapult1 not exists or not LC4_Platoon[7] can navigate to {PlayerCatapult1} or PlayerPlatoonInRange == 1
            end loop
            PlayerPlatoonInRange = 0
        end if
        if LC4_Platoon[7] can navigate to object PlayerTownCentre
            //wait number from 5 to 25 seconds
            a = 1
            clear LC4_Platoon[7] action queue
            Number = number from 1 to 4
            if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                AttackMode = 1
                set LC4_Platoon[7] attack PlayerTown with severity 0.2
            elsif Number == 3 or Number == 4 //Destroy value buildings
                AttackMode = 2
                Building = 0
                Timer = create timer for 2 seconds
                begin loop
                    Number = number from 1 to 8
                    if Number == 1 or Number == 2 or Number == 3
                        Building = get building ALTAR in PlayerTown min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[7] action queue
                        else
                            Building = 0
                        end if
                    elsif Number == 4
                        Building = get building TEMPLE in PlayerTown min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[7] action queue
                        else
                            Building = 0
                        end if
                    elsif Number == 5
                        Building = get building CREATURE_PEN in PlayerTown min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[7] action queue
                        else
                            Building = 0
                        end if
                    elsif Number == 6
                        Building = get building UNIVERSITY in PlayerTown min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[7] action queue
                        else
                            Building = 0
                        end if
                    elsif Number == 7
                        Building = get building BATHHOUSE in PlayerTown min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[7] action queue
                        else
                            Building = 0
                        end if
                    elsif Number == 8
                        Building = get building AMPITHEATRE in PlayerTown min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[7] action queue
                        else
                            Building = 0
                        end if
                    end if
                    until Building != 0 or get Timer time remaining <= 0
                end loop
            else //Capture Town
                AttackMode = 0
                set LC4_Platoon[7] attack PlayerTown with severity 0.3 for takeover
            end if
            RecalculateTimer = create timer for 40 seconds //Recalculate every 40 seconds to prevent stucked platoons
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[7]} radius 150
                TestCreature2 = get distance from {LC4_Platoon[7]} to {MyCreature}
                NumPat1 = get number of villagers in platoon LC4_Platoon[7]
                //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC4_Platoon[7] can navigate to object PlayerTownCentre
                    if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                        a = 0
                    elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                        a = 0
                    elsif not LC4_Platoon[7] can navigate to object PlayerTownCentre
                        a = 0
                    elsif LC4_Platoon[7] not exists
                        a = 0
                    elsif AttackMode == 1 and HEALTH of MyCreature == 0
                        a = 0
                    elsif AttackMode == 2 and Building not exists
                        a = 0
                    elsif AttackMode == 2 and HEALTH of Building < 0.1
                        a = 0
                    elsif AttackMode == 2 and Building == 0
                        a = 0
                    elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                        a = 0
                    end if
                //end if
                until a == 0 or LC4_Platoon[7] not exists
            end loop
            clear LC4_Platoon[7] action queue
        elsif LC4_Platoon[7] can navigate to {AttackPos[2]}
            clear LC4_Platoon[7] action queue
            add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[2]} to LC4_Platoon[7] action queue
        end if
        until LC4_Platoon[7] not exists
    end loop
    if LC4_Platoon[7] not exists
        //PlatoonKilled = 1
        wait until LC4_Platoon[7] exists
    end if
end loop

end script LC4_Platoon7Actions

begin script LC4_Platoon12Actions

    oCreature = get player 0 creature
    HeTeste3 = 0
    TestCreature2 = 0
    NumPat = 0
    NumPat5 = 0
    PlayerPlatoon1 = 0
    WorrNum = 0
    PlayerTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in PlayerTown min built 1.0
    ProPlatoonsLocation = 0
    AIPlatoon1 = 0
    Armory = 0
    Town8 = get town with id 8
    RandomActionP3 = 0
    a = 1
    Timer = create timer for 0 seconds
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    oWall = 0
    PlayerCatapult1 = 0
    PlayerPlatoonInRange = 0
    Number = 0
    NumPat1 = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 1
    wait until LC4_Platoon[12] exists
    begin loop
        TestCreature2 = get distance from {LC4_Platoon[12]} to {oCreature}
        if TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC4_Platoon[12] can navigate to {oCreature}
            clear LC4_Platoon[12] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC4_Platoon[12] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[12]
                TestCreature2 = get distance from {LC4_Platoon[12]} to {oCreature}
                until NumPat5 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC4_Platoon[12] can navigate to {oCreature} or TestCreature2 > 150
            end loop
        end if
        PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[12]} radius 150
        PlayerCatapult1 = get siege weapon of player 0 nearest {LC4_Platoon[12]} radius 150
        if PlayerPlatoon1 exists and LC4_Platoon[12] can navigate to {PlayerPlatoon1}
            clear LC4_Platoon[12] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC4_Platoon[12] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[12]
                HeTeste3 = get number of villagers in platoon PlayerPlatoon1
                until NumPat5 == 0 or HeTeste3 == 0 or not LC4_Platoon[12] can navigate to {PlayerPlatoon1}
            end loop
        elsif PlayerCatapult1 exists and LC4_Platoon[12] can navigate to {PlayerCatapult1}
            clear LC4_Platoon[12] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using PlayerCatapult1 to LC4_Platoon[12] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[12]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[12]} radius 150
                if PlayerPlatoon1 exists and LC4_Platoon[12] can navigate to {PlayerPlatoon1}
                    PlayerPlatoonInRange = 1
                end if
                until NumPat5 == 0 or PlayerCatapult1 not exists or not LC4_Platoon[12] can navigate to {PlayerCatapult1} or PlayerPlatoonInRange == 1
            end loop
            PlayerPlatoonInRange = 0
        end if
        if LC4_Platoon[12] can navigate to {AttackPos[3]} and get size of LC4_Platoon[12] action queue < 1
            clear LC4_Platoon[12] action queue
            add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[3]} to LC4_Platoon[12] action queue
        end if
        until LC4_Platoon[12] not exists or {LC4_Platoon[12]} near {AttackPos[3]}
    end loop
    
    begin loop //Attack
        TestCreature2 = get distance from {LC4_Platoon[12]} to {oCreature}
        if TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC4_Platoon[12] can navigate to {oCreature}
            clear LC4_Platoon[12] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC4_Platoon[12] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[12]
                TestCreature2 = get distance from {LC4_Platoon[12]} to {oCreature}
                until NumPat5 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC4_Platoon[12] can navigate to {oCreature} or TestCreature2 > 150
            end loop
        end if
        PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[12]} radius 150
        PlayerCatapult1 = get siege weapon of player 0 nearest {LC4_Platoon[12]} radius 150
        if PlayerPlatoon1 exists and LC4_Platoon[12] can navigate to {PlayerPlatoon1}
            clear LC4_Platoon[12] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC4_Platoon[12] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[12]
                HeTeste3 = get number of villagers in platoon PlayerPlatoon1
                until NumPat5 == 0 or HeTeste3 == 0 or not LC4_Platoon[12] can navigate to {PlayerPlatoon1}
            end loop
        elsif PlayerCatapult1 exists and LC4_Platoon[12] can navigate to {PlayerCatapult1}
            clear LC4_Platoon[12] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using PlayerCatapult1 to LC4_Platoon[12] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[12]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[12]} radius 150
                if PlayerPlatoon1 exists and LC4_Platoon[12] can navigate to {PlayerPlatoon1}
                    PlayerPlatoonInRange = 1
                end if
                until NumPat5 == 0 or PlayerCatapult1 not exists or not LC4_Platoon[12] can navigate to {PlayerCatapult1} or PlayerPlatoonInRange == 1
            end loop
            PlayerPlatoonInRange = 0
        end if
        if LC4_Platoon[12] can navigate to object PlayerTownCentre
            //wait number from 5 to 25 seconds
            a = 1
            clear LC4_Platoon[12] action queue
            Number = number from 1 to 4
            if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                AttackMode = 1
                set LC4_Platoon[12] attack PlayerTown with severity 0.2
            elsif Number == 3 or Number == 4 //Destroy value buildings
                AttackMode = 2
                Building = 0
                Timer = create timer for 2 seconds
                begin loop
                    Number = number from 1 to 8
                    if Number == 1 or Number == 2 or Number == 3
                        Building = get building ALTAR in PlayerTown min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[12] action queue
                        else
                            Building = 0
                        end if
                    elsif Number == 4
                        Building = get building TEMPLE in PlayerTown min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[12] action queue
                        else
                            Building = 0
                        end if
                    elsif Number == 5
                        Building = get building CREATURE_PEN in PlayerTown min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[12] action queue
                        else
                            Building = 0
                        end if
                    elsif Number == 6
                        Building = get building UNIVERSITY in PlayerTown min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[12] action queue
                        else
                            Building = 0
                        end if
                    elsif Number == 7
                        Building = get building BATHHOUSE in PlayerTown min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[12] action queue
                        else
                            Building = 0
                        end if
                    elsif Number == 8
                        Building = get building AMPITHEATRE in PlayerTown min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[12] action queue
                        else
                            Building = 0
                        end if
                    end if
                    until Building != 0 or get Timer time remaining <= 0
                end loop
            else //Capture Town
                AttackMode = 0
                set LC4_Platoon[12] attack PlayerTown with severity 0.3 for takeover
            end if
            RecalculateTimer = create timer for 40 seconds //Recalculate every 40 seconds to prevent stucked platoons
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[12]} radius 150
                TestCreature2 = get distance from {LC4_Platoon[12]} to {MyCreature}
                NumPat1 = get number of villagers in platoon LC4_Platoon[12]
                //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC4_Platoon[12] can navigate to object PlayerTownCentre
                    if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                        a = 0
                    elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                        a = 0
                    elsif not LC4_Platoon[12] can navigate to object PlayerTownCentre
                        a = 0
                    elsif LC4_Platoon[12] not exists
                        a = 0
                    elsif AttackMode == 1 and HEALTH of MyCreature == 0
                        a = 0
                    elsif AttackMode == 2 and Building not exists
                        a = 0
                    elsif AttackMode == 2 and HEALTH of Building < 0.1
                        a = 0
                    elsif AttackMode == 2 and Building == 0
                        a = 0
                    elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                        a = 0
                    end if
                //end if
                until a == 0 or LC4_Platoon[12] not exists
            end loop
            clear LC4_Platoon[12] action queue
        elsif LC4_Platoon[12] can navigate to {AttackPos[3]}
            clear LC4_Platoon[12] action queue
            add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[3]} to LC4_Platoon[12] action queue
        end if
        until LC4_Platoon[12] not exists
    end loop
    if LC4_Platoon[12] not exists
        //PlatoonKilled = 1
        wait until LC4_Platoon[12] exists
    end if
end loop

end script LC4_Platoon12Actions

begin script LC4_Platoon13Actions

    oCreature = get player 0 creature
    HeTeste3 = 0
    TestCreature2 = 0
    NumPat = 0
    NumPat5 = 0
    PlayerPlatoon1 = 0
    WorrNum = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    ProPlatoonsLocation = 0
    AIPlatoon1 = 0
    Armory = 0
    Town8 = get town with id 8
    RandomActionP3 = 0
    a = 1
    Timer = create timer for 0 seconds
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    oWall = 0
    PlayerCatapult1 = 0
    PlayerPlatoonInRange = 0
    Number = 0
    NumPat1 = 0
    PlayerSettlement = 0
    PlayerCreature = 0
    AttackMode = 0
    Building = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 1
    wait until LC4_SiegeCatapult[0] exists and LC4_Platoon[13] exists and ({LC4_SiegeCatapult[0]} near {NorseCapital} radius 300)
    disable platoon LC4_Platoon[13] camp
    begin loop
        TestCreature2 = get distance from {LC4_Platoon[13]} to {oCreature}
        if TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC4_Platoon[13] can navigate to {oCreature}
            clear LC4_Platoon[13] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC4_Platoon[13] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[13]
                TestCreature2 = get distance from {LC4_Platoon[13]} to {oCreature}
                until NumPat5 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC4_Platoon[13] can navigate to {oCreature} or TestCreature2 > 150
            end loop
        end if
        PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[13]} radius 150
        PlayerCatapult1 = get siege weapon of player 0 nearest {LC4_Platoon[13]} radius 100
        if PlayerPlatoon1 exists and LC4_Platoon[13] can navigate to {PlayerPlatoon1}
            clear LC4_Platoon[13] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC4_Platoon[13] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[13]
                HeTeste3 = get number of villagers in platoon PlayerPlatoon1
                until NumPat5 == 0 or HeTeste3 == 0 or not LC4_Platoon[13] can navigate to {PlayerPlatoon1}
            end loop
        elsif PlayerCatapult1 exists and LC4_Platoon[13] can navigate to {PlayerCatapult1}
            clear LC4_Platoon[13] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using PlayerCatapult1 to LC4_Platoon[13] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[13]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[13]} radius 150
                if PlayerPlatoon1 exists and LC4_Platoon[13] can navigate to {PlayerPlatoon1}
                    PlayerPlatoonInRange = 1
                end if
                until NumPat5 == 0 or PlayerCatapult1 not exists or not LC4_Platoon[13] can navigate to {PlayerCatapult1} or PlayerPlatoonInRange == 1
            end loop
            PlayerPlatoonInRange = 0
        end if
        PlayerSettlement = get nearest town at {LC4_Platoon[13]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0
            if LC4_Platoon[13] can navigate to object Armory
                clear LC4_Platoon[13] action queue
                set LC4_Platoon[13] attack PlayerSettlement with severity 0.3 for takeover
                a = 1
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[13]} radius 150
                    PlayerCreature = get distance from {LC4_Platoon[13]} to {oCreature}
                    if PlayerPlatoon1 exists
                        a = 0
                    elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                        a = 0
                    elsif not LC4_Platoon[13] can navigate to object Armory
                        a = 0
                    elsif LC4_Platoon[13] not exists
                        a = 0
                    end if
                    until a == 0 or LC4_Platoon[13] not exists or PLAYER of PlayerSettlement == 1
                end loop
                clear LC4_Platoon[13] action queue
            end if
        end if
        if LC4_SiegeCatapult[0] exists
            clear LC4_Platoon[13] action queue
            add action PLATOON_AGENDA_ACTION_DEFEND_OBJECT using LC4_SiegeCatapult[0] to LC4_Platoon[13] action queue
            begin loop
                TestCreature2 = get distance from {LC4_Platoon[13]} to {oCreature}
                PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[13]} radius 150
                PlayerSettlement = get nearest town at {LC4_Platoon[13]} for player 0 radius 500
                Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
                if Armory exists //Armory needs to exist, else game will crash
                    if PlayerSettlement == PlayerTown or not LC4_Platoon[13] can navigate to object Armory
                        PlayerSettlement = 0
                    end if
                end if
                until TestCreature2 <= 150 or PlayerPlatoon1 exists or LC4_Platoon[13] not exists or PlayerSettlement exists
            end loop
        end if
        until LC4_SiegeCatapult0IsAttacking == 1 or LC4_SiegeCatapult[0] not exists or LC4_Platoon[13] not exists
    end loop
    
    if LC4_SiegeCatapult[0] exists
        begin loop //Attack
            TestCreature2 = get distance from {LC4_Platoon[13]} to {oCreature}
            if TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC4_Platoon[13] can navigate to {oCreature}
                clear LC4_Platoon[13] action queue
                begin loop
                    add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC4_Platoon[13] action queue
                    NumPat5 = get number of villagers in platoon LC4_Platoon[13]
                    TestCreature2 = get distance from {LC4_Platoon[13]} to {oCreature}
                    until NumPat5 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC4_Platoon[13] can navigate to {oCreature} or TestCreature2 > 150
                end loop
            end if
            PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[13]} radius 150
            PlayerCatapult1 = get siege weapon of player 0 nearest {LC4_Platoon[13]} radius 100
            if PlayerPlatoon1 exists and LC4_Platoon[13] can navigate to {PlayerPlatoon1}
                clear LC4_Platoon[13] action queue
                begin loop
                    add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC4_Platoon[13] action queue
                    NumPat5 = get number of villagers in platoon LC4_Platoon[13]
                    HeTeste3 = get number of villagers in platoon PlayerPlatoon1
                    until NumPat5 == 0 or HeTeste3 == 0 or not LC4_Platoon[13] can navigate to {PlayerPlatoon1}
                end loop
            elsif PlayerCatapult1 exists and LC4_Platoon[13] can navigate to {PlayerCatapult1}
                clear LC4_Platoon[13] action queue
                begin loop
                    add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using PlayerCatapult1 to LC4_Platoon[13] action queue
                    NumPat5 = get number of villagers in platoon LC4_Platoon[13]
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[13]} radius 150
                    if PlayerPlatoon1 exists and LC4_Platoon[13] can navigate to {PlayerPlatoon1}
                        PlayerPlatoonInRange = 1
                    end if
                    until NumPat5 == 0 or PlayerCatapult1 not exists or not LC4_Platoon[13] can navigate to {PlayerCatapult1} or PlayerPlatoonInRange == 1
                end loop
                PlayerPlatoonInRange = 0
            end if
            PlayerSettlement = get nearest town at {LC4_Platoon[13]} for player 0 radius 500
            //Not a Armory, it's a towncentre.
            Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
            if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0
                if LC4_Platoon[13] can navigate to object Armory
                    clear LC4_Platoon[13] action queue
                    set LC4_Platoon[13] attack PlayerSettlement with severity 0.3 for takeover
                    a = 1
                    begin loop
                        PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[13]} radius 150
                        PlayerCreature = get distance from {LC4_Platoon[13]} to {oCreature}
                        if PlayerPlatoon1 exists
                            a = 0
                        elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                            a = 0
                        elsif not LC4_Platoon[13] can navigate to object Armory
                            a = 0
                        elsif LC4_Platoon[13] not exists
                            a = 0
                        end if
                        until a == 0 or LC4_Platoon[13] not exists or PLAYER of PlayerSettlement == 1
                    end loop
                    clear LC4_Platoon[13] action queue
                end if
            end if
            if LC4_Platoon[13] can navigate to object oTownCentre
                ////wait number from 5 to 25 seconds
                a = 1
                clear LC4_Platoon[13] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC4_Platoon[13] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[13] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[13] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[13] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[13] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[13] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[13] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    set LC4_Platoon[13] attack PlayerTown with severity 0.3 for takeover
                end if
                RecalculateTimer = create timer for 40 seconds //Recalculate every 40 seconds to prevent stucked platoons
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[13]} radius 150
                    TestCreature2 = get distance from {LC4_Platoon[13]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC4_Platoon[13]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC4_Platoon[13] can navigate to object oTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC4_Platoon[13] can navigate to object oTownCentre
                            a = 0
                        elsif LC4_Platoon[13] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC4_Platoon[13] not exists
                end loop
                clear LC4_Platoon[13] action queue
            elsif LC4_Platoon[13] can navigate to {AttackPos[4]}
                clear LC4_Platoon[13] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[4]} to LC4_Platoon[13] action queue
            else
                clear LC4_Platoon[13] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using ({AttackPos[4]} + {4.00,0.00,4.00}) to LC4_Platoon[13] action queue
            end if
            until LC4_Platoon[13] not exists
        end loop
    else
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {SiegePlatoonPos[0]} to LC4_Platoon[13] action queue
    end if
    if LC4_Platoon[13] not exists
        //PlatoonKilled = 1
        wait until LC4_Platoon[13] exists
    end if
end loop

end script LC4_Platoon13Actions

begin script LC4_SiegeCatapult0Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = 5
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    DestroyedBuilding = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 0
    SiegeStucked = 0
    LC4_SiegeCatapult0IsAttacking = 0
    wait until LC4_SiegeCatapult[0] exists and LC4_Platoon[13] exists
    wait 2 seconds
    begin loop
        PlayerCreature = get distance from {LC4_SiegeCatapult[0]} to {oCreature}
        PlayerPlatoon1 = get platoon of player 0 nearest {LC4_SiegeCatapult[0]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC4_SiegeCatapult[0]} radius 150
        
        if PlayerCreature > 10 and PlayerPlatoon1 not exists and Catapult not exists
            if PlayerPlatoon1 not exists
                a = 1
            elsif PlayerCreature > 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                a = 1
            elsif Catapult not exists
                a = 1
            end if
        end if
        
        if PlayerCreature <= 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
            clear siege weapon LC4_SiegeCatapult[0] action queue
            a = 0
        elsif PlayerPlatoon1 exists and LC4_SiegeCatapult[0] can navigate to {PlayerPlatoon1}
            clear siege weapon LC4_SiegeCatapult[0] action queue
            a = 0
        elsif Catapult exists and LC4_SiegeCatapult[0] can navigate to {Catapult}
            clear siege weapon LC4_SiegeCatapult[0] action queue
            a = 0
        elsif PointOn != 3 and a == 1
            begin loop
                if LC4_SiegeCatapult[0] exists 
                    if get SiegeOnPointTimer time remaining <= 0
                        SiegeWeaponPoint = marker at {LC4_SiegeCatapult[0]}
                        SiegeOnPointTimer = create timer for 160 seconds
                    elsif get SiegeOnPointTimer time remaining <= 5
                        if {LC4_SiegeCatapult[0]} near {SiegeWeaponPoint} radius 10
                            clear siege weapon LC4_SiegeCatapult[0] action queue
                            delete LC4_SiegeCatapult[0]
                            SiegeStucked = 1
                        end if
                    end if
                    if get CatapultMoveTimer1 time remaining <= 0
                        if get size of LC4_SiegeCatapult[0] action queue < 1

                            if PointOn == 0
                                if LC4_SiegeCatapult[0] can navigate to {SiegeRoute1[0]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute1[0]} to siege weapon LC4_SiegeCatapult[0] action queue
                                end if
                    
                            elsif PointOn == 1
                                if LC4_SiegeCatapult[0] can navigate to {SiegeRoute1[1]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute1[1]} to siege weapon LC4_SiegeCatapult[0] action queue
                                end if

                            elsif PointOn == 2
                                if LC4_SiegeCatapult[0] can navigate to {SiegeRoute1[2]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute1[2]} to siege weapon LC4_SiegeCatapult[0] action queue
                                else
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute1[1]} to siege weapon LC4_SiegeCatapult[0] action queue
                                end if

                            CatapultMoveTimer1 = create timer for 10 seconds
                            
                            end if
                        end if
                    end if        

                    if {LC4_SiegeCatapult[0]} near {SiegeRoute1[0]} radius 15 and PointOn != 1 or 60 seconds
                        PointOn = 1
                    elsif {LC4_SiegeCatapult[0]} near {SiegeRoute1[1]} radius 15 and PointOn != 2 or 60 seconds
                        PointOn = 2
                    elsif {LC4_SiegeCatapult[0]} near {SiegeRoute1[2]} radius 15 and PointOn != 3 or 60 seconds
                        PointOn = 3
                    elsif not LC4_SiegeCatapult[0] can navigate to {SiegeRoute1[2]} and {LC4_SiegeCatapult[0]} near {SiegeRoute1[1]} radius 15 and PointOn != 3
                        PointOn = 3
                    end if
                end if
            until LC4_SiegeCatapult[0] not exists or PointOn == 3 or 180 seconds
            end loop
        end if
        
        until PointOn == 3 or LC4_SiegeCatapult[0] not exists or 180 seconds
    end loop
    
    LC4_SiegeCatapult0IsAttacking = 1
    
    wait 5 seconds

    enable siege weapon LC4_SiegeCatapult[0] auto attack

    begin loop
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 5
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get HOUSE GATEHOUSE at {LC4_SiegeCatapult[0]} radius 750
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon LC4_SiegeCatapult[0] action queue
                    Target = marker at get target from {LC4_SiegeCatapult[0]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC4_SiegeCatapult[0] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {LC4_SiegeCatapult[0]} radius 750
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC4_SiegeCatapult[0] action queue
                    Target = marker at get target from {LC4_SiegeCatapult[0]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC4_SiegeCatapult[0] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            else
                House = get building ALTAR in PlayerTown min built 0.75
                if House exists and PLAYER of House == 0 and LC4_SiegeCatapult[0] can navigate to object oTownCentre
                    clear siege weapon LC4_SiegeCatapult[0] action queue
                    Target = marker at get target from {LC4_SiegeCatapult[0]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC4_SiegeCatapult[0] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            end if
        end if

        until LC4_SiegeCatapult[0] not exists
    end loop
    
    UnderAttack = UnderAttack - 1
    
    if SiegeStucked == 1
        wait 10 seconds
        if LC4_SiegeCatapult[0] not exists LC4_SiegeCatapult[0] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_5 town NorseCapital siege weapon end if
    end if
    
end loop

end script LC4_SiegeCatapult0Actions

begin script LC4_Platoon14Actions

    oCreature = get player 0 creature
    HeTeste3 = 0
    TestCreature2 = 0
    NumPat = 0
    NumPat5 = 0
    PlayerPlatoon1 = 0
    WorrNum = 0
    NorseTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in NorseTown min built 1.0
    ProPlatoonsLocation = 0
    AIPlatoon1 = 0
    Armory = 0
    Town8 = get town with id 8
    RandomActionP3 = 0
    a = 1
    Timer = create timer for 0 seconds
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    oWall = 0
    PlayerCatapult1 = 0
    PlayerPlatoonInRange = 0
    TownCaptured = 0
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    wait until LC4_Platoon[14] exists
    begin loop
        TestCreature2 = get distance from {LC4_Platoon[14]} to {oCreature}
        if TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC4_Platoon[14] can navigate to {oCreature}
            clear LC4_Platoon[14] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC4_Platoon[14] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[14]
                TestCreature2 = get distance from {LC4_Platoon[14]} to {oCreature}
                until NumPat5 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC4_Platoon[14] can navigate to {oCreature} or TestCreature2 > 150
            end loop
        end if
        PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[14]} radius 150
        PlayerCatapult1 = get siege weapon of player 0 nearest {LC4_Platoon[14]} radius 150
        if PlayerPlatoon1 exists and LC4_Platoon[14] can navigate to {PlayerPlatoon1}
            clear LC4_Platoon[14] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC4_Platoon[14] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[14]
                HeTeste3 = get number of villagers in platoon PlayerPlatoon1
                until NumPat5 == 0 or HeTeste3 == 0 or not LC4_Platoon[14] can navigate to {PlayerPlatoon1}
            end loop
        elsif PlayerCatapult1 exists and LC4_Platoon[14] can navigate to {PlayerCatapult1}
            clear LC4_Platoon[14] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using PlayerCatapult1 to LC4_Platoon[14] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[14]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[14]} radius 150
                if PlayerPlatoon1 exists and LC4_Platoon[14] can navigate to {PlayerPlatoon1}
                    PlayerPlatoonInRange = 1
                end if
                until NumPat5 == 0 or PlayerCatapult1 not exists or not LC4_Platoon[14] can navigate to {PlayerCatapult1} or PlayerPlatoonInRange == 1
            end loop
            PlayerPlatoonInRange = 0
        end if
        if LC4_Platoon[14] can navigate to {AttackPos[5]} and get size of LC4_Platoon[14] action queue < 1
            clear LC4_Platoon[14] action queue
            add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[5]} to LC4_Platoon[14] action queue
        end if
        until LC4_Platoon[14] not exists or {LC4_Platoon[14]} near {AttackPos[5]}
    end loop
    
    begin loop //Attack
        TestCreature2 = get distance from {LC4_Platoon[14]} to {oCreature}
        if TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC4_Platoon[14] can navigate to {oCreature}
            clear LC4_Platoon[14] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC4_Platoon[14] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[14]
                TestCreature2 = get distance from {LC4_Platoon[14]} to {oCreature}
                until NumPat5 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC4_Platoon[14] can navigate to {oCreature} or TestCreature2 > 150
            end loop
        end if
        PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[14]} radius 150
        PlayerCatapult1 = get siege weapon of player 0 nearest {LC4_Platoon[14]} radius 150
        if PlayerPlatoon1 exists and LC4_Platoon[14] can navigate to {PlayerPlatoon1}
            clear LC4_Platoon[14] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC4_Platoon[14] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[14]
                HeTeste3 = get number of villagers in platoon PlayerPlatoon1
                until NumPat5 == 0 or HeTeste3 == 0 or not LC4_Platoon[14] can navigate to {PlayerPlatoon1}
            end loop
        elsif PlayerCatapult1 exists and LC4_Platoon[14] can navigate to {PlayerCatapult1}
            clear LC4_Platoon[14] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using PlayerCatapult1 to LC4_Platoon[14] action queue
                NumPat5 = get number of villagers in platoon LC4_Platoon[14]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[14]} radius 150
                if PlayerPlatoon1 exists and LC4_Platoon[14] can navigate to {PlayerPlatoon1}
                    PlayerPlatoonInRange = 1
                end if
                until NumPat5 == 0 or PlayerCatapult1 not exists or not LC4_Platoon[14] can navigate to {PlayerCatapult1} or PlayerPlatoonInRange == 1
            end loop
            PlayerPlatoonInRange = 0
        end if
        NorseTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in NorseTown min built 1.0
        if LC4_Platoon[14] can navigate to object NorseTownCentre and PLAYER of NorseTown != 1 and TownCaptured == 0
            //wait number from 5 to 25 seconds
            a = 1
            clear LC4_Platoon[14] action queue
            wait 1 seconds
            if LC4_Platoon[14] can navigate to object NorseTownCentre and PLAYER of NorseTown != 1
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[14]} radius 150
                    TestCreature2 = get distance from {LC4_Platoon[14]} to {oCreature}
                    set LC4_Platoon[14] attack NorseTown with severity 0.7 for takeover
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC4_Platoon[14] can navigate to object NorseTownCentre
                        if PlayerPlatoon1 exists
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                            a = 0
                        elsif not LC4_Platoon[14] can navigate to object NorseTownCentre
                            a = 0
                        elsif LC4_Platoon[14] not exists
                            a = 0
                        elsif PLAYER of NorseTown == 1
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC4_Platoon[14] not exists
                end loop
            end if
            clear LC4_Platoon[14] action queue
        elsif LC4_Platoon[14] can navigate to {AttackPos[5]} and PLAYER of NorseTown != 1 and not {LC4_Platoon[14]} near {AttackPos[5]} radius 15
            clear LC4_Platoon[14] action queue
            add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[5]} to LC4_Platoon[14] action queue
        end if
        
        if LC4_Platoon[14] can navigate to {AttackPos[6]} and PLAYER of NorseTown == 1 and not {LC4_Platoon[14]} near {AttackPos[6]} radius 15
            TownCaptured = 1
            clear LC4_Platoon[14] action queue
            add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[6]} to LC4_Platoon[14] action queue
        end if

        until LC4_Platoon[14] not exists
    end loop
    if LC4_Platoon[14] not exists
        //PlatoonKilled = 1
        wait until LC4_Platoon[14] exists
    end if
end loop

end script LC4_Platoon14Actions

begin script LC4_Platoon15Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    PlayerSettlement = 0
    
start

begin loop

    wait until LC4_Platoon[15] exists
    
    PlayerCreature = get distance from {LC4_Platoon[15]} to {oCreature}
    if PlayerCreature <= 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC4_Platoon[15] can navigate to {oCreature}
        clear LC4_Platoon[15] action queue
        begin loop
            PlayerCreature = get distance from {LC4_Platoon[15]} to {oCreature}
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC4_Platoon[15] action queue
            NumPat1 = get number of villagers in platoon LC4_Platoon[15]
            until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC4_Platoon[15] can navigate to {oCreature} or PlayerCreature > 200
        end loop
        clear LC4_Platoon[15] action queue
    end if
    
    PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[15]} radius 200
    Catapult = get siege weapon of player 0 nearest {LC4_Platoon[15]} radius 155
    if PlayerPlatoon1 exists and LC4_Platoon[15] can navigate to {PlayerPlatoon1}
        clear LC4_Platoon[15] action queue
        begin loop
            PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[15]} radius 200
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC4_Platoon[15] action queue
            NumPat1 = get number of villagers in platoon LC4_Platoon[15]
            HeTeste1 = get number of villagers in platoon PlayerPlatoon1
            until NumPat1 == 0 or HeTeste1 == 0 or not LC4_Platoon[15] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
        end loop
        clear LC4_Platoon[15] action queue
    elsif Catapult exists and LC4_Platoon[15] can navigate to {Catapult}
        clear LC4_Platoon[15] action queue
        a = 0
        begin loop
            Catapult = get siege weapon of player 0 nearest {LC4_Platoon[15]} radius 155
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC4_Platoon[15] action queue
            NumPat1 = get number of villagers in platoon LC4_Platoon[15]
            PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[15]} radius 200
            if PlayerPlatoon1 exists and LC4_Platoon[15] can navigate to {PlayerPlatoon1}
                a = 1
            end if
            until NumPat1 == 0 or Catapult not exists or not LC4_Platoon[15] can navigate to {Catapult} or a == 1 or Catapult not exists
        end loop
        clear LC4_Platoon[15] action queue
        a = 0
    end if
    
    if get size of LC4_Platoon[15] action queue < 1 and {LC4_Platoon[15]} not near {PlatoonPos[5]} radius 25
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {PlatoonPos[5]} to LC4_Platoon[15] action queue
    end if

    if LC4_Platoon[15] not exists
        //PlatoonKilled = 1
        wait until LC4_Platoon[15] exists
    end if
    
end loop

end script LC4_Platoon15Actions

begin script LC4_Platoon16Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    PlayerSettlement = 0
    
start

begin loop

    wait until LC4_Platoon[16] exists
    
    PlayerCreature = get distance from {LC4_Platoon[16]} to {oCreature}
    if PlayerCreature <= 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC4_Platoon[16] can navigate to {oCreature}
        clear LC4_Platoon[16] action queue
        begin loop
            PlayerCreature = get distance from {LC4_Platoon[16]} to {oCreature}
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC4_Platoon[16] action queue
            NumPat1 = get number of villagers in platoon LC4_Platoon[16]
            until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC4_Platoon[16] can navigate to {oCreature} or PlayerCreature > 200
        end loop
        clear LC4_Platoon[16] action queue
    end if
    
    PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[16]} radius 200
    Catapult = get siege weapon of player 0 nearest {LC4_Platoon[16]} radius 155
    if PlayerPlatoon1 exists and LC4_Platoon[16] can navigate to {PlayerPlatoon1}
        clear LC4_Platoon[16] action queue
        begin loop
            PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[16]} radius 200
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC4_Platoon[16] action queue
            NumPat1 = get number of villagers in platoon LC4_Platoon[16]
            HeTeste1 = get number of villagers in platoon PlayerPlatoon1
            until NumPat1 == 0 or HeTeste1 == 0 or not LC4_Platoon[16] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
        end loop
        clear LC4_Platoon[16] action queue
    elsif Catapult exists and LC4_Platoon[16] can navigate to {Catapult}
        clear LC4_Platoon[16] action queue
        a = 0
        begin loop
            Catapult = get siege weapon of player 0 nearest {LC4_Platoon[16]} radius 155
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC4_Platoon[16] action queue
            NumPat1 = get number of villagers in platoon LC4_Platoon[16]
            PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[16]} radius 200
            if PlayerPlatoon1 exists and LC4_Platoon[16] can navigate to {PlayerPlatoon1}
                a = 1
            end if
            until NumPat1 == 0 or Catapult not exists or not LC4_Platoon[16] can navigate to {Catapult} or a == 1 or Catapult not exists
        end loop
        clear LC4_Platoon[16] action queue
        a = 0
    end if
    
    if get size of LC4_Platoon[16] action queue < 1 and {LC4_Platoon[16]} not near {PlatoonPos[6]} radius 25
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {PlatoonPos[6]} to LC4_Platoon[16] action queue
    end if

    if LC4_Platoon[16] not exists
        //PlatoonKilled = 1
        wait until LC4_Platoon[16] exists
    end if
    
end loop

end script LC4_Platoon16Actions

begin script LC4_Platoon17Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC4_Platoon[17] exists
    begin loop

        PlayerCreature = get distance from {LC4_Platoon[17]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC4_Platoon[17] can navigate to {oCreature}
            clear LC4_Platoon[17] action queue
            begin loop
                PlayerCreature = get distance from {LC4_Platoon[17]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC4_Platoon[17] action queue
                NumPat1 = get number of villagers in platoon LC4_Platoon[17]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC4_Platoon[17] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC4_Platoon[17] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[17]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC4_Platoon[17]} radius 150
        if PlayerPlatoon1 exists and LC4_Platoon[17] can navigate to {PlayerPlatoon1}
            clear LC4_Platoon[17] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[17]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC4_Platoon[17] action queue
                NumPat1 = get number of villagers in platoon LC4_Platoon[17]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC4_Platoon[17] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC4_Platoon[17] action queue
        elsif Catapult exists and LC4_Platoon[17] can navigate to {Catapult}
            clear LC4_Platoon[17] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC4_Platoon[17]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC4_Platoon[17] action queue
                NumPat1 = get number of villagers in platoon LC4_Platoon[17]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[17]} radius 150
                if PlayerPlatoon1 exists and LC4_Platoon[17] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC4_Platoon[17] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC4_Platoon[17] action queue
            a = 0
        end if
        
        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in NearestSettlement min built 1.0
        if not LC4_Platoon[17] can navigate to object oTownCentre and LC4_SiegeCatapult[1] exists
            add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {LC4_SiegeCatapult[1]} + {10,0,10} to LC4_Platoon[17] action queue
            wait 5 seconds
        end if

        //if get size of LC4_Platoon[17] action queue < 1
            if LC4_Platoon[17] can navigate to object oTownCentre
                //wait number from 5 to 25 seconds
                a = 1
                clear LC4_Platoon[17] action queue
            Number = number from 1 to 4
            if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                AttackMode = 1
                set LC4_Platoon[17] attack NearestSettlement with severity 0.2 for takeover
            elsif Number == 3 or Number == 4 //Destroy value buildings
                AttackMode = 2
                Building = 0
                Timer = create timer for 2 seconds
                begin loop
                    Number = number from 1 to 8
                    if Number == 1 or Number == 2 or Number == 3
                        Building = get building ALTAR in NearestSettlement min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[17] action queue
                        else
                            Building = 0
                        end if
                    elsif Number == 4
                        Building = get building TEMPLE in NearestSettlement min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[17] action queue
                        else
                            Building = 0
                        end if
                    elsif Number == 5
                        Building = get building CREATURE_PEN in NearestSettlement min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[17] action queue
                        else
                            Building = 0
                        end if
                    elsif Number == 6
                        Building = get building UNIVERSITY in NearestSettlement min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[17] action queue
                        else
                            Building = 0
                        end if
                    elsif Number == 7
                        Building = get building BATHHOUSE in NearestSettlement min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[17] action queue
                        else
                            Building = 0
                        end if
                    elsif Number == 8
                        Building = get building AMPITHEATRE in NearestSettlement min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[17] action queue
                        else
                            Building = 0
                        end if
                    end if
                    until Building != 0 or get Timer time remaining <= 0
                end loop
            else //Capture Town
                AttackMode = 0
                set LC4_Platoon[17] attack NearestSettlement with severity 0.3 for takeover
            end if
            RecalculateTimer = create timer for 40 seconds //Recalculate every 40 seconds to prevent stucked platoons
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[17]} radius 150
                MyCreature = get distance from {LC4_Platoon[17]} to {MyCreature}
                NumPat1 = get number of villagers in platoon LC4_Platoon[17]
                //if PlayerPlatoon1 exists or MyCreature <= 150 or not LC4_Platoon[17] can navigate to object oTownCentre
                    if PlayerPlatoon1 exists and not town NearestSettlement is under takeover from player 1
                        a = 0
                    elsif MyCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town NearestSettlement is under takeover from player 1
                        a = 0
                    elsif not LC4_Platoon[17] can navigate to object oTownCentre
                        a = 0
                    elsif LC4_Platoon[17] not exists
                        a = 0
                    elsif AttackMode == 1 and HEALTH of MyCreature == 0
                        a = 0
                    elsif AttackMode == 2 and Building not exists
                        a = 0
                    elsif AttackMode == 2 and HEALTH of Building < 0.1
                        a = 0
                    elsif AttackMode == 2 and Building == 0
                        a = 0
                    elsif not town NearestSettlement is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                        a = 0
                    end if
                //end if
                until a == 0 or LC4_Platoon[17] not exists
            end loop
                clear LC4_Platoon[17] action queue
            else
                clear LC4_Platoon[17] action queue
            end if
        //end if

        until LC4_Platoon[17] not exists
    end loop
    if LC4_Platoon[17] not exists
        //PlatoonKilled = 1
        wait until LC4_Platoon[17] exists
    end if
end loop

end script LC4_Platoon17Actions

begin script LC4_Platoon18Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC4_Platoon[18] exists
    begin loop

        PlayerCreature = get distance from {LC4_Platoon[18]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC4_Platoon[18] can navigate to {oCreature}
            clear LC4_Platoon[18] action queue
            begin loop
                PlayerCreature = get distance from {LC4_Platoon[18]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK using oCreature to LC4_Platoon[18] action queue
                NumPat1 = get number of villagers in platoon LC4_Platoon[18]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC4_Platoon[18] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC4_Platoon[18] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[18]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC4_Platoon[18]} radius 150
        if PlayerPlatoon1 exists and LC4_Platoon[18] can navigate to {PlayerPlatoon1}
            clear LC4_Platoon[18] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[18]} radius 150
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK using PlayerPlatoon1 to LC4_Platoon[18] action queue
                NumPat1 = get number of villagers in platoon LC4_Platoon[18]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC4_Platoon[18] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC4_Platoon[18] action queue
        elsif Catapult exists and LC4_Platoon[18] can navigate to {Catapult}
            clear LC4_Platoon[18] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC4_Platoon[18]} radius 150
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK using Catapult to LC4_Platoon[18] action queue
                NumPat1 = get number of villagers in platoon LC4_Platoon[18]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[18]} radius 150
                if PlayerPlatoon1 exists and LC4_Platoon[18] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC4_Platoon[18] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC4_Platoon[18] action queue
            a = 0
        end if
        
        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in NearestSettlement min built 1.0
        if not LC4_Platoon[18] can navigate to object oTownCentre and LC4_SiegeCatapult[1] exists
            add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {LC4_SiegeCatapult[1]} + {-10,0,-10} to LC4_Platoon[18] action queue
            wait 5 seconds
        end if

        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in NearestSettlement min built 1.0
        //if get size of LC4_Platoon[18] action queue < 1
            if LC4_Platoon[18] can navigate to object oTownCentre
                //wait number from 5 to 25 seconds
                a = 1
                clear LC4_Platoon[18] action queue
            Number = number from 1 to 4
            if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                AttackMode = 1
                set LC4_Platoon[18] attack NearestSettlement with severity 0.2 for takeover
            elsif Number == 3 or Number == 4 //Destroy value buildings
                AttackMode = 2
                Building = 0
                Timer = create timer for 2 seconds
                begin loop
                    Number = number from 1 to 8
                    if Number == 1 or Number == 2 or Number == 3
                        Building = get building ALTAR in NearestSettlement min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[18] action queue
                        else
                            Building = 0
                        end if
                    elsif Number == 4
                        Building = get building TEMPLE in NearestSettlement min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[18] action queue
                        else
                            Building = 0
                        end if
                    elsif Number == 5
                        Building = get building CREATURE_PEN in NearestSettlement min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[18] action queue
                        else
                            Building = 0
                        end if
                    elsif Number == 6
                        Building = get building UNIVERSITY in NearestSettlement min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[18] action queue
                        else
                            Building = 0
                        end if
                    elsif Number == 7
                        Building = get building BATHHOUSE in NearestSettlement min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[18] action queue
                        else
                            Building = 0
                        end if
                    elsif Number == 8
                        Building = get building AMPITHEATRE in NearestSettlement min built 0.75
                        if Building exists
                            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC4_Platoon[18] action queue
                        else
                            Building = 0
                        end if
                    end if
                    until Building != 0 or get Timer time remaining <= 0
                end loop
            else //Capture Town
                AttackMode = 0
                set LC4_Platoon[18] attack NearestSettlement with severity 0.3 for takeover
            end if
            RecalculateTimer = create timer for 40 seconds //Recalculate every 40 seconds to prevent stucked platoons
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC4_Platoon[18]} radius 150
                MyCreature = get distance from {LC4_Platoon[18]} to {MyCreature}
                NumPat1 = get number of villagers in platoon LC4_Platoon[18]
                //if PlayerPlatoon1 exists or MyCreature <= 150 or not LC4_Platoon[18] can navigate to object oTownCentre
                    if PlayerPlatoon1 exists and not town NearestSettlement is under takeover from player 1
                        a = 0
                    elsif MyCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town NearestSettlement is under takeover from player 1
                        a = 0
                    elsif not LC4_Platoon[18] can navigate to object oTownCentre
                        a = 0
                    elsif LC4_Platoon[18] not exists
                        a = 0
                    elsif AttackMode == 1 and HEALTH of MyCreature == 0
                        a = 0
                    elsif AttackMode == 2 and Building not exists
                        a = 0
                    elsif AttackMode == 2 and HEALTH of Building < 0.1
                        a = 0
                    elsif AttackMode == 2 and Building == 0
                        a = 0
                    elsif not town NearestSettlement is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                        a = 0
                    end if
                //end if
                until a == 0 or LC4_Platoon[18] not exists
            end loop
                clear LC4_Platoon[18] action queue
            else
                clear LC4_Platoon[18] action queue
            end if
        //end if

        until LC4_Platoon[17] not exists
    end loop
    if LC4_Platoon[17] not exists
        //PlatoonKilled = 1
        wait until LC4_Platoon[17] exists
    end if
end loop

end script LC4_Platoon18Actions

begin script LC4_SiegeCatapult1Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = 5
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 3
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC4_SiegeCatapult[1] exists

    wait 15 seconds

    clear siege weapon LC4_SiegeCatapult[1] action queue
    
    begin loop
        if get SiegeOnPointTimer time remaining <= 0
            SiegeWeaponPoint = marker at {LC4_SiegeCatapult[1]}
            SiegeOnPointTimer = create timer for 160 seconds
        elsif get SiegeOnPointTimer time remaining <= 5 and not {LC4_SiegeCatapult[1]} near {NearestSettlement} radius 400
            if {LC4_SiegeCatapult[1]} near {SiegeWeaponPoint} radius 10
                clear siege weapon LC4_SiegeCatapult[1] action queue
                delete LC4_SiegeCatapult[1]
                SiegeStucked = 1
            end if
        end if
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 7
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get HOUSE GATEHOUSE at {NearestSettlement} radius 400
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon LC4_SiegeCatapult[1] action queue
                    Target = marker at get target from {NearestSettlement} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC4_SiegeCatapult[1] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {NearestSettlement} radius 400
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC4_SiegeCatapult[1] action queue
                    Target = marker at get target from {LC4_SiegeCatapult[1]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC4_SiegeCatapult[1] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            elsif NumPat1 == 4 or NumPat1 == 5
                House = get building ALTAR in NearestSettlement min built 0.75
                if House exists and PLAYER of House == 0 and LC4_SiegeCatapult[1] can navigate to object oTownCentre
                    clear siege weapon LC4_SiegeCatapult[1] action queue
                    Target = marker at get target from {LC4_SiegeCatapult[1]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC4_SiegeCatapult[1] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            elsif NumPat1 == 6
                House = get building STORAGE_YARD in NearestSettlement min built 0.75
                if House exists and PLAYER of House == 0 and LC4_SiegeCatapult[1] can navigate to object oTownCentre
                    clear siege weapon LC4_SiegeCatapult[1] action queue
                    Target = marker at get target from {LC4_SiegeCatapult[1]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC4_SiegeCatapult[1] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            else
                House = get building TEMPLE in NearestSettlement min built 0.75
                if House exists and PLAYER of House == 0 and LC4_SiegeCatapult[1] can navigate to object oTownCentre
                    clear siege weapon LC4_SiegeCatapult[1] action queue
                    Target = marker at get target from {LC4_SiegeCatapult[1]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC4_SiegeCatapult[1] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            end if
        end if
        until LC4_SiegeCatapult[1] not exists
    end loop
    
end loop

end script LC4_SiegeCatapult1Actions
