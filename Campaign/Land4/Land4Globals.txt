///////////////////////////////////////////////////////////////////////////////
//    Land 4 Globals
//    ~~~~~~~~~~~~~~~
//
//    Start date:     31.10.16            By: Boxhead
//    Update date:    07.04.18            By: Boxhead
///////////////////////////////////////////////////////////////////////////////

// Debug switch
define DEBUG = 0
define oCreature = 0

define script Globals
define script LC4_DynamicDifficulty

global LandWon = 0
global TestModeOn = 0
global MigrationsAccepted = 0
global TownsConverted = 0
global TownsAggressiveConverted = 0
global UnderAttack = 0
global IntroFinished = 0
global L4Complete = 0
global FirstArmyCreated = 0
global ScriptAttackerSent = 0
global ScriptedAttackStart = 0
global LC4_SiegeCatapult0IsAttacking = 0
global LC4_EnemyCreature = 0
global ENEMY_CREATURE_ALLOWED_TO_ATTACK = 0
global PlatoonKilled = 0
global NearestSettlement = 0
global L4BuildWallComplete = 0
global L4ShowingBuildAWall = 0
global RECRUIT_DELAY = 0
global AttackNearestTownTimer = 0
global HardMode = 0
global AIVolcano = 0
global VolcanoFired = 0
global PlayerAlignmentFinal = 0
global StaticPlatoonsActionTimer = 0
global StaticPlatoonsActive = 0

global PlayerTown = 0
global Minor_FrontTown = 1
global Minor_SideTown = 2
global Minor_OreTown = 3
global Minor_MountainTown = 4
global Minor_SickTown = 5
global NorseTown = 6
global NorseCapital = 7
global MissionaryTown = 8

global FRONT_TOWN_IMPRESSIVENESS = 2638
global SIDE_TOWN_IMPRESSIVENESS = 5183
global ORE_TOWN_IMPRESSIVENESS = 7948
global MOUNTAIN_TOWN_IMPRESSIVENESS = 12948
global SICK_TOWN_IMPRESSIVENESS = 11881
global NORSE_TOWN_IMPRESSIVENESS = 15941
global NORSE_CAPITAL_IMPRESSIVENESS = 14847

begin script Globals

SecondPlaythrough = 0

start

    SecondPlaythrough = persistent data "SECOND_PLAYTHROUGH"
    HardMode = persistent data "HARD_MODE"

    ORE_TOWN_IMPRESSIVENESS = ORE_TOWN_IMPRESSIVENESS * ImpressivenessModifier
    MOUNTAIN_TOWN_IMPRESSIVENESS = MOUNTAIN_TOWN_IMPRESSIVENESS * ImpressivenessModifier
    SICK_TOWN_IMPRESSIVENESS = SICK_TOWN_IMPRESSIVENESS * ImpressivenessModifier
    NORSE_TOWN_IMPRESSIVENESS = NORSE_TOWN_IMPRESSIVENESS * ImpressivenessModifier
    NORSE_CAPITAL_IMPRESSIVENESS = NORSE_CAPITAL_IMPRESSIVENESS * ImpressivenessModifier

    if SecondPlaythrough == 1
        FRONT_TOWN_IMPRESSIVENESS += 6000
        SIDE_TOWN_IMPRESSIVENESS += 6000
        ORE_TOWN_IMPRESSIVENESS += 6000
        MOUNTAIN_TOWN_IMPRESSIVENESS += 6000
        SICK_TOWN_IMPRESSIVENESS += 6000
        NORSE_TOWN_IMPRESSIVENESS += 6000
        NORSE_CAPITAL_IMPRESSIVENESS += 6000
    end if

    if HardMode == 1
        FRONT_TOWN_IMPRESSIVENESS += 1000
        SIDE_TOWN_IMPRESSIVENESS += 2000
        ORE_TOWN_IMPRESSIVENESS += 4000
        MOUNTAIN_TOWN_IMPRESSIVENESS += 8000
        SICK_TOWN_IMPRESSIVENESS += 12000
        NORSE_TOWN_IMPRESSIVENESS += 12000
        NORSE_CAPITAL_IMPRESSIVENESS += 14500
    end if

    if Difficulty >= 5
        NORSE_TOWN_IMPRESSIVENESS -= 3000
        NORSE_CAPITAL_IMPRESSIVENESS += 6000
    end if

    GB_PlayerTown = get town with id 0//For Global Script
    PlayerTown = get town with id 0
    Minor_FrontTown = get town with id 1
    Minor_SideTown = get town with id 2
    Minor_OreTown = get town with id 3
    Minor_MountainTown = get town with id 4
    Minor_SickTown = get town with id 5
    NorseTown = get town with id 6
    NorseCapital = get town with id 7
    MissionaryTown = get town with id 8

    PlayerAlignmentFinal = get player 0 alignment
    StaticPlatoonsActionTimer = create timer for 1500 seconds

end script Globals


begin script LC4_DynamicDifficulty

    Counter = 0
    DifficultyTimer = create timer for 3600 seconds

    RecruitSizeModifierTemp = 0
    RecruitModifierTemp = 0
    EpicModifierTemp = 0
    BuilderModifierTemp = 0

start

//Game gets constantly easier
begin loop
    wait 2.5 seconds
    if get DifficultyTimer time remaining <= 0
        RecruitModifier *= 1.15
        EpicModifier *= 1.25
        BuilderModifier *= 1.25
        DifficultyTimer = create timer for 1800 seconds
        Counter++
    end if
    until Counter >= 3
end loop

//Store old values
RecruitSizeModifierTemp = RecruitSizeModifier
RecruitModifierTemp = RecruitModifier
EpicModifierTemp = EpicModifier
BuilderModifierTemp = BuilderModifier

//Give the AI a comeback for 30 minutes
RecruitSizeModifier = 2.0
//RecruitModifier = 1.25
BuilderModifier = 1.25
EpicModifier = 1.0

wait 1800 seconds

//Now restore old values
RecruitSizeModifier = RecruitSizeModifierTemp
RecruitModifier = RecruitModifierTemp
EpicModifier = EpicModifierTemp
BuilderModifier = BuilderModifierTemp

end script LC4_DynamicDifficulty