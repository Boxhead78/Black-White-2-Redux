///////////////////////////////////////////////////////////////////////////////
//    Land 14 Aztec-Strategy
//    ~~~~~~~~~~~~~~~~~~~~~~~~~~~
//
///////////////////////////////////////////////////////////////////////////////

define script LC14_Aztec_Capital_Impressiveness
define script LC14_TownConversion
define script LC14_Tribute
define script LC14_GatehouseManager
define script LC14_Speeches
define script LC14_Aztec_Capital
define script LC14_AttackNearestTownTimer
define script LC14_GetNearestSettlement
define script DisableLocalPlatoonResponse
define script LC14_GetPlayerUnits
define script LC14_GenericTalusSpeeches(whichUnit,PlayerOfUnit)
define script LC14_DefendPlatoons
define script LC14_FireRain(whichTemple,whichPosition)
define script LC14_FireRainTempleEffects(whichTemple,Weather)
define script LC14_FireBalls(Position, Weather)
define script LC14_FireBallsBarrel(Position, Weather)
define script LC14_WeatherLightning(Position, Weather)
define script LC14_TempleDestroyed(whichTemple)
define script LC14_DeathSpell(PlayerID,SpellPosition,GodPosition)
define script LC14_MainScript(SKIP_SIEGE)
define script LC14_PlayRandomBanter
define script LC14_Epics
define script LC14_EarthquakeCinema(Earthquake)

define TalusPlatoon = 0
define TalusCatapult = 0

global AztecGodThrowBlitz = 0
global AztecGodThrowFirerain = 0
global SiegeRan = 0
global SiegeScriptStartedOnce = 0
global SmallAttacksAllowed = 0

begin script LC14_Aztec_Capital_Impressiveness

    Threshold = 0

start

    Threshold = get town AztecTown1 impressiveness
    Threshold = Threshold / 3
    set migration threshold from AztecTown1 to PlayerTown AZTECTOWN1_IMPRESSIVENESS - Threshold

    Threshold = get town AztecTown2 impressiveness
    Threshold = Threshold / 3
    set migration threshold from AztecTown2 to PlayerTown AZTECTOWN2_IMPRESSIVENESS - Threshold

    Threshold = get town AztecTown3 impressiveness
    Threshold = Threshold / 3
    set migration threshold from AztecTown3 to PlayerTown AZTECTOWN3_IMPRESSIVENESS - Threshold

    Threshold = get town AztecCapital impressiveness
    Threshold = Threshold / 3
    set migration threshold from AztecCapital to PlayerTown AZTECCAPITAL_IMPRESSIVENESS - Threshold

    if PLAYER of AztecTown1 == 0
        enable migration from AztecTown2 to AztecTown1
        enable migration from AztecTown3 to AztecTown1
        enable migration from AztecCapital to AztecTown1
        
    elsif PLAYER of AztecTown1 >= 1
        disable migration from AztecTown2 to AztecTown1
        disable migration from AztecTown3 to AztecTown1
        disable migration from AztecCapital to AztecTown1
    end if

    if PLAYER of AztecTown2 == 0
        enable migration from AztecTown1 to AztecTown2
        enable migration from AztecTown3 to AztecTown2
        enable migration from AztecCapital to AztecTown2
        
    elsif PLAYER of AztecTown2 >= 1
        disable migration from AztecTown1 to AztecTown2
        disable migration from AztecTown3 to AztecTown2
        disable migration from AztecCapital to AztecTown2
    end if

    if PLAYER of AztecTown3 == 0
        enable migration from AztecTown1 to AztecTown3
        enable migration from AztecTown2 to AztecTown3
        enable migration from AztecCapital to AztecTown3
        
    elsif PLAYER of AztecTown3 >= 1
        disable migration from AztecTown1 to AztecTown3
        disable migration from AztecTown2 to AztecTown3
        disable migration from AztecCapital to AztecTown3
    end if

    if PLAYER of AztecCapital == 0
        enable migration from AztecTown1 to AztecCapital
        enable migration from AztecTown2 to AztecCapital
        enable migration from AztecTown3 to AztecCapital
        
    elsif PLAYER of AztecCapital >= 1
        disable migration from AztecTown1 to AztecCapital
        disable migration from AztecTown2 to AztecCapital
        disable migration from AztecTown3 to AztecCapital
    end if

end script LC14_Aztec_Capital_Impressiveness

begin script LC14_TownConversion

    isConverted1 = 0
    isConverted2 = 0
    isConverted3 = 0
    isConverted4 = 0
    a = 0
    b = 0
    c = 0
    d = 0
    
start

begin loop

    isConverted1 = variable get town AztecTown1 method of last conversion
    isConverted2 = variable get town AztecTown2 method of last conversion
    isConverted3 = variable get town AztecTown3 method of last conversion
    isConverted4 = variable get town AztecCapital method of last conversion
    
    if isConverted1 != 0 and a == 0
        if PLAYER of AztecTown1 == 0 or get town AztecTown1 is migrating to == PlayerTown
            a = 1
            TownsConverted = TownsConverted + 1
            if isConverted1 == 1
                TownsAggressiveConverted = TownsAggressiveConverted + 1
            elsif isConverted1 == 2
                TownsPeacefulConverted = TownsPeacefulConverted + 1
            end if
        end if
    end if
    
    if isConverted1 != 0
        if PLAYER of AztecCapital == 1
            disable migration from AztecTown1 to AztecTown2
            disable migration from AztecTown1 to AztecTown3
            disable migration from AztecTown1 to AztecCapital
            disable migration from AztecTown1 to PlayerTown
        else
            enable migration from AztecTown1 to AztecTown2
            enable migration from AztecTown1 to AztecTown3
            enable migration from AztecTown1 to AztecCapital
            enable migration from AztecTown1 to PlayerTown
        end if
    end if

    if isConverted2 != 0 and b == 0
        if PLAYER of AztecTown2 == 0 or get town AztecTown2 is migrating to == PlayerTown
            b = 1
            TownsConverted = TownsConverted + 1
            if isConverted2 == 1
                TownsAggressiveConverted = TownsAggressiveConverted + 1
            elsif isConverted2 == 2
                TownsPeacefulConverted = TownsPeacefulConverted + 1
            end if
        end if
    end if

    if isConverted2 != 0
        if PLAYER of AztecCapital == 1
            disable migration from AztecTown2 to AztecTown1
            disable migration from AztecTown2 to AztecTown3
            disable migration from AztecTown2 to AztecCapital
            disable migration from AztecTown2 to PlayerTown
        else
            enable migration from AztecTown2 to AztecTown1
            enable migration from AztecTown2 to AztecTown3
            enable migration from AztecTown2 to AztecCapital
            enable migration from AztecTown2 to PlayerTown
        end if
    end if
    
    if isConverted3 != 0 and c == 0
        if PLAYER of AztecTown3 == 0 or get town AztecTown3 is migrating to == PlayerTown
            c = 1
            TownsConverted = TownsConverted + 1
            if isConverted3 == 1
                TownsAggressiveConverted = TownsAggressiveConverted + 1
            elsif isConverted3 == 2
                TownsPeacefulConverted = TownsPeacefulConverted + 1
            end if
        end if
    end if    
    
    if isConverted3 != 0
        if PLAYER of AztecTown3 == 1
            disable migration from AztecTown3 to AztecTown1
            disable migration from AztecTown3 to AztecTown2
            disable migration from AztecTown3 to AztecCapital
            disable migration from AztecTown3 to PlayerTown
        else
            enable migration from AztecTown3 to AztecTown1
            enable migration from AztecTown3 to AztecTown2
            enable migration from AztecTown3 to AztecCapital
            enable migration from AztecTown3 to PlayerTown
        end if
    end if

    if isConverted4 != 0 and d == 0
        if PLAYER of AztecCapital == 0 or get town AztecCapital is migrating to == PlayerTown
            d = 1
            TownsConverted = TownsConverted + 1
            if isConverted4 == 1
                TownsAggressiveConverted = TownsAggressiveConverted + 1
            elsif isConverted4 == 2
                TownsPeacefulConverted = TownsPeacefulConverted + 1
            end if
        end if
    end if    
    
    if isConverted4 != 0
        if PLAYER of AztecCapital == 1
            disable migration from AztecCapital to AztecTown1
            disable migration from AztecCapital to AztecTown2
            disable migration from AztecCapital to AztecTown3
            disable migration from AztecCapital to PlayerTown
        else
            enable migration from AztecCapital to AztecTown1
            enable migration from AztecCapital to AztecTown2
            enable migration from AztecCapital to AztecTown3
            enable migration from AztecCapital to PlayerTown
        end if
    end if

end loop

end script LC14_TownConversion

begin script LC14_Tribute

    mig1 = 0
    mig2 = 0
    mig3 = 0
    mig4 = 0
    mig5 = 0
    mig6 = 0
    mig7 = 0
    mig8 = 0
    mig9 = 0
    mig10 = 0
    mig11 = 0
    mig12 = 0
    a = 0

start

begin loop

    if (variable get town AztecTown1 status == variable MIGRATION_MIGRATED) and mig1 == 0 and get town AztecTown1 has migrated to == PlayerTown
        mig1 = 1
        MigrationsAccepted = MigrationsAccepted + 1
    end if
    
    if (variable get town AztecTown2 status == variable MIGRATION_MIGRATED) and mig2 == 0 and get town AztecTown2 has migrated to == PlayerTown
        mig2 = 1
        MigrationsAccepted = MigrationsAccepted + 1
    end if
    
    if (variable get town AztecTown3 status == variable MIGRATION_MIGRATED) and mig3 == 0 and get town AztecTown3 has migrated to == PlayerTown
        mig3 = 1
        MigrationsAccepted = MigrationsAccepted + 1
    end if

    if (variable get town AztecCapital status == variable MIGRATION_MIGRATED) and mig4 == 0 and get town AztecCapital has migrated to == PlayerTown
        mig4 = 1
        MigrationsAccepted = MigrationsAccepted + 1
    end if

    if MigrationsAccepted >= 1 and a == 0
        a = 1
        increment tribute by 150000
    end if
    
    if MigrationsAccepted >= 2 and a == 1
        a = 2
        increment tribute by 150000
    end if

    if MigrationsAccepted >= 3 and a == 2
        a = 3
        increment tribute by 150000
    end if

    if TownsAggressiveConverted >= 1 and a == 0
        a = 1
        increment tribute by 75000
    end if

    if TownsAggressiveConverted >= 2 and a == 1
        a = 2
        increment tribute by 150000
    end if

    if TownsAggressiveConverted >= 3 and a == 1
        a = 2
        increment tribute by 150000
    end if

    if TownsAggressiveConverted >= 4 and a == 2
        a = 3
        increment tribute by 150000
    end if

end loop

end script LC14_Tribute

begin script LC14_GatehouseManager

    GateHouseT11 = 0
    GateHouseT21 = 0
    GateHouseT22 = 0
    GateHouseT31 = 0
    GateHouseT32 = 0

    Counter = 0
    Cnt = 0

    oCreature = get player 0 creature

    PlayerPlatoonT11 = 0
    CatapultT11 = 0
    TestCreatureT11 = 0

    EnemyNearDoorT11 = 0

    PlayerPlatoonT21 = 0
    CatapultT21 = 0
    TestCreatureT21 = 0
    PlayerPlatoonT22 = 0
    CatapultT22 = 0
    TestCreatureT22 = 0

    EnemyNearDoorT21 = 0
    EnemyNearDoorT22 = 0

    PlayerPlatoonT31 = 0
    CatapultT31 = 0
    TestCreatureT31 = 0

    EnemyNearDoorT31 = 0
start

begin loop

    GateHouseT11 = get SCRIPT_OBJECT_TYPE_ABODE ABODE_NUMBER_GATEHOUSE_F at {1705.57,181.94,1243.39} radius 15
    
    oCreature = get player 0 creature

    if PLAYER of AztecCapital == 1

        if not town AztecCapital is under takeover from player 0
            PlayerPlatoonT11 = get platoon of player 0 nearest {GateHouseT11} radius 100
            CatapultT11 = get siege weapon of player 0 nearest {GateHouseT11} radius 100
            TestCreatureT11 = get distance from {GateHouseT11} to {oCreature}
            
            if PlayerPlatoonT11 exists
                EnemyNearDoorT11 = 1
            elsif CatapultT11 exists
                EnemyNearDoorT11 = 1
            elsif TestCreatureT11 < 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                EnemyNearDoorT11 = 1
            else
                EnemyNearDoorT11 = 0
            end if
            
            if EnemyNearDoorT11 == 1
                set gate GateHouseT11 close
            else
                set gate GateHouseT11 open
            end if

        else
            set gate GateHouseT11 open
        end if
    end if


    GateHouseT21 = get SCRIPT_OBJECT_TYPE_ABODE ABODE_NUMBER_GATEHOUSE_F at {1450.94,141.84,1872.16} radius 15
    GateHouseT22 = get SCRIPT_OBJECT_TYPE_ABODE ABODE_NUMBER_GATEHOUSE_F at {1723.31,115.99,1681.52} radius 15
    
    oCreature = get player 0 creature

    if PLAYER of AztecTown1 == 1

        if not town AztecTown1 is under takeover from player 0
            PlayerPlatoonT21 = get platoon of player 0 nearest {GateHouseT21} radius 100
            CatapultT21 = get siege weapon of player 0 nearest {GateHouseT21} radius 100
            TestCreatureT21 = get distance from {GateHouseT21} to {oCreature}
            
            if PlayerPlatoonT21 exists
                EnemyNearDoorT21 = 1
            elsif CatapultT21 exists
                EnemyNearDoorT21 = 1
            elsif TestCreatureT21 < 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                EnemyNearDoorT21 = 1
            else
                EnemyNearDoorT21 = 0
            end if
            
            if EnemyNearDoorT21 == 1
                set gate GateHouseT21 close
            else
                set gate GateHouseT21 open
            end if


            PlayerPlatoonT22 = get platoon of player 0 nearest {GateHouseT22} radius 100
            CatapultT22 = get siege weapon of player 0 nearest {GateHouseT22} radius 100
            TestCreatureT22 = get distance from {GateHouseT22} to {oCreature}
            
            if PlayerPlatoonT22 exists
                EnemyNearDoorT22 = 1
            elsif CatapultT22 exists
                EnemyNearDoorT22 = 1
            elsif TestCreatureT22 < 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                EnemyNearDoorT22 = 1
            else
                EnemyNearDoorT22 = 0
            end if
            
            if EnemyNearDoorT22 == 1
                set gate GateHouseT22 close
            else
                set gate GateHouseT22 open
            end if
        else
            set gate GateHouseT21 open
            set gate GateHouseT22 open
        end if

    end if

    GateHouseT31 = get SCRIPT_OBJECT_TYPE_ABODE ABODE_NUMBER_GATEHOUSE_F at {1139.15,56.47,1218.94} radius 15
    
    oCreature = get player 0 creature

    if PLAYER of AztecTown2 == 1

        if not town AztecTown2 is under takeover from player 0
            PlayerPlatoonT31 = get platoon of player 0 nearest {GateHouseT31} radius 100
            CatapultT31 = get siege weapon of player 0 nearest {GateHouseT31} radius 100
            TestCreatureT31 = get distance from {GateHouseT31} to {oCreature}
            
            if PlayerPlatoonT31 exists
                EnemyNearDoorT31 = 1
            elsif CatapultT31 exists
                EnemyNearDoorT31 = 1
            elsif TestCreatureT31 < 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                EnemyNearDoorT31 = 1
            else
                EnemyNearDoorT31 = 0
            end if
            
            if EnemyNearDoorT31 == 1
                set gate GateHouseT31 close
            else
                set gate GateHouseT31 open
            end if

        else
            set gate GateHouseT31 open
        end if

    end if

end loop

end script LC14_GatehouseManager

begin script LC14_Speeches

    LoseDialogue1 = 0
    
    Number = 0
    
    AttackTimer = create timer for 0 seconds
    LoseTimer = create timer for 0 seconds
    
    a = 0
    b = 0
    c = 0
    d = 0
    e = 0
    f = 0
    g = 0
    h = 0
    i = 0
    j = 0
    jj = 0
    k = 0
    l = 0
    m = 0
    n = 0
    o = 0
    p = 0
    q = 0
    r = 0
    s = 0
    t = 0
    w = 0
    v = 0
    crechediag = 0
    astory = 0
    bstory = 0
    
    ab = 0
    ac = 0
    ad = 0
    ae = 0
    af = 0
    ag = 0
    ah = 0
    ai = 0
    aj = 0
    ak = 0
    al = 0
    am = 0
    
    StoryDialogue = 0
    StoryDialogueTimer = create timer for 300 seconds
    
    EvilDialogue = 0
    GoodDialogue = 0
    
    Platoon = 0
    Catapult = 0

    AltarBuilt = 0

    TownSpeech1 = 0
    TownSpeech2 = 0
    TownSpeech3 = 0
    TownSpeech4 = 0
    TownSpeech5 = 0

    PlayerPlatoon = 0

    UnderAttackTimer = create timer for 0 seconds

    VillagersComment = 0
    VillagersCommentTimer = create timer for 0 seconds

    VillagersFound = 0
    VillagersFree = 0

    GreekTownComment = 0
    GreekTownCommentTimer = create timer for 50 seconds

    PrisonAttacked = 0

    CreatureDeadTimerComment = create timer for 0 seconds

    LargeSiegeComment = 0

    LoseDialogueAllowed = 0
    StartDialogue = 0

    TalusTownComment = 0

start

begin loop

    if UnderAttack >= 1 and get AttackTimer time remaining <= 0 and GB_DialogueIsRunning == 0
        GB_DialogueIsRunning = 1
        UnderAttack = 0
        Number = number from 1 to 14
        if Number == 1
            begin dialogue
                make evil spirit appear
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_EA_01"
                wait until read
                send evil spirit home
            end dialogue
        end if
        if Number == 2
            begin dialogue
                make evil spirit appear
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_EA_02"
                wait until read
                send evil spirit home
            end dialogue
        end if
        if Number == 3
            begin dialogue
                make evil spirit appear
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_EA_05"
                wait until read
                send evil spirit home
            end dialogue
        end if
        if Number == 4
            begin dialogue
                make evil spirit appear
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_EA_06"
                wait until read
                send evil spirit home
            end dialogue
        end if
        if Number == 5
            begin dialogue
                make evil spirit appear
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_EA_07"
                wait until read
                send evil spirit home
            end dialogue
        end if
        if Number == 6
            begin dialogue
                make evil spirit appear
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_EA_08"
                wait until read
                send evil spirit home
            end dialogue
        end if
        if Number == 7
            begin dialogue
                make evil spirit appear
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_EA_18"
                wait until read
                send evil spirit home
            end dialogue
        end if
        if Number == 8
            begin dialogue
                make good spirit appear
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_GA_01"
                wait until read
                send good spirit home
            end dialogue
        end if
        if Number == 9
            begin dialogue
                make good spirit appear
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_GA_02"
                wait until read
                send good spirit home
            end dialogue
        end if
        if Number == 10
            begin dialogue
                make good spirit appear
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_GA_05"
                wait until read
                send good spirit home
            end dialogue
        end if
        if Number == 11
            begin dialogue
                make good spirit appear
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_GA_06"
                wait until read
                send good spirit home
            end dialogue
        end if
        if Number == 12
            begin dialogue
                make good spirit appear
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_GA_07"
                wait until read
                send good spirit home
            end dialogue
        end if
        if Number == 13
            begin dialogue
                make good spirit appear
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_GA_09"
                wait until read
                send good spirit home
            end dialogue
        end if
        if Number == 14
            begin dialogue
                make good spirit appear
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_GA_10"
                wait until read
                send good spirit home
            end dialogue
        end if
        GB_DialogueIsRunning = 0
        AttackTimer = create timer for 45 seconds
    end if
    
    if PLAYER of PlayerTown == 0 or LoseDialogueAllowed == 1
        LoseDialogueAllowed = 1
        if PLAYER of PlayerTown != 0 and PLAYER of AztecTown1 != 0 and PLAYER of AztecTown2 != 0 and PLAYER of AztecTown3 != 0 and PLAYER of AztecCapital != 0  and get LoseTimer time remaining <= 0 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            LoseDialogue1 = number from 1 to 5
            if LoseDialogue1 == 1
                begin dialogue
                    make good spirit appear
                    say "BW2T_SCRIPT_GENERIC_ADVISORS_SUGGEST_RESTART_10"
                    wait until read
                    send good spirit home
                end dialogue
            end if
            
            if LoseDialogue1 == 2
                begin dialogue
                    make evil spirit appear
                    say "BW2T_SCRIPT_GENERIC_ADVISORS_SUGGEST_RESTART_20"
                    wait until read
                    send evil spirit home
                end dialogue
            end if
            
            if LoseDialogue1 == 3
                begin dialogue
                    make good spirit appear
                    say "BW2T_SCRIPT_GENERIC_ADVISORS_SUGGEST_RESTART_30"
                    wait until read
                    send good spirit home
                end dialogue
            end if
            
            if LoseDialogue1 == 4
                begin dialogue
                    make evil spirit appear
                    say "BW2T_SCRIPT_GENERIC_ADVISORS_SUGGEST_RESTART_40"
                    wait until read
                    send evil spirit home
                end dialogue
            end if
            
            if LoseDialogue1 == 5
                begin dialogue
                    make evil spirit appear
                    say "BW2T_SCRIPT_GENERIC_ADVISORS_SUGGEST_RESTART_50"
                    wait until read
                    send evil spirit home
                end dialogue
            end if
            
            GB_DialogueIsRunning = 0
            LoseTimer = create timer for 75 seconds
        end if
    end if

    if Language == German
        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 0 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 1
            begin dialogue
                say "BW2XT_LAND05_TALUS_VARIOUS_420"
                clear dialogue
                close dialogue
                wait BW2XT_LAND05_TALUS_VARIOUS_420 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 1 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 2
            begin dialogue
                say "BW2XT_LAND05_TALUS_MIRACLE_ATTACK_30"
                clear dialogue
                close dialogue
                wait BW2XT_LAND05_TALUS_MIRACLE_ATTACK_30 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 2 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 3
            begin dialogue
                say "BW2XT_LAND02_TALUS_BANTER_110"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_TALUS_BANTER_110 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 3 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 4
            begin dialogue
                say "BW2XT_LAND02_DURINGLAND_40"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_DURINGLAND_40 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 4 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 5
            begin dialogue
                say "BW2XT_LAND02_MISC_210"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_MISC_210 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 5 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 6
            begin dialogue
                say "BW2XT_LAND02_DURINGLAND_40"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_DURINGLAND_40 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 6 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 7
            begin dialogue
                say "BW2XT_LAND02_PLAYER_SAVES_TC_20"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_PLAYER_SAVES_TC_20 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 7 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 8
            begin dialogue
                say "BW2XT_LAND02_DURINGLAND_90"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_DURINGLAND_90 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 8 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 9
            begin dialogue
                say "BW2XT_LAND02_DURINGLAND_80"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_DURINGLAND_80 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 9 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 10
            begin dialogue
                say "BW2XT_GENERAL_TALUS_TAUNTS_03"
                clear dialogue
                close dialogue
                wait BW2XT_GENERAL_TALUS_TAUNTS_03 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 10 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 11
            begin dialogue
                say "BW2XT_GENERAL_TALUS_TAUNTS_06"
                clear dialogue
                close dialogue
                wait BW2XT_GENERAL_TALUS_TAUNTS_06 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 11 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 12
            begin dialogue
                say "BW2XT_GENERAL_TALUS_TAUNTS_08"
                clear dialogue
                close dialogue
                wait BW2XT_GENERAL_TALUS_TAUNTS_08 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 12 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 13
            begin dialogue
                say "BW2XT_GENERAL_TALUS_TAUNTS_03"
                clear dialogue
                close dialogue
                wait BW2XT_GENERAL_TALUS_TAUNTS_03 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 13 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 14
            begin dialogue
                say "BW2XT_GENERAL_TALUS_TAUNTS_06"
                clear dialogue
                close dialogue
                wait BW2XT_GENERAL_TALUS_TAUNTS_06 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 14 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 0
            begin dialogue
                say "BW2XT_GENERAL_TALUS_TAUNTS_08"
                clear dialogue
                close dialogue
                wait BW2XT_GENERAL_TALUS_TAUNTS_08 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if
    end if
    if Language == English
        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 0 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 1
            begin dialogue
                say "BW2XT_LAND05_TALUS_VARIOUS_420"
                clear dialogue
                close dialogue
                wait BW2XT_LAND05_TALUS_VARIOUS_420 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 1 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 2
            begin dialogue
                say "BW2XT_LAND05_TALUS_MIRACLE_ATTACK_30"
                clear dialogue
                close dialogue
                wait BW2XT_LAND05_TALUS_MIRACLE_ATTACK_30 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 2 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 3
            begin dialogue
                say "BW2XT_LAND02_TALUS_BANTER_110"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_TALUS_BANTER_110 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 3 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 4
            begin dialogue
                say "BW2XT_LAND02_DURINGLAND_40"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_DURINGLAND_40 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 4 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 5
            begin dialogue
                say "BW2XT_LAND02_MISC_210"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_MISC_210 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 5 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 6
            begin dialogue
                say "BW2XT_LAND02_DURINGLAND_40"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_DURINGLAND_40 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 6 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 7
            begin dialogue
                say "BW2XT_LAND02_PLAYER_SAVES_TC_20"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_PLAYER_SAVES_TC_20 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 7 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 8
            begin dialogue
                say "BW2XT_LAND02_DURINGLAND_80"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_DURINGLAND_80 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 8 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 9
            begin dialogue
                say "BW2XT_LAND02_DURINGLAND_90"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_DURINGLAND_90 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 9 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 10
            begin dialogue
                say "BW2XT_LAND02_MISC_100"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_MISC_100 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 10 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 11
            begin dialogue
                say "BW2XT_LAND02_MISC_110"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_MISC_110 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 11 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 12
            begin dialogue
                say "BW2XT_LAND02_MISC_160"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_MISC_160 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 12 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 13
            begin dialogue
                say "BW2XT_LAND02_MISC_70"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_MISC_70 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 13 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 14
            begin dialogue
                say "BW2XT_LAND02_MISC_110"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_MISC_110 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 14 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 15
            begin dialogue
                say "BW2XT_LAND03_DURINGLAND_10"
                clear dialogue
                close dialogue
                wait BW2XT_LAND03_DURINGLAND_10 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 15 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 16
            begin dialogue
                say "BW2XT_LAND03_DURINGLAND_20"
                clear dialogue
                close dialogue
                wait BW2XT_LAND03_DURINGLAND_20 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 16 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 0
            begin dialogue
                say "BW2XT_LAND03_TALUS_ARMINGTON_10"
                clear dialogue
                close dialogue
                wait BW2XT_LAND03_TALUS_ARMINGTON_10 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if
    end if

    if StartDialogue == 0
        StartDialogue = 1
        begin dialogue
            make evil spirit appear
            make good spirit appear
            //say "BW2T_SCRIPT_10FINAL_STEALTH_40"
            say "BW2T_SCRIPT_11FINAL_ADVISORS_INTRO_90"
            wait until read
            say "BW2T_SCRIPT_11FINAL_ADVISORS_INTRO_100"
            wait until read
            //say "BW2T_SCRIPT_11FINAL_ADVISORS_INTRO_110"
            //wait until read
            send evil spirit home
            send good spirit home
        end dialogue
        wait 15 seconds
        begin dialogue
            say "BW2XT_LAND05_SNEAK_ATTACK_70"
            clear dialogue
            close dialogue
            wait BW2XT_LAND05_SNEAK_ATTACK_70 + 0.75 seconds
            wait 5 seconds
            say "BW2XT_LAND05_SNEAK_ATTACK_10"
            clear dialogue
            close dialogue
            wait BW2XT_LAND05_SNEAK_ATTACK_10 + 0.75 seconds
            say "BW2XT_LAND05_SNEAK_ATTACK_20"
            clear dialogue
            close dialogue
            wait BW2XT_LAND05_SNEAK_ATTACK_20 + 0.75 seconds
        end dialogue
    end if

    if TalusCommentWall == 1
        TalusCommentWall = 2
        wait 14 seconds
        EarlyAttackWaveAllowed = 1
        begin dialogue
            say "BW2XT_LAND05_TALUS_VARIOUS_180"
            clear dialogue
            close dialogue
            wait BW2XT_LAND05_TALUS_VARIOUS_180 + 0.75 seconds
            wait 5 seconds
            say "BW2XT_LAND05_TALUS_VARIOUS_380"
            clear dialogue
            close dialogue
            wait BW2XT_LAND05_TALUS_VARIOUS_380 + 0.75 seconds
        end dialogue
    end if

    if PLAYER of PlayerTown == 0 and TalusTownComment == 0
        TalusTownComment = 1

    end if

    //BW2T_SCRIPT_11FINAL_ADVISORS_AZTEC_ANGER_90
end loop

end script LC14_Speeches


begin script LC14_GenericTalusSpeeches(whichUnit,PlayerOfUnit)

    Number = 0

start

begin loop
    wait number from 1 to 10 seconds
    until whichUnit not exists
end loop

//Unit Dead Comment
if get UnitDeadTimer time remaining <= 0 and GB_DialogueIsRunning == 0
    if Language == German
        if PlayerOfUnit == 0
            GB_DialogueIsRunning = 1
            Number = number from 1 to 12
            begin dialogue
                if Number == 1
                    say "BW2XT_GENERAL_TALUS_WINNING_01"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_WINNING_01 + 1 seconds
                    say "BW2XT_GENERAL_TALUS_WINNING_02"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_WINNING_02 + 1 seconds
                elsif Number == 2
                    say "BW2XT_GENERAL_TALUS_WINNING_03"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_WINNING_03 + 1 seconds
                elsif Number == 3
                    say "BW2XT_GENERAL_TALUS_WINNING_04"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_WINNING_04 + 1 seconds
                elsif Number == 4
                    say "BW2XT_GENERAL_TALUS_WINNING_05"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_WINNING_05 + 1 seconds
                elsif Number == 5
                    say "BW2XT_GENERAL_TALUS_WINNING_06"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_WINNING_06 + 1 seconds
                elsif Number == 6
                    say "BW2XT_GENERAL_TALUS_WINNING_07"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_WINNING_07 + 1 seconds
                elsif Number == 7
                    say "BW2XT_GENERAL_TALUS_WINNING_08"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_WINNING_08 + 1 seconds
                elsif Number == 8
                    say "BW2XT_GENERAL_TALUS_WINNING_09"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_WINNING_09 + 1 seconds
                elsif Number == 9
                    say "BW2XT_GENERAL_TALUS_WINNING_10"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_WINNING_10 + 1 seconds
                elsif Number == 10
                    say "BW2XT_GENERAL_TALUS_WINNING_11"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_WINNING_11 + 1 seconds
                elsif Number == 11
                    say "BW2XT_GENERAL_TALUS_WINNING_12"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_WINNING_12 + 1 seconds
                elsif Number == 12
                    say "BW2XT_GENERAL_TALUS_WINNING_13"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_WINNING_13 + 1 seconds
                end if
            end dialogue
            GB_DialogueIsRunning = 0
        else
            GB_DialogueIsRunning = 1
            Number = number from 1 to 10
            begin dialogue
                if Number == 1
                    say "BW2XT_GENERAL_TALUS_LOSING_01"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_LOSING_01 + 1 seconds
                elsif Number == 2
                    say "BW2XT_GENERAL_TALUS_LOSING_02"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_LOSING_02 + 1 seconds
                elsif Number == 3
                    say "BW2XT_GENERAL_TALUS_LOSING_03"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_LOSING_03 + 1 seconds
                elsif Number == 4
                    say "BW2XT_GENERAL_TALUS_LOSING_04"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_LOSING_04 + 1 seconds
                elsif Number == 5
                    say "BW2XT_GENERAL_TALUS_LOSING_05"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_LOSING_05 + 1 seconds
                elsif Number == 6
                    say "BW2XT_GENERAL_TALUS_LOSING_06"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_LOSING_06 + 1 seconds
                elsif Number == 7
                    say "BW2XT_GENERAL_TALUS_LOSING_07"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_LOSING_07 + 1 seconds
                elsif Number == 8
                    say "BW2XT_GENERAL_TALUS_LOSING_08"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_LOSING_08 + 1 seconds
                elsif Number == 9
                    say "BW2XT_GENERAL_TALUS_LOSING_09"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_LOSING_09 + 1 seconds
                elsif Number == 10
                    say "BW2XT_GENERAL_TALUS_LOSING_10"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_LOSING_10 + 1 seconds
                end if
            end dialogue
            GB_DialogueIsRunning = 0
        end if
    elsif Language == English
        if PlayerOfUnit == 0
            GB_DialogueIsRunning = 1
            Number = number from 1 to 8
            begin dialogue
                if Number == 1
                    say "BW2XT_LAND01_GENERAL_01"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND01_GENERAL_01 + 1 seconds
                elsif Number == 2
                    say "BW2XT_LAND01_GENERAL_02"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND01_GENERAL_02 + 1 seconds
                elsif Number == 3
                    say "BW2XT_LAND01_GENERAL_03"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND01_GENERAL_03 + 1 seconds
                elsif Number == 4
                    say "BW2XT_LAND01_GENERAL_04"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND01_GENERAL_04 + 1 seconds
                elsif Number == 5
                    say "BW2XT_LAND01_GENERAL_05"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND01_GENERAL_05 + 1 seconds
                elsif Number == 6
                    say "BW2XT_LAND02_MISC_70"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND02_MISC_70 + 1 seconds
                elsif Number == 7
                    say "BW2XT_LAND02_PLAYER_ATTACKS_10"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND02_PLAYER_ATTACKS_10 + 1 seconds
                elsif Number == 8
                    say "BW2XT_LAND02_PLAYER_ATTACKS_20"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND02_PLAYER_ATTACKS_20 + 1 seconds
                end if
            end dialogue
            GB_DialogueIsRunning = 0
        else
            GB_DialogueIsRunning = 1
            Number = number from 1 to 8
            begin dialogue
                if Number == 1
                    say "BW2XT_LAND02_TALUS_BANTER_20"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND02_TALUS_BANTER_20 + 1 seconds
                elsif Number == 2
                    say "BW2XT_LAND02_TALUS_BANTER_40"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND02_TALUS_BANTER_40 + 1 seconds
                elsif Number == 3
                    say "BW2XT_LAND02_TALUS_BANTER_50"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND02_TALUS_BANTER_50 + 1 seconds
                elsif Number == 4
                    say "BW2XT_LAND02_TALUS_BANTER_60"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND02_TALUS_BANTER_60 + 1 seconds
                elsif Number == 5
                    say "BW2XT_LAND02_TALUS_BANTER_70"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND02_TALUS_BANTER_70 + 1 seconds
                elsif Number == 6
                    say "BW2XT_LAND02_TALUS_BANTER_110"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND02_TALUS_BANTER_110 + 1 seconds
                elsif Number == 7
                    say "XTRA_LINE_1"
                    clear dialogue
                    close dialogue
                    wait XTRA_LINE_1 + 1 seconds
                elsif Number == 8
                    say "XTRA_LINE_2"
                    clear dialogue
                    close dialogue
                    wait XTRA_LINE_2 + 1 seconds
                end if
            end dialogue
            GB_DialogueIsRunning = 0
        end if
    end if
    UnitDeadTimer = create timer for number from 15 to 45 seconds
end if

end script LC14_GenericTalusSpeeches


begin script LC14_GetPlayerUnits

    MyPlatoon = 0

start

begin loop
    wait 2.5 seconds
    MyPlatoon = get platoon of player 0 nearest hand position radius 100 excluding scripted
    if MyPlatoon exists
        run background script LC14_GenericTalusSpeeches(MyPlatoon,0)
    end if
end loop

end script LC14_GetPlayerUnits


begin script LC14_Aztec_Capital

    AttackingPosition = 0
    AttackingPositionFallBack = 0
    Wall[10]
    NearestSettlementTownCentre = 0
    AttackDir[3]
    Number = 0
    SiegeWaypoint1 = 0
    SiegeWaypoint2 = 0
    SiegeWaypoint3 = 0
    AttackAztecTown1Timer = create timer for 0 seconds
    CapturePlayer0Timer = 0
    CapturePlayerTown = 0
    TownCentre = 0
    LargeSiegeTimer = create timer for 999999 seconds
    LargeSiegeStarted = 0
    LargeSiegeInit = 0
    TempSiege = 0
    TempPlatoon = 0
    myAttackTimer2 = create timer for 0 seconds

start

    if Intro == 1
        set player 1 town PlayerTown capture reason LAST_CAPTURE_AGGRESSIVE
    else
        DynamicMusicReady = 1
    end if

    begin loop
        AztecTemple[0] = get building ABODE_NUMBER_BATHHOUSE in AztecTempleTown[0] min built 1.0
        AztecTemple[1] = get building ABODE_NUMBER_BATHHOUSE in AztecTempleTown[1] min built 1.0
        AztecTemple[2] = get building ABODE_NUMBER_BATHHOUSE in AztecTempleTown[2] min built 1.0
        until AztecTemple[0] exists and AztecTemple[1] exists and AztecTemple[2] exists
    end loop

    AztecTempleScrolls[0] = create highlight GOLD name "HELP_TEXT_MULTIPLAYER_BANTER_SET_01_TEXT_01" remind "HELP_TEXT_MULTIPLAYER_BANTER_SET_01_TEXT_01" at {1363.10,127.93,1898.50} + {0,5,0}
    AztecTempleScrolls[1] = create highlight GOLD name "HELP_TEXT_MULTIPLAYER_BANTER_SET_01_TEXT_01" remind "HELP_TEXT_MULTIPLAYER_BANTER_SET_01_TEXT_01" at {1079.71,56.72,1186.97} + {0,5,0}
    AztecTempleScrolls[2] = create highlight GOLD name "HELP_TEXT_MULTIPLAYER_BANTER_SET_01_TEXT_01" remind "HELP_TEXT_MULTIPLAYER_BANTER_SET_01_TEXT_01" at {674.64,43.84,453.32} + {0,5,0}

    ALTITUDE of AztecTempleScrolls[0] = 3.0
    ALTITUDE of AztecTempleScrolls[1] = 3.0
    ALTITUDE of AztecTempleScrolls[2] = 3.0

    disable AztecTemple[0] hurt by fire
    disable AztecTemple[1] hurt by fire
    disable AztecTemple[2] hurt by fire

    run background script LC14_FireRain(AztecTemple[0],marker at {1163.26,121.20,1938.87})
    run background script LC14_FireRain(AztecTemple[1],marker at {1349.81,47.53,1241.44})
    run background script LC14_FireRain(AztecTemple[2],marker at {1387.88,151.23,578.09})

    while AIVolcano not exists
        AIVolcano = get SCRIPT_OBJECT_TYPE_WONDER EPIC_WONDER_NUMBER_VOLCANO at {AztecTown2} radius 150
    end while
    disable AIVolcano hurt by fire
    CHARGE of AIVolcano = 1.0

    while AIEarthquake not exists
        AIEarthquake = get SCRIPT_OBJECT_TYPE_WONDER EPIC_WONDER_NUMBER_EARTHQUAKE at {1962.57,101.50,942.89} radius 150
    end while
    disable AIEarthquake hurt by fire
    CHARGE of AIEarthquake = 1.0

    while AIHurricane not exists
        AIHurricane = get SCRIPT_OBJECT_TYPE_WONDER EPIC_WONDER_NUMBER_HURRICANE at {1750.17,157.69,943.01} radius 150
    end while
    disable AIHurricane hurt by fire
    CHARGE of AIHurricane = 1.0

    AttackNearestTownTimer = create timer for 0 seconds

    LC14_RecruitTimer1 = create timer for 60 seconds
    LC14_RecruitTimer2 = create timer for 60 seconds
    LC14_RecruitTimer3 = create timer for 60 seconds

    //VOLCANO
    //HURRICANE
    //EARTHQUAKE

    if Difficulty >= 4
        add resource WOOD 3000 to PlayerTown
        add resource ORE 3000 to PlayerTown
        add resource FOOD 3000 to PlayerTown
    elsif Difficulty == 3
        add resource WOOD 5000 to PlayerTown
        add resource ORE 5000 to PlayerTown
        add resource FOOD 5000 to PlayerTown
    elsif Difficulty == 2
        add resource WOOD 7500 to PlayerTown
        add resource ORE 7500 to PlayerTown
        add resource FOOD 7500 to PlayerTown
    elsif Difficulty == 1
        add resource WOOD 10000 to PlayerTown
        add resource ORE 10000 to PlayerTown
        add resource FOOD 10000 to PlayerTown
    end if

    //AztecCapital Walls
    Wall[0] = get wall segment nearest {1677.06,181.50,1240.49} radius 15
    Wall[1] = get wall segment nearest {1733.05,181.03,1240.13} radius 15

    //AztecTown1 Walls
    Wall[2] = get wall segment nearest {1757.51,115.75,1663.69} radius 15
    Wall[3] = get wall segment nearest {1692.16,118.64,1698.54} radius 15
    Wall[4] = get wall segment nearest {1443.24,141.24,1836.13} radius 15
    Wall[5] = get wall segment nearest {1457.85,142.19,1905.36} radius 15

    //AztecTown2 Walls
    Wall[6] = get wall segment nearest {1125.06,56.02,1242.05} radius 15
    Wall[7] = get wall segment nearest {1135.37,56.59,1185.06} radius 15

    //PlayerTown Walls
    Wall[8] = get wall segment nearest {871.51,113.75,2012.96} radius 15
    Wall[9] = get wall segment nearest {919.95,114.34,2060.42} radius 15

    //----Create town static defenders platoons----//
    //AztecCapital
    LC14_Platoon[0] = create platoon ARMY_UNIT_TYPE_MELEE_6 at {PlatoonPos[0]} with 50 * RecruitSizeModifier men and 0 women
    attach LC14_Platoon[0] to AztecCapital
    PLAYER of LC14_Platoon[0] = 1
    run background script LC14_StaticPlatoonsActions(PlatoonPos[0],Melee,LC14_Platoon[0])
    run background script LC14_GenericTalusSpeeches(LC14_Platoon[0],1)
    disable platoon LC14_Platoon[0] respond to town AztecCapital attack
    disable platoon LC14_Platoon[0] camp
    set LC14_Platoon[0] focus to {AztecTown1}

    LC14_Platoon[1] = create platoon ARMY_UNIT_TYPE_MELEE_7 at {PlatoonPos[1]} with 20 * RecruitSizeModifier men and 0 women
    attach LC14_Platoon[1] to AztecCapital
    PLAYER of LC14_Platoon[1] = 1
    run background script LC14_StaticPlatoonsActions(PlatoonPos[1],Melee,LC14_Platoon[1])
    run background script LC14_GenericTalusSpeeches(LC14_Platoon[1],1)
    disable platoon LC14_Platoon[1] respond to town AztecCapital attack
    disable platoon LC14_Platoon[1] camp
    set LC14_Platoon[1] focus to {PlatoonPos[1]}

    LC14_Platoon[2] = create platoon ARMY_UNIT_TYPE_MELEE_7 at {PlatoonPos[2]} with 20 * RecruitSizeModifier men and 0 women
    attach LC14_Platoon[2] to AztecCapital
    PLAYER of LC14_Platoon[2] = 1
    run background script LC14_StaticPlatoonsActions(PlatoonPos[2],Melee,LC14_Platoon[2])
    run background script LC14_GenericTalusSpeeches(LC14_Platoon[2],1)
    disable platoon LC14_Platoon[2] respond to town AztecCapital attack
    disable platoon LC14_Platoon[2] camp
    set LC14_Platoon[2] focus to {PlatoonPos[2]}

    LC14_Platoon[3] = create platoon ARMY_UNIT_TYPE_MELEE_7 at {PlatoonPos[3]} with 20 * RecruitSizeModifier men and 0 women
    attach LC14_Platoon[3] to AztecCapital
    PLAYER of LC14_Platoon[3] = 1
    run background script LC14_StaticPlatoonsActions(PlatoonPos[3],Melee,LC14_Platoon[3])
    run background script LC14_GenericTalusSpeeches(LC14_Platoon[3],1)
    disable platoon LC14_Platoon[3] respond to town AztecCapital attack
    disable platoon LC14_Platoon[3] camp
    set LC14_Platoon[3] focus to {PlatoonPos[3]}

    LC14_Platoon[4] = create platoon ARMY_UNIT_TYPE_RANGED_7 at {PlatoonPos[4]} with 20 * RecruitSizeModifier men and 0 women
    attach LC14_Platoon[4] to AztecCapital
    PLAYER of LC14_Platoon[4] = 1
    run background script LC14_StaticPlatoonsActions(PlatoonPos[4],Ranged,LC14_Platoon[4])
    run background script LC14_GenericTalusSpeeches(LC14_Platoon[4],1)
    disable platoon LC14_Platoon[4] respond to town AztecCapital attack
    disable platoon LC14_Platoon[4] camp
    set LC14_Platoon[4] focus to {PlatoonPos[4]}

    LC14_Platoon[5] = create platoon ARMY_UNIT_TYPE_RANGED_7 at {PlatoonPos[5]} with 20 * RecruitSizeModifier men and 0 women
    attach LC14_Platoon[5] to AztecCapital
    PLAYER of LC14_Platoon[5] = 1
    run background script LC14_StaticPlatoonsActions(PlatoonPos[5],Ranged,LC14_Platoon[5])
    run background script LC14_GenericTalusSpeeches(LC14_Platoon[5],1)
    disable platoon LC14_Platoon[5] respond to town AztecCapital attack
    disable platoon LC14_Platoon[5] camp
    set LC14_Platoon[5] focus to {PlatoonPos[5]}

    LC14_Platoon[6] = create platoon ARMY_UNIT_TYPE_RANGED_7 at {PlatoonPos[6]} with 20 * RecruitSizeModifier men and 0 women
    attach LC14_Platoon[6] to AztecCapital
    PLAYER of LC14_Platoon[6] = 1
    run background script LC14_StaticPlatoonsActions(PlatoonPos[6],Ranged,LC14_Platoon[6])
    run background script LC14_GenericTalusSpeeches(LC14_Platoon[6],1)
    disable platoon LC14_Platoon[6] respond to town AztecCapital attack
    disable platoon LC14_Platoon[6] camp
    set LC14_Platoon[6] focus to {PlatoonPos[6]}

    //AztecTown1
    LC14_Platoon[7] = create platoon ARMY_UNIT_TYPE_MELEE_6 at {PlatoonPos[7]} with 40 * RecruitSizeModifier men and 0 women
    attach LC14_Platoon[7] to AztecTown1
    PLAYER of LC14_Platoon[7] = 1
    run background script LC14_StaticPlatoonsActions(PlatoonPos[7],Melee,LC14_Platoon[7])
    run background script LC14_GenericTalusSpeeches(LC14_Platoon[7],1)
    disable platoon LC14_Platoon[7] respond to town AztecTown1 attack
    disable platoon LC14_Platoon[7] camp
    set LC14_Platoon[7] focus to {PlatoonPos[7]}

    LC14_Platoon[8] = create platoon ARMY_UNIT_TYPE_MELEE_6 at {PlatoonPos[8]} with 40 * RecruitSizeModifier men and 0 women
    attach LC14_Platoon[8] to AztecTown1
    PLAYER of LC14_Platoon[8] = 1
    run background script LC14_StaticPlatoonsActions(PlatoonPos[8],Melee,LC14_Platoon[8])
    run background script LC14_GenericTalusSpeeches(LC14_Platoon[8],1)
    disable platoon LC14_Platoon[8] respond to town AztecTown1 attack
    disable platoon LC14_Platoon[8] camp
    set LC14_Platoon[8] focus to {PlatoonPos[8]}

    LC14_Platoon[9] = create platoon ARMY_UNIT_TYPE_MELEE_6 at {PlatoonPos[9]} with 40 * RecruitSizeModifier men and 0 women
    attach LC14_Platoon[9] to AztecTown1
    PLAYER of LC14_Platoon[9] = 1
    run background script LC14_StaticPlatoonsActions(PlatoonPos[9],Melee,LC14_Platoon[9])
    run background script LC14_GenericTalusSpeeches(LC14_Platoon[9],1)
    disable platoon LC14_Platoon[9] respond to town AztecTown1 attack
    disable platoon LC14_Platoon[9] camp
    set LC14_Platoon[9] focus to {PlatoonPos[9]}

    LC14_Platoon[10] = create platoon ARMY_UNIT_TYPE_RANGED_6 at {PlatoonPos[10]} with 40 * RecruitSizeModifier men and 0 women
    attach LC14_Platoon[10] to AztecTown1
    PLAYER of LC14_Platoon[10] = 1
    run background script LC14_StaticPlatoonsActions(PlatoonPos[10],Ranged,LC14_Platoon[10])
    run background script LC14_GenericTalusSpeeches(LC14_Platoon[10],1)
    disable platoon LC14_Platoon[10] respond to town AztecTown1 attack
    disable platoon LC14_Platoon[10] camp
    set LC14_Platoon[10] focus to {PlatoonPos[10]}

    //AztecTown2
    LC14_Platoon[11] = create platoon ARMY_UNIT_TYPE_RANGED_6 at {PlatoonPos[11]} with 30 * RecruitSizeModifier men and 0 women
    attach LC14_Platoon[11] to AztecTown2
    PLAYER of LC14_Platoon[11] = 1
    run background script LC14_StaticPlatoonsActions(PlatoonPos[11],Ranged,LC14_Platoon[11])
    run background script LC14_GenericTalusSpeeches(LC14_Platoon[11],1)
    disable platoon LC14_Platoon[11] respond to town AztecTown2 attack
    disable platoon LC14_Platoon[11] camp
    set LC14_Platoon[11] focus to {PlatoonPos[11]}

    LC14_Platoon[12] = create platoon ARMY_UNIT_TYPE_RANGED_6 at {PlatoonPos[12]} with 30 * RecruitSizeModifier men and 0 women
    attach LC14_Platoon[12] to AztecTown2
    PLAYER of LC14_Platoon[12] = 1
    run background script LC14_StaticPlatoonsActions(PlatoonPos[12],Ranged,LC14_Platoon[12])
    run background script LC14_GenericTalusSpeeches(LC14_Platoon[12],1)
    disable platoon LC14_Platoon[12] respond to town AztecTown2 attack
    disable platoon LC14_Platoon[12] camp
    set LC14_Platoon[12] focus to {PlatoonPos[12]}

    //PlayerTown
    LC14_Platoon[13] = create platoon ARMY_UNIT_TYPE_RANGED_6 at {PlatoonPos[13]} with 25 * RecruitSizeModifier men and 0 women
    attach LC14_Platoon[13] to PlayerTown
    PLAYER of LC14_Platoon[13] = 1
    run background script LC14_StaticPlatoonsActions(PlatoonPos[13],Ranged,LC14_Platoon[13])
    run background script LC14_GenericTalusSpeeches(LC14_Platoon[13],1)
    disable platoon LC14_Platoon[13] respond to town PlayerTown attack
    disable platoon LC14_Platoon[13] camp
    set LC14_Platoon[13] focus to {PlatoonPos[13]}

    LC14_Platoon[14] = create platoon ARMY_UNIT_TYPE_MELEE_6 at {PlatoonPos[14]} with 25 * RecruitSizeModifier men and 0 women
    attach LC14_Platoon[14] to PlayerTown
    PLAYER of LC14_Platoon[14] = 1
    run background script LC14_StaticPlatoonsActions(PlatoonPos[14],Melee,LC14_Platoon[14])
    run background script LC14_GenericTalusSpeeches(LC14_Platoon[14],1)
    disable platoon LC14_Platoon[14] respond to town PlayerTown attack
    disable platoon LC14_Platoon[14] camp
    set LC14_Platoon[14] focus to {PlatoonPos[14]}

    LC14_Platoon[15] = create platoon ARMY_UNIT_TYPE_MELEE_6 at {PlatoonPos[15]} with 25 * RecruitSizeModifier men and 0 women
    attach LC14_Platoon[15] to PlayerTown
    PLAYER of LC14_Platoon[15] = 1
    run background script LC14_StaticPlatoonsActions(PlatoonPos[15],Melee,LC14_Platoon[15])
    run background script LC14_GenericTalusSpeeches(LC14_Platoon[15],1)
    disable platoon LC14_Platoon[15] respond to town PlayerTown attack
    disable platoon LC14_Platoon[15] camp
    set LC14_Platoon[15] focus to {PlatoonPos[15]}

    //----Create static defenders platoons----//
    LC14_Platoon[16] = create platoon ARMY_UNIT_TYPE_MELEE_8 at {PlatoonPos[16]} with 60 * RecruitSizeModifier men and 0 women
    attach LC14_Platoon[16] to AztecTown3
    PLAYER of LC14_Platoon[16] = 1
    run background script LC14_StaticPlatoonsActions(PlatoonPos[16],Melee,LC14_Platoon[16])
    run background script LC14_GenericTalusSpeeches(LC14_Platoon[16],1)
    disable platoon LC14_Platoon[16] respond to town AztecTown3 attack
    disable platoon LC14_Platoon[16] camp
    set LC14_Platoon[16] focus to {PlatoonPos[16]}

    //----Create patrol platoons----//
    LC14_Platoon[17] = create platoon ARMY_UNIT_TYPE_MELEE_6 at {PatrolRouteA[0]} with 60 * RecruitSizeModifier men and 0 women
    attach LC14_Platoon[17] to AztecCapital
    PLAYER of LC14_Platoon[17] = 1
    run background script LC14_ArmyBehaivours(LC14_Platoon[17],Melee,Patrol,0,0,0,WaypointsA,0)
    run background script LC14_GenericTalusSpeeches(LC14_Platoon[17],1)
    disable platoon LC14_Platoon[17] respond to town AztecCapital attack
    disable platoon LC14_Platoon[17] camp
    set LC14_Platoon[17] focus to {AztecCapital}

    LC14_Platoon[18] = create platoon ARMY_UNIT_TYPE_RANGED_6 at {PatrolRouteA[0]} with 60 * RecruitSizeModifier men and 0 women
    attach LC14_Platoon[18] to AztecCapital
    PLAYER of LC14_Platoon[18] = 1
    run background script LC14_ArmyBehaivours(LC14_Platoon[18],Ranged,PatrolLinked,LC14_Platoon[17],0,0,WaypointsA,0)
    run background script LC14_GenericTalusSpeeches(LC14_Platoon[18],1)
    disable platoon LC14_Platoon[18] respond to town AztecCapital attack
    disable platoon LC14_Platoon[18] camp
    set LC14_Platoon[18] focus to {AztecCapital}

    LC14_Platoon[19] = create platoon ARMY_UNIT_TYPE_MELEE_7 at {PatrolRouteB[0]} with 85 * RecruitSizeModifier men and 0 women
    attach LC14_Platoon[19] to AztecCapital
    PLAYER of LC14_Platoon[19] = 1
    run background script LC14_ArmyBehaivours(LC14_Platoon[19],Melee,Patrol,0,0,0,WaypointsB,0)
    run background script LC14_GenericTalusSpeeches(LC14_Platoon[19],1)
    disable platoon LC14_Platoon[19] respond to town AztecCapital attack
    disable platoon LC14_Platoon[19] camp
    set LC14_Platoon[19] focus to {AztecCapital}

    //----Create town archer platoons----//
    LC14_WallArcher[0] = create platoon PLATOON_INFO_AZTEC_RANGED_5 at {Wall[0]} with 20 * RecruitSizeModifier men and 0 women
    attach LC14_WallArcher[0] to AztecCapital
    PLAYER of LC14_WallArcher[0] = 1
    enable platoon LC14_WallArcher[0] respond to town AztecCapital attack
    run background script LC14_GenericTalusSpeeches(LC14_WallArcher[0],1)
    add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[0] to LC14_WallArcher[0] action queue

    LC14_WallArcher[1] = create platoon PLATOON_INFO_AZTEC_RANGED_5 at {Wall[1]} with 20 * RecruitSizeModifier men and 0 women
    attach LC14_WallArcher[1] to AztecCapital
    PLAYER of LC14_WallArcher[1] = 1
    enable platoon LC14_WallArcher[1] respond to town AztecCapital attack
    run background script LC14_GenericTalusSpeeches(LC14_WallArcher[1],1)
    add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[1] to LC14_WallArcher[1] action queue


    LC14_WallArcher[2] = create platoon PLATOON_INFO_AZTEC_RANGED_5 at {Wall[2]} with 20 * RecruitSizeModifier men and 0 women
    attach LC14_WallArcher[2] to AztecTown1
    PLAYER of LC14_WallArcher[2] = 1
    enable platoon LC14_WallArcher[2] respond to town AztecTown1 attack
    run background script LC14_GenericTalusSpeeches(LC14_WallArcher[2],1)
    add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[2] to LC14_WallArcher[2] action queue

    LC14_WallArcher[3] = create platoon PLATOON_INFO_AZTEC_RANGED_5 at {Wall[3]} with 20 * RecruitSizeModifier men and 0 women
    attach LC14_WallArcher[3] to AztecTown1
    PLAYER of LC14_WallArcher[3] = 1
    enable platoon LC14_WallArcher[3] respond to town AztecTown1 attack
    run background script LC14_GenericTalusSpeeches(LC14_WallArcher[3],1)
    add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[3] to LC14_WallArcher[3] action queue

    LC14_WallArcher[4] = create platoon PLATOON_INFO_AZTEC_RANGED_5 at {Wall[4]} with 20 * RecruitSizeModifier men and 0 women
    attach LC14_WallArcher[4] to AztecTown1
    PLAYER of LC14_WallArcher[4] = 1
    enable platoon LC14_WallArcher[4] respond to town AztecTown1 attack
    run background script LC14_GenericTalusSpeeches(LC14_WallArcher[4],1)
    add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[4] to LC14_WallArcher[4] action queue

    LC14_WallArcher[5] = create platoon PLATOON_INFO_AZTEC_RANGED_5 at {Wall[5]} with 20 * RecruitSizeModifier men and 0 women
    attach LC14_WallArcher[5] to AztecTown1
    PLAYER of LC14_WallArcher[5] = 1
    enable platoon LC14_WallArcher[5] respond to town AztecTown1 attack
    run background script LC14_GenericTalusSpeeches(LC14_WallArcher[5],1)
    add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[5] to LC14_WallArcher[5] action queue


    LC14_WallArcher[6] = create platoon PLATOON_INFO_AZTEC_RANGED_5 at {Wall[6]} with 20 * RecruitSizeModifier men and 0 women
    attach LC14_WallArcher[6] to AztecTown2
    PLAYER of LC14_WallArcher[6] = 1
    enable platoon LC14_WallArcher[6] respond to town AztecTown2 attack
    run background script LC14_GenericTalusSpeeches(LC14_WallArcher[6],1)
    add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[6] to LC14_WallArcher[6] action queue

    LC14_WallArcher[7] = create platoon PLATOON_INFO_AZTEC_RANGED_5 at {Wall[7]} with 20 * RecruitSizeModifier men and 0 women
    attach LC14_WallArcher[7] to AztecTown2
    PLAYER of LC14_WallArcher[7] = 1
    enable platoon LC14_WallArcher[7] respond to town AztecTown2 attack
    run background script LC14_GenericTalusSpeeches(LC14_WallArcher[7],1)
    add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[7] to LC14_WallArcher[7] action queue


    LC14_WallArcher[8] = create platoon PLATOON_INFO_AZTEC_RANGED_5 at {Wall[8]} with 12 * RecruitSizeModifier men and 0 women
    attach LC14_WallArcher[8] to PlayerTown
    PLAYER of LC14_WallArcher[8] = 1
    enable platoon LC14_WallArcher[8] respond to town PlayerTown attack
    run background script LC14_GenericTalusSpeeches(LC14_WallArcher[8],1)
    add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[8] to LC14_WallArcher[8] action queue

    LC14_WallArcher[9] = create platoon PLATOON_INFO_AZTEC_RANGED_5 at {Wall[9]} with 12 * RecruitSizeModifier men and 0 women
    attach LC14_WallArcher[9] to PlayerTown
    PLAYER of LC14_WallArcher[9] = 1
    enable platoon LC14_WallArcher[9] respond to town PlayerTown attack
    run background script LC14_GenericTalusSpeeches(LC14_WallArcher[9],1)
    add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[9] to LC14_WallArcher[9] action queue

    //----Create static sieges----//
    if Difficulty >= 4
        LC14_SiegeCatapult[0] = create siege weapon SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_7 belonging to AztecCapital at {StaticSiegePos[0]}
        set LC14_SiegeCatapult[0] focus to {PlayerTown}
        add action SIEGEWEAPON_AGENDA_ACTION_DEFEND_POSITION using {StaticSiegePos[0]} to siege weapon LC14_SiegeCatapult[0] action queue
    end if

    LC14_SiegeCatapult[1] = create siege weapon SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_7 belonging to AztecCapital at {StaticSiegePos[1]}
    set LC14_SiegeCatapult[1] focus to {PlayerTown}
    add action SIEGEWEAPON_AGENDA_ACTION_DEFEND_POSITION using {StaticSiegePos[1]} to siege weapon LC14_SiegeCatapult[1] action queue

    LC14_SiegeCatapult[2] = create siege weapon SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_7 belonging to AztecCapital at {StaticSiegePos[2]}
    set LC14_SiegeCatapult[2] focus to {PlayerTown}
    add action SIEGEWEAPON_AGENDA_ACTION_DEFEND_POSITION using {StaticSiegePos[2]} to siege weapon LC14_SiegeCatapult[2] action queue

    LC14_SiegeCatapult[3] = create siege weapon SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_7 belonging to AztecCapital at {StaticSiegePos[3]}
    set LC14_SiegeCatapult[3] focus to {PlayerTown}
    add action SIEGEWEAPON_AGENDA_ACTION_DEFEND_POSITION using {StaticSiegePos[3]} to siege weapon LC14_SiegeCatapult[3] action queue

    LC14_SiegeCatapult[4] = create siege weapon SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_7 belonging to AztecCapital at {StaticSiegePos[4]}
    set LC14_SiegeCatapult[4] focus to {PlayerTown}
    add action SIEGEWEAPON_AGENDA_ACTION_DEFEND_POSITION using {StaticSiegePos[4]} to siege weapon LC14_SiegeCatapult[4] action queue

    //Create Special Troops
    //PlayerTown Early Attackers
    LC14_Platoon[20] = create platoon ARMY_UNIT_TYPE_MELEE_7 at {PlatoonPos[17]} with 40 * RecruitSizeModifier men and 0 women
    PLAYER of LC14_Platoon[20] = 1
    AttackingPosition = marker at {AttackPos[0]}
    AttackingPositionFallBack = marker at {AttackPos[1]}
    run background script LC14_ArmyBehaivours(LC14_Platoon[20],Melee,Attacker,0,AttackingPosition,AttackingPositionFallBack,0,0)
    run background script LC14_GenericTalusSpeeches(LC14_Platoon[20],1)
    run background script LC14_CreateUndeadPlatoon(LC14_Platoon[20],40 * RecruitSizeModifier,40 * RecruitSizeModifier,s_aztecwarrior_ghost)
    disable platoon LC14_Platoon[20] respond to town AztecCapital attack
    disable platoon LC14_Platoon[20] camp
    set LC14_Platoon[20] focus to {AztecCapital}

    LC14_Platoon[21] = create platoon ARMY_UNIT_TYPE_MELEE_7 at {PlatoonPos[18]} with 40 * RecruitSizeModifier men and 0 women
    PLAYER of LC14_Platoon[21] = 1
    AttackingPosition = marker at {AttackPos[0]} + {20,0,20}
    AttackingPositionFallBack = marker at {AttackPos[1]} + {20,0,20}
    run background script LC14_ArmyBehaivours(LC14_Platoon[21],Melee,Attacker,0,AttackingPosition,AttackingPositionFallBack,0,0)
    run background script LC14_GenericTalusSpeeches(LC14_Platoon[21],1)
    run background script LC14_CreateUndeadPlatoon(LC14_Platoon[21],40 * RecruitSizeModifier,40 * RecruitSizeModifier,s_aztecwarrior_ghost)
    disable platoon LC14_Platoon[21] respond to town AztecCapital attack
    disable platoon LC14_Platoon[21] camp
    set LC14_Platoon[21] focus to {AztecTown1}

    //LargeSiege Platoons
    LC14_Platoon[22] = create platoon ARMY_UNIT_TYPE_MELEE_7 at {1509.72,149.88,1904.03} with 40 * RecruitSizeModifier men and 0 women
    PLAYER of LC14_Platoon[22] = 1
    run background script LC14_GenericTalusSpeeches(LC14_Platoon[22],1)
    run background script LC14_CreateUndeadPlatoon(LC14_Platoon[22],40 * RecruitSizeModifier,40 * RecruitSizeModifier,s_skeletonadultland2)
    disable platoon LC14_Platoon[22] respond to town AztecCapital attack
    disable platoon LC14_Platoon[22] camp
    set LC14_Platoon[22] focus to {AztecTown1}

    LC14_Platoon[23] = create platoon ARMY_UNIT_TYPE_MELEE_7 at {1496.67,147.99,1907.57} with 40 * RecruitSizeModifier men and 0 women
    PLAYER of LC14_Platoon[23] = 1
    run background script LC14_GenericTalusSpeeches(LC14_Platoon[23],1)
    run background script LC14_CreateUndeadPlatoon(LC14_Platoon[23],40 * RecruitSizeModifier,40 * RecruitSizeModifier,s_skeletonadultland2)
    disable platoon LC14_Platoon[23] respond to town AztecCapital attack
    disable platoon LC14_Platoon[23] camp
    set LC14_Platoon[23] focus to {AztecTown1}

    LC14_Platoon[24] = create platoon ARMY_UNIT_TYPE_MELEE_7 at {1478.08,146.15,1911.51} with 40 * RecruitSizeModifier men and 0 women
    PLAYER of LC14_Platoon[24] = 1
    run background script LC14_GenericTalusSpeeches(LC14_Platoon[24],1)
    run background script LC14_CreateUndeadPlatoon(LC14_Platoon[24],40 * RecruitSizeModifier,40 * RecruitSizeModifier,s_skeletonadultland2)
    disable platoon LC14_Platoon[24] respond to town AztecCapital attack
    disable platoon LC14_Platoon[24] camp
    set LC14_Platoon[24] focus to {AztecTown1}

    LC14_Platoon[25] = create platoon ARMY_UNIT_TYPE_MELEE_7 at {1478.66,145.30,1884.45} with 40 * RecruitSizeModifier men and 0 women
    PLAYER of LC14_Platoon[25] = 1
    run background script LC14_GenericTalusSpeeches(LC14_Platoon[25],1)
    run background script LC14_CreateUndeadPlatoon(LC14_Platoon[25],40 * RecruitSizeModifier,40 * RecruitSizeModifier,s_skeletonadultland2)
    disable platoon LC14_Platoon[25] respond to town AztecCapital attack
    disable platoon LC14_Platoon[25] camp
    set LC14_Platoon[25] focus to {AztecTown1}

    LC14_Platoon[26] = create platoon ARMY_UNIT_TYPE_MELEE_7 at {1493.17,148.05,1879.85} with 40 * RecruitSizeModifier men and 0 women
    PLAYER of LC14_Platoon[26] = 1
    run background script LC14_GenericTalusSpeeches(LC14_Platoon[26],1)
    run background script LC14_CreateUndeadPlatoon(LC14_Platoon[26],40 * RecruitSizeModifier,40 * RecruitSizeModifier,s_skeletonadultland2)
    disable platoon LC14_Platoon[26] respond to town AztecCapital attack
    disable platoon LC14_Platoon[26] camp
    set LC14_Platoon[26] focus to {AztecTown1}

    LC14_Platoon[27] = create platoon ARMY_UNIT_TYPE_MELEE_7 at {1510.35,151.18,1874.07} with 40 * RecruitSizeModifier men and 0 women
    PLAYER of LC14_Platoon[27] = 1
    run background script LC14_GenericTalusSpeeches(LC14_Platoon[27],1)
    run background script LC14_CreateUndeadPlatoon(LC14_Platoon[27],40 * RecruitSizeModifier,40 * RecruitSizeModifier,s_skeletonadultland2)
    disable platoon LC14_Platoon[27] respond to town AztecCapital attack
    disable platoon LC14_Platoon[27] camp
    set LC14_Platoon[27] focus to {AztecTown1}

    wait until IntroFinished == 1

    begin loop
        NearestSettlementTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in NearestSettlement min built 1.0
        //AztecCapital
        if LC14_Platoon[0] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC14_RecruitTimer1 time remaining <= 0
            LC14_Platoon[0] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 30 * RecruitSizeModifier
            LC14_RecruitTimer1 = create timer for 200 * RecruitModifier seconds
            enable platoon LC14_Platoon[0] respond to town AztecCapital attack
            wait until not LC14_Platoon[0] recruiting
            run background script LC14_StaticPlatoonsActions(PlatoonPos[0],Melee,LC14_Platoon[0])
            run background script LC14_GenericTalusSpeeches(LC14_Platoon[0],1)

        elsif LC14_Platoon[1] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC14_RecruitTimer1 time remaining <= 0
            LC14_Platoon[1] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 30 * RecruitSizeModifier
            LC14_RecruitTimer1 = create timer for 200 * RecruitModifier seconds
            enable platoon LC14_Platoon[1] respond to town AztecCapital attack
            wait until not LC14_Platoon[1] recruiting
            run background script LC14_StaticPlatoonsActions(PlatoonPos[1],Melee,LC14_Platoon[1])
            run background script LC14_GenericTalusSpeeches(LC14_Platoon[1],1)

        elsif LC14_Platoon[2] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC14_RecruitTimer1 time remaining <= 0
            LC14_Platoon[2] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 30 * RecruitSizeModifier
            LC14_RecruitTimer1 = create timer for 200 * RecruitModifier seconds
            enable platoon LC14_Platoon[2] respond to town AztecCapital attack
            wait until not LC14_Platoon[2] recruiting
            run background script LC14_StaticPlatoonsActions(PlatoonPos[2],Melee,LC14_Platoon[2])
            run background script LC14_GenericTalusSpeeches(LC14_Platoon[2],1)

        elsif LC14_Platoon[3] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC14_RecruitTimer1 time remaining <= 0
            LC14_Platoon[3] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 30 * RecruitSizeModifier
            LC14_RecruitTimer1 = create timer for 200 * RecruitModifier seconds
            enable platoon LC14_Platoon[3] respond to town AztecCapital attack
            wait until not LC14_Platoon[3] recruiting
            run background script LC14_StaticPlatoonsActions(PlatoonPos[3],Melee,LC14_Platoon[3])
            run background script LC14_GenericTalusSpeeches(LC14_Platoon[3],1)

        elsif LC14_Platoon[4] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC14_RecruitTimer1 time remaining <= 0
            LC14_Platoon[4] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 30 * RecruitSizeModifier
            LC14_RecruitTimer1 = create timer for 200 * RecruitModifier seconds
            enable platoon LC14_Platoon[4] respond to town AztecCapital attack
            wait until not LC14_Platoon[4] recruiting
            run background script LC14_StaticPlatoonsActions(PlatoonPos[4],Ranged,LC14_Platoon[4])
            run background script LC14_GenericTalusSpeeches(LC14_Platoon[4],1)

        elsif LC14_Platoon[5] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC14_RecruitTimer1 time remaining <= 0
            LC14_Platoon[5] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 30 * RecruitSizeModifier
            LC14_RecruitTimer1 = create timer for 200 * RecruitModifier seconds
            enable platoon LC14_Platoon[5] respond to town AztecCapital attack
            wait until not LC14_Platoon[5] recruiting
            run background script LC14_StaticPlatoonsActions(PlatoonPos[5],Ranged,LC14_Platoon[5])
            run background script LC14_GenericTalusSpeeches(LC14_Platoon[5],1)

        elsif LC14_Platoon[6] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC14_RecruitTimer1 time remaining <= 0
            LC14_Platoon[6] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 30 * RecruitSizeModifier
            LC14_RecruitTimer1 = create timer for 200 * RecruitModifier seconds
            enable platoon LC14_Platoon[6] respond to town AztecCapital attack
            wait until not LC14_Platoon[6] recruiting
            run background script LC14_StaticPlatoonsActions(PlatoonPos[6],Ranged,LC14_Platoon[6])
            run background script LC14_GenericTalusSpeeches(LC14_Platoon[6],1)

        elsif LC14_Platoon[17] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC14_RecruitTimer1 time remaining <= 0
            LC14_Platoon[17] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 40 * RecruitSizeModifier
            LC14_RecruitTimer1 = create timer for 200 * RecruitModifier seconds
            enable platoon LC14_Platoon[17] respond to town AztecCapital attack
            wait until not LC14_Platoon[17] recruiting
            run background script LC14_StaticPlatoonsActions(PlatoonPos[5],Melee,LC14_Platoon[17])
            run background script LC14_GenericTalusSpeeches(LC14_Platoon[17],1)

        elsif LC14_Platoon[18] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC14_RecruitTimer1 time remaining <= 0
            LC14_Platoon[18] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 40 * RecruitSizeModifier
            LC14_RecruitTimer1 = create timer for 200 * RecruitModifier seconds
            enable platoon LC14_Platoon[18] respond to town AztecCapital attack
            wait until not LC14_Platoon[18] recruiting
            run background script LC14_StaticPlatoonsActions(PlatoonPos[5],Ranged,LC14_Platoon[18])
            run background script LC14_GenericTalusSpeeches(LC14_Platoon[18],1)

        elsif LC14_WallArcher[0] not exists and Wall[0] exists and PLAYER of Wall[0] == 1 and HEALTH of Wall[0] == 1.0 and not town AztecCapital is under takeover from player 0 and get LC14_RecruitTimer1 time remaining <= 0
            LC14_WallArcher[0] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 20 * RecruitSizeModifier
            LC14_RecruitTimer1 = create timer for 60 * RecruitModifier seconds
            wait until not LC14_WallArcher[0] recruiting
            enable platoon LC14_WallArcher[0] respond to town AztecCapital attack
            add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[0] to LC14_WallArcher[0] action queue
            run background script LC14_GenericTalusSpeeches(LC14_WallArcher[0],1)

        elsif LC14_WallArcher[1] not exists and Wall[1] exists and PLAYER of Wall[1] == 1 and HEALTH of Wall[1] == 1.0 and not town AztecCapital is under takeover from player 0 and get LC14_RecruitTimer1 time remaining <= 0
            LC14_WallArcher[1] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 20 * RecruitSizeModifier
            LC14_RecruitTimer1 = create timer for 60 * RecruitModifier seconds
            wait until not LC14_WallArcher[1] recruiting
            enable platoon LC14_WallArcher[1] respond to town AztecCapital attack
            add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[1] to LC14_WallArcher[1] action queue
            run background script LC14_GenericTalusSpeeches(LC14_WallArcher[1],1)

        //Attack PlayerTown with AIAttacksAllowed
        elsif LC14_Platoon[33] not exists and AIAttacksAllowed == 1 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC14_RecruitTimer1 time remaining <= 0
            LC14_Platoon[33] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 50 * RecruitSizeModifier
            LC14_RecruitTimer1 = create timer for 100 * RecruitModifier seconds
            enable platoon LC14_Platoon[33] respond to town AztecCapital attack
            wait until not LC14_Platoon[33] recruiting
            if PLAYER of AztecTown1 != 0
                AttackingPosition = marker at {AttackPos[0]} + {0,0,0}
                AttackingPositionFallBack = marker at {AttackPos[1]} + {0,0,0}
            else
                AttackingPosition = marker at {AttackPos[2]} + {0,0,0}
                AttackingPositionFallBack = marker at {AttackPos[3]} + {0,0,0}
            end if
            run background script LC14_GenericTalusSpeeches(LC14_Platoon[33],1)
            run background script LC14_ArmyBehaivours(LC14_Platoon[33],Melee,Attacker,0,AttackingPosition,AttackingPositionFallBack,0,0)

        elsif LC14_Platoon[34] not exists and AIAttacksAllowed == 1 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC14_RecruitTimer1 time remaining <= 0
            LC14_Platoon[34] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 50 * RecruitSizeModifier
            LC14_RecruitTimer1 = create timer for 100 * RecruitModifier seconds
            enable platoon LC14_Platoon[34] respond to town AztecCapital attack
            wait until not LC14_Platoon[34] recruiting
            if PLAYER of AztecTown1 != 0
                AttackingPosition = marker at {AttackPos[0]} + {25,0,0}
                AttackingPositionFallBack = marker at {AttackPos[1]} + {25,0,0}
            else
                AttackingPosition = marker at {AttackPos[2]} + {25,0,0}
                AttackingPositionFallBack = marker at {AttackPos[3]} + {25,0,0}
            end if
            run background script LC14_GenericTalusSpeeches(LC14_Platoon[34],1)
            run background script LC14_ArmyBehaivours(LC14_Platoon[34],Melee,Attacker,0,AttackingPosition,AttackingPositionFallBack,0,0)

        elsif LC14_Platoon[35] not exists and AIAttacksAllowed == 1 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC14_RecruitTimer1 time remaining <= 0
            LC14_Platoon[35] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 50 * RecruitSizeModifier
            LC14_RecruitTimer1 = create timer for 100 * RecruitModifier seconds
            enable platoon LC14_Platoon[35] respond to town AztecCapital attack
            wait until not LC14_Platoon[35] recruiting
            if PLAYER of AztecTown1 != 0
                AttackingPosition = marker at {AttackPos[0]} + {0,0,25}
                AttackingPositionFallBack = marker at {AttackPos[1]} + {0,0,25}
            else
                AttackingPosition = marker at {AttackPos[2]} + {0,0,25}
                AttackingPositionFallBack = marker at {AttackPos[3]} + {0,0,25}
            end if
            run background script LC14_GenericTalusSpeeches(LC14_Platoon[35],1)
            run background script LC14_ArmyBehaivours(LC14_Platoon[35],Melee,Attacker,0,AttackingPosition,AttackingPositionFallBack,0,0)

        elsif LC14_Platoon[36] not exists and AIAttacksAllowed == 1 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC14_RecruitTimer1 time remaining <= 0
            LC14_Platoon[36] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 50 * RecruitSizeModifier
            LC14_RecruitTimer1 = create timer for 100 * RecruitModifier seconds
            enable platoon LC14_Platoon[36] respond to town AztecCapital attack
            wait until not LC14_Platoon[36] recruiting
            if PLAYER of AztecTown1 != 0
                AttackingPosition = marker at {AttackPos[0]} + {-25,0,0}
                AttackingPositionFallBack = marker at {AttackPos[1]} + {-25,0,0}
            else
                AttackingPosition = marker at {AttackPos[2]} + {-25,0,0}
                AttackingPositionFallBack = marker at {AttackPos[3]} + {-25,0,0}
            end if
            run background script LC14_GenericTalusSpeeches(LC14_Platoon[36],1)
            run background script LC14_ArmyBehaivours(LC14_Platoon[36],Ranged,Attacker,0,AttackingPosition,AttackingPositionFallBack,0,0)
    
        elsif LC14_Platoon[37] not exists and AIAttacksAllowed == 1 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC14_RecruitTimer1 time remaining <= 0
            LC14_Platoon[37] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 50 * RecruitSizeModifier
            LC14_RecruitTimer1 = create timer for 100 * RecruitModifier seconds
            enable platoon LC14_Platoon[37] respond to town AztecCapital attack
            wait until not LC14_Platoon[37] recruiting
            if PLAYER of AztecTown1 != 0
                AttackingPosition = marker at {AttackPos[0]} + {0,0,-25}
                AttackingPositionFallBack = marker at {AttackPos[1]} + {0,0,-25}
            else
                AttackingPosition = marker at {AttackPos[2]} + {0,0,-25}
                AttackingPositionFallBack = marker at {AttackPos[3]} + {0,0,-25}
            end if
            run background script LC14_GenericTalusSpeeches(LC14_Platoon[37],1)
            run background script LC14_ArmyBehaivours(LC14_Platoon[37],Ranged,Attacker,0,AttackingPosition,AttackingPositionFallBack,0,0)

        elsif LC14_Platoon[38] not exists and AIAttacksAllowed == 1 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC14_RecruitTimer1 time remaining <= 0
            LC14_Platoon[38] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 50 * RecruitSizeModifier
            LC14_RecruitTimer1 = create timer for 100 * RecruitModifier seconds
            enable platoon LC14_Platoon[38] respond to town AztecCapital attack
            wait until not LC14_Platoon[38] recruiting
            if PLAYER of AztecTown1 != 0
                AttackingPosition = marker at {AttackPos[0]} + {25,0,25}
                AttackingPositionFallBack = marker at {AttackPos[1]} + {25,0,25}
            else
                AttackingPosition = marker at {AttackPos[2]} + {25,0,25}
                AttackingPositionFallBack = marker at {AttackPos[3]} + {25,0,25}
            end if
            run background script LC14_GenericTalusSpeeches(LC14_Platoon[38],1)
            run background script LC14_ArmyBehaivours(LC14_Platoon[38],Ranged,Attacker,0,AttackingPosition,AttackingPositionFallBack,0,0)

        elsif LC14_Platoon[39] not exists and AIAttacksAllowed == 1 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC14_RecruitTimer1 time remaining <= 0
            LC14_Platoon[39] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 50 * RecruitSizeModifier
            LC14_RecruitTimer1 = create timer for 100 * RecruitModifier seconds
            enable platoon LC14_Platoon[39] respond to town AztecCapital attack
            wait until not LC14_Platoon[39] recruiting
            if PLAYER of AztecTown1 != 0
                AttackingPosition = marker at {AttackPos[0]} + {-25,0,-25}
                AttackingPositionFallBack = marker at {AttackPos[1]} + {-25,0,-25}
            else
                AttackingPosition = marker at {AttackPos[2]} + {-25,0,-25}
                AttackingPositionFallBack = marker at {AttackPos[3]} + {-25,0,-25}
            end if
            run background script LC14_GenericTalusSpeeches(LC14_Platoon[39],1)
            run background script LC14_ArmyBehaivours(LC14_Platoon[39],Ranged,Attacker,0,AttackingPosition,AttackingPositionFallBack,0,0)

        elsif LC14_SiegeCatapult[14] not exists and AIAttacksAllowed == 1 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC14_RecruitTimer1 time remaining <= 0
            LC14_SiegeCatapult[14] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_7 town AztecCapital siege weapon
            LC14_RecruitTimer1 = create timer for 80 * RecruitModifier seconds
            SiegeWaypoint1 = marker at {SiegeRoute2[0]}
            SiegeWaypoint2 = marker at {SiegeRoute2[1]} + {0,0}
            SiegeWaypoint3 = marker at {SiegeRoute2[2]} + {0,0}
            run background script LC14_MoveCatapultThenAttack(LC14_SiegeCatapult[14],0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)

        elsif LC14_SiegeCatapult[15] not exists and AIAttacksAllowed == 1 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC14_RecruitTimer1 time remaining <= 0
            LC14_SiegeCatapult[15] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_7 town AztecCapital siege weapon
            LC14_RecruitTimer1 = create timer for 80 * RecruitModifier seconds
            SiegeWaypoint1 = marker at {SiegeRoute2[0]}
            SiegeWaypoint2 = marker at {SiegeRoute2[1]} + {35,0}
            SiegeWaypoint3 = marker at {SiegeRoute2[2]} + {35,0}
            run background script LC14_MoveCatapultThenAttack(LC14_SiegeCatapult[15],0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)

        elsif LC14_SiegeCatapult[16] not exists and AIAttacksAllowed == 1 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC14_RecruitTimer1 time remaining <= 0
            LC14_SiegeCatapult[16] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_7 town AztecCapital siege weapon
            LC14_RecruitTimer1 = create timer for 80 * RecruitModifier seconds
            SiegeWaypoint1 = marker at {SiegeRoute2[0]}
            SiegeWaypoint2 = marker at {SiegeRoute2[1]} + {0,-35}
            SiegeWaypoint3 = marker at {SiegeRoute2[2]} + {0,-35}
            run background script LC14_MoveCatapultThenAttack(LC14_SiegeCatapult[16],0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)

        elsif LC14_SiegeCatapult[17] not exists and AIAttacksAllowed == 1 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC14_RecruitTimer1 time remaining <= 0
            LC14_SiegeCatapult[17] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_7 town AztecCapital siege weapon
            LC14_RecruitTimer1 = create timer for 80 * RecruitModifier seconds
            SiegeWaypoint1 = marker at {SiegeRoute2[0]}
            SiegeWaypoint2 = marker at {SiegeRoute2[1]} + {-35,0}
            SiegeWaypoint3 = marker at {SiegeRoute2[2]} + {-35,0}
            run background script LC14_MoveCatapultThenAttack(LC14_SiegeCatapult[17],0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)

        elsif LC14_SiegeCatapult[18] not exists and AIAttacksAllowed == 1 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC14_RecruitTimer1 time remaining <= 0
            LC14_SiegeCatapult[18] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_7 town AztecCapital siege weapon
            LC14_RecruitTimer1 = create timer for 80 * RecruitModifier seconds
            SiegeWaypoint1 = marker at {SiegeRoute2[0]}
            SiegeWaypoint2 = marker at {SiegeRoute2[1]} + {0,35}
            SiegeWaypoint3 = marker at {SiegeRoute2[2]} + {0,35}
            run background script LC14_MoveCatapultThenAttack(LC14_SiegeCatapult[18],0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)
        
        elsif LC14_SiegeCatapult[19] not exists and AIAttacksAllowed == 1 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC14_RecruitTimer1 time remaining <= 0
            LC14_SiegeCatapult[19] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_7 town AztecCapital siege weapon
            LC14_RecruitTimer1 = create timer for 80 * RecruitModifier seconds
            SiegeWaypoint1 = marker at {SiegeRoute2[0]}
            SiegeWaypoint2 = marker at {SiegeRoute2[1]} + {15,15}
            SiegeWaypoint3 = marker at {SiegeRoute2[2]} + {15,15}
            run background script LC14_MoveCatapultThenAttack(LC14_SiegeCatapult[19],0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)

        //Attack NearestSettlement
        elsif LC14_Platoon[28] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get AttackNearestTownTimer time remaining <= 0 and AttackingPlatoons == 1
            LC14_Platoon[28] = recruit ARMY_UNIT_TYPE_MELEE_4 town AztecCapital platoon of size 75 * RecruitSizeModifier
            LC14_RecruitTimer1 = create timer for 300 * RecruitModifier seconds
            enable platoon LC14_Platoon[28] respond to town AztecCapital attack
            wait until not LC14_Platoon[28] recruiting
            run background script LC14_ArmyBehaivours(LC14_Platoon[28],Melee,Conqueror,LC14_SiegeCatapult[11],0,0,0,0)
            run background script LC14_GenericTalusSpeeches(LC14_Platoon[28],1)

        elsif LC14_Platoon[29] not exists and LC14_Platoon[28] exists and {LC14_Platoon[28]} near {AztecCapital} radius 400 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get AttackNearestTownTimer time remaining <= 0 and AttackingPlatoons == 1
            LC14_Platoon[29] = recruit ARMY_UNIT_TYPE_MELEE_4 town AztecCapital platoon of size 75 * RecruitSizeModifier
            LC14_RecruitTimer1 = create timer for 300 * RecruitModifier seconds
            enable platoon LC14_Platoon[29] respond to town AztecCapital attack
            wait until not LC14_Platoon[29] recruiting
            run background script LC14_ArmyBehaivours(LC14_Platoon[29],Melee,Conqueror,LC14_SiegeCatapult[11],0,0,0,0)
            run background script LC14_GenericTalusSpeeches(LC14_Platoon[29],1)

        elsif LC14_Platoon[30] not exists and LC14_Platoon[28] exists and {LC14_Platoon[28]} near {AztecCapital} radius 400 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get AttackNearestTownTimer time remaining <= 0 and AttackingPlatoons == 1
            LC14_Platoon[30] = recruit ARMY_UNIT_TYPE_RANGED_4 town AztecCapital platoon of size 75 * RecruitSizeModifier
            LC14_RecruitTimer1 = create timer for 300 * RecruitModifier seconds
            enable platoon LC14_Platoon[30] respond to town AztecCapital attack
            wait until not LC14_Platoon[30] recruiting
            run background script LC14_ArmyBehaivours(LC14_Platoon[30],Ranged,Conqueror,LC14_SiegeCatapult[12],0,0,0,0)
            run background script LC14_GenericTalusSpeeches(LC14_Platoon[30],1)

        elsif LC14_Platoon[31] not exists and LC14_Platoon[28] exists and {LC14_Platoon[28]} near {AztecCapital} radius 400 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get AttackNearestTownTimer time remaining <= 0 and AttackingPlatoons == 1
            LC14_Platoon[31] = recruit ARMY_UNIT_TYPE_RANGED_4 town AztecCapital platoon of size 75 * RecruitSizeModifier
            LC14_RecruitTimer1 = create timer for 300 * RecruitModifier seconds
            enable platoon LC14_Platoon[31] respond to town AztecCapital attack
            wait until not LC14_Platoon[31] recruiting
            run background script LC14_ArmyBehaivours(LC14_Platoon[31],Ranged,Conqueror,LC14_SiegeCatapult[13],0,0,0,0)
            run background script LC14_GenericTalusSpeeches(LC14_Platoon[31],1)

        elsif LC14_Platoon[32] not exists and LC14_Platoon[28] exists and {LC14_Platoon[28]} near {AztecCapital} radius 400 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get AttackNearestTownTimer time remaining <= 0 and AttackingPlatoons == 1
            LC14_Platoon[32] = recruit ARMY_UNIT_TYPE_RANGED_4 town AztecCapital platoon of size 75 * RecruitSizeModifier
            LC14_RecruitTimer1 = create timer for 300 * RecruitModifier seconds
            enable platoon LC14_Platoon[32] respond to town AztecCapital attack
            wait until not LC14_Platoon[32] recruiting
            run background script LC14_ArmyBehaivours(LC14_Platoon[32],Ranged,Conqueror,LC14_SiegeCatapult[13],0,0,0,0)
            run background script LC14_GenericTalusSpeeches(LC14_Platoon[32],1)

        elsif LC14_SiegeCatapult[11] not exists and LC14_Platoon[28] exists and {LC14_Platoon[28]} near {AztecCapital} radius 400 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get AttackNearestTownTimer time remaining <= 0 and AttackingPlatoons == 1
            LC14_SiegeCatapult[11] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_5 town AztecCapital siege weapon
            LC14_RecruitTimer1 = create timer for 300 * RecruitModifier seconds
            run background script LC14_MoveCatapultThenAttack(LC14_SiegeCatapult[11],Conqueror,0,0,0)

        elsif LC14_SiegeCatapult[12] not exists and LC14_Platoon[28] exists and {LC14_Platoon[28]} near {AztecCapital} radius 400 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get AttackNearestTownTimer time remaining <= 0 and AttackingPlatoons == 1
            LC14_SiegeCatapult[12] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_5 town AztecCapital siege weapon
            LC14_RecruitTimer1 = create timer for 300 * RecruitModifier seconds
            run background script LC14_MoveCatapultThenAttack(LC14_SiegeCatapult[12],Conqueror,0,0,0)

        elsif LC14_SiegeCatapult[13] not exists and LC14_Platoon[28] exists and {LC14_Platoon[28]} near {AztecCapital} radius 400 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get AttackNearestTownTimer time remaining <= 0 and AttackingPlatoons == 1
            LC14_SiegeCatapult[13] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_5 town AztecCapital siege weapon
            LC14_RecruitTimer1 = create timer for 300 * RecruitModifier seconds
            run background script LC14_MoveCatapultThenAttack(LC14_SiegeCatapult[13],Conqueror,0,0,0)

        elsif LC14_Platoon[7] not exists and PLAYER of AztecTown1 == 1 and not town AztecTown1 is under takeover from player 0 and get LC14_RecruitTimer2 time remaining <= 0
            LC14_Platoon[7] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecTown1 platoon of size 30 * RecruitSizeModifier
            LC14_RecruitTimer2 = create timer for 200 * RecruitModifier seconds
            enable platoon LC14_Platoon[7] respond to town AztecTown1 attack
            wait until not LC14_Platoon[7] recruiting
            run background script LC14_StaticPlatoonsActions(PlatoonPos[7],Melee,LC14_Platoon[7])
            run background script LC14_GenericTalusSpeeches(LC14_Platoon[7],1)

        elsif LC14_Platoon[8] not exists and PLAYER of AztecTown1 == 1 and not town AztecTown1 is under takeover from player 0 and get LC14_RecruitTimer2 time remaining <= 0
            LC14_Platoon[8] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecTown1 platoon of size 30 * RecruitSizeModifier
            LC14_RecruitTimer2 = create timer for 200 * RecruitModifier seconds
            enable platoon LC14_Platoon[8] respond to town AztecTown1 attack
            wait until not LC14_Platoon[8] recruiting
            run background script LC14_StaticPlatoonsActions(PlatoonPos[8],Melee,LC14_Platoon[8])
            run background script LC14_GenericTalusSpeeches(LC14_Platoon[8],1)

        elsif LC14_Platoon[9] not exists and PLAYER of AztecTown1 == 1 and not town AztecTown1 is under takeover from player 0 and get LC14_RecruitTimer2 time remaining <= 0
            LC14_Platoon[9] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecTown1 platoon of size 30 * RecruitSizeModifier
            LC14_RecruitTimer2 = create timer for 200 * RecruitModifier seconds
            enable platoon LC14_Platoon[9] respond to town AztecTown1 attack
            wait until not LC14_Platoon[9] recruiting
            run background script LC14_StaticPlatoonsActions(PlatoonPos[9],Melee,LC14_Platoon[9])
            run background script LC14_GenericTalusSpeeches(LC14_Platoon[9],1)

        elsif LC14_Platoon[10] not exists and PLAYER of AztecTown1 == 1 and not town AztecTown1 is under takeover from player 0 and get LC14_RecruitTimer2 time remaining <= 0
            LC14_Platoon[10] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecTown1 platoon of size 30 * RecruitSizeModifier
            LC14_RecruitTimer2 = create timer for 200 * RecruitModifier seconds
            enable platoon LC14_Platoon[10] respond to town AztecTown1 attack
            wait until not LC14_Platoon[10] recruiting
            run background script LC14_StaticPlatoonsActions(PlatoonPos[10],Ranged,LC14_Platoon[10])
            run background script LC14_GenericTalusSpeeches(LC14_Platoon[10],1)

        elsif LC14_WallArcher[2] not exists and Wall[2] exists and PLAYER of Wall[2] == 1 and HEALTH of Wall[2] == 1.0 and not town AztecTown1 is under takeover from player 0 and get LC14_RecruitTimer2 time remaining <= 0
            LC14_WallArcher[2] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecTown1 platoon of size 20 * RecruitSizeModifier
            LC14_RecruitTimer2 = create timer for 60 * RecruitModifier seconds
            wait until not LC14_WallArcher[2] recruiting
            enable platoon LC14_WallArcher[2] respond to town AztecTown1 attack
            add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[2] to LC14_WallArcher[2] action queue
            run background script LC14_GenericTalusSpeeches(LC14_WallArcher[2],1)

        elsif LC14_WallArcher[3] not exists and Wall[3] exists and PLAYER of Wall[3] == 1 and HEALTH of Wall[3] == 1.0 and not town AztecTown1 is under takeover from player 0 and get LC14_RecruitTimer2 time remaining <= 0
            LC14_WallArcher[3] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecTown1 platoon of size 20 * RecruitSizeModifier
            LC14_RecruitTimer2 = create timer for 60 * RecruitModifier seconds
            wait until not LC14_WallArcher[3] recruiting
            enable platoon LC14_WallArcher[3] respond to town AztecTown1 attack
            add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[3] to LC14_WallArcher[3] action queue
            run background script LC14_GenericTalusSpeeches(LC14_WallArcher[3],1)

        elsif LC14_WallArcher[4] not exists and Wall[4] exists and PLAYER of Wall[4] == 1 and HEALTH of Wall[4] == 1.0 and not town AztecTown1 is under takeover from player 0 and get LC14_RecruitTimer2 time remaining <= 0
            LC14_WallArcher[4] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecTown1 platoon of size 20 * RecruitSizeModifier
            LC14_RecruitTimer2 = create timer for 60 * RecruitModifier seconds
            wait until not LC14_WallArcher[4] recruiting
            enable platoon LC14_WallArcher[4] respond to town AztecTown1 attack
            add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[4] to LC14_WallArcher[4] action queue
            run background script LC14_GenericTalusSpeeches(LC14_WallArcher[4],1)

        elsif LC14_WallArcher[5] not exists and Wall[5] exists and PLAYER of Wall[5] == 1 and HEALTH of Wall[5] == 1.0 and not town AztecTown1 is under takeover from player 0 and get LC14_RecruitTimer2 time remaining <= 0
            LC14_WallArcher[5] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecTown1 platoon of size 20 * RecruitSizeModifier
            LC14_RecruitTimer2 = create timer for 60 * RecruitModifier seconds
            wait until not LC14_WallArcher[5] recruiting
            enable platoon LC14_WallArcher[5] respond to town AztecTown1 attack
            add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[5] to LC14_WallArcher[5] action queue
            run background script LC14_GenericTalusSpeeches(LC14_WallArcher[5],1)

        elsif LC14_Platoon[11] not exists and PLAYER of AztecTown2 == 1 and not town AztecTown2 is under takeover from player 0 and get LC14_RecruitTimer3 time remaining <= 0
            LC14_Platoon[11] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecTown2 platoon of size 25 * RecruitSizeModifier
            LC14_RecruitTimer3 = create timer for 200 * RecruitModifier seconds
            enable platoon LC14_Platoon[11] respond to town AztecTown2 attack
            wait until not LC14_Platoon[11] recruiting
            run background script LC14_StaticPlatoonsActions(PlatoonPos[11],Ranged,LC14_Platoon[11])
            run background script LC14_GenericTalusSpeeches(LC14_Platoon[11],1)

        elsif LC14_Platoon[12] not exists and PLAYER of AztecTown2 == 1 and not town AztecTown2 is under takeover from player 0 and get LC14_RecruitTimer3 time remaining <= 0
            LC14_Platoon[12] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecTown2 platoon of size 25 * RecruitSizeModifier
            LC14_RecruitTimer3 = create timer for 200 * RecruitModifier seconds
            enable platoon LC14_Platoon[12] respond to town AztecTown2 attack
            wait until not LC14_Platoon[12] recruiting
            run background script LC14_StaticPlatoonsActions(PlatoonPos[12],Ranged,LC14_Platoon[12])
            run background script LC14_GenericTalusSpeeches(LC14_Platoon[12],1)

        elsif LC14_WallArcher[6] not exists and Wall[6] exists and PLAYER of Wall[6] == 1 and HEALTH of Wall[6] == 1.0 and not town AztecTown2 is under takeover from player 0 and get LC14_RecruitTimer3 time remaining <= 0
            LC14_WallArcher[6] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecTown2 platoon of size 20 * RecruitSizeModifier
            LC14_RecruitTimer3 = create timer for 60 * RecruitModifier seconds
            wait until not LC14_WallArcher[6] recruiting
            enable platoon LC14_WallArcher[6] respond to town AztecTown2 attack
            add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[6] to LC14_WallArcher[6] action queue
            run background script LC14_GenericTalusSpeeches(LC14_WallArcher[6],1)

        elsif LC14_WallArcher[7] not exists and Wall[7] exists and PLAYER of Wall[7] == 1 and HEALTH of Wall[7] == 1.0 and not town AztecTown2 is under takeover from player 0 and get LC14_RecruitTimer3 time remaining <= 0
            LC14_WallArcher[7] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecTown2 platoon of size 20 * RecruitSizeModifier
            LC14_RecruitTimer3 = create timer for 60 * RecruitModifier seconds
            wait until not LC14_WallArcher[7] recruiting
            enable platoon LC14_WallArcher[7] respond to town AztecTown2 attack
            add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[7] to LC14_WallArcher[7] action queue
            run background script LC14_GenericTalusSpeeches(LC14_WallArcher[7],1)

        end if

        if PLAYER of PlayerTown == 0 and LargeSiegeInit == 0
            LargeSiegeInit = 1
            if Difficulty == 1
                LargeSiegeTimer = create timer for 1000 seconds
            elsif Difficulty == 2
                LargeSiegeTimer = create timer for 900 seconds
            elsif Difficulty == 3
                LargeSiegeTimer = create timer for 700 seconds
            elsif Difficulty == 4
                LargeSiegeTimer = create timer for 500 seconds
            else
                LargeSiegeTimer = create timer for 400 seconds
            end if
        end if

        if get LargeSiegeTimer time remaining <= 0 or get player 0 impressiveness > 12500
            if LargeSiegeStarted == 0
                LargeSiegeStarted = 1
                LargeSiegeTimer = create timer for 999999 seconds
                if PLAYER of AztecTown1 == 1
                    run background script LC14_MainScript(0)
                else
                    LC14_LargeSiegeIsRunning = 0
                    LC14_LargeSiegeLaunchAttack = 1
                    LC14_LargeSiegeOver = 1
                    myAttackTimer = create timer for 150 seconds
                    AIAttacksAllowed = 1
                    run background script LC14_Epics
                end if
            end if
        end if

        if SiegeRan == 0 and LC14_LargeSiegeIsRunning == 1 and PLAYER of AztecTown1 != 1
            wait until dialogue ready and SiegeScriptStartedOnce == 1
            stop script "LC14_MainScript"
            wait 3 seconds
            run background script LC14_MainScript(1)
            if LC14_LargeSiegeOver != 1
                LC14_LargeSiegeOver = 1
            end if
            if LC14_LargeSiegeIsRunning != 0
                LC14_LargeSiegeIsRunning = 0
            end if
            if LC14_LargeSiegeLaunchAttack != 1
                LC14_LargeSiegeLaunchAttack = 1
            end if
            if SiegeRan != 1
                SiegeRan = 1
            end if
        end if

        //Attack PlayerTown with AIAttacksAllowed and Scripted Timer
        if get myAttackTimer time remaining <= 0 and SmallAttacksAllowed == 1 and PLAYER of AztecCapital == 1
            myAttackTimer = create timer for 600 * RecruitModifier seconds

            SiegeWaypoint1 = marker at {SiegeRoute2[0]}
            SiegeWaypoint2 = marker at {SiegeRoute2[1]} + {0,0}
            SiegeWaypoint3 = marker at {SiegeRoute2[2]} + {0,0}
            TempSiege = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_7 town AztecCapital siege weapon
            run background script LC14_MoveCatapultThenAttack(TempSiege,0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)

            TempPlatoon = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 30 * RecruitSizeModifier
            enable platoon TempPlatoon respond to town AztecCapital attack
            if PLAYER of AztecTown1 != 0
                AttackingPosition = marker at {AttackPos[0]} + {0,0,25}
                AttackingPositionFallBack = marker at {AttackPos[1]} + {0,0,25}
            else
                AttackingPosition = marker at {AttackPos[2]} + {0,0,25}
                AttackingPositionFallBack = marker at {AttackPos[3]} + {0,0,25}
            end if
            run background script LC14_GenericTalusSpeeches(TempPlatoon,1)
            run background script LC14_ArmyBehaivours(TempPlatoon,Melee,Escort,TempSiege,AttackingPosition,AttackingPositionFallBack,0,0)

            SiegeWaypoint1 = marker at {SiegeRoute2[0]}
            SiegeWaypoint2 = marker at {SiegeRoute2[1]} + {15,15}
            SiegeWaypoint3 = marker at {SiegeRoute2[2]} + {15,15}
            TempSiege = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_7 town AztecCapital siege weapon
            run background script LC14_MoveCatapultThenAttack(TempSiege,0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)


            TempPlatoon = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 30 * RecruitSizeModifier
            enable platoon TempPlatoon respond to town AztecCapital attack
            if PLAYER of AztecTown1 != 0
                AttackingPosition = marker at {AttackPos[0]} + {0,0,25}
                AttackingPositionFallBack = marker at {AttackPos[1]} + {0,0,0}
            else
                AttackingPosition = marker at {AttackPos[2]} + {0,0,25}
                AttackingPositionFallBack = marker at {AttackPos[3]} + {0,0,0}
            end if
            run background script LC14_GenericTalusSpeeches(TempPlatoon,1)
            run background script LC14_ArmyBehaivours(TempPlatoon,Ranged,Escort,TempSiege,AttackingPosition,AttackingPositionFallBack,0,0)
        end if

        if get myAttackTimer2 time remaining <= 0 and LC14_LargeSiegeOver == 1 and PLAYER of AztecTown1 == 1
            myAttackTimer2 = create timer for 720 * RecruitModifier seconds

            SiegeWaypoint1 = marker at {SiegeRoute1[0]}
            SiegeWaypoint2 = marker at {SiegeRoute1[1]} + {0,0}
            SiegeWaypoint3 = marker at {SiegeRoute1[2]} + {0,0}
            TempSiege = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_7 town AztecTown1 siege weapon
            run background script LC14_MoveCatapultThenAttack(TempSiege,0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)

            TempPlatoon = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecTown1 platoon of size 30 * RecruitSizeModifier
            enable platoon TempPlatoon respond to town AztecTown1 attack
            if PLAYER of AztecTown1 != 0
                AttackingPosition = marker at {AttackPos[0]} + {0,0,25}
                AttackingPositionFallBack = marker at {AttackPos[1]} + {0,0,25}
            else
                AttackingPosition = marker at {AttackPos[2]} + {0,0,25}
                AttackingPositionFallBack = marker at {AttackPos[3]} + {0,0,25}
            end if
            run background script LC14_GenericTalusSpeeches(TempPlatoon,1)
            run background script LC14_ArmyBehaivours(TempPlatoon,Melee,Escort,TempSiege,AttackingPosition,AttackingPositionFallBack,0,0)

            SiegeWaypoint1 = marker at {SiegeRoute1[0]}
            SiegeWaypoint2 = marker at {SiegeRoute1[1]} + {15,15}
            SiegeWaypoint3 = marker at {SiegeRoute1[2]} + {15,15}
            TempSiege = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_7 town AztecTown1 siege weapon
            run background script LC14_MoveCatapultThenAttack(TempSiege,0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)


            TempPlatoon = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecTown1 platoon of size 30 * RecruitSizeModifier
            enable platoon TempPlatoon respond to town AztecTown1 attack
            if PLAYER of AztecTown1 != 0
                AttackingPosition = marker at {AttackPos[0]} + {0,0,25}
                AttackingPositionFallBack = marker at {AttackPos[1]} + {0,0,0}
            else
                AttackingPosition = marker at {AttackPos[2]} + {0,0,25}
                AttackingPositionFallBack = marker at {AttackPos[3]} + {0,0,0}
            end if
            run background script LC14_GenericTalusSpeeches(TempPlatoon,1)
            run background script LC14_ArmyBehaivours(TempPlatoon,Ranged,Escort,TempSiege,AttackingPosition,AttackingPositionFallBack,0,0)
        end if

    end loop

end script LC14_Aztec_Capital


//This script controls some special behaivors of the enemy as in land11
begin script LC14_MainScript(SKIP_SIEGE)

    AttackingPosition = 0
    AttackingPositionFallBack = 0
    CastEpicPos = 0
    EpicWarning = 0
    land14mixer = 0
    enemyPlatoon[10]
    SiegeWaypoint1 = 0
    SiegeWaypoint2 = 0
    SiegeWaypoint3 = 0

    VolcanoWarning = 0
    EpicVolc = 0
    UndeadSpawn = 0

start

    SiegeScriptStartedOnce = 1

    if SKIP_SIEGE == 0
        wait until dialogue ready and DynamicMusicReady == 1
        //Respawn Platoons, are pre-placed already
        GB_DialogueIsRunning = 1
        begin dialogue
            say "BW2XT_LAND02_TALUS_THREATS_60"
            clear dialogue
            close dialogue
            wait BW2XT_LAND02_TALUS_THREATS_60 + 1 seconds
            make evil spirit appear
            say "BW2XT_LAND05_TALUS_VARIOUS_410"
            clear dialogue
            close dialogue
            wait BW2XT_LAND05_TALUS_VARIOUS_410 + 1 seconds
            make evil spirit disappear
        end dialogue
        GB_DialogueIsRunning = 0

        wait 30 seconds

        start dynamic music
        set dynamic music "small" loop -1

        LC14_LargeSiegeIsRunning = 1
        run background script LC14_LargeSiegePlatoons

        //Run skeleton armies
        AttackingPosition = marker at {AttackPos[0]} + {0,0,0}
        AttackingPositionFallBack = marker at {AttackPos[1]} + {0,0,0}
        run background script LC14_ArmyBehaivours(LC14_Platoon[22],Melee,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)
        AttackingPosition = marker at {AttackPos[0]} + {20,0,20}
        AttackingPositionFallBack = marker at {AttackPos[1]} + {20,0,20}
        run background script LC14_ArmyBehaivours(LC14_Platoon[23],Melee,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)
        AttackingPosition = marker at {AttackPos[0]} + {-20,0,-20}
        AttackingPositionFallBack = marker at {AttackPos[1]} + {-20,0,-20}
        run background script LC14_ArmyBehaivours(LC14_Platoon[24],Melee,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)
        AttackingPosition = marker at {AttackPos[0]} + {50,0,0}
        AttackingPositionFallBack = marker at {AttackPos[1]} + {50,0,0}
        run background script LC14_ArmyBehaivours(LC14_Platoon[25],Melee,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)
        AttackingPosition = marker at {AttackPos[0]} + {35,0,35}
        AttackingPositionFallBack = marker at {AttackPos[1]} + {35,0,35}
        run background script LC14_ArmyBehaivours(LC14_Platoon[26],Melee,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)
        AttackingPosition = marker at {AttackPos[0]} + {-45,0,20}
        AttackingPositionFallBack = marker at {AttackPos[1]} + {-45,0,20}
        run background script LC14_ArmyBehaivours(LC14_Platoon[27],Melee,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)

        run script LC14_PlayRandomBanter

        wait 60 seconds
        
        enemyPlatoon[0] = recruit ARMY_UNIT_TYPE_MELEE_6 town AztecTown1 platoon of size 30 * RecruitSizeModifier
        AttackingPosition = marker at {AttackPos[0]} + {45,0}
        AttackingPositionFallBack = marker at {AttackPos[1]} + {45,0}
        run background script LC14_ArmyBehaivours(enemyPlatoon[0],Melee,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)

        enemyPlatoon[1] = recruit ARMY_UNIT_TYPE_RANGED_6 town AztecTown1 platoon of size 30 * RecruitSizeModifier
        AttackingPosition = marker at {AttackPos[0]} + {-45,0}
        AttackingPositionFallBack = marker at {AttackPos[1]} + {-45,0}
        run background script LC14_ArmyBehaivours(enemyPlatoon[1],Ranged,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)

        wait until dialogue ready
        set dynamic music "medium" loop -1

        LC14_LargeSiegeLaunchAttack = 1
        GB_DialogueIsRunning = 1
        begin dialogue
            say "BW2XT_LAND02_TALUS_THREATS_80"
            clear dialogue
            close dialogue
            wait BW2XT_LAND02_TALUS_THREATS_80 + 1 seconds
            say "BW2XT_LAND02_TALUS_THREATS_90"
            clear dialogue
            close dialogue
            wait BW2XT_LAND02_TALUS_THREATS_90 + 1 seconds
        end dialogue
        GB_DialogueIsRunning = 0

        wait 15 seconds

        run script LC14_PlayRandomBanter

        wait 15 seconds

        enemyPlatoon[0] = recruit ARMY_UNIT_TYPE_MELEE_6 town AztecTown1 platoon of size 20 * RecruitSizeModifier
        AttackingPosition = marker at {AttackPos[0]} + {45,0}
        AttackingPositionFallBack = marker at {AttackPos[1]} + {45,0}
        run background script LC14_ArmyBehaivours(enemyPlatoon[0],Melee,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)

        enemyPlatoon[1] = recruit ARMY_UNIT_TYPE_RANGED_6 town AztecTown1 platoon of size 20 * RecruitSizeModifier
        AttackingPosition = marker at {AttackPos[0]} + {-45,0}
        AttackingPositionFallBack = marker at {AttackPos[1]} + {-45,0}
        run background script LC14_ArmyBehaivours(enemyPlatoon[1],Ranged,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)

        enemyPlatoon[2] = recruit ARMY_UNIT_TYPE_MELEE_6 town AztecTown1 platoon of size 20 * RecruitSizeModifier
        AttackingPosition = marker at {AttackPos[0]} + {45,0}
        AttackingPositionFallBack = marker at {AttackPos[1]} + {0,45}
        run background script LC14_ArmyBehaivours(enemyPlatoon[2],Melee,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)

        enemyPlatoon[3] = recruit ARMY_UNIT_TYPE_RANGED_6 town AztecTown1 platoon of size 20 * RecruitSizeModifier
        AttackingPosition = marker at {AttackPos[0]} + {-45,0}
        AttackingPositionFallBack = marker at {AttackPos[1]} + {0,-45}
        run background script LC14_ArmyBehaivours(enemyPlatoon[3],Ranged,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)

        wait 15 seconds

        AztecGodThrowBlitz = 1

        run script LC14_PlayRandomBanter

        set dynamic music "small" loop -1
        wait 15 seconds
        set dynamic music "largeevent1" loop -1 urgent
        wait 35 seconds
        set dynamic music "smallevent4" loop 0 urgent
        wait 8 seconds
        set dynamic music "medium" loop -1

        wait 30 seconds

        run script LC14_PlayRandomBanter

        wait 30 seconds

        run script LC14_PlayRandomBanter

        wait 15 seconds

        enemyPlatoon[0] = recruit ARMY_UNIT_TYPE_MELEE_6 town AztecTown1 platoon of size 150 * RecruitSizeModifier
        AttackingPosition = marker at {AttackPos[0]} + {45,45}
        AttackingPositionFallBack = marker at {AttackPos[1]} + {45,45}
        run background script LC14_ArmyBehaivours(enemyPlatoon[0],Melee,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)

        enemyPlatoon[1] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_6 town AztecTown1 siege weapon
        disable siege weapon enemyPlatoon[1] auto attack
        SiegeWaypoint1 = marker at {SiegeRoute1[0]}
        SiegeWaypoint2 = marker at {SiegeRoute1[1]} + {20,20}
        SiegeWaypoint3 = marker at {SiegeRoute1[2]} + {20,20}
        run background script LC14_MoveCatapultThenAttack(enemyPlatoon[1],0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)

        enemyPlatoon[2] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_6 town AztecTown1 siege weapon
        disable siege weapon enemyPlatoon[2] auto attack
        SiegeWaypoint1 = marker at {SiegeRoute1[0]}
        SiegeWaypoint2 = marker at {SiegeRoute1[1]} + {-20,-20}
        SiegeWaypoint3 = marker at {SiegeRoute1[2]} + {-20,-20}
        run background script LC14_MoveCatapultThenAttack(enemyPlatoon[2],0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)

        wait 45 seconds

        run script LC14_PlayRandomBanter
        AztecGodThrowFirerain = 1
        LC14_LargeSiegeOver = 1
        SiegeRan = 1

        set dynamic music "small" loop -1

        wait until PLAYER of AztecTown1 != 1 or 30 seconds
    end if

    set dynamic music "smallendofbattle" loop -1 urgent
    if PLAYER of AztecTown1 == 1
        wait 60 seconds
    else
        wait 15 seconds
    end if
    land14mixer = create mixer
    set mixer land14mixer channel AUDIO_MIXER_CHANNEL_MUSIC to 0.0 with fadetime 7
    wait 7 seconds 
    stop dynamic music
    destroy mixer land14mixer with fadetime 3

    enable migration from AztecCapital to PlayerTown
    enable migration from AztecTown1 to PlayerTown
    enable migration from AztecTown2 to PlayerTown

    wait until PLAYER of AztecTown1 != 1

    if HEALTH of AIVolcano == 1.0 and VolcanoFired == 0
        enable predefined sky "VOLCANO" time 10
        ET_FireEpicLocation = marker at {1583.71,143.96,1841.69}
        VolcanoWarning = create visual effect VISUAL_EFFECT_EPIC_TARGET_WARNING at {ET_FireEpicLocation} time 15 target {ET_FireEpicLocation}
        EpicVolc = create volcano at {ET_FireEpicLocation} player 1
        VolcanoFired = 1
        run background script LC14_Volcano(AIVolcano, EpicVolc)
    end if

    if VolcanoFired == 1
        wait until CHARGE of AIVolcano < 1.0
    end if

    run background script LC14_Epics

    wait 150 seconds

    if HEALTH of AIVolcano == 1.0 and VolcanoFired == 0
        enable predefined sky "VOLCANO" time 10
        CastEpicPos = marker at {1027.72,118.41,1972.32}
        run script EpicTargeter(PlayerTown,marker at {CastEpicPos},1)
        EpicWarning = create visual effect VISUAL_EFFECT_EPIC_TARGET_WARNING at {ET_FireEpicLocation} time 15 target {ET_FireEpicLocation}
        EpicVolc = create volcano at {ET_FireEpicLocation} player 1
        VolcanoFired = 1
        run background script LC14_Volcano(AIVolcano, EpicVolc)
    end if

    wait 150 seconds

    if HEALTH of AIVolcano == 1.0 and VolcanoFired == 0
        enable predefined sky "VOLCANO" time 10
        CastEpicPos = marker at {1027.72,118.41,1972.32}
        run script EpicTargeter(PlayerTown,marker at {CastEpicPos},1)
        EpicWarning = create visual effect VISUAL_EFFECT_EPIC_TARGET_WARNING at {ET_FireEpicLocation} time 15 target {ET_FireEpicLocation}
        EpicVolc = create volcano at {ET_FireEpicLocation} player 1
        VolcanoFired = 1
        run background script LC14_Volcano(AIVolcano, EpicVolc)
    end if

    wait 330 seconds

    VolcanoFired = 1

    SmallAttacksAllowed = 1

    //Spawn undead armies
    begin cinema
        set fade red 0 green 0 blue 0 time 2
        store camera details
        wait 2 seconds
        start music "exintro1" loop 1
        UndeadSpawn = marker at {1571.54,146.92,1849.28}
        set camera position to {1441.67,210.78,1695.04}
        set camera focus to {AztecTown1}
        set fade in time 2
        wait 3 seconds

        enemyPlatoon[0] = create platoon ARMY_UNIT_TYPE_MELEE_7 at {UndeadSpawn} + {number from -20 to 20,number from -20 to 20} with 1 men and 0 women
        PLAYER of enemyPlatoon[0] = 1
        AttackingPosition = marker at {AttackPos[0]}
        AttackingPositionFallBack = marker at {AttackPos[1]}
        run background script LC14_ArmyBehaivours(enemyPlatoon[0],Melee,Attacker,0,AttackingPosition,AttackingPositionFallBack,0,0)
        run background script LC14_GenericTalusSpeeches(enemyPlatoon[0],1)
        run background script LC14_CreateUndeadPlatoon(enemyPlatoon[0],1,40 * RecruitSizeModifier,s_skeletonadultland2)
        disable platoon enemyPlatoon[0] respond to town AztecCapital attack
        disable platoon enemyPlatoon[0] camp

        enemyPlatoon[1] = create platoon ARMY_UNIT_TYPE_MELEE_7 at {UndeadSpawn} + {number from -20 to 20,number from -20 to 20} with 1 men and 0 women
        PLAYER of enemyPlatoon[1] = 1
        AttackingPosition = marker at {AttackPos[0]} + {30,0,30}
        AttackingPositionFallBack = marker at {AttackPos[1]} + {30,0,30}
        run background script LC14_ArmyBehaivours(enemyPlatoon[1],Melee,Attacker,0,AttackingPosition,AttackingPositionFallBack,0,0)
        run background script LC14_GenericTalusSpeeches(enemyPlatoon[1],1)
        run background script LC14_CreateUndeadPlatoon(enemyPlatoon[1],1,40 * RecruitSizeModifier,s_skeletonadultland2)
        disable platoon enemyPlatoon[1] respond to town AztecCapital attack
        disable platoon enemyPlatoon[1] camp

        set camera position to {1533.88,168.00,1841.87}
        set camera focus to {enemyPlatoon[1]}

        wait 6 seconds
        set fade red 0 green 0 blue 0 time 3
        wait 3 seconds
        restore camera details
        set fade in time 3
        wait 3 seconds
    end cinema

    enemyPlatoon[2] = create platoon ARMY_UNIT_TYPE_MELEE_7 at {UndeadSpawn} + {number from -20 to 20,number from -20 to 20} with 1 men and 0 women
    PLAYER of enemyPlatoon[2] = 1
    AttackingPosition = marker at {AttackPos[0]} + {-30,0,-30}
    AttackingPositionFallBack = marker at {AttackPos[1]} + {-30,0,-30}
    run background script LC14_ArmyBehaivours(enemyPlatoon[2],Melee,Attacker,0,AttackingPosition,AttackingPositionFallBack,0,0)
    run background script LC14_GenericTalusSpeeches(enemyPlatoon[2],1)
    run background script LC14_CreateUndeadPlatoon(enemyPlatoon[2],1,40 * RecruitSizeModifier,s_skeletonadultland2)
    disable platoon enemyPlatoon[2] respond to town AztecCapital attack
    disable platoon enemyPlatoon[2] camp

    enemyPlatoon[3] = create platoon ARMY_UNIT_TYPE_MELEE_7 at {UndeadSpawn} + {number from -20 to 20,number from -20 to 20} with 1 men and 0 women
    PLAYER of enemyPlatoon[3] = 1
    AttackingPosition = marker at {AttackPos[0]} + {-30,0,0}
    AttackingPositionFallBack = marker at {AttackPos[1]} + {-30,0,0}
    run background script LC14_ArmyBehaivours(enemyPlatoon[3],Melee,Attacker,0,AttackingPosition,AttackingPositionFallBack,0,0)
    run background script LC14_GenericTalusSpeeches(enemyPlatoon[3],1)
    run background script LC14_CreateUndeadPlatoon(enemyPlatoon[3],1,40 * RecruitSizeModifier,s_skeletonadultland2)
    disable platoon enemyPlatoon[3] respond to town AztecCapital attack
    disable platoon enemyPlatoon[3] camp

    enemyPlatoon[4] = create platoon ARMY_UNIT_TYPE_MELEE_7 at {UndeadSpawn} + {number from -20 to 20,number from -20 to 20} with 1 men and 0 women
    PLAYER of enemyPlatoon[4] = 1
    AttackingPosition = marker at {AttackPos[0]} + {-15,0,15}
    AttackingPositionFallBack = marker at {AttackPos[1]} + {-15,0,15}
    run background script LC14_ArmyBehaivours(enemyPlatoon[4],Melee,Attacker,0,AttackingPosition,AttackingPositionFallBack,0,0)
    run background script LC14_GenericTalusSpeeches(enemyPlatoon[4],1)
    run background script LC14_CreateUndeadPlatoon(enemyPlatoon[4],1,40 * RecruitSizeModifier,s_skeletonadultland2)
    disable platoon enemyPlatoon[4] respond to town AztecCapital attack
    disable platoon enemyPlatoon[4] camp

    enemyPlatoon[5] = create siege weapon SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_7 belonging to AztecCapital at {UndeadSpawn} + {number from -20 to 20,number from -20 to 20}
    attach enemyPlatoon[5] to AztecCapital
    PLAYER of enemyPlatoon[5] = 1
    disable siege weapon enemyPlatoon[5] auto attack
    SiegeWaypoint1 = marker at {SiegeRoute1[0]}
    SiegeWaypoint2 = marker at {SiegeRoute1[1]} + {0,0}
    SiegeWaypoint3 = marker at {SiegeRoute1[2]} + {0,0}
    run background script LC14_MoveCatapultThenAttack(enemyPlatoon[5],0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)

    enemyPlatoon[6] = create siege weapon SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_7 belonging to AztecCapital at {UndeadSpawn} + {number from -20 to 20,number from -20 to 20}
    attach enemyPlatoon[6] to AztecCapital
    PLAYER of enemyPlatoon[6] = 1
    disable siege weapon enemyPlatoon[6] auto attack
    SiegeWaypoint1 = marker at {SiegeRoute1[0]}
    SiegeWaypoint2 = marker at {SiegeRoute1[1]} + {20,20}
    SiegeWaypoint3 = marker at {SiegeRoute1[2]} + {20,20}
    run background script LC14_MoveCatapultThenAttack(enemyPlatoon[6],0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)

    enemyPlatoon[7] = create siege weapon SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_7 belonging to AztecCapital at {UndeadSpawn} + {number from -20 to 20,number from -20 to 20}
    attach enemyPlatoon[7] to AztecCapital
    PLAYER of enemyPlatoon[7] = 1
    disable siege weapon enemyPlatoon[7] auto attack
    SiegeWaypoint1 = marker at {SiegeRoute1[0]}
    SiegeWaypoint2 = marker at {SiegeRoute1[1]} + {-20,-20}
    SiegeWaypoint3 = marker at {SiegeRoute1[2]} + {-20,-20}
    run background script LC14_MoveCatapultThenAttack(enemyPlatoon[7],0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)

    enemyPlatoon[8] = create siege weapon SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_7 belonging to AztecCapital at {UndeadSpawn} + {number from -20 to 20,number from -20 to 20}
    attach enemyPlatoon[8] to AztecCapital
    PLAYER of enemyPlatoon[8] = 1
    disable siege weapon enemyPlatoon[8] auto attack
    SiegeWaypoint1 = marker at {SiegeRoute1[0]}
    SiegeWaypoint2 = marker at {SiegeRoute1[1]} + {45,0}
    SiegeWaypoint3 = marker at {SiegeRoute1[2]} + {45,0}
    run background script LC14_MoveCatapultThenAttack(enemyPlatoon[8],0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)

    enemyPlatoon[9] = create siege weapon SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_7 belonging to AztecCapital at {UndeadSpawn} + {number from -20 to 20,number from -20 to 20}
    attach enemyPlatoon[9] to AztecCapital
    PLAYER of enemyPlatoon[9] = 1
    disable siege weapon enemyPlatoon[9] auto attack
    SiegeWaypoint1 = marker at {SiegeRoute1[0]}
    SiegeWaypoint2 = marker at {SiegeRoute1[1]} + {0,45}
    SiegeWaypoint3 = marker at {SiegeRoute1[2]} + {0,45}
    run background script LC14_MoveCatapultThenAttack(enemyPlatoon[9],0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)

    wait 30 seconds

    enemyPlatoon[0] = create platoon ARMY_UNIT_TYPE_MELEE_7 at {UndeadSpawn} + {number from -20 to 20,number from -20 to 20} with 1 men and 0 women
    PLAYER of enemyPlatoon[0] = 1
    AttackingPosition = marker at {AttackPos[0]}
    AttackingPositionFallBack = marker at {AttackPos[1]}
    run background script LC14_ArmyBehaivours(enemyPlatoon[0],Melee,Attacker,0,AttackingPosition,AttackingPositionFallBack,0,0)
    run background script LC14_GenericTalusSpeeches(enemyPlatoon[0],1)
    run background script LC14_CreateUndeadPlatoon(enemyPlatoon[0],1,225 * RecruitSizeModifier,s_skeletonadultland2)
    disable platoon enemyPlatoon[0] respond to town AztecCapital attack
    disable platoon enemyPlatoon[0] camp

    //End script and release control to AI
    myAttackTimer = create timer for 600 seconds
    AIAttacksAllowed = 1

    CHARGE of AIVolcano = 1.0

end script LC14_MainScript


begin script LC14_Epics

    FireEpicPos = 0
    EpicWarning = 0
    EnemyEpic = 0
    Number = 0
    EpicTimer = create timer for 0 seconds
    EPICDELAY = 1500
    myTown = 0

start

while LandOver == 0
    if get EpicTimer time remaining <= 0
        Number = number from 1 to 3
        if Number == 1 and CHARGE of AIVolcano == 1.0 and HEALTH of AIVolcano == 1.0 and VolcanoFired == 1
            if PLAYER of PlayerTown == 0
                myTown = PlayerTown
            elsif PLAYER of AztecCapital == 0
                myTown = AztecCapital
            elsif PLAYER of AztecTown1 == 0
                myTown = AztecTown1
            elsif PLAYER of AztecTown2 == 0
                myTown = AztecTown2
            end if

            wait until dialogue ready
            GB_DialogueIsRunning = 1
            begin dialogue
                say "BW2XT_LAND05_EARTHQUAKE_20"
                clear dialogue
                close dialogue
                wait BW2XT_LAND05_EARTHQUAKE_20 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0

            enable predefined sky "VOLCANO" time 10
            Number = number from 1 to 2
            if Number == 1
                FireEpicPos = marker at {856.70,203.35,1811.41}
            else
                FireEpicPos = marker at {1131.71,210.24,2158.22}
            end if
            run script EpicTargeter(myTown,marker at {FireEpicPos},1)
            EpicWarning = create visual effect VISUAL_EFFECT_EPIC_TARGET_WARNING at {ET_FireEpicLocation} time 15 target {ET_FireEpicLocation}
            wait 15 seconds
            EnemyEpic = create volcano at {ET_FireEpicLocation} player 1
            run background script LC14_Volcano(AIVolcano, EnemyEpic)
            EpicTimer = create timer for EPICDELAY * EpicModifier seconds

        elsif Number == 2 and CHARGE of AIEarthquake == 1.0 and HEALTH of AIEarthquake == 1.0
            if PLAYER of PlayerTown == 0
                myTown = PlayerTown
            elsif PLAYER of AztecCapital == 0
                myTown = AztecCapital
            elsif PLAYER of AztecTown1 == 0
                myTown = AztecTown1
            elsif PLAYER of AztecTown2 == 0
                myTown = AztecTown2
            end if

            wait until dialogue ready
            GB_DialogueIsRunning = 1
            begin dialogue
                Number = number from 1 to 2
                if Number == 1
                    say "BW2XT_LAND05_EARTHQUAKE_60"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND05_EARTHQUAKE_60 + 1 seconds
                elsif Number == 2
                    say "BW2XT_LAND05_EARTHQUAKE_70"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND05_EARTHQUAKE_70 + 1 seconds
                end if
            end dialogue
            GB_DialogueIsRunning = 0

            run script EpicTargeter(myTown,marker at {myTown},0)
            enable predefined sky "EARTHQUAKE" time 9

            wait 5 seconds
            invoke AIEarthquake EPIC_WONDER_STAGE_1
            play sound "SCRIPT2_EEPIC_SYNTH3" at {AIEarthquake}
            wait 2.5 seconds
            wait 2 seconds
            play sound "SCRIPT2_EEPIC_SYNTH3" at {AIEarthquake}
            invoke AIEarthquake EPIC_WONDER_STAGE_2
            wait 1 second
            wait 2 seconds
            invoke AIEarthquake EPIC_WONDER_STAGE_3
            invoke AIEarthquake EPIC_WONDER_STAGE_4
            invoke AIEarthquake EPIC_WONDER_STAGE_5
            invoke AIEarthquake EPIC_WONDER_STAGE_6
            play sound "BEAMOFLIGHTLOOP1" at {AIEarthquake}
            wait 2 seconds
            play sound "BEAMOFLIGHTLOOP1" at {AIEarthquake}
            play sound "SCRIPT2_EEPIC_SYNTH2" at {AIEarthquake}
            invoke AIEarthquake EPIC_WONDER_STAGE_7
            invoke AIEarthquake EPIC_WONDER_STAGE_8
            invoke AIEarthquake EPIC_WONDER_STAGE_9
            invoke AIEarthquake EPIC_WONDER_STAGE_10
            invoke AIEarthquake EPIC_WONDER_STAGE_START_BEAM
            invoke AIEarthquake EPIC_START_CASTING
            invoke AIEarthquake EPIC_PULSE_UP

            EpicWarning = create visual effect VISUAL_EFFECT_EPIC_TARGET_WARNING at {ET_FireEpicLocation} time 15 target {ET_FireEpicLocation}
            wait 13 seconds
            wait until dialogue ready and camera ready
            run background script LC14_EarthquakeCinema(ET_FireEpicLocation)
            wait 2 seconds
            EnemyEpic = create earthquake start {myTown} end {ET_FireEpicLocation} player 1
            run background script LC14_Earthquake(AIEarthquake, EnemyEpic)
            EpicTimer = create timer for EPICDELAY * EpicModifier seconds

        elsif Number == 3 and CHARGE of AIHurricane == 1.0 and HEALTH of AIHurricane == 1.0
            if PLAYER of PlayerTown == 0
                myTown = PlayerTown
            elsif PLAYER of AztecCapital == 0
                myTown = AztecCapital
            elsif PLAYER of AztecTown1 == 0
                myTown = AztecTown1
            elsif PLAYER of AztecTown2 == 0
                myTown = AztecTown2
            end if

            wait until dialogue ready
            GB_DialogueIsRunning = 1
            begin dialogue
                Number = number from 1 to 2
                if Number == 1
                    say "BW2XT_LAND05_HURRICANE_20"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND05_HURRICANE_20 + 1 seconds
                    say "BW2XT_LAND05_HURRICANE_30"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND05_HURRICANE_30 + 1 seconds
                elsif Number == 2
                    say "BW2XT_LAND05_HURRICANE_50"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND05_HURRICANE_50 + 1 seconds
                end if
            end dialogue
            GB_DialogueIsRunning = 0

            enable predefined sky "HURRICANE" time 9
            run script EpicTargeter(myTown,marker at {myTown},0)
            EpicWarning = create visual effect VISUAL_EFFECT_EPIC_TARGET_WARNING at {ET_FireEpicLocation} time 15 target {ET_FireEpicLocation}
            wait 15 seconds
            EnemyEpic = create hurricane at {ET_FireEpicLocation} player 1 direction {myTown}
            run background script LC14_Hurricane(AIHurricane, EnemyEpic)
            EpicTimer = create timer for EPICDELAY * EpicModifier seconds

        end if
    end if
end while

end script LC14_Epics


begin script LC14_EarthquakeCinema(Earthquake)

X = 0
Y = 150
Z = 0
XOK = 0
ZOK = 0

start

XOK = 0
ZOK = 0
X = 0
Y = 150
Z = 0

begin loop
    if X < 80 and X > -80
        X = number from -125 to 125
    else
        XOK = 1
    end if
    if Z < 80 and Z > -80
        Z = number from -125 to 125
    else
        ZOK = 1
    end if

    until XOK == 1 and ZOK == 1
end loop


begin interruptible cinema

    set camera position to {Earthquake} + {X,Y,Z}
    set camera focus to {Earthquake} + {0,10,0 }
    wait 5 seconds

end cinema

end script LC14_EarthquakeCinema


begin script LC14_LargeSiegePlatoons

    AttackingPosition = 0
    AttackingPositionFallBack = 0
    SiegeWaypoint1 = 0
    SiegeWaypoint2 = 0
    SiegeWaypoint3 = 0

start

begin loop

    if PLAYER of AztecTown1 == 1

        if LC14_Platoon[22] not exists and PLAYER of AztecTown1 == 1 and LC14_LargeSiegeIsRunning == 1
            wait number from 2 to 4 seconds
            LC14_Platoon[22] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecTown1 platoon of size 30 * RecruitSizeModifier
            wait until not LC14_Platoon[22] recruiting
            AttackingPosition = marker at {AttackPos[0]}
            AttackingPositionFallBack = marker at {AttackPos[1]}
            run background script LC14_ArmyBehaivours(LC14_Platoon[22],Melee,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)
        end if

        if LC14_Platoon[23] not exists and PLAYER of AztecTown1 == 1 and LC14_LargeSiegeIsRunning == 1
            wait number from 2 to 4 seconds
            LC14_Platoon[23] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecTown1 platoon of size 30 * RecruitSizeModifier
            wait until not LC14_Platoon[23] recruiting
            AttackingPosition = marker at {AttackPos[0]} + {20,20}
            AttackingPositionFallBack = marker at {AttackPos[1]} + {20,20}
            run background script LC14_ArmyBehaivours(LC14_Platoon[23],Melee,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)
        end if

        if LC14_Platoon[24] not exists and PLAYER of AztecTown1 == 1 and LC14_LargeSiegeIsRunning == 1
            wait number from 2 to 4 seconds
            LC14_Platoon[24] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecTown1 platoon of size 30 * RecruitSizeModifier
            wait until not LC14_Platoon[24] recruiting
            AttackingPosition = marker at {AttackPos[0]} + {-20,-20}
            AttackingPositionFallBack = marker at {AttackPos[1]} + {-20,-20}
            run background script LC14_ArmyBehaivours(LC14_Platoon[24],Melee,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)
        end if

        if LC14_Platoon[25] not exists and PLAYER of AztecTown1 == 1 and LC14_LargeSiegeIsRunning == 1
            wait number from 2 to 4 seconds
            LC14_Platoon[25] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecTown1 platoon of size 30 * RecruitSizeModifier
            wait until not LC14_Platoon[25] recruiting
            AttackingPosition = marker at {AttackPos[0]} + {50,0}
            AttackingPositionFallBack = marker at {AttackPos[1]} + {50,0}
            run background script LC14_ArmyBehaivours(LC14_Platoon[25],Ranged,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)
        end if

        if LC14_Platoon[26] not exists and PLAYER of AztecTown1 == 1 and LC14_LargeSiegeIsRunning == 1 and Difficulty >= 3
            wait number from 2 to 4 seconds
            LC14_Platoon[26] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecTown1 platoon of size 30 * RecruitSizeModifier
            wait until not LC14_Platoon[26] recruiting
            AttackingPosition = marker at {AttackPos[0]} + {35,35}
            AttackingPositionFallBack = marker at {AttackPos[1]} + {35,35}
            run background script LC14_ArmyBehaivours(LC14_Platoon[26],Ranged,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)
        end if

        if LC14_Platoon[27] not exists and PLAYER of AztecTown1 == 1 and LC14_LargeSiegeIsRunning == 1 and Difficulty >= 4
            wait number from 2 to 4 seconds
            LC14_Platoon[27] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecTown1 platoon of size 30 * RecruitSizeModifier
            wait until not LC14_Platoon[27] recruiting
            AttackingPosition = marker at {AttackPos[0]} + {-45,25}
            AttackingPositionFallBack = marker at {AttackPos[1]} + {-45,25}
            run background script LC14_ArmyBehaivours(LC14_Platoon[27],Ranged,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)
        end if

        //Add Catapults
        if LC14_SiegeCatapult[5] not exists and PLAYER of AztecTown1 == 1 and LC14_LargeSiegeIsRunning == 1
            wait number from 1 to 3 seconds
            LC14_SiegeCatapult[5] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_6 town AztecTown1 siege weapon
            disable siege weapon LC14_SiegeCatapult[5] auto attack
            SiegeWaypoint1 = marker at {SiegeRoute1[0]}
            SiegeWaypoint2 = marker at {SiegeRoute1[1]} + {0,0}
            SiegeWaypoint3 = marker at {SiegeRoute1[2]} + {0,0}
            run background script LC14_MoveCatapultThenAttack(LC14_SiegeCatapult[5],0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)
        end if

        if LC14_SiegeCatapult[6] not exists and PLAYER of AztecTown1 == 1 and LC14_LargeSiegeIsRunning == 1
            wait number from 1 to 3 seconds
            LC14_SiegeCatapult[6] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_6 town AztecTown1 siege weapon
            disable siege weapon LC14_SiegeCatapult[6] auto attack
            SiegeWaypoint1 = marker at {SiegeRoute1[0]}
            SiegeWaypoint2 = marker at {SiegeRoute1[1]} + {30,30}
            SiegeWaypoint3 = marker at {SiegeRoute1[2]} + {30,30}
            run background script LC14_MoveCatapultThenAttack(LC14_SiegeCatapult[6],0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)
        end if

        if LC14_SiegeCatapult[7] not exists and PLAYER of AztecTown1 == 1 and LC14_LargeSiegeIsRunning == 1
            wait number from 1 to 3 seconds
            LC14_SiegeCatapult[7] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_6 town AztecTown1 siege weapon
            disable siege weapon LC14_SiegeCatapult[7] auto attack
            SiegeWaypoint1 = marker at {SiegeRoute1[0]}
            SiegeWaypoint2 = marker at {SiegeRoute1[1]} + {-30,-30}
            SiegeWaypoint3 = marker at {SiegeRoute1[2]} + {-30,-30}
            run background script LC14_MoveCatapultThenAttack(LC14_SiegeCatapult[7],0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)
        end if

        if LC14_SiegeCatapult[8] not exists and PLAYER of AztecTown1 == 1 and LC14_LargeSiegeIsRunning == 1 and Difficulty >= 3
            wait number from 1 to 3 seconds
            LC14_SiegeCatapult[8] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_6 town AztecTown1 siege weapon
            disable siege weapon LC14_SiegeCatapult[8] auto attack
            SiegeWaypoint1 = marker at {SiegeRoute1[0]}
            SiegeWaypoint2 = marker at {SiegeRoute1[1]} + {45,0}
            SiegeWaypoint3 = marker at {SiegeRoute1[2]} + {45,0}
            run background script LC14_MoveCatapultThenAttack(LC14_SiegeCatapult[8],0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)
        end if

        if LC14_SiegeCatapult[9] not exists and PLAYER of AztecTown1 == 1 and LC14_LargeSiegeIsRunning == 1 and Difficulty >= 3
            wait number from 1 to 3 seconds
            LC14_SiegeCatapult[9] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_6 town AztecTown1 siege weapon
            disable siege weapon LC14_SiegeCatapult[9] auto attack
            SiegeWaypoint1 = marker at {SiegeRoute1[0]}
            SiegeWaypoint2 = marker at {SiegeRoute1[1]} + {-45,0}
            SiegeWaypoint3 = marker at {SiegeRoute1[2]} + {-45,0}
            run background script LC14_MoveCatapultThenAttack(LC14_SiegeCatapult[9],0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)
        end if

        if LC14_SiegeCatapult[10] not exists and PLAYER of AztecTown1 == 1 and LC14_LargeSiegeIsRunning == 1 and Difficulty >= 4
            wait number from 1 to 3 seconds
            LC14_SiegeCatapult[10] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_6 town AztecTown1 siege weapon
            disable siege weapon LC14_SiegeCatapult[10] auto attack
            SiegeWaypoint1 = marker at {SiegeRoute1[0]}
            SiegeWaypoint2 = marker at {SiegeRoute1[1]} + {0,45}
            SiegeWaypoint3 = marker at {SiegeRoute1[2]} + {0,45}
            run background script LC14_MoveCatapultThenAttack(LC14_SiegeCatapult[10],0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)
        end if
    end if

    until LC14_LargeSiegeOver == 1
end loop 

end script LC14_LargeSiegePlatoons


begin script LC14_PlayRandomBanter

    whichDialogue = 0

start

    wait until dialogue ready
    GB_DialogueIsRunning = 1
    whichDialogue = number from 1 to 12
    if whichDialogue == 1
        begin dialogue
            say "BW2XT_LAND02_PLAYER_OLDCITY_10"
            clear dialogue
            close dialogue
            wait BW2XT_LAND02_PLAYER_OLDCITY_10 + 1 seconds
        end dialogue
    elsif whichDialogue == 2
        begin dialogue
            say "BW2XT_LAND02_PLAYER_OLDCITY_20"
            clear dialogue
            close dialogue
            wait BW2XT_LAND02_PLAYER_OLDCITY_20 + 1 seconds
        end dialogue
    elsif whichDialogue == 3
        begin dialogue
            say "BW2XT_LAND02_TALUS_BANTER_50"
            clear dialogue
            close dialogue
            wait BW2XT_LAND02_TALUS_BANTER_50 + 1 seconds
        end dialogue
    elsif whichDialogue == 4
        begin dialogue
            say "BW2XT_LAND03_TALUS_ATTACKS_TOWN_20"
            clear dialogue
            close dialogue
            wait BW2XT_LAND03_TALUS_ATTACKS_TOWN_20 + 1 seconds
        end dialogue

    elsif whichDialogue == 5
        begin dialogue
            say "BW2XT_LAND03_TALUS_ATTACKS_TOWN_50"
            clear dialogue
            close dialogue
            wait BW2XT_LAND03_TALUS_ATTACKS_TOWN_50 + 1 seconds
        end dialogue
    elsif whichDialogue == 6
        begin dialogue
            say "BW2XT_LAND05_TALUS_VARIOUS_120"
            clear dialogue
            close dialogue
            wait BW2XT_LAND05_TALUS_VARIOUS_120 + 1 seconds
        end dialogue
    elsif whichDialogue == 7
        begin dialogue
            say "BW2XT_LAND05_TALUS_VARIOUS_150"
            clear dialogue
            close dialogue
            wait BW2XT_LAND05_TALUS_VARIOUS_150 + 1 seconds
        end dialogue
    elsif whichDialogue == 8
        begin dialogue
            say "BW2XT_LAND05_TALUS_VARIOUS_170"
            clear dialogue
            close dialogue
            wait BW2XT_LAND05_TALUS_VARIOUS_170 + 1 seconds
        end dialogue
    elsif whichDialogue == 9
        begin dialogue
            say "BW2XT_LAND05_TOWN_ATTACK_30"
            clear dialogue
            close dialogue
            wait BW2XT_LAND05_TOWN_ATTACK_30 + 1 seconds
        end dialogue
    elsif whichDialogue == 10
        begin dialogue
            say "BW2XT_LAND02_TALUS_SIEGE_30"
            clear dialogue
            close dialogue
            wait BW2XT_LAND02_TALUS_SIEGE_30 + 1 seconds
        end dialogue
    elsif whichDialogue == 11
        begin dialogue
            say "BW2XT_LAND02_TALUS_SIEGE_20"
            clear dialogue
            close dialogue
            wait BW2XT_LAND02_TALUS_SIEGE_20 + 1 seconds
        end dialogue
    elsif whichDialogue == 12
        begin dialogue
            say "BW2XT_LAND02_TALUS_SIEGE_10"
            clear dialogue
            close dialogue
            wait BW2XT_LAND02_TALUS_SIEGE_10 + 1 seconds
        end dialogue
    end if
    GB_DialogueIsRunning = 0

end script LC14_PlayRandomBanter


begin script LC14_AttackNearestTownTimer

start

begin loop

    if get AttackNearestTownTimer time remaining <= 0
        wait 45 seconds
        AttackNearestTownTimer = create timer for 1250 * RecruitModifier seconds
    end if

end loop

end script LC14_AttackNearestTownTimer


begin script LC14_DefendPlatoons

    PlayerPlatoon = 0
    DefendRecruitTimer1 = create timer for 0 seconds
    DefendRecruitTimer2 = create timer for 0 seconds
    DefendRecruitTimer3 = create timer for 0 seconds
    DefendRecruitTimer4 = create timer for 0 seconds

    DefenderPlatoon[9]
    DelayDone = 0

start

    begin loop
        if PLAYER of AztecTown1 == 1 and DelayDone == 0
            DefendRecruitTimer1 = create timer for 300 seconds
            DelayDone = 1
        end if
        PlayerPlatoon = get platoon of player 0 nearest {AztecTown1} radius 250
        if PlayerPlatoon exists and DefenderPlatoon[0] not exists and DefenderPlatoon[0] not exists and get DefendRecruitTimer1 time remaining <= 0 and PLAYER of AztecTown1 == 1 //Makes a couple of defend platoons
            DefenderPlatoon[0] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecTown1 platoon of size 30 * RecruitSizeModifier
            enable platoon DefenderPlatoon[0] respond to town AztecTown1 attack
            wait until not DefenderPlatoon[0] recruiting
            
            DefenderPlatoon[1] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecTown1 platoon of size 30 * RecruitSizeModifier
            enable platoon DefenderPlatoon[1] respond to town AztecTown1 attack
            wait until not DefenderPlatoon[1] recruiting
            
            DefendRecruitTimer1 = create timer for 180 * RecruitModifier seconds
        end if

        PlayerPlatoon = get platoon of player 0 nearest {AztecTown2} radius 500
        if PlayerPlatoon exists and DefenderPlatoon[2] not exists and DefenderPlatoon[3] not exists and get DefendRecruitTimer2 time remaining <= 0 and PLAYER of AztecTown2 == 1 //Makes a couple of defend platoons
            DefenderPlatoon[2] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecTown2 platoon of size 30 * RecruitSizeModifier
            enable platoon DefenderPlatoon[2] respond to town AztecTown2 attack
            wait until not DefenderPlatoon[2] recruiting
            
            DefenderPlatoon[3] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecTown2 platoon of size 30 * RecruitSizeModifier
            enable platoon DefenderPlatoon[3] respond to town AztecTown2 attack
            wait until not DefenderPlatoon[3] recruiting

            DefendRecruitTimer2 = create timer for 180 * RecruitModifier seconds
        end if

        /*
        PlayerPlatoon = get platoon of player 0 nearest {AztecTown3} radius 500
        if PlayerPlatoon exists and DefenderPlatoon[4] not exists and DefenderPlatoon[5] not exists and get DefendRecruitTimer3 time remaining <= 0 and PLAYER of AztecTown3 == 1 //Makes a couple of defend platoons
            DefenderPlatoon[4] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecTown3 platoon of size 30 * RecruitSizeModifier
            enable platoon DefenderPlatoon[4] respond to town AztecTown3 attack
            wait until not DefenderPlatoon[4] recruiting
            
            DefenderPlatoon[5] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecTown3 platoon of size 30 * RecruitSizeModifier
            enable platoon DefenderPlatoon[5] respond to town AztecTown3 attack
            wait until not DefenderPlatoon[5] recruiting

            DefendRecruitTimer3 = create timer for 180 * RecruitModifier seconds
        end if
        */

        PlayerPlatoon = get platoon of player 0 nearest {AztecCapital} radius 500
        if PlayerPlatoon exists and DefenderPlatoon[6] not exists and DefenderPlatoon[7] not exists and DefenderPlatoon[8] not exists and get DefendRecruitTimer4 time remaining <= 0 and PLAYER of AztecCapital == 1 //Makes a couple of defend platoons
            DefenderPlatoon[6] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 30 * RecruitSizeModifier
            enable platoon DefenderPlatoon[6] respond to town AztecCapital attack
            wait until not DefenderPlatoon[6] recruiting
            
            DefenderPlatoon[7] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 30 * RecruitSizeModifier
            enable platoon DefenderPlatoon[7] respond to town AztecCapital attack
            wait until not DefenderPlatoon[7] recruiting
            
            DefenderPlatoon[8] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 30 * RecruitSizeModifier
            enable platoon DefenderPlatoon[8] respond to town AztecCapital attack
            wait until not DefenderPlatoon[8] recruiting

            DefendRecruitTimer4 = create timer for 180 * RecruitModifier seconds
        end if
    end loop

end script LC14_DefendPlatoons


begin script LC14_GetNearestSettlement

    NearestTown = 0

start

begin loop
    if PLAYER of AztecCapital == 0
        NearestTown = AztecCapital

    elsif PLAYER of AztecTown1 == 0
        NearestTown = AztecTown1

    elsif PLAYER of AztecTown2 == 0
        NearestTown = AztecTown2

    else
        NearestTown = PlayerTown

    end if

    NearestSettlement = NearestTown
    wait 45 seconds
end loop

end script LC14_GetNearestSettlement


begin script LC14_AztecCapitalRessourceManager

start

begin loop

    wait 5 seconds

    if PLAYER of AztecCapital == 1
        if (get town AztecCapital RESOURCE_TYPE_ORE total < 40000)
            add resource RESOURCE_TYPE_ORE number from 500 to 750 to AztecCapital
        elsif (get town AztecCapital RESOURCE_TYPE_WOOD total < 40000)
            add resource RESOURCE_TYPE_WOOD number from 1000 to 1500 to AztecCapital
        elsif (get town AztecCapital RESOURCE_TYPE_FOOD total < 40000)
            add resource RESOURCE_TYPE_FOOD number from 1000 to 1500 to AztecCapital
        end if
    end if
    until PLAYER of AztecCapital != 1
end loop    

end script LC14_AztecCapitalRessourceManager

begin script LC14_AztecCapitalVillagerManager

    Counter = 0
    Villager = 0
    HousesBuilt = 0

start

begin loop

    wait 1450 * BuilderModifier seconds
    Counter = 0

    if PLAYER of AztecCapital == 1
        if HousesBuilt == 0
            if PLAYER of AztecTown2 != 1
                HousesBuilt = 1
                build all town AztecCapital buildings in group 10
                run background script LC14_AIAltarCounter(get HOUSE ALTAR at {1541.69,148.50,641.20} radius 25)
            end if
        end if
        begin loop
            Villager = create random villager of tribe TRIBE_TYPE_AZTEC at {AztecCapital} + {number from -12 to 12, 0, number from -12 to 12}//create VILLAGER VILLAGER_INFO_JAPANESE_FORESTER_MALE at {1013.581, 132.333, 2002.798} + {number from -3 to 3, 0, number from -3 to 3}
            attach Villager to AztecCapital
            release Villager
            
            wait number from 6 to 10 seconds
            Counter++
            until Counter >= 50 or PLAYER of AztecCapital != 1
        end loop
    end if

end loop

end script LC14_AztecCapitalVillagerManager

begin script LC14_AztecTown1RessourceManager

start

begin loop

    wait 5 seconds

    if PLAYER of AztecTown1 == 1
        if (get town AztecTown1 RESOURCE_TYPE_ORE total < 22000)
            add resource RESOURCE_TYPE_ORE number from 500 to 750 to AztecTown1
        elsif (get town AztecTown1 RESOURCE_TYPE_WOOD total < 40000)
            add resource RESOURCE_TYPE_WOOD number from 1000 to 1500 to AztecTown1
        elsif (get town AztecTown1 RESOURCE_TYPE_FOOD total < 40000)
            add resource RESOURCE_TYPE_FOOD number from 1000 to 1500 to AztecTown1
        end if
    end if

end loop    

end script LC14_AztecTown1RessourceManager

begin script LC14_AztecTown1VillagerManager

    Counter = 0
    Villager = 0
    HousesBuilt = 0

start

begin loop

    wait 1450 * BuilderModifier seconds
    Counter = 0

    if PLAYER of AztecTown1 == 1
        if HousesBuilt == 0
            HousesBuilt = 1
            build all town AztecTown1 buildings in group 10
        end if
        begin loop
            Villager = create random villager of tribe TRIBE_TYPE_GREEK at {AztecTown1} + {number from -12 to 12, 0, number from -12 to 12}//create VILLAGER VILLAGER_INFO_JAPANESE_FORESTER_MALE at {1013.581, 132.333, 2002.798} + {number from -3 to 3, 0, number from -3 to 3}
            attach Villager to AztecTown1
            release Villager
            
            wait number from 6 to 10 seconds
            Counter++
            until Counter >= 20 or PLAYER of AztecTown1 != 1
        end loop
    end if

end loop

end script LC14_AztecTown1VillagerManager

begin script LC14_AztecTown2RessourceManager

start

begin loop

    wait 5 seconds

    if PLAYER of AztecTown2 == 1
        if (get town AztecTown2 RESOURCE_TYPE_ORE total < 35000)
            add resource RESOURCE_TYPE_ORE number from 500 to 750 to AztecTown2
        elsif (get town AztecTown2 RESOURCE_TYPE_WOOD total < 40000)
            add resource RESOURCE_TYPE_WOOD number from 1000 to 1500 to AztecTown2
        elsif (get town AztecTown2 RESOURCE_TYPE_FOOD total < 40000)
            add resource RESOURCE_TYPE_FOOD number from 1000 to 1500 to AztecTown2
        end if
    end if

end loop    

end script LC14_AztecTown2RessourceManager

begin script LC14_AztecTown2VillagerManager

    Counter = 0
    Villager = 0
    HousesBuilt = 0

start

begin loop

    wait 1450 * BuilderModifier seconds
    Counter = 0

    if PLAYER of AztecTown2 == 1
        if HousesBuilt == 0
            HousesBuilt = 1
            build all town AztecTown2 buildings in group 10
        end if
        begin loop
            Villager = create random villager of tribe TRIBE_TYPE_AZTEC at {AztecTown2} + {number from -12 to 12, 0, number from -12 to 12}//create VILLAGER VILLAGER_INFO_JAPANESE_FORESTER_MALE at {1013.581, 132.333, 2002.798} + {number from -3 to 3, 0, number from -3 to 3}
            attach Villager to AztecTown2
            release Villager
            
            wait number from 6 to 10 seconds
            Counter++
            until Counter >= 20 or PLAYER of AztecTown2 != 1
        end loop
    end if

end loop

end script LC14_AztecTown2VillagerManager


begin script LC14_FireRain(whichTemple,whichPosition)

    Weather[6]
    Position = 0
    WeatherPos = 0
    Number = 0

start

    if whichTemple == AztecTemple[0]
        WeatherPos = marker at {whichPosition}

    elsif whichTemple == AztecTemple[1]
        WeatherPos = marker at {whichPosition}

    elsif whichTemple == AztecTemple[2]
        WeatherPos = marker at {whichPosition}

    end if

    Weather[0] = create SCRIPT_OBJECT_TYPE_WEATHER_THING WEATHER_INFO_MEDIUM_CLOUD at {WeatherPos} + {0, 0, 0}
    set cloud for Weather[0] above {WeatherPos} + {0, 30, 0}
    set cloud generation 7
    set Weather[0] properties rainfall 1 snowfall 0 overcast 0.9
    SCALE of Weather[0] = 5

    Weather[1] = create SCRIPT_OBJECT_TYPE_WEATHER_THING WEATHER_INFO_MEDIUM_CLOUD at {WeatherPos} + {250, 0, 0}
    set cloud for Weather[1] above {WeatherPos} + {250, 30, 0}
    set cloud generation 7
    set Weather[1] properties rainfall 1 snowfall 0 overcast 0.9
    SCALE of Weather[1] = 5

    Weather[2] = create SCRIPT_OBJECT_TYPE_WEATHER_THING WEATHER_INFO_MEDIUM_CLOUD at {WeatherPos} + {0, 0, 250}
    set cloud for Weather[2] above {WeatherPos} + {0, 30, 250}
    set cloud generation 7
    set Weather[2] properties rainfall 1 snowfall 0 overcast 0.9
    SCALE of Weather[2] = 5

    Weather[3] = create SCRIPT_OBJECT_TYPE_WEATHER_THING WEATHER_INFO_MEDIUM_CLOUD at {WeatherPos} + {-250, 0, 0}
    set cloud for Weather[3] above {WeatherPos} + {-250, 30, 0}
    set cloud generation 7
    set Weather[3] properties rainfall 1 snowfall 0 overcast 0.9
    SCALE of Weather[3] = 5

    Weather[4] = create SCRIPT_OBJECT_TYPE_WEATHER_THING WEATHER_INFO_MEDIUM_CLOUD at {WeatherPos} + {0, 0, -250}
    set cloud for Weather[4] above {WeatherPos} + {0, 30, -250}
    set cloud generation 7
    set Weather[4] properties rainfall 1 snowfall 0 overcast 0.9
    SCALE of Weather[4] = 5

    Weather[5] = create SCRIPT_OBJECT_TYPE_WEATHER_THING WEATHER_INFO_MEDIUM_CLOUD at {WeatherPos} + {0, 0, 0}
    set cloud for Weather[5] above {WeatherPos} + {0, 30, 0}
    set cloud generation 7
    set Weather[5] properties rainfall 1 snowfall 0 overcast 0.9
    SCALE of Weather[5] = 5

    run background script LC14_FireRainTempleEffects(whichTemple,Weather[0])

    Position = marker at {Weather[0]} + {0, -30, 0}
    run background script LC14_WeatherLightning(Position, Weather[0])

    Position = marker at {Weather[0]} + {0, 500, 0}
    run background script LC14_FireBalls(Position, Weather[0])
    run background script LC14_FireBallsBarrel(Position, Weather[0])

    wait until HEALTH of whichTemple < 1.0

    run background script LC14_TempleDestroyed(marker at {whichTemple})

    wait 5 seconds

    delete Weather[0]
    delete Weather[1]
    delete Weather[2]
    delete Weather[3]
    delete Weather[4]
    delete Weather[5]

end script LC14_FireRain

begin script LC14_FireRainTempleEffects(whichTemple,Weather)

    Visual1 = 0
    Visual2 = 0
    Visual3 = 0

start

Visual1 = create visual effect VISUAL_EFFECT_EPIC_VOLCANO_BEAM_PULSE_UP at {whichTemple} time -1 target {whichTemple}
Visual3 = create visual effect VISUAL_EFFECT_EPIC_VOLCANO_BEAM at {whichTemple} time -1 target {whichTemple}
set Visual1 colour red 192 green 0 blue 0
set Visual3 colour red 192 green 0 blue 0

begin loop
    wait number from 1 to 2 seconds

    Visual2 = create visual effect VISUAL_EFFECT_MIRACLE_CHARGE at {whichTemple} + {0,15,0} time 7.5
    set Visual2 colour red 192 green 0 blue 0
    SCALE of Visual2 = 6

    until Weather not exists
end loop

delete Visual1 with fade
delete Visual2 with fade
delete Visual3 with fade

end script LC14_FireRainTempleEffects

begin script LC14_FireBalls(Position, Weather)

FireBall = 0
FireBallStart = 0
FireBallTarget = 0

start

begin loop
    wait number from 1 to 2.25 seconds
    FireBallStart = marker at ({Position} + {number from -100 to 100, number from -10 to 15, number from -100 to 100})
    FireBallTarget = marker at ({FireBallStart} + {number from -5 to 5, number from -5 to -15, number from -5 to 5})
    FireBall = make player 1 throw miracle MIRACLE_TYPE_FIRE from ({FireBallStart} + {0,-3.0,0}) heading ({FireBallTarget} + {0,21,0} - {FireBallStart})

    until Weather not exists
end loop

end script LC14_FireBalls

begin script LC14_FireBallsBarrel(Position, Weather)

FireBall = 0
FireBallStart = 0
FireBallTarget = 0
Counter = 0
Timer = create timer for 0 seconds

start

wait 15 seconds

begin loop
    if Counter < 4 and get Timer time remaining == 0
        wait number from 0.25 to 0.5 seconds
        FireBallStart = marker at ({Position} + {number from -100 to 100, number from -10 to 15, number from -100 to 100})
        FireBallTarget = marker at ({FireBallStart} + {number from -5 to 5, number from -5 to -15, number from -5 to 5})
        FireBall = make player 1 throw miracle MIRACLE_TYPE_FIRE from ({FireBallStart} + {0,-3.0,0}) heading ({FireBallTarget} + {0,21,0} - {FireBallStart})
        Counter++
    elsif Counter >= 9
        Counter = 0
        Timer = create timer for 20 seconds
    end if

    until Weather not exists
end loop

end script LC14_FireBallsBarrel

begin script LC14_WeatherLightning(Position, Weather)

start

begin loop
    wait number from 20 to 40 seconds
    set lightning strike at {Position} + {number from -80 to 80,0,number from -80 to 80} from Weather scale 1

    until Weather not exists
end loop

end script LC14_WeatherLightning


begin script LC14_TempleDestroyed(whichTemple)

    VisEffect = 0
    VisColour = 0

start

    wait 2 seconds

    VisEffect = create visual effect VISUAL_EFFECT_SIREN_BEAM at {whichTemple} time 4 target {whichTemple}
    SCALE of VisEffect = 2.0
    play string sound "SCRIPT4_SEPIC_BEAMOFLIGHTSTART1"
    play string sound "SCRIPT4_SEPIC_BEAMOFLIGHT11"
    wait 0.5 second
    play string sound "SCRIPT4_SEPIC_BEAMOFLIGHTLOOP7"
    wait 3 seconds
    stop sound "SCRIPT4_SEPIC_BEAMOFLIGHTLOOP7"
    play string sound "SCRIPT2_EEPIC_EARTHQUAKECRACK"
    VisEffect = create visual effect VISUAL_EFFECT_EARTHQUAKE_STEAMVENT at {whichTemple} time 6 target {whichTemple}
    SCALE of VisEffect = 4.0
    VisEffect = create visual effect VISUAL_EFFECT_EARTHQUAKE_FLARE at {whichTemple} time 6 target {whichTemple}
    SCALE of VisEffect = 4.0
    VisEffect = create visual effect VISUAL_EFFECT_EARTHQUAKE_DUST at {whichTemple} time 6 target {whichTemple}
    SCALE of VisEffect = 3.0
    wait 5 seconds
    stop sound "SCRIPT2_EEPIC_EARTHQUAKECRACK"
    play string sound "SCRIPT1_VEPIC_EXPLOSION2"
    VisEffect = create visual effect VISUAL_EFFECT_EPIC_VOLCANO_EXPLOSION at {whichTemple} time 15 target {whichTemple}
    SCALE of VisEffect = 2.0

    if HEALTH of AztecTemple[0] < 1.0 and AztecTemple[0] exists
        delete AztecTemple[0]
        delete AztecTempleScrolls[0]
        TempleDestroyed[0] = 1
    end if
    if HEALTH of AztecTemple[1] < 1.0 and AztecTemple[1] exists
        delete AztecTemple[1]
        delete AztecTempleScrolls[1]
        TempleDestroyed[1] = 1
    end if
    if HEALTH of AztecTemple[2] < 1.0 and AztecTemple[2] exists
        delete AztecTemple[2]
        delete AztecTempleScrolls[2]
        TempleDestroyed[2] = 1
    end if

end script LC14_TempleDestroyed


begin script LC14_DeathSpell(PlayerID,SpellPosition,GodPosition)

    myEffect = 0
    myWonder = 0
    AttackingPosition = 0
    AttackingPositionFallBack = 0
    SacrificePoint = marker at {977.41,279.34,1748.11}

start

    //Effects here
    myWonder = make player 1 throw miracle MIRACLE_TYPE_METEOR from ({GodPosition} + {0,-1.25,0}) heading ({SpellPosition} + {0,0,0} - {GodPosition})
    set myWonder color red 148 green 0 blue 211
    wait 2.5 seconds
    delete myWonder

    myEffect = create visual effect VISUAL_MIRACLE_METEOR_GROUND at {SpellPosition} time 25
    set myWonder color red 148 green 0 blue 211
    SCALE of myWonder = 1.0
    wait 1.5 seconds
    myEffect = create visual effect VISUAL_MIRACLE_HEAL_GROUND at {SpellPosition}  + {0,5,0} time 25
    set myWonder color red 148 green 0 blue 211
    SCALE of myWonder = 2.5

    //Spawn Skeletons here

end script LC14_DeathSpell


begin script DisableLocalPlatoonResponse

    Counter = 0

start

begin loop
    if Counter > 99
        Counter = 0
        wait 30 seconds
    end if
    if LC14_Platoon[Counter] exists
        disable platoon LC14_Platoon[Counter] respond to local platoon attack
    end if
    if LC14_WallArcher[Counter] exists
        disable platoon LC14_WallArcher[Counter] respond to local platoon attack
    end if

    Counter++
end loop

end script DisableLocalPlatoonResponse