///////////////////////////////////////////////////////////////////////////////
//    Land 13 Aztec-Strategy
//    ~~~~~~~~~~~~~~~~~~~~~~~~~~~
//
///////////////////////////////////////////////////////////////////////////////

//TODO:
//Singing Cows, Outro

define script LC13_Aztec_Capital_Impressiveness
define script LC13_TownConversion
define script LC13_Tribute
define script LC13_GatehouseManager
define script LC13_Speeches
define script LC13_Aztec_Capital
define script LC13_AttackNearestTownTimer
define script LC13_GetNearestSettlement
define script LC13_DefendPlatoons
define script DisableLocalPlatoonResponse
define script LC13_GetPlayerUnits
define script LC13_GenericTalusSpeeches(whichUnit,PlayerOfUnit)
define script LC13_DeathSpell(PlayerID,SpellPosition,GodPosition)
define script LC13_CheckStonehenge(whichPlatoon,whichWeather)

define TalusPlatoon = 0
define TalusCatapult = 0

global AttackReady = 0
global ThrowMiracleTimer = 0
global ThunderstormTimer = 0
global MiracleTimerStarted = 0
global MiracleThunderstormStarted = 0

begin script LC13_Aztec_Capital_Impressiveness

    Threshold = 0

start

    Threshold = get town MinorTown1 impressiveness
    Threshold = Threshold / 3
    set migration threshold from MinorTown1 to PlayerTown MINOR_TOWN1_IMPRESSIVENESS - Threshold

    Threshold = get town MinorTown2 impressiveness
    Threshold = Threshold / 3
    set migration threshold from MinorTown2 to PlayerTown MINOR_TOWN2_IMPRESSIVENESS - Threshold

    Threshold = get town MinorTown3 impressiveness
    Threshold = Threshold / 3
    set migration threshold from MinorTown3 to PlayerTown MINOR_TOWN3_IMPRESSIVENESS - Threshold

    Threshold = get town MinorTown4 impressiveness
    Threshold = Threshold / 3
    set migration threshold from MinorTown4 to PlayerTown MINOR_TOWN4_IMPRESSIVENESS - Threshold

    Threshold = get town MinorTown5 impressiveness
    Threshold = Threshold / 3
    set migration threshold from MinorTown5 to PlayerTown MINOR_TOWN5_IMPRESSIVENESS - Threshold

    Threshold = get town MinorTown6 impressiveness
    Threshold = Threshold / 3
    set migration threshold from MinorTown6 to PlayerTown MINOR_TOWN6_IMPRESSIVENESS - Threshold

    Threshold = get town MinorTown7 impressiveness
    Threshold = Threshold / 3
    set migration threshold from MinorTown7 to PlayerTown MINOR_TOWN7_IMPRESSIVENESS - Threshold

    Threshold = get town MinorTown8 impressiveness
    Threshold = Threshold / 3
    set migration threshold from MinorTown8 to PlayerTown MINOR_TOWN8_IMPRESSIVENESS - Threshold

    Threshold = get town AztecTown1 impressiveness
    Threshold = Threshold / 3
    set migration threshold from AztecTown1 to PlayerTown AZTECTOWN1_IMPRESSIVENESS - Threshold

    Threshold = get town AztecTown2 impressiveness
    Threshold = Threshold / 3
    set migration threshold from AztecTown2 to PlayerTown AZTECTOWN2_IMPRESSIVENESS - Threshold

    Threshold = get town AztecCapital impressiveness
    Threshold = Threshold / 3
    set migration threshold from AztecCapital to PlayerTown AZTECCAPITAL_IMPRESSIVENESS - Threshold

begin loop

    if PLAYER of MinorTown1 == 0
        enable migration from MinorTown2 to MinorTown1
        enable migration from MinorTown3 to MinorTown1
        enable migration from MinorTown4 to MinorTown1
        enable migration from MinorTown5 to MinorTown1
        enable migration from MinorTown6 to MinorTown1
        enable migration from MinorTown7 to MinorTown1
        enable migration from MinorTown8 to MinorTown1
        enable migration from AztecTown1 to MinorTown1
        enable migration from AztecTown2 to MinorTown1
        enable migration from AztecCapital to MinorTown1
        
    elsif PLAYER of MinorTown1 >= 1
        disable migration from MinorTown2 to MinorTown1
        disable migration from MinorTown3 to MinorTown1
        disable migration from MinorTown4 to MinorTown1
        disable migration from MinorTown5 to MinorTown1
        disable migration from MinorTown6 to MinorTown1
        disable migration from MinorTown7 to MinorTown1
        disable migration from MinorTown8 to MinorTown1
        disable migration from AztecTown1 to MinorTown1
        disable migration from AztecTown2 to MinorTown1
        disable migration from AztecCapital to MinorTown1
    end if

    if PLAYER of MinorTown2 == 0
        enable migration from MinorTown1 to MinorTown2
        enable migration from MinorTown3 to MinorTown2
        enable migration from MinorTown4 to MinorTown2
        enable migration from MinorTown5 to MinorTown2
        enable migration from MinorTown6 to MinorTown2
        enable migration from MinorTown7 to MinorTown2
        enable migration from MinorTown8 to MinorTown2
        enable migration from AztecTown1 to MinorTown2
        enable migration from AztecTown2 to MinorTown2
        enable migration from AztecCapital to MinorTown2
        
    elsif PLAYER of MinorTown2 >= 1
        disable migration from MinorTown1 to MinorTown2
        disable migration from MinorTown3 to MinorTown2
        disable migration from MinorTown4 to MinorTown2
        disable migration from MinorTown5 to MinorTown2
        disable migration from MinorTown6 to MinorTown2
        disable migration from MinorTown7 to MinorTown2
        disable migration from MinorTown8 to MinorTown2
        disable migration from AztecTown1 to MinorTown2
        disable migration from AztecTown2 to MinorTown2
        disable migration from AztecCapital to MinorTown2
    end if

    if PLAYER of MinorTown3 == 0
        enable migration from MinorTown1 to MinorTown3
        enable migration from MinorTown2 to MinorTown3
        enable migration from MinorTown4 to MinorTown3
        enable migration from MinorTown5 to MinorTown3
        enable migration from MinorTown6 to MinorTown3
        enable migration from MinorTown7 to MinorTown3
        enable migration from MinorTown8 to MinorTown3
        enable migration from AztecTown1 to MinorTown3
        enable migration from AztecTown2 to MinorTown3
        enable migration from AztecCapital to MinorTown3
        
    elsif PLAYER of MinorTown3 >= 1
        disable migration from MinorTown1 to MinorTown3
        disable migration from MinorTown2 to MinorTown3
        disable migration from MinorTown4 to MinorTown3
        disable migration from MinorTown5 to MinorTown3
        disable migration from MinorTown6 to MinorTown3
        disable migration from MinorTown7 to MinorTown3
        disable migration from MinorTown8 to MinorTown3
        disable migration from AztecTown1 to MinorTown3
        disable migration from AztecTown2 to MinorTown3
        disable migration from AztecCapital to MinorTown3
    end if

    if PLAYER of MinorTown4 == 0
        enable migration from MinorTown1 to MinorTown4
        enable migration from MinorTown2 to MinorTown4
        enable migration from MinorTown3 to MinorTown4
        enable migration from MinorTown5 to MinorTown4
        enable migration from MinorTown6 to MinorTown4
        enable migration from MinorTown7 to MinorTown4
        enable migration from MinorTown8 to MinorTown4
        enable migration from AztecTown1 to MinorTown4
        enable migration from AztecTown2 to MinorTown4
        enable migration from AztecCapital to MinorTown4
        
    elsif PLAYER of MinorTown4 >= 1
        disable migration from MinorTown1 to MinorTown4
        disable migration from MinorTown2 to MinorTown4
        disable migration from MinorTown3 to MinorTown4
        disable migration from MinorTown5 to MinorTown4
        disable migration from MinorTown6 to MinorTown4
        disable migration from MinorTown7 to MinorTown4
        disable migration from MinorTown8 to MinorTown4
        disable migration from AztecTown1 to MinorTown4
        disable migration from AztecTown2 to MinorTown4
        disable migration from AztecCapital to MinorTown4
    end if

    if PLAYER of MinorTown5 == 0
        enable migration from MinorTown1 to MinorTown5
        enable migration from MinorTown2 to MinorTown5
        enable migration from MinorTown3 to MinorTown5
        enable migration from MinorTown4 to MinorTown5
        enable migration from MinorTown6 to MinorTown5
        enable migration from MinorTown7 to MinorTown5
        enable migration from MinorTown8 to MinorTown5
        enable migration from AztecTown1 to MinorTown5
        enable migration from AztecTown2 to MinorTown5
        enable migration from AztecCapital to MinorTown5
        
    elsif PLAYER of MinorTown5 >= 1
        disable migration from MinorTown1 to MinorTown5
        disable migration from MinorTown2 to MinorTown5
        disable migration from MinorTown3 to MinorTown5
        disable migration from MinorTown4 to MinorTown5
        disable migration from MinorTown6 to MinorTown5
        disable migration from MinorTown7 to MinorTown5
        disable migration from MinorTown8 to MinorTown5
        disable migration from AztecTown1 to MinorTown5
        disable migration from AztecTown2 to MinorTown5
        disable migration from AztecCapital to MinorTown5
    end if

    if PLAYER of MinorTown6 == 0
        enable migration from MinorTown1 to MinorTown6
        enable migration from MinorTown2 to MinorTown6
        enable migration from MinorTown3 to MinorTown6
        enable migration from MinorTown4 to MinorTown6
        enable migration from MinorTown5 to MinorTown6
        enable migration from MinorTown7 to MinorTown6
        enable migration from MinorTown8 to MinorTown6
        enable migration from AztecTown1 to MinorTown6
        enable migration from AztecTown2 to MinorTown6
        enable migration from AztecCapital to MinorTown6
        
    elsif PLAYER of MinorTown6 >= 1
        disable migration from MinorTown1 to MinorTown6
        disable migration from MinorTown2 to MinorTown6
        disable migration from MinorTown3 to MinorTown6
        disable migration from MinorTown4 to MinorTown6
        disable migration from MinorTown5 to MinorTown6
        disable migration from MinorTown7 to MinorTown6
        disable migration from MinorTown8 to MinorTown6
        disable migration from AztecTown1 to MinorTown6
        disable migration from AztecTown2 to MinorTown6
        disable migration from AztecCapital to MinorTown6
    end if

    if PLAYER of MinorTown7 == 0
        enable migration from MinorTown1 to MinorTown7
        enable migration from MinorTown2 to MinorTown7
        enable migration from MinorTown3 to MinorTown7
        enable migration from MinorTown4 to MinorTown7
        enable migration from MinorTown5 to MinorTown7
        enable migration from MinorTown6 to MinorTown7
        enable migration from MinorTown8 to MinorTown7
        enable migration from AztecTown1 to MinorTown7
        enable migration from AztecTown2 to MinorTown7
        enable migration from AztecCapital to MinorTown7
        
    elsif PLAYER of MinorTown7 >= 1
        disable migration from MinorTown1 to MinorTown7
        disable migration from MinorTown2 to MinorTown7
        disable migration from MinorTown3 to MinorTown7
        disable migration from MinorTown4 to MinorTown7
        disable migration from MinorTown5 to MinorTown7
        disable migration from MinorTown6 to MinorTown7
        disable migration from MinorTown8 to MinorTown7
        disable migration from AztecTown1 to MinorTown7
        disable migration from AztecTown2 to MinorTown7
        disable migration from AztecCapital to MinorTown7
    end if

    if PLAYER of MinorTown8 == 0
        enable migration from MinorTown1 to MinorTown8
        enable migration from MinorTown2 to MinorTown8
        enable migration from MinorTown3 to MinorTown8
        enable migration from MinorTown4 to MinorTown8
        enable migration from MinorTown5 to MinorTown8
        enable migration from MinorTown6 to MinorTown8
        enable migration from MinorTown7 to MinorTown8
        enable migration from AztecTown1 to MinorTown8
        enable migration from AztecTown2 to MinorTown8
        enable migration from AztecCapital to MinorTown8
        
    elsif PLAYER of MinorTown8 >= 1
        disable migration from MinorTown1 to MinorTown8
        disable migration from MinorTown2 to MinorTown8
        disable migration from MinorTown3 to MinorTown8
        disable migration from MinorTown4 to MinorTown8
        disable migration from MinorTown5 to MinorTown8
        disable migration from MinorTown6 to MinorTown8
        disable migration from MinorTown7 to MinorTown8
        disable migration from AztecTown1 to MinorTown8
        disable migration from AztecTown2 to MinorTown8
        disable migration from AztecCapital to MinorTown8
    end if

    if PLAYER of AztecTown1 == 0
        enable migration from MinorTown1 to AztecTown1
        enable migration from MinorTown2 to AztecTown1
        enable migration from MinorTown3 to AztecTown1
        enable migration from MinorTown4 to AztecTown1
        enable migration from MinorTown5 to AztecTown1
        enable migration from MinorTown6 to AztecTown1
        enable migration from MinorTown7 to AztecTown1
        enable migration from MinorTown8 to AztecTown1
        enable migration from AztecTown2 to AztecTown1
        enable migration from AztecCapital to AztecTown1
        
    elsif PLAYER of AztecTown1 >= 1
        disable migration from MinorTown1 to AztecTown1
        disable migration from MinorTown2 to AztecTown1
        disable migration from MinorTown3 to AztecTown1
        disable migration from MinorTown4 to AztecTown1
        disable migration from MinorTown5 to AztecTown1
        disable migration from MinorTown6 to AztecTown1
        disable migration from MinorTown7 to AztecTown1
        disable migration from MinorTown8 to AztecTown1
        disable migration from AztecTown2 to AztecTown1
        disable migration from AztecCapital to AztecTown1
    end if

    if PLAYER of AztecTown2 == 0
        enable migration from MinorTown1 to AztecTown2
        enable migration from MinorTown2 to AztecTown2
        enable migration from MinorTown3 to AztecTown2
        enable migration from MinorTown4 to AztecTown2
        enable migration from MinorTown5 to AztecTown2
        enable migration from MinorTown6 to AztecTown2
        enable migration from MinorTown7 to AztecTown2
        enable migration from MinorTown8 to AztecTown2
        enable migration from AztecTown1 to AztecTown2
        enable migration from AztecCapital to AztecTown2
        
    elsif PLAYER of AztecTown2 >= 1
        disable migration from MinorTown1 to AztecTown2
        disable migration from MinorTown2 to AztecTown2
        disable migration from MinorTown3 to AztecTown2
        disable migration from MinorTown4 to AztecTown2
        disable migration from MinorTown5 to AztecTown2
        disable migration from MinorTown6 to AztecTown2
        disable migration from MinorTown7 to AztecTown2
        disable migration from MinorTown8 to AztecTown2
        disable migration from AztecTown1 to AztecTown2
        disable migration from AztecCapital to AztecTown2
    end if

    if PLAYER of AztecCapital == 0
        enable migration from MinorTown1 to AztecCapital
        enable migration from MinorTown2 to AztecCapital
        enable migration from MinorTown3 to AztecCapital
        enable migration from MinorTown4 to AztecCapital
        enable migration from MinorTown5 to AztecCapital
        enable migration from MinorTown6 to AztecCapital
        enable migration from MinorTown7 to AztecCapital
        enable migration from MinorTown8 to AztecCapital
        enable migration from AztecTown1 to AztecCapital
        enable migration from AztecTown2 to AztecCapital
        
    elsif PLAYER of AztecCapital >= 1
        disable migration from MinorTown1 to AztecCapital
        disable migration from MinorTown2 to AztecCapital
        disable migration from MinorTown3 to AztecCapital
        disable migration from MinorTown4 to AztecCapital
        disable migration from MinorTown5 to AztecCapital
        disable migration from MinorTown6 to AztecCapital
        disable migration from MinorTown7 to AztecCapital
        disable migration from MinorTown8 to AztecCapital
        disable migration from AztecTown1 to AztecCapital
        disable migration from AztecTown2 to AztecCapital
    end if

end loop

end script LC13_Aztec_Capital_Impressiveness

begin script LC13_TownConversion

    isConverted1 = 0
    isConverted2 = 0
    isConverted3 = 0
    isConverted4 = 0
    isConverted5 = 0
    isConverted6 = 0
    isConverted7 = 0
    isConverted8 = 0
    isConverted9 = 0
    isConverted10 = 0
    isConverted11 = 0
    isConverted12 = 0
    a = 0
    b = 0
    c = 0
    d = 0
    e = 0
    f = 0
    g = 0
    h = 0
    i = 0
    j = 0
    k = 0
    l = 0
    
start

begin loop

    isConverted1 = variable get town MinorTown1 method of last conversion
    isConverted2 = variable get town MinorTown2 method of last conversion
    isConverted3 = variable get town MinorTown3 method of last conversion
    isConverted4 = variable get town MinorTown4 method of last conversion
    isConverted5 = variable get town MinorTown5 method of last conversion
    isConverted6 = variable get town MinorTown6 method of last conversion
    isConverted7 = variable get town MinorTown7 method of last conversion
    isConverted8 = variable get town MinorTown8 method of last conversion
    isConverted9 = variable get town AztecTown1 method of last conversion
    isConverted10 = variable get town AztecTown2 method of last conversion
    isConverted12 = variable get town AztecCapital method of last conversion

    if isConverted1 != 0 and a == 0
        if PLAYER of MinorTown1 == 0 or get town MinorTown1 is migrating to == PlayerTown
            a = 1
            TownsConverted = TownsConverted + 1
            if isConverted1 == 1
                TownsAggressiveConverted = TownsAggressiveConverted + 1
            elsif isConverted1 == 2
                TownsPeacefulConverted = TownsPeacefulConverted + 1
            end if
        end if
    end if

    if isConverted1 != 0
        if PLAYER of AztecCapital == 1
            disable migration from MinorTown1 to MinorTown2
            disable migration from MinorTown1 to MinorTown3
            disable migration from MinorTown1 to MinorTown4
            disable migration from MinorTown1 to MinorTown5
            disable migration from MinorTown1 to MinorTown6
            disable migration from MinorTown1 to MinorTown7
            disable migration from MinorTown1 to MinorTown8
            disable migration from MinorTown1 to AztecTown1
            disable migration from MinorTown1 to AztecTown2
            disable migration from MinorTown1 to AztecCapital
            disable migration from MinorTown1 to PlayerTown
        else
            enable migration from MinorTown1 to MinorTown2
            enable migration from MinorTown1 to MinorTown3
            enable migration from MinorTown1 to MinorTown4
            enable migration from MinorTown1 to MinorTown5
            enable migration from MinorTown1 to MinorTown6
            enable migration from MinorTown1 to MinorTown7
            enable migration from MinorTown1 to MinorTown8
            enable migration from MinorTown1 to AztecTown1
            enable migration from MinorTown1 to AztecTown2
            enable migration from MinorTown1 to AztecCapital
            enable migration from MinorTown1 to PlayerTown
        end if
    end if
    
    if isConverted2 != 0 and b == 0
        if PLAYER of MinorTown2 == 0 or get town MinorTown2 is migrating to == PlayerTown
            b = 1
            TownsConverted = TownsConverted + 1
            if isConverted2 == 1
                TownsAggressiveConverted = TownsAggressiveConverted + 1
            elsif isConverted2 == 2
                TownsPeacefulConverted = TownsPeacefulConverted + 1
            end if
        end if
    end if

    if isConverted2 != 0
        if PLAYER of AztecCapital == 1
            disable migration from MinorTown2 to MinorTown1
            disable migration from MinorTown2 to MinorTown3
            disable migration from MinorTown2 to MinorTown4
            disable migration from MinorTown2 to MinorTown5
            disable migration from MinorTown2 to MinorTown6
            disable migration from MinorTown2 to MinorTown7
            disable migration from MinorTown2 to MinorTown8
            disable migration from MinorTown2 to AztecTown1
            disable migration from MinorTown2 to AztecTown2
            disable migration from MinorTown2 to AztecCapital
            disable migration from MinorTown2 to PlayerTown
        else
            enable migration from MinorTown2 to MinorTown1
            enable migration from MinorTown2 to MinorTown3
            enable migration from MinorTown2 to MinorTown4
            enable migration from MinorTown2 to MinorTown5
            enable migration from MinorTown2 to MinorTown6
            enable migration from MinorTown2 to MinorTown7
            enable migration from MinorTown2 to MinorTown8
            enable migration from MinorTown2 to AztecTown1
            enable migration from MinorTown2 to AztecTown2
            enable migration from MinorTown2 to AztecCapital
            enable migration from MinorTown2 to PlayerTown
        end if
    end if
    
    if isConverted3 != 0 and c == 0
        if PLAYER of MinorTown3 == 0 or get town MinorTown3 is migrating to == PlayerTown
            c = 1
            TownsConverted = TownsConverted + 1
            if isConverted3 == 1
                TownsAggressiveConverted = TownsAggressiveConverted + 1
            elsif isConverted3 == 2
                TownsPeacefulConverted = TownsPeacefulConverted + 1
            end if
        end if
    end if

    if isConverted3 != 0
        if PLAYER of AztecCapital == 1
            disable migration from MinorTown3 to MinorTown1
            disable migration from MinorTown3 to MinorTown2
            disable migration from MinorTown3 to MinorTown4
            disable migration from MinorTown3 to MinorTown5
            disable migration from MinorTown3 to MinorTown6
            disable migration from MinorTown3 to MinorTown7
            disable migration from MinorTown3 to MinorTown8
            disable migration from MinorTown3 to AztecTown1
            disable migration from MinorTown3 to AztecTown2
            disable migration from MinorTown3 to AztecCapital
            disable migration from MinorTown3 to PlayerTown
        else
            enable migration from MinorTown3 to MinorTown1
            enable migration from MinorTown3 to MinorTown2
            enable migration from MinorTown3 to MinorTown4
            enable migration from MinorTown3 to MinorTown5
            enable migration from MinorTown3 to MinorTown6
            enable migration from MinorTown3 to MinorTown7
            enable migration from MinorTown3 to MinorTown8
            enable migration from MinorTown3 to AztecTown1
            enable migration from MinorTown3 to AztecTown2
            enable migration from MinorTown3 to AztecCapital
            enable migration from MinorTown3 to PlayerTown
        end if
    end if
    
    if isConverted4 != 0 and d == 0
        if PLAYER of MinorTown4 == 0 or get town MinorTown4 is migrating to == PlayerTown
            d = 1
            TownsConverted = TownsConverted + 1
            if isConverted4 == 1
                TownsAggressiveConverted = TownsAggressiveConverted + 1
            elsif isConverted4 == 2
                TownsPeacefulConverted = TownsPeacefulConverted + 1
            end if
        end if
    end if

    if isConverted4 != 0
        if PLAYER of AztecCapital == 1
            disable migration from MinorTown4 to MinorTown1
            disable migration from MinorTown4 to MinorTown2
            disable migration from MinorTown4 to MinorTown3
            disable migration from MinorTown4 to MinorTown5
            disable migration from MinorTown4 to MinorTown6
            disable migration from MinorTown4 to MinorTown7
            disable migration from MinorTown4 to MinorTown8
            disable migration from MinorTown4 to AztecTown1
            disable migration from MinorTown4 to AztecTown2
            disable migration from MinorTown4 to AztecCapital
            disable migration from MinorTown4 to PlayerTown
        else
            enable migration from MinorTown4 to MinorTown1
            enable migration from MinorTown4 to MinorTown2
            enable migration from MinorTown4 to MinorTown3
            enable migration from MinorTown4 to MinorTown5
            enable migration from MinorTown4 to MinorTown6
            enable migration from MinorTown4 to MinorTown7
            enable migration from MinorTown4 to MinorTown8
            enable migration from MinorTown4 to AztecTown1
            enable migration from MinorTown4 to AztecTown2
            enable migration from MinorTown4 to AztecCapital
            enable migration from MinorTown4 to PlayerTown
        end if
    end if
    
    if isConverted5 != 0 and e == 0
        if PLAYER of MinorTown5 == 0 or get town MinorTown5 is migrating to == PlayerTown
            e = 1
            TownsConverted = TownsConverted + 1
            if isConverted5 == 1
                TownsAggressiveConverted = TownsAggressiveConverted + 1
            elsif isConverted5 == 2
                TownsPeacefulConverted = TownsPeacefulConverted + 1
            end if
        end if
    end if

    if isConverted5 != 0
        if PLAYER of AztecCapital == 1
            disable migration from MinorTown5 to MinorTown1
            disable migration from MinorTown5 to MinorTown2
            disable migration from MinorTown5 to MinorTown3
            disable migration from MinorTown5 to MinorTown4
            disable migration from MinorTown5 to MinorTown6
            disable migration from MinorTown5 to MinorTown7
            disable migration from MinorTown5 to MinorTown8
            disable migration from MinorTown5 to AztecTown1
            disable migration from MinorTown5 to AztecTown2
            disable migration from MinorTown5 to AztecCapital
            disable migration from MinorTown5 to PlayerTown
        else
            enable migration from MinorTown5 to MinorTown1
            enable migration from MinorTown5 to MinorTown2
            enable migration from MinorTown5 to MinorTown3
            enable migration from MinorTown5 to MinorTown4
            enable migration from MinorTown5 to MinorTown6
            enable migration from MinorTown5 to MinorTown7
            enable migration from MinorTown5 to MinorTown8
            enable migration from MinorTown5 to AztecTown1
            enable migration from MinorTown5 to AztecTown2
            enable migration from MinorTown5 to AztecCapital
            enable migration from MinorTown5 to PlayerTown
        end if
    end if
    
    if isConverted6 != 0 and f == 0
        if PLAYER of MinorTown6 == 0 or get town MinorTown6 is migrating to == PlayerTown
            f = 1
            TownsConverted = TownsConverted + 1
            if isConverted6 == 1
                TownsAggressiveConverted = TownsAggressiveConverted + 1
            elsif isConverted6 == 2
                TownsPeacefulConverted = TownsPeacefulConverted + 1
            end if
        end if
    end if

    if isConverted6 != 0
        if PLAYER of AztecCapital == 1
            disable migration from MinorTown6 to MinorTown1
            disable migration from MinorTown6 to MinorTown2
            disable migration from MinorTown6 to MinorTown3
            disable migration from MinorTown6 to MinorTown4
            disable migration from MinorTown6 to MinorTown5
            disable migration from MinorTown6 to MinorTown7
            disable migration from MinorTown6 to MinorTown8
            disable migration from MinorTown6 to AztecTown1
            disable migration from MinorTown6 to AztecTown2
            disable migration from MinorTown6 to AztecCapital
            disable migration from MinorTown6 to PlayerTown
        else
            enable migration from MinorTown6 to MinorTown1
            enable migration from MinorTown6 to MinorTown2
            enable migration from MinorTown6 to MinorTown3
            enable migration from MinorTown6 to MinorTown4
            enable migration from MinorTown6 to MinorTown5
            enable migration from MinorTown6 to MinorTown7
            enable migration from MinorTown6 to MinorTown8
            enable migration from MinorTown6 to AztecTown1
            enable migration from MinorTown6 to AztecTown2
            enable migration from MinorTown6 to AztecCapital
            enable migration from MinorTown6 to PlayerTown
        end if
    end if
    
    if isConverted7 != 0 and g == 0
        if PLAYER of MinorTown7 == 0 or get town MinorTown7 is migrating to == PlayerTown
            g = 1
            TownsConverted = TownsConverted + 1
            if isConverted7 == 1
                TownsAggressiveConverted = TownsAggressiveConverted + 1
            elsif isConverted7 == 2
                TownsPeacefulConverted = TownsPeacefulConverted + 1
            end if
        end if
    end if    

    if isConverted7 != 0
        if PLAYER of AztecCapital == 1
            disable migration from MinorTown7 to MinorTown1
            disable migration from MinorTown7 to MinorTown2
            disable migration from MinorTown7 to MinorTown3
            disable migration from MinorTown7 to MinorTown4
            disable migration from MinorTown7 to MinorTown5
            disable migration from MinorTown7 to MinorTown6
            disable migration from MinorTown7 to MinorTown8
            disable migration from MinorTown7 to AztecTown1
            disable migration from MinorTown7 to AztecTown2
            disable migration from MinorTown7 to AztecCapital
            disable migration from MinorTown7 to PlayerTown
        else
            enable migration from MinorTown7 to MinorTown1
            enable migration from MinorTown7 to MinorTown2
            enable migration from MinorTown7 to MinorTown3
            enable migration from MinorTown7 to MinorTown4
            enable migration from MinorTown7 to MinorTown5
            enable migration from MinorTown7 to MinorTown6
            enable migration from MinorTown7 to MinorTown8
            enable migration from MinorTown7 to AztecTown1
            enable migration from MinorTown7 to AztecTown2
            enable migration from MinorTown7 to AztecCapital
            enable migration from MinorTown7 to PlayerTown
        end if
    end if
    
    if isConverted8 != 0 and h == 0
        if PLAYER of MinorTown8 == 0 or get town MinorTown8 is migrating to == PlayerTown
            h = 1
            TownsConverted = TownsConverted + 1
            if isConverted8 == 1
                TownsAggressiveConverted = TownsAggressiveConverted + 1
            elsif isConverted8 == 2
                TownsPeacefulConverted = TownsPeacefulConverted + 1
            end if
        end if
    end if

    if isConverted8 != 0
        if PLAYER of AztecCapital == 1
            disable migration from MinorTown8 to MinorTown1
            disable migration from MinorTown8 to MinorTown2
            disable migration from MinorTown8 to MinorTown3
            disable migration from MinorTown8 to MinorTown4
            disable migration from MinorTown8 to MinorTown5
            disable migration from MinorTown8 to MinorTown6
            disable migration from MinorTown8 to MinorTown7
            disable migration from MinorTown8 to AztecTown1
            disable migration from MinorTown8 to AztecTown2
            disable migration from MinorTown8 to AztecCapital
            disable migration from MinorTown8 to PlayerTown
        else
            enable migration from MinorTown8 to MinorTown1
            enable migration from MinorTown8 to MinorTown2
            enable migration from MinorTown8 to MinorTown3
            enable migration from MinorTown8 to MinorTown4
            enable migration from MinorTown8 to MinorTown5
            enable migration from MinorTown8 to MinorTown6
            enable migration from MinorTown8 to MinorTown7
            enable migration from MinorTown8 to AztecTown1
            enable migration from MinorTown8 to AztecTown2
            enable migration from MinorTown8 to AztecCapital
            enable migration from MinorTown8 to PlayerTown
        end if
    end if
    
    if isConverted9 != 0 and i == 0
        if PLAYER of AztecTown1 == 0 or get town AztecTown1 is migrating to == PlayerTown
            i = 1
            TownsConverted = TownsConverted + 1
            if isConverted9 == 1
                TownsAggressiveConverted = TownsAggressiveConverted + 1
            elsif isConverted9 == 2
                TownsPeacefulConverted = TownsPeacefulConverted + 1
            end if
        end if
    end if

    if isConverted9 != 0
        if PLAYER of AztecCapital == 1
            disable migration from AztecTown1 to MinorTown1
            disable migration from AztecTown1 to MinorTown2
            disable migration from AztecTown1 to MinorTown3
            disable migration from AztecTown1 to MinorTown4
            disable migration from AztecTown1 to MinorTown5
            disable migration from AztecTown1 to MinorTown6
            disable migration from AztecTown1 to MinorTown7
            disable migration from AztecTown1 to MinorTown8
            disable migration from AztecTown1 to AztecTown2
            disable migration from AztecTown1 to AztecCapital
            disable migration from AztecTown1 to PlayerTown
        else
            enable migration from AztecTown1 to MinorTown1
            enable migration from AztecTown1 to MinorTown2
            enable migration from AztecTown1 to MinorTown3
            enable migration from AztecTown1 to MinorTown4
            enable migration from AztecTown1 to MinorTown5
            enable migration from AztecTown1 to MinorTown6
            enable migration from AztecTown1 to MinorTown7
            enable migration from AztecTown1 to MinorTown8
            enable migration from AztecTown1 to AztecTown2
            enable migration from AztecTown1 to AztecCapital
            enable migration from AztecTown1 to PlayerTown
        end if
    end if
    
    if isConverted10 != 0 and j == 0
        if PLAYER of AztecTown2 == 0 or get town AztecTown2 is migrating to == PlayerTown
            j = 1
            TownsConverted = TownsConverted + 1
            if isConverted10 == 1
                TownsAggressiveConverted = TownsAggressiveConverted + 1
            elsif isConverted10 == 2
                TownsPeacefulConverted = TownsPeacefulConverted + 1
            end if
        end if
    end if

    if isConverted10 != 0
        if PLAYER of AztecCapital == 1
            disable migration from AztecTown2 to MinorTown1
            disable migration from AztecTown2 to MinorTown2
            disable migration from AztecTown2 to MinorTown3
            disable migration from AztecTown2 to MinorTown4
            disable migration from AztecTown2 to MinorTown5
            disable migration from AztecTown2 to MinorTown6
            disable migration from AztecTown2 to MinorTown7
            disable migration from AztecTown2 to MinorTown8
            disable migration from AztecTown2 to AztecTown1
            disable migration from AztecTown2 to AztecCapital
            disable migration from AztecTown2 to PlayerTown
        else
            enable migration from AztecTown2 to MinorTown1
            enable migration from AztecTown2 to MinorTown2
            enable migration from AztecTown2 to MinorTown3
            enable migration from AztecTown2 to MinorTown4
            enable migration from AztecTown2 to MinorTown5
            enable migration from AztecTown2 to MinorTown6
            enable migration from AztecTown2 to MinorTown7
            enable migration from AztecTown2 to MinorTown8
            enable migration from AztecTown2 to AztecTown1
            enable migration from AztecTown2 to AztecCapital
            enable migration from AztecTown2 to PlayerTown
        end if
    end if
    
    if isConverted12 != 0 and l == 0
        if PLAYER of AztecCapital == 0 or get town AztecCapital is migrating to == PlayerTown
            l = 1
            TownsConverted = TownsConverted + 1
            if isConverted12 == 1
                TownsAggressiveConverted = TownsAggressiveConverted + 1
            elsif isConverted12 == 2
                TownsPeacefulConverted = TownsPeacefulConverted + 1
            end if
        end if
    end if    

    if isConverted12 != 0
        if PLAYER of AztecCapital == 1
            disable migration from AztecCapital to MinorTown1
            disable migration from AztecCapital to MinorTown2
            disable migration from AztecCapital to MinorTown3
            disable migration from AztecCapital to MinorTown4
            disable migration from AztecCapital to MinorTown5
            disable migration from AztecCapital to MinorTown6
            disable migration from AztecCapital to MinorTown7
            disable migration from AztecCapital to MinorTown8
            disable migration from AztecCapital to AztecTown1
            disable migration from AztecCapital to AztecTown2
            disable migration from AztecCapital to PlayerTown
        else
            enable migration from AztecCapital to MinorTown1
            enable migration from AztecCapital to MinorTown2
            enable migration from AztecCapital to MinorTown3
            enable migration from AztecCapital to MinorTown4
            enable migration from AztecCapital to MinorTown5
            enable migration from AztecCapital to MinorTown6
            enable migration from AztecCapital to MinorTown7
            enable migration from AztecCapital to MinorTown8
            enable migration from AztecCapital to AztecTown1
            enable migration from AztecCapital to AztecTown2
            enable migration from AztecCapital to PlayerTown
        end if
    end if
end loop
    
end script LC13_TownConversion

begin script LC13_Tribute

    mig1 = 0
    mig2 = 0
    mig3 = 0
    mig4 = 0
    mig5 = 0
    mig6 = 0
    mig7 = 0
    mig8 = 0
    mig9 = 0
    mig10 = 0
    mig11 = 0
    mig12 = 0
    a = 0

start

begin loop

    if (variable get town MinorTown1 status == variable MIGRATION_MIGRATED) and mig1 == 0 and get town MinorTown1 has migrated to == PlayerTown
        mig1 = 1
        MigrationsAccepted = MigrationsAccepted + 1
    end if
    
    if (variable get town MinorTown2 status == variable MIGRATION_MIGRATED) and mig2 == 0 and get town MinorTown2 has migrated to == PlayerTown
        mig2 = 1
        MigrationsAccepted = MigrationsAccepted + 1
    end if
    
    if (variable get town MinorTown3 status == variable MIGRATION_MIGRATED) and mig3 == 0 and get town MinorTown3 has migrated to == PlayerTown
        mig3 = 1
        MigrationsAccepted = MigrationsAccepted + 1
    end if
    
    if (variable get town MinorTown4 status == variable MIGRATION_MIGRATED) and mig4 == 0 and get town MinorTown4 has migrated to == PlayerTown
        mig4 = 1
        MigrationsAccepted = MigrationsAccepted + 1
    end if
    
    if (variable get town MinorTown5 status == variable MIGRATION_MIGRATED) and mig5 == 0 and get town MinorTown5 has migrated to == PlayerTown
        mig5 = 1
        MigrationsAccepted = MigrationsAccepted + 1
    end if
    
    if (variable get town MinorTown6 status == variable MIGRATION_MIGRATED) and mig6 == 0 and get town MinorTown6 has migrated to == PlayerTown
        mig6 = 1
        MigrationsAccepted = MigrationsAccepted + 1
    end if
    
    if (variable get town MinorTown7 status == variable MIGRATION_MIGRATED) and mig7 == 0 and get town MinorTown7 has migrated to == PlayerTown
        mig7 = 1
        MigrationsAccepted = MigrationsAccepted + 1
    end if
    
    if (variable get town MinorTown8 status == variable MIGRATION_MIGRATED) and mig8 == 0 and get town MinorTown8 has migrated to == PlayerTown
        mig8 = 1
        MigrationsAccepted = MigrationsAccepted + 1
    end if
    
    if (variable get town AztecTown1 status == variable MIGRATION_MIGRATED) and mig9 == 0 and get town AztecTown1 has migrated to == PlayerTown
        mig9 = 1
        MigrationsAccepted = MigrationsAccepted + 1
    end if
    
    if (variable get town AztecTown2 status == variable MIGRATION_MIGRATED) and mig10 == 0 and get town AztecTown2 has migrated to == PlayerTown
        mig10 = 1
        MigrationsAccepted = MigrationsAccepted + 1
    end if
    
    if (variable get town AztecCapital status == variable MIGRATION_MIGRATED) and mig11 == 0 and get town AztecCapital has migrated to == PlayerTown
        mig11 = 1
        MigrationsAccepted = MigrationsAccepted + 1
    end if

    if MigrationsAccepted >= 1 and a == 0
        a = 1
        increment tribute by 5000
    end if
    
    if MigrationsAccepted >= 2 and a == 1
        a = 2
        increment tribute by 5000
    end if
    
    if MigrationsAccepted >= 3 and a == 2
        a = 3
        increment tribute by 10000
    end if
    
    if MigrationsAccepted >= 4 and a == 3
        a = 4
        increment tribute by 10000
    end if
    
    if MigrationsAccepted >= 5 and a == 4
        a = 5
        increment tribute by 10000
    end if
    
    if MigrationsAccepted >= 6 and a == 5
        a = 6
        increment tribute by 15000
    end if
    
    if MigrationsAccepted >= 7 and a == 6
        a = 7
        increment tribute by 15000
    end if
    
    if MigrationsAccepted >= 8 and a == 7
        a = 8
        increment tribute by 15000
    end if
    
    if MigrationsAccepted >= 9 and a == 8
        a = 9
        increment tribute by 20000
    end if
    
    if MigrationsAccepted >= 10 and a == 9
        a = 10
        increment tribute by 20000
    end if
    
    if MigrationsAccepted >= 11 and a == 10
        a = 11
        increment tribute by 25000
    end if
    
end loop

end script LC13_Tribute

begin script LC13_GatehouseManager

    GateHouseT11 = 0
    GateHouseT12 = 0
    GateHouseT13 = 0
    GateHouseT14 = 0
    GateHouseT15 = 0
    GateHouseT16 = 0
    GateHouseT17 = 0
    GateHouseT21 = 0
    GateHouseT22 = 0

    Counter = 0
    Cnt = 0

    oCreature = get player 0 creature

    PlayerPlatoonT11 = 0
    CatapultT11 = 0
    TestCreatureT11 = 0
    PlayerPlatoonT12 = 0
    CatapultT12 = 0
    TestCreatureT12 = 0
    PlayerPlatoonT13 = 0
    CatapultT13 = 0
    TestCreatureT13 = 0
    PlayerPlatoonT14 = 0
    CatapultT14 = 0
    TestCreatureT14 = 0
    PlayerPlatoonT15 = 0
    CatapultT15 = 0
    TestCreatureT15 = 0
    PlayerPlatoonT16 = 0
    CatapultT16 = 0
    TestCreatureT16 = 0
    PlayerPlatoonT17 = 0
    CatapultT17 = 0
    TestCreatureT17 = 0

    EnemyNearDoorT11 = 0
    EnemyNearDoorT12 = 0
    EnemyNearDoorT13 = 0
    EnemyNearDoorT14 = 0
    EnemyNearDoorT15 = 0
    EnemyNearDoorT16 = 0
    EnemyNearDoorT17 = 0

    PlayerPlatoonT21 = 0
    CatapultT21 = 0
    TestCreatureT21 = 0
    PlayerPlatoonT22 = 0
    CatapultT22 = 0
    TestCreatureT22 = 0

    EnemyNearDoorT21 = 0
    EnemyNearDoorT22 = 0

start

begin loop

    GateHouseT11 = get SCRIPT_OBJECT_TYPE_ABODE ABODE_NUMBER_GATEHOUSE_F at {978.35,275.97,1801.02} radius 15
    GateHouseT12 = get SCRIPT_OBJECT_TYPE_ABODE ABODE_NUMBER_GATEHOUSE_F at {1116.53,276.66,1558.91} radius 15
    GateHouseT13 = get SCRIPT_OBJECT_TYPE_ABODE ABODE_NUMBER_GATEHOUSE_F at {1401.20,316.50,1539.01} radius 15
    GateHouseT14 = get SCRIPT_OBJECT_TYPE_ABODE ABODE_NUMBER_GATEHOUSE_F at {1231.72,362.59,1797.36} radius 15
    GateHouseT15 = get SCRIPT_OBJECT_TYPE_ABODE ABODE_NUMBER_GATEHOUSE_F at {1537.95,319.00,1615.23} radius 15
    GateHouseT16 = get SCRIPT_OBJECT_TYPE_ABODE ABODE_NUMBER_GATEHOUSE_F at {1606.30,318.95,1718.35} radius 15
    GateHouseT17 = get SCRIPT_OBJECT_TYPE_ABODE ABODE_NUMBER_GATEHOUSE_F at {1748.63,162.31,1271.61} radius 15

    oCreature = get player 0 creature

    if PLAYER of AztecCapital == 1

        if not town AztecCapital is under takeover from player 0
            PlayerPlatoonT11 = get platoon of player 0 nearest {GateHouseT11} radius 100
            CatapultT11 = get siege weapon of player 0 nearest {GateHouseT11} radius 100
            TestCreatureT11 = get distance from {GateHouseT11} to {oCreature}
            
            if PlayerPlatoonT11 exists
                EnemyNearDoorT11 = 1
            elsif CatapultT11 exists
                EnemyNearDoorT11 = 1
            elsif TestCreatureT11 < 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                EnemyNearDoorT11 = 1
            else
                EnemyNearDoorT11 = 0
            end if
            
            if EnemyNearDoorT11 == 1
                set gate GateHouseT11 close
            else
                set gate GateHouseT11 open
            end if


            PlayerPlatoonT12 = get platoon of player 0 nearest {GateHouseT12} radius 100
            CatapultT12 = get siege weapon of player 0 nearest {GateHouseT12} radius 100
            TestCreatureT12 = get distance from {GateHouseT12} to {oCreature}
            
            if PlayerPlatoonT12 exists
                EnemyNearDoorT12 = 1
            elsif CatapultT12 exists
                EnemyNearDoorT12 = 1
            elsif TestCreatureT12 < 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                EnemyNearDoorT12 = 1
            else
                EnemyNearDoorT12 = 0
            end if
            
            if EnemyNearDoorT12 == 1
                set gate GateHouseT12 close
            else
                set gate GateHouseT12 open
            end if


            PlayerPlatoonT13 = get platoon of player 0 nearest {GateHouseT13} radius 100
            CatapultT13 = get siege weapon of player 0 nearest {GateHouseT13} radius 100
            TestCreatureT13 = get distance from {GateHouseT13} to {oCreature}
            
            if PlayerPlatoonT13 exists
                EnemyNearDoorT13 = 1
            elsif CatapultT13 exists
                EnemyNearDoorT13 = 1
            elsif TestCreatureT13 < 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                EnemyNearDoorT13 = 1
            else
                EnemyNearDoorT13 = 0
            end if
            
            if EnemyNearDoorT13 == 1
                set gate GateHouseT13 close
            else
                set gate GateHouseT13 open
            end if


            PlayerPlatoonT14 = get platoon of player 0 nearest {GateHouseT14} radius 100
            CatapultT14 = get siege weapon of player 0 nearest {GateHouseT14} radius 100
            TestCreatureT14 = get distance from {GateHouseT14} to {oCreature}
            
            if PlayerPlatoonT14 exists
                EnemyNearDoorT14 = 1
            elsif CatapultT14 exists
                EnemyNearDoorT14 = 1
            elsif TestCreatureT14 < 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                EnemyNearDoorT14 = 1
            else
                EnemyNearDoorT14 = 0
            end if
            
            if EnemyNearDoorT14 == 1
                set gate GateHouseT14 close
            else
                set gate GateHouseT14 open
            end if


            PlayerPlatoonT15 = get platoon of player 0 nearest {GateHouseT15} radius 100
            CatapultT15 = get siege weapon of player 0 nearest {GateHouseT15} radius 100
            TestCreatureT15 = get distance from {GateHouseT15} to {oCreature}
            
            if PlayerPlatoonT15 exists
                EnemyNearDoorT15 = 1
            elsif CatapultT15 exists
                EnemyNearDoorT15 = 1
            elsif TestCreatureT15 < 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                EnemyNearDoorT15 = 1
            else
                EnemyNearDoorT15 = 0
            end if
            
            if EnemyNearDoorT15 == 1
                set gate GateHouseT15 close
            else
                set gate GateHouseT15 open
            end if


            PlayerPlatoonT16 = get platoon of player 0 nearest {GateHouseT16} radius 100
            CatapultT16 = get siege weapon of player 0 nearest {GateHouseT16} radius 100
            TestCreatureT16 = get distance from {GateHouseT16} to {oCreature}
            
            if PlayerPlatoonT16 exists
                EnemyNearDoorT16 = 1
            elsif CatapultT16 exists
                EnemyNearDoorT16 = 1
            elsif TestCreatureT16 < 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                EnemyNearDoorT16 = 1
            else
                EnemyNearDoorT16 = 0
            end if
            
            if EnemyNearDoorT16 == 1
                set gate GateHouseT16 close
            else
                set gate GateHouseT16 open
            end if

            PlayerPlatoonT17 = get platoon of player 0 nearest {GateHouseT17} radius 100
            CatapultT17 = get siege weapon of player 0 nearest {GateHouseT17} radius 100
            TestCreatureT17 = get distance from {GateHouseT17} to {oCreature}
            
            if PlayerPlatoonT17 exists
                EnemyNearDoorT17 = 1
            elsif CatapultT17 exists
                EnemyNearDoorT17 = 1
            elsif TestCreatureT17 < 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                EnemyNearDoorT17 = 1
            else
                EnemyNearDoorT17 = 0
            end if
            
            if EnemyNearDoorT17 == 1
                set gate GateHouseT17 close
            else
                set gate GateHouseT17 open
            end if
        else
            set gate GateHouseT11 open
            set gate GateHouseT12 open
            set gate GateHouseT13 open
            set gate GateHouseT14 open
            set gate GateHouseT15 open
            set gate GateHouseT16 open
            set gate GateHouseT17 open
        end if
    end if


    GateHouseT21 = get SCRIPT_OBJECT_TYPE_ABODE ABODE_NUMBER_GATEHOUSE_F at {1636.27,25.39,271.01} radius 15
    GateHouseT22 = get SCRIPT_OBJECT_TYPE_ABODE ABODE_NUMBER_GATEHOUSE_F at {1750.09,24.59,222.49} radius 15
    
    oCreature = get player 0 creature

    if PLAYER of AztecTown2 == 1

        if not town AztecTown2 is under takeover from player 0
            PlayerPlatoonT21 = get platoon of player 0 nearest {GateHouseT21} radius 100
            CatapultT21 = get siege weapon of player 0 nearest {GateHouseT21} radius 100
            TestCreatureT21 = get distance from {GateHouseT21} to {oCreature}
            
            if PlayerPlatoonT21 exists
                EnemyNearDoorT21 = 1
            elsif CatapultT21 exists
                EnemyNearDoorT21 = 1
            elsif TestCreatureT21 < 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                EnemyNearDoorT21 = 1
            else
                EnemyNearDoorT21 = 0
            end if
            
            if EnemyNearDoorT21 == 1
                set gate GateHouseT21 close
            else
                set gate GateHouseT21 open
            end if


            PlayerPlatoonT22 = get platoon of player 0 nearest {GateHouseT22} radius 100
            CatapultT22 = get siege weapon of player 0 nearest {GateHouseT22} radius 100
            TestCreatureT22 = get distance from {GateHouseT22} to {oCreature}
            
            if PlayerPlatoonT22 exists
                EnemyNearDoorT22 = 1
            elsif CatapultT22 exists
                EnemyNearDoorT22 = 1
            elsif TestCreatureT22 < 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                EnemyNearDoorT22 = 1
            else
                EnemyNearDoorT22 = 0
            end if
            
            if EnemyNearDoorT22 == 1
                set gate GateHouseT22 close
            else
                set gate GateHouseT22 open
            end if
        else
            set gate GateHouseT21 open
            set gate GateHouseT22 open
        end if

    end if
end loop

end script LC13_GatehouseManager

begin script LC13_Speeches

    LoseDialogue1 = 0
    
    Number = 0
    
    AttackTimer = create timer for 0 seconds
    LoseTimer = create timer for 0 seconds
    
    a = 0
    b = 0
    c = 0
    d = 0
    e = 0
    f = 0
    g = 0
    h = 0
    i = 0
    j = 0
    jj = 0
    k = 0
    l = 0
    m = 0
    n = 0
    o = 0
    p = 0
    q = 0
    r = 0
    s = 0
    t = 0
    w = 0
    v = 0
    crechediag = 0
    astory = 0
    bstory = 0
    
    ab = 0
    ac = 0
    ad = 0
    ae = 0
    af = 0
    ag = 0
    ah = 0
    ai = 0
    aj = 0
    ak = 0
    al = 0
    am = 0
    
    StoryDialogue = 0
    StoryDialogueTimer = create timer for 120 seconds
    
    EvilDialogue = 0
    GoodDialogue = 0
    
    Platoon = 0
    Catapult = 0

    AltarBuilt = 0

    TownSpeech1 = 0
    TownSpeech2 = 0
    TownSpeech3 = 0
    TownSpeech4 = 0
    TownSpeech5 = 0

    PlayerPlatoon = 0

    UnderAttackTimer = create timer for 0 seconds

    VillagersComment = 0
    VillagersCommentTimer = create timer for 0 seconds

    VillagersFound = 0
    VillagersFree = 0

    GreekTownComment = 0
    GreekTownCommentTimer = create timer for 50 seconds

    PrisonAttacked = 0

    CreatureDeadTimerComment = create timer for 0 seconds

    LargeSiegeComment = 0

    MigrationComment = 0
    TownComment = 0
    FirstSacrifice = 1

start

begin loop

    if UnderAttack >= 1 and get AttackTimer time remaining <= 0 and GB_DialogueIsRunning == 0
        GB_DialogueIsRunning = 1
        UnderAttack = 0
        Number = number from 1 to 14
        if Number == 1
            begin dialogue
                make evil spirit appear
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_EA_01"
                wait until read
                send evil spirit home
            end dialogue
        end if
        if Number == 2
            begin dialogue
                make evil spirit appear
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_EA_02"
                wait until read
                send evil spirit home
            end dialogue
        end if
        if Number == 3
            begin dialogue
                make evil spirit appear
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_EA_05"
                wait until read
                send evil spirit home
            end dialogue
        end if
        if Number == 4
            begin dialogue
                make evil spirit appear
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_EA_06"
                wait until read
                send evil spirit home
            end dialogue
        end if
        if Number == 5
            begin dialogue
                make evil spirit appear
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_EA_07"
                wait until read
                send evil spirit home
            end dialogue
        end if
        if Number == 6
            begin dialogue
                make evil spirit appear
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_EA_08"
                wait until read
                send evil spirit home
            end dialogue
        end if
        if Number == 7
            begin dialogue
                make evil spirit appear
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_EA_18"
                wait until read
                send evil spirit home
            end dialogue
        end if
        if Number == 8
            begin dialogue
                make good spirit appear
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_GA_01"
                wait until read
                send good spirit home
            end dialogue
        end if
        if Number == 9
            begin dialogue
                make good spirit appear
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_GA_02"
                wait until read
                send good spirit home
            end dialogue
        end if
        if Number == 10
            begin dialogue
                make good spirit appear
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_GA_05"
                wait until read
                send good spirit home
            end dialogue
        end if
        if Number == 11
            begin dialogue
                make good spirit appear
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_GA_06"
                wait until read
                send good spirit home
            end dialogue
        end if
        if Number == 12
            begin dialogue
                make good spirit appear
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_GA_07"
                wait until read
                send good spirit home
            end dialogue
        end if
        if Number == 13
            begin dialogue
                make good spirit appear
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_GA_09"
                wait until read
                send good spirit home
            end dialogue
        end if
        if Number == 14
            begin dialogue
                make good spirit appear
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_GA_10"
                wait until read
                send good spirit home
            end dialogue
        end if
        GB_DialogueIsRunning = 0
        AttackTimer = create timer for 45 seconds
    end if
    
    if PLAYER of PlayerTown != 0 and PLAYER of MinorTown1 != 0 and PLAYER of MinorTown2 != 0 and PLAYER of MinorTown3 != 0 and PLAYER of MinorTown4 != 0 and PLAYER of AztecTown1 != 0 and PLAYER of AztecTown2 != 0 and PLAYER of AztecCapital != 0  and get LoseTimer time remaining <= 0 and GB_DialogueIsRunning == 0
        GB_DialogueIsRunning = 1
        LoseDialogue1 = number from 1 to 5
        if LoseDialogue1 == 1
            begin dialogue
                make good spirit appear
                say "BW2T_SCRIPT_GENERIC_ADVISORS_SUGGEST_RESTART_10"
                wait until read
                send good spirit home
            end dialogue
        end if
        
        if LoseDialogue1 == 2
            begin dialogue
                make evil spirit appear
                say "BW2T_SCRIPT_GENERIC_ADVISORS_SUGGEST_RESTART_20"
                wait until read
                send evil spirit home
            end dialogue
        end if
        
        if LoseDialogue1 == 3
            begin dialogue
                make good spirit appear
                say "BW2T_SCRIPT_GENERIC_ADVISORS_SUGGEST_RESTART_30"
                wait until read
                send good spirit home
            end dialogue
        end if
        
        if LoseDialogue1 == 4
            begin dialogue
                make evil spirit appear
                say "BW2T_SCRIPT_GENERIC_ADVISORS_SUGGEST_RESTART_40"
                wait until read
                send evil spirit home
            end dialogue
        end if
        
        if LoseDialogue1 == 5
            begin dialogue
                make evil spirit appear
                say "BW2T_SCRIPT_GENERIC_ADVISORS_SUGGEST_RESTART_50"
                wait until read
                send evil spirit home
            end dialogue
        end if
        
        GB_DialogueIsRunning = 0
        LoseTimer = create timer for 75 seconds
    end if

    if Language == German
        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 0 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 1
            begin dialogue
                say "BW2XT_LAND03_DURINGLAND_10"
                clear dialogue
                close dialogue
                wait BW2XT_LAND03_DURINGLAND_10 + 1 seconds
                say "BW2XT_LAND03_DURINGLAND_20"
                clear dialogue
                close dialogue
                wait BW2XT_LAND03_DURINGLAND_20 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 1 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 2
            begin dialogue
                say "BW2XT_LAND02_MISC_50"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_MISC_50 + 1 seconds
                say "BW2XT_LAND02_MISC_60"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_MISC_60 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 2 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 3
            begin dialogue
                say "BW2XT_LAND02_MISC_210"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_MISC_210 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 3 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 4
            begin dialogue
                say "BW2XT_LAND02_DURINGLAND_40"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_DURINGLAND_40 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 4 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 5
            begin dialogue
                say "BW2XT_LAND02_PLAYER_SAVES_TC_20"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_PLAYER_SAVES_TC_20 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 5 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 6
            begin dialogue
                say "BW2XT_LAND02_DURINGLAND_90"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_DURINGLAND_90 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 6 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 7
            begin dialogue
                say "BW2XT_GENERAL_TALUS_TAUNTS_01"
                clear dialogue
                close dialogue
                wait BW2XT_GENERAL_TALUS_TAUNTS_01 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 7 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 8
            begin dialogue
                say "BW2XT_GENERAL_TALUS_TAUNTS_02"
                clear dialogue
                close dialogue
                wait BW2XT_GENERAL_TALUS_TAUNTS_02 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 8 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 9
            begin dialogue
                say "BW2XT_GENERAL_TALUS_TAUNTS_03"
                clear dialogue
                close dialogue
                wait BW2XT_GENERAL_TALUS_TAUNTS_03 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 9 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 10
            begin dialogue
                say "BW2XT_GENERAL_TALUS_TAUNTS_06"
                clear dialogue
                close dialogue
                wait BW2XT_GENERAL_TALUS_TAUNTS_06 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 10 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 0
            begin dialogue
                say "BW2XT_GENERAL_TALUS_TAUNTS_08"
                clear dialogue
                close dialogue
                wait BW2XT_GENERAL_TALUS_TAUNTS_08 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if
    end if
    if Language == English
        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 0 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 1
            begin dialogue
                say "BW2XT_LAND03_DURINGLAND_10"
                clear dialogue
                close dialogue
                wait BW2XT_LAND03_DURINGLAND_10 + 1 seconds
                say "BW2XT_LAND03_DURINGLAND_20"
                clear dialogue
                close dialogue
                wait BW2XT_LAND03_DURINGLAND_20 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 1 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 2
            begin dialogue
                say "BW2XT_LAND02_MISC_50"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_MISC_50 + 1 seconds
                say "BW2XT_LAND02_MISC_60"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_MISC_60 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 2 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 3
            begin dialogue
                say "BW2XT_LAND02_MISC_210"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_MISC_210 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 3 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 4
            begin dialogue
                say "BW2XT_LAND02_DURINGLAND_40"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_DURINGLAND_40 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 4 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 5
            begin dialogue
                say "BW2XT_LAND02_PLAYER_SAVES_TC_20"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_PLAYER_SAVES_TC_20 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 5 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 6
            begin dialogue
                say "BW2XT_LAND02_DURINGLAND_90"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_DURINGLAND_90 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 6 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 7
            begin dialogue
                say "BW2XT_LAND02_MISC_100"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_MISC_100 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 7 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 8
            begin dialogue
                say "BW2XT_LAND02_MISC_110"
                clear dialogue
                close dialogue
                wait BW2XT_LAND02_MISC_110 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 8 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 9
            begin dialogue
                say "BW2XT_LAND03_DURINGLAND_10"
                clear dialogue
                close dialogue
                wait BW2XT_LAND03_DURINGLAND_10 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 9 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 10
            begin dialogue
                say "BW2XT_LAND03_DURINGLAND_20"
                clear dialogue
                close dialogue
                wait BW2XT_LAND03_DURINGLAND_20 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 10 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 0
            begin dialogue
                say "BW2XT_LAND03_TALUS_ARMINGTON_10"
                clear dialogue
                close dialogue
                wait BW2XT_LAND03_TALUS_ARMINGTON_10 + 1 seconds
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 200 seconds
        end if
    end if

    if get WolfVillagerTimer time remaining <= 0 and GB_DialogueIsRunning == 0
        GB_DialogueIsRunning = 1
        if FirstSacrifice == 1
            FirstSacrifice = 0
            begin dialogue
                say "BW2XT_LAND03_WOLF_TAKES_VILLAGER_02"
                clear dialogue
                close dialogue
                wait BW2XT_LAND03_WOLF_TAKES_VILLAGER_02 + 1 seconds
            end dialogue
        else
            Number = number from 1 to 6
            if Number == 1
                begin dialogue
                    say "BW2XT_LAND03_TALUS_WOLFPICKSUPVILLAGER"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND03_TALUS_WOLFPICKSUPVILLAGER + 1 seconds
                end dialogue
            elsif Number == 2
                begin dialogue
                    say "BW2XT_LAND03_WOLF_TAKES_VILLAGER_01"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND03_WOLF_TAKES_VILLAGER_01 + 1 seconds
                end dialogue
            elsif Number == 3
                begin dialogue
                    say "BW2XT_LAND03_WOLF_TAKES_VILLAGER_02"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND03_WOLF_TAKES_VILLAGER_02 + 1 seconds
                end dialogue
            elsif Number == 4
                begin dialogue
                    say "BW2XT_LAND03_WOLF_SACRIFICE_10"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND03_WOLF_SACRIFICE_10 + 1 seconds
                end dialogue
            elsif Number == 5
                begin dialogue
                    say "BW2XT_LAND03_WOLF_SACRIFICE_20"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND03_WOLF_SACRIFICE_20 + 1 seconds
                end dialogue
            elsif Number == 6
                begin dialogue
                    say "BW2XT_LAND03_WOLF_SACRIFICE_30"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND03_WOLF_SACRIFICE_30 + 1 seconds
                end dialogue
            end if
        end if
        GB_DialogueIsRunning = 0
        wait 2.5 seconds
        WolfVillagerTimer = create timer for number from 360 to 940 seconds
    end if

    if VolcanoFired == 1 and GB_DialogueIsRunning == 0
        VolcanoFired = 2
        GB_DialogueIsRunning = 1
        begin dialogue
            say "BW2XT_LAND05_EARTHQUAKE_10"
            clear dialogue
            close dialogue
            wait BW2XT_LAND05_EARTHQUAKE_10 + 1 seconds
            say "BW2XT_LAND05_EARTHQUAKE_20"
            clear dialogue
            close dialogue
            wait BW2XT_LAND05_EARTHQUAKE_20 + 1 seconds
        end dialogue
        GB_DialogueIsRunning = 0
    end if

end loop

end script LC13_Speeches


begin script LC13_GenericTalusSpeeches(whichUnit,PlayerOfUnit)

    Number = 0

start

begin loop
    wait number from 1 to 10 seconds
    until whichUnit not exists
end loop

//Unit Dead Comment
if get UnitDeadTimer time remaining <= 0 and GB_DialogueIsRunning == 0
    if Language == German
        if PlayerOfUnit == 0
            GB_DialogueIsRunning = 1
            Number = number from 1 to 12
            begin dialogue
                if Number == 1
                    say "BW2XT_GENERAL_TALUS_WINNING_01"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_WINNING_01 + 1 seconds
                    say "BW2XT_GENERAL_TALUS_WINNING_02"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_WINNING_02 + 1 seconds
                elsif Number == 2
                    say "BW2XT_GENERAL_TALUS_WINNING_03"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_WINNING_03 + 1 seconds
                elsif Number == 3
                    say "BW2XT_GENERAL_TALUS_WINNING_04"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_WINNING_04 + 1 seconds
                elsif Number == 4
                    say "BW2XT_GENERAL_TALUS_WINNING_05"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_WINNING_05 + 1 seconds
                elsif Number == 5
                    say "BW2XT_GENERAL_TALUS_WINNING_06"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_WINNING_06 + 1 seconds
                elsif Number == 6
                    say "BW2XT_GENERAL_TALUS_WINNING_07"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_WINNING_07 + 1 seconds
                elsif Number == 7
                    say "BW2XT_GENERAL_TALUS_WINNING_08"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_WINNING_08 + 1 seconds
                elsif Number == 8
                    say "BW2XT_GENERAL_TALUS_WINNING_09"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_WINNING_09 + 1 seconds
                elsif Number == 9
                    say "BW2XT_GENERAL_TALUS_WINNING_10"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_WINNING_10 + 1 seconds
                elsif Number == 10
                    say "BW2XT_GENERAL_TALUS_WINNING_11"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_WINNING_11 + 1 seconds
                elsif Number == 11
                    say "BW2XT_GENERAL_TALUS_WINNING_12"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_WINNING_12 + 1 seconds
                elsif Number == 12
                    say "BW2XT_GENERAL_TALUS_WINNING_13"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_WINNING_13 + 1 seconds
                end if
            end dialogue
            GB_DialogueIsRunning = 0
        else
            GB_DialogueIsRunning = 1
            Number = number from 1 to 10
            begin dialogue
                if Number == 1
                    say "BW2XT_GENERAL_TALUS_LOSING_01"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_LOSING_01 + 1 seconds
                elsif Number == 2
                    say "BW2XT_GENERAL_TALUS_LOSING_02"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_LOSING_02 + 1 seconds
                elsif Number == 3
                    say "BW2XT_GENERAL_TALUS_LOSING_03"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_LOSING_03 + 1 seconds
                elsif Number == 4
                    say "BW2XT_GENERAL_TALUS_LOSING_04"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_LOSING_04 + 1 seconds
                elsif Number == 5
                    say "BW2XT_GENERAL_TALUS_LOSING_05"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_LOSING_05 + 1 seconds
                elsif Number == 6
                    say "BW2XT_GENERAL_TALUS_LOSING_06"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_LOSING_06 + 1 seconds
                elsif Number == 7
                    say "BW2XT_GENERAL_TALUS_LOSING_07"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_LOSING_07 + 1 seconds
                elsif Number == 8
                    say "BW2XT_GENERAL_TALUS_LOSING_08"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_LOSING_08 + 1 seconds
                elsif Number == 9
                    say "BW2XT_GENERAL_TALUS_LOSING_09"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_LOSING_09 + 1 seconds
                elsif Number == 10
                    say "BW2XT_GENERAL_TALUS_LOSING_10"
                    clear dialogue
                    close dialogue
                    wait BW2XT_GENERAL_TALUS_LOSING_10 + 1 seconds
                end if
            end dialogue
            GB_DialogueIsRunning = 0
        end if
    elsif Language == English
        if PlayerOfUnit == 0
            GB_DialogueIsRunning = 1
            Number = number from 1 to 8
            begin dialogue
                if Number == 1
                    say "BW2XT_LAND01_GENERAL_01"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND01_GENERAL_01 + 1 seconds
                elsif Number == 2
                    say "BW2XT_LAND01_GENERAL_02"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND01_GENERAL_02 + 1 seconds
                elsif Number == 3
                    say "BW2XT_LAND01_GENERAL_03"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND01_GENERAL_03 + 1 seconds
                elsif Number == 4
                    say "BW2XT_LAND01_GENERAL_04"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND01_GENERAL_04 + 1 seconds
                elsif Number == 5
                    say "BW2XT_LAND01_GENERAL_05"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND01_GENERAL_05 + 1 seconds
                elsif Number == 6
                    say "BW2XT_LAND02_MISC_70"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND02_MISC_70 + 1 seconds
                elsif Number == 7
                    say "BW2XT_LAND02_PLAYER_ATTACKS_10"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND02_PLAYER_ATTACKS_10 + 1 seconds
                elsif Number == 8
                    say "BW2XT_LAND02_PLAYER_ATTACKS_20"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND02_PLAYER_ATTACKS_20 + 1 seconds
                end if
            end dialogue
            GB_DialogueIsRunning = 0
        else
            GB_DialogueIsRunning = 1
            Number = number from 1 to 8
            begin dialogue
                if Number == 1
                    say "BW2XT_LAND02_TALUS_BANTER_20"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND02_TALUS_BANTER_20 + 1 seconds
                elsif Number == 2
                    say "BW2XT_LAND02_TALUS_BANTER_40"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND02_TALUS_BANTER_40 + 1 seconds
                elsif Number == 3
                    say "BW2XT_LAND02_TALUS_BANTER_50"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND02_TALUS_BANTER_50 + 1 seconds
                elsif Number == 4
                    say "BW2XT_LAND02_TALUS_BANTER_60"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND02_TALUS_BANTER_60 + 1 seconds
                elsif Number == 5
                    say "BW2XT_LAND02_TALUS_BANTER_70"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND02_TALUS_BANTER_70 + 1 seconds
                elsif Number == 6
                    say "BW2XT_LAND02_TALUS_BANTER_110"
                    clear dialogue
                    close dialogue
                    wait BW2XT_LAND02_TALUS_BANTER_110 + 1 seconds
                elsif Number == 7
                    say "XTRA_LINE_1"
                    clear dialogue
                    close dialogue
                    wait XTRA_LINE_1 + 1 seconds
                elsif Number == 8
                    say "XTRA_LINE_2"
                    clear dialogue
                    close dialogue
                    wait XTRA_LINE_2 + 1 seconds
                end if
            end dialogue
            GB_DialogueIsRunning = 0
        end if
    end if
    UnitDeadTimer = create timer for number from 15 to 45 seconds
end if

end script LC13_GenericTalusSpeeches


begin script LC13_GetPlayerUnits

    MyPlatoon = 0

start

begin loop
    wait 2.5 seconds
    MyPlatoon = get platoon of player 0 nearest hand position radius 100 excluding scripted
    if MyPlatoon exists
        run background script LC13_GenericTalusSpeeches(MyPlatoon,0)
    end if
end loop

end script LC13_GetPlayerUnits


begin script LC13_Aztec_Capital

    AttackingPosition = 0
    AttackingPositionFallBack = 0
    Wall[14]
    NearestSettlementTownCentre = 0
    AttackDir[3]
    Number = 0
    SiegeWaypoint1 = 0
    SiegeWaypoint2 = 0
    SiegeWaypoint3 = 0
    AttackAztecTown1Timer = create timer for 0 seconds
    VolcanoTimer = create timer for 0 seconds
    VOLCANODELAY = 3000
    VolcanoWarning = 0
    CastEpicPos = 0
    EpicVolc = 0
    CaptureAztecTown1 = 0

start

    AttackNearestTownTimer = create timer for 0 seconds
    ThrowMiracleTimer = create timer for 999999 seconds
    ThunderstormTimer = create timer for 999999 seconds
    SendStonehengeTroops = create timer for 1200 seconds

    LC13_RecruitTimer1 = create timer for 60 seconds
    LC13_RecruitTimer2 = create timer for 60 seconds
    LC13_RecruitTimer3 = create timer for 60 seconds

    AIVolcano = get SCRIPT_OBJECT_TYPE_WONDER EPIC_WONDER_NUMBER_VOLCANO at {AztecCapital} radius 150
    disable AIVolcano hurt by fire

    CHARGE of AIVolcano = 1.0

    if Difficulty >= 4
        add resource WOOD 3000 to PlayerTown
        add resource ORE 3000 to PlayerTown
        add resource FOOD 3000 to PlayerTown
    elsif Difficulty == 3
        add resource WOOD 5000 to PlayerTown
        add resource ORE 5000 to PlayerTown
        add resource FOOD 5000 to PlayerTown
    elsif Difficulty == 2
        add resource WOOD 7500 to PlayerTown
        add resource ORE 7500 to PlayerTown
        add resource FOOD 7500 to PlayerTown
    elsif Difficulty == 1
        add resource WOOD 10000 to PlayerTown
        add resource ORE 10000 to PlayerTown
        add resource FOOD 10000 to PlayerTown
    end if

    //AztecCapital Walls
    Wall[0] = get wall segment nearest {1231.63,365.25,1823.89} radius 15
    Wall[1] = get wall segment nearest {1227.44,362.64,1767.34} radius 15
    Wall[2] = get wall segment nearest {1006.41,275.76,1795.39} radius 15
    Wall[3] = get wall segment nearest {946.65,277.44,1796.14} radius 15
    Wall[4] = get wall segment nearest {1084.34,277.06,1562.19} radius 15
    Wall[5] = get wall segment nearest {1153.46,276.55,1563.69} radius 15
    Wall[6] = get wall segment nearest {1414.10,318.03,1562.75} radius 15
    Wall[7] = get wall segment nearest {1392.03,320.37,1506.39} radius 15
    Wall[8] = get wall segment nearest {1515.53,321.62,1590.79} radius 15
    Wall[9] = get wall segment nearest {1555.43,318.93,1638.89} radius 15
    Wall[10] = get wall segment nearest {1720.35,161.67,1293.18} radius 15
    Wall[11] = get wall segment nearest {1780.71,161.33,1268.40} radius 15

    //AztecTown2 Walls
    Wall[12] = get wall segment nearest {1654.64,24.75,298.24} radius 15
    Wall[13] = get wall segment nearest {1622.23,26.23,239.20} radius 15

    //----Create town static defenders platoons----//
    //AztecCapital
    LC13_Platoon[0] = create platoon ARMY_UNIT_TYPE_RANGED_7 at {PlatoonPos[0]} with 30 * RecruitSizeModifier men and 0 women
    attach LC13_Platoon[0] to AztecCapital
    PLAYER of LC13_Platoon[0] = 1
    run background script LC13_StaticPlatoonsActions(PlatoonPos[0],Ranged,LC13_Platoon[0])
    run background script LC13_GenericTalusSpeeches(LC13_Platoon[0],1)
    disable platoon LC13_Platoon[0] respond to town AztecCapital attack
    disable platoon LC13_Platoon[0] camp
    set LC13_Platoon[0] focus to {1230.83,362.58,1794.76}

    LC13_Platoon[1] = create platoon ARMY_UNIT_TYPE_MELEE_7 at {PlatoonPos[1]} with 30 * RecruitSizeModifier men and 0 women
    attach LC13_Platoon[1] to AztecCapital
    PLAYER of LC13_Platoon[1] = 1
    run background script LC13_StaticPlatoonsActions(PlatoonPos[1],Melee,LC13_Platoon[1])
    run background script LC13_GenericTalusSpeeches(LC13_Platoon[1],1)
    disable platoon LC13_Platoon[1] respond to town AztecCapital attack
    disable platoon LC13_Platoon[1] camp
    set LC13_Platoon[1] focus to {1230.83,362.58,1794.76}

    LC13_Platoon[2] = create platoon ARMY_UNIT_TYPE_MELEE_7 at {PlatoonPos[2]} with 50 * RecruitSizeModifier men and 0 women
    attach LC13_Platoon[2] to AztecCapital
    PLAYER of LC13_Platoon[2] = 1
    run background script LC13_StaticPlatoonsActions(PlatoonPos[2],Melee,LC13_Platoon[2])
    run background script LC13_GenericTalusSpeeches(LC13_Platoon[2],1)
    disable platoon LC13_Platoon[2] respond to town AztecCapital attack
    disable platoon LC13_Platoon[2] camp
    set LC13_Platoon[2] focus to {AztecCapital}

    LC13_Platoon[3] = create platoon ARMY_UNIT_TYPE_MELEE_5 at {PlatoonPos[3]} with 30 * RecruitSizeModifier men and 0 women
    attach LC13_Platoon[3] to AztecCapital
    PLAYER of LC13_Platoon[3] = 1
    run background script LC13_StaticPlatoonsActions(PlatoonPos[3],Melee,LC13_Platoon[3])
    run background script LC13_GenericTalusSpeeches(LC13_Platoon[3],1)
    disable platoon LC13_Platoon[3] respond to town AztecCapital attack
    disable platoon LC13_Platoon[3] camp
    set LC13_Platoon[3] focus to {AztecCapital}

    LC13_Platoon[4] = create platoon ARMY_UNIT_TYPE_MELEE_5 at {PlatoonPos[4]} with 30 * RecruitSizeModifier men and 0 women
    attach LC13_Platoon[4] to AztecCapital
    PLAYER of LC13_Platoon[4] = 1
    run background script LC13_StaticPlatoonsActions(PlatoonPos[4],Melee,LC13_Platoon[4])
    run background script LC13_GenericTalusSpeeches(LC13_Platoon[4],1)
    disable platoon LC13_Platoon[4] respond to town AztecCapital attack
    disable platoon LC13_Platoon[4] camp
    set LC13_Platoon[4] focus to {AztecCapital}

    LC13_Platoon[5] = create platoon ARMY_UNIT_TYPE_RANGED_5 at {PlatoonPos[5]} with 30 * RecruitSizeModifier men and 0 women
    attach LC13_Platoon[5] to AztecCapital
    PLAYER of LC13_Platoon[5] = 1
    run background script LC13_StaticPlatoonsActions(PlatoonPos[5],Ranged,LC13_Platoon[5])
    run background script LC13_GenericTalusSpeeches(LC13_Platoon[5],1)
    disable platoon LC13_Platoon[5] respond to town AztecCapital attack
    disable platoon LC13_Platoon[5] camp
    set LC13_Platoon[5] focus to {AztecCapital}

    //AztecTown2
    LC13_Platoon[6] = create platoon ARMY_UNIT_TYPE_RANGED_5 at {PlatoonPos[6]} with 40 * RecruitSizeModifier men and 0 women
    attach LC13_Platoon[6] to AztecTown2
    PLAYER of LC13_Platoon[6] = 1
    run background script LC13_StaticPlatoonsActions(PlatoonPos[6],Ranged,LC13_Platoon[6])
    run background script LC13_GenericTalusSpeeches(LC13_Platoon[6],1)
    disable platoon LC13_Platoon[6] respond to town AztecTown2 attack
    disable platoon LC13_Platoon[6] camp
    set LC13_Platoon[6] focus to {AztecTown2}

    LC13_Platoon[7] = create platoon ARMY_UNIT_TYPE_RANGED_5 at {PlatoonPos[7]} with 40 * RecruitSizeModifier men and 0 women
    attach LC13_Platoon[7] to AztecTown2
    PLAYER of LC13_Platoon[7] = 1
    run background script LC13_StaticPlatoonsActions(PlatoonPos[7],Ranged,LC13_Platoon[7])
    run background script LC13_GenericTalusSpeeches(LC13_Platoon[7],1)
    disable platoon LC13_Platoon[7] respond to town AztecTown2 attack
    disable platoon LC13_Platoon[7] camp
    set LC13_Platoon[7] focus to {AztecTown2}

    LC13_Platoon[8] = create platoon ARMY_UNIT_TYPE_MELEE_5 at {PlatoonPos[8]} with 40 * RecruitSizeModifier men and 0 women
    attach LC13_Platoon[8] to AztecTown2
    PLAYER of LC13_Platoon[8] = 1
    run background script LC13_StaticPlatoonsActions(PlatoonPos[8],Melee,LC13_Platoon[8])
    run background script LC13_GenericTalusSpeeches(LC13_Platoon[8],1)
    disable platoon LC13_Platoon[8] respond to town AztecTown2 attack
    disable platoon LC13_Platoon[8] camp
    set LC13_Platoon[8] focus to {AztecTown2}

    //----Create static defenders platoons----//
    LC13_Platoon[9] = create platoon ARMY_UNIT_TYPE_MELEE_5 at {PlatoonPos[11]} with 30 * RecruitSizeModifier men and 0 women
    attach LC13_Platoon[9] to AztecCapital
    PLAYER of LC13_Platoon[9] = 1
    run background script LC13_StaticPlatoonsActions(PlatoonPos[11],Melee,LC13_Platoon[9])
    run background script LC13_GenericTalusSpeeches(LC13_Platoon[9],1)
    disable platoon LC13_Platoon[9] respond to town AztecCapital attack
    disable platoon LC13_Platoon[9] camp
    set LC13_Platoon[9] focus to {AztecCapital}

    LC13_Platoon[10] = create platoon ARMY_UNIT_TYPE_RANGED_5 at {PlatoonPos[12]} with 30 * RecruitSizeModifier men and 0 women
    attach LC13_Platoon[10] to AztecCapital
    PLAYER of LC13_Platoon[10] = 1
    run background script LC13_StaticPlatoonsActions(PlatoonPos[12],Ranged,LC13_Platoon[10])
    run background script LC13_GenericTalusSpeeches(LC13_Platoon[10],1)
    disable platoon LC13_Platoon[10] respond to town AztecCapital attack
    disable platoon LC13_Platoon[10] camp
    set LC13_Platoon[10] focus to {AztecCapital}

    LC13_Platoon[11] = create platoon ARMY_UNIT_TYPE_MELEE_5 at {PlatoonPos[13]} with 30 * RecruitSizeModifier men and 0 women
    attach LC13_Platoon[11] to AztecCapital
    PLAYER of LC13_Platoon[11] = 1
    run background script LC13_StaticPlatoonsActions(PlatoonPos[13],Melee,LC13_Platoon[11])
    run background script LC13_GenericTalusSpeeches(LC13_Platoon[11],1)
    disable platoon LC13_Platoon[11] respond to town AztecCapital attack
    disable platoon LC13_Platoon[11] camp
    set LC13_Platoon[11] focus to {AztecCapital}

    //----Create patrol platoons----//
    LC13_Platoon[12] = create platoon ARMY_UNIT_TYPE_MELEE_5 at {PatrolRouteA[0]} with 50 * RecruitSizeModifier men and 0 women
    attach LC13_Platoon[12] to AztecCapital
    PLAYER of LC13_Platoon[12] = 1
    run background script LC13_ArmyBehaivours(LC13_Platoon[12],Melee,Patrol,0,0,0,WaypointsA,0)
    run background script LC13_GenericTalusSpeeches(LC13_Platoon[12],1)
    disable platoon LC13_Platoon[12] respond to town AztecCapital attack
    disable platoon LC13_Platoon[12] camp
    set LC13_Platoon[12] focus to {AztecCapital}

    LC13_Platoon[13] = create platoon ARMY_UNIT_TYPE_RANGED_5 at {PatrolRouteA[0]} with 50 * RecruitSizeModifier men and 0 women
    attach LC13_Platoon[13] to AztecCapital
    PLAYER of LC13_Platoon[13] = 1
    run background script LC13_ArmyBehaivours(LC13_Platoon[13],Ranged,PatrolLinked,LC13_Platoon[12],0,0,WaypointsA,0)
    run background script LC13_GenericTalusSpeeches(LC13_Platoon[13],1)
    disable platoon LC13_Platoon[13] respond to town AztecCapital attack
    disable platoon LC13_Platoon[13] camp
    set LC13_Platoon[13] focus to {AztecCapital}

    //----Create town archer platoons----//
    LC13_WallArcher[0] = create platoon PLATOON_INFO_AZTEC_RANGED_5 at {Wall[0]} with 20 * RecruitSizeModifier men and 0 women
    attach LC13_WallArcher[0] to AztecCapital
    PLAYER of LC13_WallArcher[0] = 1
    enable platoon LC13_WallArcher[0] respond to town AztecCapital attack
    run background script LC13_GenericTalusSpeeches(LC13_WallArcher[0],1)
    add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[0] to LC13_WallArcher[0] action queue

    LC13_WallArcher[1] = create platoon PLATOON_INFO_AZTEC_RANGED_5 at {Wall[1]} with 20 * RecruitSizeModifier men and 0 women
    attach LC13_WallArcher[1] to AztecCapital
    PLAYER of LC13_WallArcher[1] = 1
    enable platoon LC13_WallArcher[1] respond to town AztecCapital attack
    run background script LC13_GenericTalusSpeeches(LC13_WallArcher[1],1)
    add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[1] to LC13_WallArcher[1] action queue

    LC13_WallArcher[2] = create platoon PLATOON_INFO_AZTEC_RANGED_5 at {Wall[2]} with 20 * RecruitSizeModifier men and 0 women
    attach LC13_WallArcher[2] to AztecCapital
    PLAYER of LC13_WallArcher[2] = 1
    enable platoon LC13_WallArcher[2] respond to town AztecCapital attack
    run background script LC13_GenericTalusSpeeches(LC13_WallArcher[2],1)
    add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[2] to LC13_WallArcher[2] action queue

    LC13_WallArcher[3] = create platoon PLATOON_INFO_AZTEC_RANGED_5 at {Wall[3]} with 20 * RecruitSizeModifier men and 0 women
    attach LC13_WallArcher[3] to AztecCapital
    PLAYER of LC13_WallArcher[3] = 1
    enable platoon LC13_WallArcher[3] respond to town AztecCapital attack
    run background script LC13_GenericTalusSpeeches(LC13_WallArcher[3],1)
    add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[3] to LC13_WallArcher[3] action queue

    LC13_WallArcher[4] = create platoon PLATOON_INFO_AZTEC_RANGED_5 at {Wall[4]} with 20 * RecruitSizeModifier men and 0 women
    attach LC13_WallArcher[4] to AztecCapital
    PLAYER of LC13_WallArcher[4] = 1
    enable platoon LC13_WallArcher[4] respond to town AztecCapital attack
    run background script LC13_GenericTalusSpeeches(LC13_WallArcher[4],1)
    add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[4] to LC13_WallArcher[4] action queue

    LC13_WallArcher[5] = create platoon PLATOON_INFO_AZTEC_RANGED_5 at {Wall[5]} with 20 * RecruitSizeModifier men and 0 women
    attach LC13_WallArcher[5] to AztecCapital
    PLAYER of LC13_WallArcher[5] = 1
    enable platoon LC13_WallArcher[5] respond to town AztecCapital attack
    run background script LC13_GenericTalusSpeeches(LC13_WallArcher[5],1)
    add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[5] to LC13_WallArcher[5] action queue

    LC13_WallArcher[6] = create platoon PLATOON_INFO_AZTEC_RANGED_5 at {Wall[6]} with 20 * RecruitSizeModifier men and 0 women
    attach LC13_WallArcher[6] to AztecCapital
    PLAYER of LC13_WallArcher[6] = 1
    enable platoon LC13_WallArcher[6] respond to town AztecCapital attack
    run background script LC13_GenericTalusSpeeches(LC13_WallArcher[6],1)
    add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[6] to LC13_WallArcher[6] action queue

    LC13_WallArcher[7] = create platoon PLATOON_INFO_AZTEC_RANGED_5 at {Wall[7]} with 20 * RecruitSizeModifier men and 0 women
    attach LC13_WallArcher[7] to AztecCapital
    PLAYER of LC13_WallArcher[7] = 1
    enable platoon LC13_WallArcher[7] respond to town AztecCapital attack
    run background script LC13_GenericTalusSpeeches(LC13_WallArcher[7],1)
    add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[7] to LC13_WallArcher[7] action queue

    LC13_WallArcher[8] = create platoon PLATOON_INFO_AZTEC_RANGED_5 at {Wall[8]} with 20 * RecruitSizeModifier men and 0 women
    attach LC13_WallArcher[8] to AztecCapital
    PLAYER of LC13_WallArcher[8] = 1
    enable platoon LC13_WallArcher[8] respond to town AztecCapital attack
    run background script LC13_GenericTalusSpeeches(LC13_WallArcher[8],1)
    add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[8] to LC13_WallArcher[8] action queue

    LC13_WallArcher[9] = create platoon PLATOON_INFO_AZTEC_RANGED_5 at {Wall[9]} with 20 * RecruitSizeModifier men and 0 women
    attach LC13_WallArcher[9] to AztecCapital
    PLAYER of LC13_WallArcher[9] = 1
    enable platoon LC13_WallArcher[9] respond to town AztecCapital attack
    run background script LC13_GenericTalusSpeeches(LC13_WallArcher[9],1)
    add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[9] to LC13_WallArcher[9] action queue

    LC13_WallArcher[10] = create platoon PLATOON_INFO_AZTEC_RANGED_5 at {Wall[10]} with 20 * RecruitSizeModifier men and 0 women
    attach LC13_WallArcher[10] to AztecCapital
    PLAYER of LC13_WallArcher[10] = 1
    enable platoon LC13_WallArcher[10] respond to town AztecCapital attack
    run background script LC13_GenericTalusSpeeches(LC13_WallArcher[10],1)
    add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[10] to LC13_WallArcher[10] action queue

    LC13_WallArcher[11] = create platoon PLATOON_INFO_AZTEC_RANGED_5 at {Wall[11]} with 20 * RecruitSizeModifier men and 0 women
    attach LC13_WallArcher[11] to AztecCapital
    PLAYER of LC13_WallArcher[11] = 1
    enable platoon LC13_WallArcher[11] respond to town AztecCapital attack
    run background script LC13_GenericTalusSpeeches(LC13_WallArcher[11],1)
    add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[11] to LC13_WallArcher[11] action queue

    //AztecTown2
    LC13_WallArcher[12] = create platoon PLATOON_INFO_AZTEC_RANGED_5 at {Wall[12]} with 20 * RecruitSizeModifier men and 0 women
    attach LC13_WallArcher[12] to AztecTown2
    PLAYER of LC13_WallArcher[12] = 1
    enable platoon LC13_WallArcher[12] respond to town AztecTown2 attack
    run background script LC13_GenericTalusSpeeches(LC13_WallArcher[12],1)
    add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[12] to LC13_WallArcher[12] action queue

    LC13_WallArcher[13] = create platoon PLATOON_INFO_AZTEC_RANGED_5 at {Wall[13]} with 20 * RecruitSizeModifier men and 0 women
    attach LC13_WallArcher[13] to AztecTown2
    PLAYER of LC13_WallArcher[13] = 1
    enable platoon LC13_WallArcher[13] respond to town AztecTown2 attack
    run background script LC13_GenericTalusSpeeches(LC13_WallArcher[13],1)
    add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[13] to LC13_WallArcher[13] action queue

    //----Create static sieges----//
    LC13_SiegeCatapult[0] = create siege weapon SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_7 belonging to AztecCapital at {StaticSiegePos[0]}
    set LC13_SiegeCatapult[0] focus to {PlayerTown}
    add action SIEGEWEAPON_AGENDA_ACTION_DEFEND_POSITION using {StaticSiegePos[0]} to siege weapon LC13_SiegeCatapult[0] action queue

    LC13_SiegeCatapult[1] = create siege weapon SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_7 belonging to AztecCapital at {StaticSiegePos[1]}
    set LC13_SiegeCatapult[1] focus to {PlayerTown}
    add action SIEGEWEAPON_AGENDA_ACTION_DEFEND_POSITION using {StaticSiegePos[1]} to siege weapon LC13_SiegeCatapult[1] action queue

    LC13_SiegeCatapult[2] = create siege weapon SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_7 belonging to AztecCapital at {StaticSiegePos[2]}
    set LC13_SiegeCatapult[2] focus to {PlayerTown}
    add action SIEGEWEAPON_AGENDA_ACTION_DEFEND_POSITION using {StaticSiegePos[2]} to siege weapon LC13_SiegeCatapult[2] action queue

    LC13_SiegeCatapult[3] = create siege weapon SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_7 belonging to AztecCapital at {StaticSiegePos[3]}
    set LC13_SiegeCatapult[3] focus to {PlayerTown}
    add action SIEGEWEAPON_AGENDA_ACTION_DEFEND_POSITION using {StaticSiegePos[3]} to siege weapon LC13_SiegeCatapult[3] action queue

    wait until IntroFinished == 1

    begin loop
        NearestSettlementTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in NearestSettlement min built 1.0
        //AztecCapital
        if LC13_Platoon[0] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC13_RecruitTimer1 time remaining <= 0
            LC13_Platoon[0] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 30 * RecruitSizeModifier
            LC13_RecruitTimer1 = create timer for 240 * RecruitModifier seconds
            enable platoon LC13_Platoon[0] respond to town AztecCapital attack
            wait until not LC13_Platoon[0] recruiting
            run background script LC13_StaticPlatoonsActions(PlatoonPos[0],Ranged,LC13_Platoon[0])
            run background script LC13_GenericTalusSpeeches(LC13_Platoon[0],1)

        elsif LC13_Platoon[1] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC13_RecruitTimer1 time remaining <= 0
            LC13_Platoon[1] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 30 * RecruitSizeModifier
            LC13_RecruitTimer1 = create timer for 240 * RecruitModifier seconds
            enable platoon LC13_Platoon[1] respond to town AztecCapital attack
            wait until not LC13_Platoon[1] recruiting
            run background script LC13_StaticPlatoonsActions(PlatoonPos[1],Melee,LC13_Platoon[1])
            run background script LC13_GenericTalusSpeeches(LC13_Platoon[1],1)
        
        elsif LC13_Platoon[2] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC13_RecruitTimer1 time remaining <= 0
            LC13_Platoon[2] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 30 * RecruitSizeModifier
            LC13_RecruitTimer1 = create timer for 240 * RecruitModifier seconds
            enable platoon LC13_Platoon[2] respond to town AztecCapital attack
            wait until not LC13_Platoon[2] recruiting
            run background script LC13_StaticPlatoonsActions(PlatoonPos[2],Melee,LC13_Platoon[2])
            run background script LC13_GenericTalusSpeeches(LC13_Platoon[2],1)

        elsif LC13_Platoon[3] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC13_RecruitTimer1 time remaining <= 0
            LC13_Platoon[3] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 30 * RecruitSizeModifier
            LC13_RecruitTimer1 = create timer for 240 * RecruitModifier seconds
            enable platoon LC13_Platoon[3] respond to town AztecCapital attack
            wait until not LC13_Platoon[3] recruiting
            run background script LC13_StaticPlatoonsActions(PlatoonPos[3],Melee,LC13_Platoon[3])
            run background script LC13_GenericTalusSpeeches(LC13_Platoon[3],1)

        elsif LC13_Platoon[4] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC13_RecruitTimer1 time remaining <= 0
            LC13_Platoon[4] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 30 * RecruitSizeModifier
            LC13_RecruitTimer1 = create timer for 240 * RecruitModifier seconds
            enable platoon LC13_Platoon[4] respond to town AztecCapital attack
            wait until not LC13_Platoon[4] recruiting
            run background script LC13_StaticPlatoonsActions(PlatoonPos[4],Ranged,LC13_Platoon[4])
            run background script LC13_GenericTalusSpeeches(LC13_Platoon[4],1)

        elsif LC13_Platoon[5] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC13_RecruitTimer1 time remaining <= 0
            LC13_Platoon[5] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 30 * RecruitSizeModifier
            LC13_RecruitTimer1 = create timer for 240 * RecruitModifier seconds
            enable platoon LC13_Platoon[5] respond to town AztecCapital attack
            wait until not LC13_Platoon[5] recruiting
            run background script LC13_StaticPlatoonsActions(PlatoonPos[5],Ranged,LC13_Platoon[5])
            run background script LC13_GenericTalusSpeeches(LC13_Platoon[5],1)

        elsif LC13_WallArcher[0] not exists and Wall[0] exists and PLAYER of Wall[0] == 1 and HEALTH of Wall[0] == 1.0 and not town AztecCapital is under takeover from player 0 and get LC13_RecruitTimer1 time remaining <= 0
            LC13_WallArcher[0] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 20 * RecruitSizeModifier
            LC13_RecruitTimer1 = create timer for 60 * RecruitModifier seconds
            wait until not LC13_WallArcher[0] recruiting
            enable platoon LC13_WallArcher[0] respond to town AztecCapital attack
            add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[0] to LC13_WallArcher[0] action queue
            run background script LC13_GenericTalusSpeeches(LC13_WallArcher[0],1)

        elsif LC13_WallArcher[1] not exists and Wall[1] exists and PLAYER of Wall[1] == 1 and HEALTH of Wall[1] == 1.0 and not town AztecCapital is under takeover from player 0 and get LC13_RecruitTimer1 time remaining <= 0
            LC13_WallArcher[1] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 20 * RecruitSizeModifier
            LC13_RecruitTimer1 = create timer for 60 * RecruitModifier seconds
            wait until not LC13_WallArcher[1] recruiting
            enable platoon LC13_WallArcher[1] respond to town AztecCapital attack
            add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[1] to LC13_WallArcher[1] action queue
            run background script LC13_GenericTalusSpeeches(LC13_WallArcher[1],1)

        elsif LC13_WallArcher[2] not exists and Wall[2] exists and PLAYER of Wall[2] == 1 and HEALTH of Wall[2] == 1.0 and not town AztecCapital is under takeover from player 0 and get LC13_RecruitTimer1 time remaining <= 0
            LC13_WallArcher[2] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 20 * RecruitSizeModifier
            LC13_RecruitTimer1 = create timer for 60 * RecruitModifier seconds
            wait until not LC13_WallArcher[2] recruiting
            enable platoon LC13_WallArcher[2] respond to town AztecCapital attack
            add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[2] to LC13_WallArcher[2] action queue
            run background script LC13_GenericTalusSpeeches(LC13_WallArcher[2],1)

        elsif LC13_WallArcher[3] not exists and Wall[3] exists and PLAYER of Wall[3] == 1 and HEALTH of Wall[3] == 1.0 and not town AztecCapital is under takeover from player 0 and get LC13_RecruitTimer1 time remaining <= 0
            LC13_WallArcher[3] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 20 * RecruitSizeModifier
            LC13_RecruitTimer1 = create timer for 60 * RecruitModifier seconds
            wait until not LC13_WallArcher[3] recruiting
            enable platoon LC13_WallArcher[3] respond to town AztecCapital attack
            add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[3] to LC13_WallArcher[3] action queue
            run background script LC13_GenericTalusSpeeches(LC13_WallArcher[3],1)
        
        elsif LC13_WallArcher[4] not exists and Wall[4] exists and PLAYER of Wall[4] == 1 and HEALTH of Wall[4] == 1.0 and not town AztecCapital is under takeover from player 0 and get LC13_RecruitTimer1 time remaining <= 0
            LC13_WallArcher[4] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 20 * RecruitSizeModifier
            LC13_RecruitTimer1 = create timer for 60 * RecruitModifier seconds
            wait until not LC13_WallArcher[4] recruiting
            enable platoon LC13_WallArcher[4] respond to town AztecCapital attack
            add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[4] to LC13_WallArcher[4] action queue
            run background script LC13_GenericTalusSpeeches(LC13_WallArcher[4],1)

        elsif LC13_WallArcher[5] not exists and Wall[5] exists and PLAYER of Wall[5] == 1 and HEALTH of Wall[5] == 1.0 and not town AztecCapital is under takeover from player 0 and get LC13_RecruitTimer1 time remaining <= 0
            LC13_WallArcher[5] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 20 * RecruitSizeModifier
            LC13_RecruitTimer1 = create timer for 60 * RecruitModifier seconds
            wait until not LC13_WallArcher[5] recruiting
            enable platoon LC13_WallArcher[5] respond to town AztecCapital attack
            add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[5] to LC13_WallArcher[5] action queue
            run background script LC13_GenericTalusSpeeches(LC13_WallArcher[5],1)

        elsif LC13_WallArcher[6] not exists and Wall[6] exists and PLAYER of Wall[6] == 1 and HEALTH of Wall[6] == 1.0 and not town AztecCapital is under takeover from player 0 and get LC13_RecruitTimer1 time remaining <= 0
            LC13_WallArcher[6] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 20 * RecruitSizeModifier
            LC13_RecruitTimer1 = create timer for 60 * RecruitModifier seconds
            wait until not LC13_WallArcher[6] recruiting
            enable platoon LC13_WallArcher[6] respond to town AztecCapital attack
            add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[6] to LC13_WallArcher[6] action queue
            run background script LC13_GenericTalusSpeeches(LC13_WallArcher[6],1)

        elsif LC13_WallArcher[7] not exists and Wall[7] exists and PLAYER of Wall[7] == 1 and HEALTH of Wall[7] == 1.0 and not town AztecCapital is under takeover from player 0 and get LC13_RecruitTimer1 time remaining <= 0
            LC13_WallArcher[7] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 20 * RecruitSizeModifier
            LC13_RecruitTimer1 = create timer for 60 * RecruitModifier seconds
            wait until not LC13_WallArcher[7] recruiting
            enable platoon LC13_WallArcher[7] respond to town AztecCapital attack
            add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[7] to LC13_WallArcher[7] action queue
            run background script LC13_GenericTalusSpeeches(LC13_WallArcher[7],1)

        elsif LC13_WallArcher[8] not exists and Wall[8] exists and PLAYER of Wall[8] == 1 and HEALTH of Wall[8] == 1.0 and not town AztecCapital is under takeover from player 0 and get LC13_RecruitTimer1 time remaining <= 0
            LC13_WallArcher[8] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 20 * RecruitSizeModifier
            LC13_RecruitTimer1 = create timer for 60 * RecruitModifier seconds
            wait until not LC13_WallArcher[8] recruiting
            enable platoon LC13_WallArcher[8] respond to town AztecCapital attack
            add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[8] to LC13_WallArcher[8] action queue
            run background script LC13_GenericTalusSpeeches(LC13_WallArcher[8],1)

        elsif LC13_WallArcher[9] not exists and Wall[9] exists and PLAYER of Wall[9] == 1 and HEALTH of Wall[9] == 1.0 and not town AztecCapital is under takeover from player 0 and get LC13_RecruitTimer1 time remaining <= 0
            LC13_WallArcher[9] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 20 * RecruitSizeModifier
            LC13_RecruitTimer1 = create timer for 60 * RecruitModifier seconds
            wait until not LC13_WallArcher[9] recruiting
            enable platoon LC13_WallArcher[9] respond to town AztecCapital attack
            add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[9] to LC13_WallArcher[9] action queue
            run background script LC13_GenericTalusSpeeches(LC13_WallArcher[9],1)

        elsif LC13_WallArcher[10] not exists and Wall[10] exists and PLAYER of Wall[10] == 1 and HEALTH of Wall[10] == 1.0 and not town AztecCapital is under takeover from player 0 and get LC13_RecruitTimer1 time remaining <= 0
            LC13_WallArcher[10] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 20 * RecruitSizeModifier
            LC13_RecruitTimer1 = create timer for 60 * RecruitModifier seconds
            wait until not LC13_WallArcher[10] recruiting
            enable platoon LC13_WallArcher[10] respond to town AztecCapital attack
            add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[10] to LC13_WallArcher[10] action queue
            run background script LC13_GenericTalusSpeeches(LC13_WallArcher[10],1)
        
        elsif LC13_WallArcher[11] not exists and Wall[11] exists and PLAYER of Wall[11] == 1 and HEALTH of Wall[11] == 1.0 and not town AztecCapital is under takeover from player 0 and get LC13_RecruitTimer1 time remaining <= 0
            LC13_WallArcher[11] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 20 * RecruitSizeModifier
            LC13_RecruitTimer1 = create timer for 60 * RecruitModifier seconds
            wait until not LC13_WallArcher[11] recruiting
            enable platoon LC13_WallArcher[11] respond to town AztecCapital attack
            add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[11] to LC13_WallArcher[11] action queue
            run background script LC13_GenericTalusSpeeches(LC13_WallArcher[11],1)

        //Capture AztecTown1
        elsif LC13_Platoon[22] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC13_RecruitTimer1 time remaining <= 0 and TriedAztecTown1Attack == 0 and CaptureAztecTown1 == 1
            LC13_Platoon[22] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 25 * RecruitSizeModifier
            LC13_RecruitTimer1 = create timer for 120 * RecruitModifier seconds
            enable platoon LC13_Platoon[22] respond to town AztecCapital attack
            wait until not LC13_Platoon[22] recruiting
            AttackingPosition = marker at {1326.08,133.27,746.30} + {0,0,0}
            AttackingPositionFallBack = marker at {1245.49,141.35,898.79} + {0,0,0}
            run background script LC13_GenericTalusSpeeches(LC13_Platoon[22],1)
            run background script LC13_ArmyBehaivours(LC13_Platoon[22],Melee,CaptureSpecTown,0,AttackingPosition,AttackingPositionFallBack,0,0)

        elsif LC13_Platoon[23] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC13_RecruitTimer1 time remaining <= 0 and TriedAztecTown1Attack == 0 and CaptureAztecTown1 == 1
            LC13_Platoon[23] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 25 * RecruitSizeModifier
            LC13_RecruitTimer1 = create timer for 120 * RecruitModifier seconds
            enable platoon LC13_Platoon[23] respond to town AztecCapital attack
            wait until not LC13_Platoon[23] recruiting
            AttackingPosition = marker at {1326.08,133.27,746.30} + {25,0,0}
            AttackingPositionFallBack = marker at {1245.49,141.35,898.79} + {25,0,0}
            run background script LC13_GenericTalusSpeeches(LC13_Platoon[23],1)
            run background script LC13_ArmyBehaivours(LC13_Platoon[23],Melee,CaptureSpecTown,0,AttackingPosition,AttackingPositionFallBack,0,0)

        elsif LC13_Platoon[24] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC13_RecruitTimer1 time remaining <= 0 and TriedAztecTown1Attack == 0 and CaptureAztecTown1 == 1
            LC13_Platoon[24] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 25 * RecruitSizeModifier
            LC13_RecruitTimer1 = create timer for 120 * RecruitModifier seconds
            enable platoon LC13_Platoon[24] respond to town AztecCapital attack
            wait until not LC13_Platoon[24] recruiting
            AttackingPosition = marker at {1326.08,133.27,746.30} + {0,0,25}
            AttackingPositionFallBack = marker at {1245.49,141.35,898.79} + {0,0,25}
            run background script LC13_GenericTalusSpeeches(LC13_Platoon[24],1)
            run background script LC13_ArmyBehaivours(LC13_Platoon[24],Ranged,CaptureSpecTown,0,AttackingPosition,AttackingPositionFallBack,0,0)

        elsif LC13_Platoon[25] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC13_RecruitTimer1 time remaining <= 0 and TriedAztecTown1Attack == 0 and CaptureAztecTown1 == 1
            LC13_Platoon[25] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 25 * RecruitSizeModifier
            LC13_RecruitTimer1 = create timer for 120 * RecruitModifier seconds
            enable platoon LC13_Platoon[25] respond to town AztecCapital attack
            wait until not LC13_Platoon[25] recruiting
            AttackingPosition = marker at {1326.08,133.27,746.30} + {15,0,15}
            AttackingPositionFallBack = marker at {1245.49,141.35,898.79} + {15,0,15}
            run background script LC13_GenericTalusSpeeches(LC13_Platoon[25],1)
            run background script LC13_ArmyBehaivours(LC13_Platoon[25],Ranged,CaptureSpecTown,0,AttackingPosition,AttackingPositionFallBack,0,0)

        //Attack PlayerTown
        elsif LC13_Platoon[30] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC13_RecruitTimer1 time remaining <= 0 and TownsConverted >= 2
            Number = number from 1 to 5
            if Number == 1 or Number == 2
                LC13_Platoon[30] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 75 * RecruitSizeModifier
            elsif Number == 3 or Number == 4
                LC13_Platoon[30] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 50 * RecruitSizeModifier
            elsif Number == 5
                LC13_Platoon[30] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 150 * RecruitSizeModifier
            end if
            LC13_RecruitTimer1 = create timer for 220 * RecruitModifier seconds
            enable platoon LC13_Platoon[30] respond to town AztecCapital attack
            wait until not LC13_Platoon[30] recruiting
            AttackDir[0] = number from 1 to 3
            if AttackDir[0] == 1
                AttackingPosition = marker at {AttackPos[0]} + {0,0,0}
                AttackingPositionFallBack = marker at {AttackPos[1]} + {0,0,0}
            elsif AttackDir[1] == 2
                AttackingPosition = marker at {AttackPos[2]} + {0,0,0}
                AttackingPositionFallBack = marker at {AttackPos[3]} + {0,0,0}
            else
                AttackingPosition = marker at {AttackPos[4]} + {0,0,0}
                AttackingPositionFallBack = marker at {AttackPos[5]} + {0,0,0}
            end if
            run background script LC13_GenericTalusSpeeches(LC13_Platoon[30],1)
            if Number == 1 or Number == 2
                run background script LC13_ArmyBehaivours(LC13_Platoon[30],Ranged,Attacker,0,AttackingPosition,AttackingPositionFallBack,0,0)
            elsif Number == 3 or Number == 4
                run background script LC13_ArmyBehaivours(LC13_Platoon[30],Melee,Attacker,0,AttackingPosition,AttackingPositionFallBack,0,0)
            elsif Number == 5
                run background script LC13_ArmyBehaivours(LC13_Platoon[30],Melee,Attacker,0,AttackingPosition,AttackingPositionFallBack,0,0)
            end if

        elsif LC13_Platoon[31] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC13_RecruitTimer1 time remaining <= 0 and TownsConverted >= 2
            Number = number from 1 to 5
            if Number == 1 or Number == 2
                LC13_Platoon[31] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 75 * RecruitSizeModifier
            elsif Number == 3 or Number == 4
                LC13_Platoon[31] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 50 * RecruitSizeModifier
            elsif Number == 5
                LC13_Platoon[31] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 150 * RecruitSizeModifier
            end if
            LC13_RecruitTimer1 = create timer for 200 * RecruitModifier seconds
            enable platoon LC13_Platoon[31] respond to town AztecCapital attack
            wait until not LC13_Platoon[31] recruiting
            if AttackDir[0] == 1
                AttackingPosition = marker at {AttackPos[0]} + {0,0,0}
                AttackingPositionFallBack = marker at {AttackPos[1]} + {0,0,0}
            elsif AttackDir[1] == 2
                AttackingPosition = marker at {AttackPos[2]} + {0,0,0}
                AttackingPositionFallBack = marker at {AttackPos[3]} + {0,0,0}
            else
                AttackingPosition = marker at {AttackPos[4]} + {0,0,0}
                AttackingPositionFallBack = marker at {AttackPos[5]} + {0,0,0}
            end if
            run background script LC13_GenericTalusSpeeches(LC13_Platoon[31],1)
            if Number == 1 or Number == 2
                run background script LC13_ArmyBehaivours(LC13_Platoon[31],Ranged,Attacker,0,AttackingPosition,AttackingPositionFallBack,0,0)
            elsif Number == 3 or Number == 4
                run background script LC13_ArmyBehaivours(LC13_Platoon[31],Melee,Attacker,0,AttackingPosition,AttackingPositionFallBack,0,0)
            elsif Number == 5
                run background script LC13_ArmyBehaivours(LC13_Platoon[31],Melee,Attacker,0,AttackingPosition,AttackingPositionFallBack,0,0)
            end if

        elsif LC13_Platoon[32] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC13_RecruitTimer1 time remaining <= 0 and TownsConverted >= 2
            LC13_Platoon[32] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 90 * RecruitSizeModifier
            LC13_RecruitTimer1 = create timer for 200 * RecruitModifier seconds
            enable platoon LC13_Platoon[32] respond to town AztecCapital attack
            wait until not LC13_Platoon[32] recruiting
            if AttackDir[0] == 1
                AttackingPosition = marker at {AttackPos[0]} + {0,0,0}
                AttackingPositionFallBack = marker at {AttackPos[1]} + {0,0,0}
            elsif AttackDir[1] == 2
                AttackingPosition = marker at {AttackPos[2]} + {0,0,0}
                AttackingPositionFallBack = marker at {AttackPos[3]} + {0,0,0}
            else
                AttackingPosition = marker at {AttackPos[4]} + {0,0,0}
                AttackingPositionFallBack = marker at {AttackPos[5]} + {0,0,0}
            end if
            run background script LC13_GenericTalusSpeeches(LC13_Platoon[32],1)
            run background script LC13_ArmyBehaivours(LC13_Platoon[32],Ranged,Attacker,0,AttackingPosition,AttackingPositionFallBack,0,0)

        elsif LC13_SiegeCatapult[12] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC13_RecruitTimer1 time remaining <= 0 and TownsConverted >= 2
            LC13_SiegeCatapult[12] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_7 town AztecCapital siege weapon
            LC13_RecruitTimer1 = create timer for 80 * RecruitModifier seconds
            if AttackDir[0] == 1
                SiegeWaypoint1 = marker at {SiegeRoute1[0]}
                SiegeWaypoint2 = marker at {SiegeRoute1[0]} + {0,0}
                SiegeWaypoint3 = marker at {SiegeRoute1[0]} + {0,0}
            elsif AttackDir[1] == 2
                SiegeWaypoint1 = marker at {SiegeRoute2[0]}
                SiegeWaypoint2 = marker at {SiegeRoute2[0]} + {0,0}
                SiegeWaypoint3 = marker at {SiegeRoute2[0]} + {0,0}
            else
                SiegeWaypoint1 = marker at {SiegeRoute3[0]}
                SiegeWaypoint2 = marker at {SiegeRoute3[0]} + {0,0}
                SiegeWaypoint3 = marker at {SiegeRoute3[0]} + {0,0}
            end if
            run background script LC13_MoveCatapultThenAttack(LC13_SiegeCatapult[12],0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)

        elsif LC13_SiegeCatapult[13] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC13_RecruitTimer1 time remaining <= 0 and TownsConverted >= 2
            LC13_SiegeCatapult[13] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_7 town AztecCapital siege weapon
            LC13_RecruitTimer1 = create timer for 80 * RecruitModifier seconds
            if AttackDir[0] == 1
                SiegeWaypoint1 = marker at {SiegeRoute1[0]}
                SiegeWaypoint2 = marker at {SiegeRoute1[0]} + {0,0}
                SiegeWaypoint3 = marker at {SiegeRoute1[0]} + {0,0}
            elsif AttackDir[1] == 2
                SiegeWaypoint1 = marker at {SiegeRoute2[0]}
                SiegeWaypoint2 = marker at {SiegeRoute2[0]} + {0,0}
                SiegeWaypoint3 = marker at {SiegeRoute2[0]} + {0,0}
            else
                SiegeWaypoint1 = marker at {SiegeRoute3[0]}
                SiegeWaypoint2 = marker at {SiegeRoute3[0]} + {0,0}
                SiegeWaypoint3 = marker at {SiegeRoute3[0]} + {0,0}
            end if
            run background script LC13_MoveCatapultThenAttack(LC13_SiegeCatapult[13],0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)

        elsif LC13_SiegeCatapult[14] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC13_RecruitTimer1 time remaining <= 0 and TownsConverted >= 2
            LC13_SiegeCatapult[14] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_7 town AztecCapital siege weapon
            LC13_RecruitTimer1 = create timer for 80 * RecruitModifier seconds
            if AttackDir[0] == 1
                SiegeWaypoint1 = marker at {SiegeRoute1[0]}
                SiegeWaypoint2 = marker at {SiegeRoute1[0]} + {0,0}
                SiegeWaypoint3 = marker at {SiegeRoute1[0]} + {0,0}
            elsif AttackDir[1] == 2
                SiegeWaypoint1 = marker at {SiegeRoute2[0]}
                SiegeWaypoint2 = marker at {SiegeRoute2[0]} + {0,0}
                SiegeWaypoint3 = marker at {SiegeRoute2[0]} + {0,0}
            else
                SiegeWaypoint1 = marker at {SiegeRoute3[0]}
                SiegeWaypoint2 = marker at {SiegeRoute3[0]} + {0,0}
                SiegeWaypoint3 = marker at {SiegeRoute3[0]} + {0,0}
            end if
            run background script LC13_MoveCatapultThenAttack(LC13_SiegeCatapult[14],0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)
    

        //Attack NearestSettlement
        elsif LC13_Platoon[26] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get AttackNearestTownTimer time remaining <= 0 and AttackingPlatoons == 1
            LC13_Platoon[26] = recruit ARMY_UNIT_TYPE_MELEE_4 town AztecCapital platoon of size 45 * RecruitSizeModifier
            LC13_RecruitTimer1 = create timer for 200 * RecruitModifier seconds
            enable platoon LC13_Platoon[26] respond to town AztecCapital attack
            wait until not LC13_Platoon[26] recruiting
            run background script LC13_ArmyBehaivours(LC13_Platoon[26],Melee,Conqueror,LC13_SiegeCatapult[9],0,0,0,0)
            run background script LC13_GenericTalusSpeeches(LC13_Platoon[26],1)

        elsif LC13_Platoon[27] not exists and LC13_Platoon[26] exists and {LC13_Platoon[26]} near {AztecCapital} radius 400 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get AttackNearestTownTimer time remaining <= 0 and AttackingPlatoons == 1
            LC13_Platoon[27] = recruit ARMY_UNIT_TYPE_MELEE_4 town AztecCapital platoon of size 45 * RecruitSizeModifier
            LC13_RecruitTimer1 = create timer for 200 * RecruitModifier seconds
            enable platoon LC13_Platoon[27] respond to town AztecCapital attack
            wait until not LC13_Platoon[27] recruiting
            run background script LC13_ArmyBehaivours(LC13_Platoon[27],Melee,Conqueror,LC13_SiegeCatapult[9],0,0,0,0)
            run background script LC13_GenericTalusSpeeches(LC13_Platoon[27],1)

        elsif LC13_Platoon[28] not exists and LC13_Platoon[26] exists and {LC13_Platoon[26]} near {AztecCapital} radius 400 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get AttackNearestTownTimer time remaining <= 0 and AttackingPlatoons == 1
            LC13_Platoon[28] = recruit ARMY_UNIT_TYPE_RANGED_4 town AztecCapital platoon of size 50 * RecruitSizeModifier
            LC13_RecruitTimer1 = create timer for 200 * RecruitModifier seconds
            enable platoon LC13_Platoon[28] respond to town AztecCapital attack
            wait until not LC13_Platoon[28] recruiting
            run background script LC13_ArmyBehaivours(LC13_Platoon[28],Melee,Conqueror,LC13_SiegeCatapult[10],0,0,0,0)
            run background script LC13_GenericTalusSpeeches(LC13_Platoon[28],1)

        elsif LC13_Platoon[29] not exists and LC13_Platoon[26] exists and {LC13_Platoon[26]} near {AztecCapital} radius 400 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get AttackNearestTownTimer time remaining <= 0 and AttackingPlatoons == 1
            LC13_Platoon[29] = recruit ARMY_UNIT_TYPE_RANGED_4 town AztecCapital platoon of size 60 * RecruitSizeModifier
            LC13_RecruitTimer1 = create timer for 200 * RecruitModifier seconds
            enable platoon LC13_Platoon[29] respond to town AztecCapital attack
            wait until not LC13_Platoon[29] recruiting
            run background script LC13_ArmyBehaivours(LC13_Platoon[29],Melee,Conqueror,LC13_SiegeCatapult[11],0,0,0,0)
            run background script LC13_GenericTalusSpeeches(LC13_Platoon[29],1)

        elsif LC13_SiegeCatapult[9] not exists and LC13_Platoon[26] exists and {LC13_Platoon[26]} near {AztecCapital} radius 400 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get AttackNearestTownTimer time remaining <= 0 and AttackingPlatoons == 1
            LC13_SiegeCatapult[9] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_5 town AztecCapital siege weapon
            LC13_RecruitTimer1 = create timer for 200 * RecruitModifier seconds
            run background script LC13_MoveCatapultThenAttack(LC13_SiegeCatapult[9],Conqueror,0,0,0)

        elsif LC13_SiegeCatapult[10] not exists and LC13_Platoon[26] exists and {LC13_Platoon[26]} near {AztecCapital} radius 400 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get AttackNearestTownTimer time remaining <= 0 and AttackingPlatoons == 1
            LC13_SiegeCatapult[10] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_5 town AztecCapital siege weapon
            LC13_RecruitTimer1 = create timer for 200 * RecruitModifier seconds
            run background script LC13_MoveCatapultThenAttack(LC13_SiegeCatapult[10],Conqueror,0,0,0)

        elsif LC13_SiegeCatapult[11] not exists and LC13_Platoon[26] exists and {LC13_Platoon[26]} near {AztecCapital} radius 400 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get AttackNearestTownTimer time remaining <= 0 and AttackingPlatoons == 1
            LC13_SiegeCatapult[11] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_5 town AztecCapital siege weapon
            LC13_RecruitTimer1 = create timer for 200 * RecruitModifier seconds
            run background script LC13_MoveCatapultThenAttack(LC13_SiegeCatapult[11],Conqueror,0,0,0)

        //AztecTown1
        elsif LC13_Platoon[14] not exists and PLAYER of AztecTown1 == 1 and not town AztecTown1 is under takeover from player 0 and get LC13_RecruitTimer2 time remaining <= 0
            LC13_Platoon[14] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecTown1 platoon of size 60 * RecruitSizeModifier
            LC13_RecruitTimer2 = create timer for 240 * RecruitModifier seconds
            enable platoon LC13_Platoon[14] respond to town AztecTown1 attack
            wait until not LC13_Platoon[14] recruiting
            run background script LC13_StaticPlatoonsActions(PlatoonPos[9],Melee,LC13_Platoon[14])
            run background script LC13_GenericTalusSpeeches(LC13_Platoon[14],1)

        elsif LC13_Platoon[15] not exists and PLAYER of AztecTown1 == 1 and not town AztecTown1 is under takeover from player 0 and get LC13_RecruitTimer2 time remaining <= 0
            LC13_Platoon[15] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecTown1 platoon of size 60 * RecruitSizeModifier
            LC13_RecruitTimer2 = create timer for 240 * RecruitModifier seconds
            enable platoon LC13_Platoon[15] respond to town AztecTown1 attack
            wait until not LC13_Platoon[15] recruiting
            run background script LC13_StaticPlatoonsActions(PlatoonPos[10],Ranged,LC13_Platoon[15])
            run background script LC13_GenericTalusSpeeches(LC13_Platoon[15],1)

        //AztecTown2
        elsif LC13_Platoon[6] not exists and PLAYER of AztecTown2 == 1 and not town AztecTown2 is under takeover from player 0 and get LC13_RecruitTimer3 time remaining <= 0
            LC13_Platoon[6] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecTown2 platoon of size 30 * RecruitSizeModifier
            LC13_RecruitTimer3 = create timer for 240 * RecruitModifier seconds
            enable platoon LC13_Platoon[6] respond to town AztecTown2 attack
            wait until not LC13_Platoon[6] recruiting
            run background script LC13_StaticPlatoonsActions(PlatoonPos[6],Ranged,LC13_Platoon[6])
            run background script LC13_GenericTalusSpeeches(LC13_Platoon[6],1)

        elsif LC13_Platoon[7] not exists and PLAYER of AztecTown2 == 1 and not town AztecTown2 is under takeover from player 0 and get LC13_RecruitTimer3 time remaining <= 0
            LC13_Platoon[7] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecTown2 platoon of size 30 * RecruitSizeModifier
            LC13_RecruitTimer3 = create timer for 240 * RecruitModifier seconds
            enable platoon LC13_Platoon[7] respond to town AztecTown2 attack
            wait until not LC13_Platoon[7] recruiting
            run background script LC13_StaticPlatoonsActions(PlatoonPos[7],Ranged,LC13_Platoon[7])
            run background script LC13_GenericTalusSpeeches(LC13_Platoon[7],1)

        elsif LC13_Platoon[8] not exists and PLAYER of AztecTown2 == 1 and not town AztecTown2 is under takeover from player 0 and get LC13_RecruitTimer3 time remaining <= 0
            LC13_Platoon[8] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecTown2 platoon of size 30 * RecruitSizeModifier
            LC13_RecruitTimer3 = create timer for 240 * RecruitModifier seconds
            enable platoon LC13_Platoon[8] respond to town AztecTown2 attack
            wait until not LC13_Platoon[8] recruiting
            run background script LC13_StaticPlatoonsActions(PlatoonPos[8],Ranged,LC13_Platoon[8])
            run background script LC13_GenericTalusSpeeches(LC13_Platoon[8],1)

        //Skeleton Attacks
        elsif LC13_SiegeCatapult[4] not exists and LC13_NumberOfSkeletonPlatoons >= 2 and not town AztecCapital is under takeover from player 0
            LC13_SiegeCatapult[4] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_5 town AztecCapital siege weapon
            LC13_RecruitTimer1 = create timer for 80 * RecruitModifier seconds
            SiegeWaypoint1 = marker at {SiegeRoute2[0]}
            SiegeWaypoint2 = marker at {SiegeRoute2[1]} + {0,0}
            SiegeWaypoint3 = marker at {SiegeRoute2[2]} + {0,0}
            run background script LC13_MoveCatapultThenAttack(LC13_SiegeCatapult[4],0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)

        elsif LC13_SiegeCatapult[5] not exists and LC13_NumberOfSkeletonPlatoons >= 4 and not town AztecCapital is under takeover from player 0
            LC13_SiegeCatapult[5] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_5 town AztecCapital siege weapon
            LC13_RecruitTimer1 = create timer for 80 * RecruitModifier seconds
            SiegeWaypoint1 = marker at {SiegeRoute1[0]}
            SiegeWaypoint2 = marker at {SiegeRoute1[1]} + {0,0}
            SiegeWaypoint3 = marker at {SiegeRoute1[2]} + {0,0}
            run background script LC13_MoveCatapultThenAttack(LC13_SiegeCatapult[5],0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)

        elsif LC13_SiegeCatapult[6] not exists and LC13_NumberOfSkeletonPlatoons >= 4 and not town AztecCapital is under takeover from player 0
            LC13_SiegeCatapult[6] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_5 town AztecCapital siege weapon
            LC13_RecruitTimer1 = create timer for 80 * RecruitModifier seconds
            SiegeWaypoint1 = marker at {SiegeRoute1[0]}
            SiegeWaypoint2 = marker at {SiegeRoute1[1]} + {30,0}
            SiegeWaypoint3 = marker at {SiegeRoute1[2]} + {30,0}
            run background script LC13_MoveCatapultThenAttack(LC13_SiegeCatapult[6],0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)

        elsif LC13_SiegeCatapult[7] not exists and LC13_NumberOfSkeletonPlatoons >= 6 and not town AztecCapital is under takeover from player 0
            LC13_SiegeCatapult[7] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_5 town AztecCapital siege weapon
            LC13_RecruitTimer1 = create timer for 80 * RecruitModifier seconds
            SiegeWaypoint1 = marker at {SiegeRoute3[0]}
            SiegeWaypoint2 = marker at {SiegeRoute3[1]} + {30,0}
            SiegeWaypoint3 = marker at {SiegeRoute3[2]} + {30,0}
            run background script LC13_MoveCatapultThenAttack(LC13_SiegeCatapult[7],0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)

        elsif LC13_SiegeCatapult[8] not exists and LC13_NumberOfSkeletonPlatoons >= 6 and not town AztecCapital is under takeover from player 0
            LC13_SiegeCatapult[8] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_5 town AztecCapital siege weapon
            LC13_RecruitTimer1 = create timer for 80 * RecruitModifier seconds
            SiegeWaypoint1 = marker at {SiegeRoute3[0]}
            SiegeWaypoint2 = marker at {SiegeRoute3[1]} + {30,0}
            SiegeWaypoint3 = marker at {SiegeRoute3[2]} + {30,0}
            run background script LC13_MoveCatapultThenAttack(LC13_SiegeCatapult[8],0,SiegeWaypoint1,SiegeWaypoint2,SiegeWaypoint3)

        end if

        if PLAYER of AztecCapital == 0 or PLAYER of AztecTown1 == 0 or PLAYER of AztecTown2 == 0 or PLAYER of MinorTown2 == 0 or PLAYER of MinorTown3 == 0 or PLAYER of MinorTown4 == 0 or PLAYER of MinorTown5 == 0 or PLAYER of MinorTown6 == 0 or PLAYER of MinorTown8 == 0 or PLAYER of AztecCapital != 1
            //Take over a town and start attacking the player a lot    
            if NearestSettlement != 0 and PLAYER of NearestSettlement == 0
                AttackingPlatoons = 1
            end if

        elsif PLAYER of NearestSettlement == 1 and AttackingPlatoons == 1
            //Attack PlayerTown with remaining troops
            AttackingPlatoons = 0
        end if

        if get VolcanoTimer time remaining <= 300 and PLAYER of AztecCapital == 1 and HEALTH of AIVolcano >= 1.0 and CHARGE of AIVolcano != 1.0
            CHARGE of AIVolcano = 1.0
        end if

        if HEALTH of AIVolcano >= 1.0 and get VolcanoTimer time remaining <= 0 and PLAYER of AztecCapital == 1 and CinemaIsRunning == 0 and not town PlayerTown is under takeover from player 1 and PLAYER of PlayerTown == 0
            if get VolcanoTimer time remaining <= 0 and PLAYER of AztecTown2 != 1
                enable predefined sky "VOLCANO" time 9

                if VolcanoFired == 0
                    VolcanoFired = 1
                end if

                Number = number from 1 to 3
                if Number == 1
                    CastEpicPos = marker at {1187.32,75.92,375.34}
                elsif Number == 2
                    CastEpicPos = marker at {1041.70,61.99,448.07}
                else
                    CastEpicPos = marker at {964.85,74.35,599.37}
                end if

                run script EpicTargeter(PlayerTown,marker at {CastEpicPos},1)
                    
                VolcanoWarning = create visual effect VISUAL_EFFECT_EPIC_TARGET_WARNING at {ET_FireEpicLocation} time 15 target {ET_FireEpicLocation}
                wait 15 seconds
                EpicVolc = create volcano at {ET_FireEpicLocation} player 1
                    
                run background script LC13_Volcano(AIVolcano, EpicVolc)

                VolcanoTimer = create timer for VOLCANODELAY * EpicModifier seconds
                VOLCANODELAY += 750
            end if
        end if

        if PLAYER of AztecTown2 != 1 and MiracleThunderstormStarted == 0
            MiracleThunderstormStarted = 1
            ThunderstormTimer = create timer for 540 seconds
        end if

        if CaptureAztecTown1 == 0
            if TownsConverted >= 3 or TownsAggressiveConverted >= 1
                CaptureAztecTown1 = 1
            end if
        end if

        if PLAYER of AztecTown1 == 1 and MiracleTimerStarted == 0
            MiracleTimerStarted = 1
            ThrowMiracleTimer = create timer for 60 seconds
        end if

        //Send Platoons to Stonehenge
        if get SendStonehengeTroops time remaining <= 0
            if LC13_Platoon[33] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0
                LC13_Platoon[33] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 30 * RecruitSizeModifier
                enable platoon LC13_Platoon[33] respond to town AztecCapital attack
                wait until not LC13_Platoon[33] recruiting
                AttackingPosition = marker at {1253.43,133.39,803.14} + {-15,0,-15}
                run background script LC13_GenericTalusSpeeches(LC13_Platoon[33],1)
                run background script LC13_ArmyBehaivours(LC13_Platoon[33],Ranged,GoToStonehenge,LC13_Platoon[30],AttackingPosition,0,0,0)
                run background script LC13_CheckStonehenge(LC13_Platoon[33],0)
            end if
            if LC13_Platoon[34] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0
                LC13_Platoon[34] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 30 * RecruitSizeModifier
                enable platoon LC13_Platoon[34] respond to town AztecCapital attack
                wait until not LC13_Platoon[34] recruiting
                AttackingPosition = marker at {1253.43,133.39,803.14} + {15,0,15}
                run background script LC13_GenericTalusSpeeches(LC13_Platoon[34],1)
                run background script LC13_ArmyBehaivours(LC13_Platoon[34],Ranged,GoToStonehenge,LC13_Platoon[31],AttackingPosition,0,0,0)
                run background script LC13_CheckStonehenge(LC13_Platoon[34],0)
            end if
            SendStonehengeTroops = create timer for 900 * RecruitModifier seconds
        end if

        //Attack AztecTown1
        if TownsConverted >= 3 and PLAYER of AztecTown1 != 1 and CaptureAztecTown1 == 1 and not town AztecTown1 is under takeover from player 1 and get AttackAztecTown1Timer time remaining <= 0
            if LC13_Platoon[22] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0
                LC13_Platoon[22] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 25 * RecruitSizeModifier
                LC13_RecruitTimer1 = create timer for 300 * RecruitModifier seconds
                enable platoon LC13_Platoon[22] respond to town AztecCapital attack
                wait until not LC13_Platoon[22] recruiting
                AttackingPosition = marker at {1326.08,133.27,746.30} + {0,0,0}
                AttackingPositionFallBack = marker at {1245.49,141.35,898.79} + {0,0,0}
                run background script LC13_GenericTalusSpeeches(LC13_Platoon[22],1)
                run background script LC13_ArmyBehaivours(LC13_Platoon[22],Melee,CaptureSpecTown,0,AttackingPosition,AttackingPositionFallBack,0,0)
            end if

            if LC13_Platoon[23] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0
                LC13_Platoon[23] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 25 * RecruitSizeModifier
                LC13_RecruitTimer1 = create timer for 300 * RecruitModifier seconds
                enable platoon LC13_Platoon[23] respond to town AztecCapital attack
                wait until not LC13_Platoon[23] recruiting
                AttackingPosition = marker at {1326.08,133.27,746.30} + {25,0,0}
                AttackingPositionFallBack = marker at {1245.49,141.35,898.79} + {25,0,0}
                run background script LC13_GenericTalusSpeeches(LC13_Platoon[23],1)
                run background script LC13_ArmyBehaivours(LC13_Platoon[23],Melee,CaptureSpecTown,0,AttackingPosition,AttackingPositionFallBack,0,0)
            end if

            if LC13_Platoon[24] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0
                LC13_Platoon[24] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 25 * RecruitSizeModifier
                LC13_RecruitTimer1 = create timer for 300 * RecruitModifier seconds
                enable platoon LC13_Platoon[24] respond to town AztecCapital attack
                wait until not LC13_Platoon[24] recruiting
                AttackingPosition = marker at {1326.08,133.27,746.30} + {0,0,25}
                AttackingPositionFallBack = marker at {1245.49,141.35,898.79} + {0,0,25}
                run background script LC13_GenericTalusSpeeches(LC13_Platoon[24],1)
                run background script LC13_ArmyBehaivours(LC13_Platoon[24],Ranged,CaptureSpecTown,0,AttackingPosition,AttackingPositionFallBack,0,0)
            end if

            if LC13_Platoon[25] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0
                LC13_Platoon[25] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 25 * RecruitSizeModifier
                LC13_RecruitTimer1 = create timer for 300 * RecruitModifier seconds
                enable platoon LC13_Platoon[25] respond to town AztecCapital attack
                wait until not LC13_Platoon[25] recruiting
                AttackingPosition = marker at {1326.08,133.27,746.30} + {15,0,15}
                AttackingPositionFallBack = marker at {1245.49,141.35,898.79} + {15,0,15}
                run background script LC13_GenericTalusSpeeches(LC13_Platoon[25],1)
                run background script LC13_ArmyBehaivours(LC13_Platoon[25],Ranged,CaptureSpecTown,0,AttackingPosition,AttackingPositionFallBack,0,0)
            end if

            AttackAztecTown1Timer = create timer for 1500 seconds
        end if
    end loop

end script LC13_Aztec_Capital


begin script LC13_DefendPlatoons

    PlayerPlatoon = 0
    DefendRecruitTimer1 = create timer for 0 seconds
    DefendRecruitTimer2 = create timer for 0 seconds
    DefendRecruitTimer3 = create timer for 0 seconds

    DefenderPlatoon[8]
    DelayDone = 0

start

    begin loop
        if PLAYER of AztecTown1 == 1 and DelayDone == 0
            DefendRecruitTimer1 = create timer for 300 seconds
            DelayDone = 1
        end if
        PlayerPlatoon = get platoon of player 0 nearest {AztecTown1} radius 250
        if PlayerPlatoon exists and DefenderPlatoon[0] not exists and DefenderPlatoon[0] not exists and get DefendRecruitTimer1 time remaining <= 0 and PLAYER of AztecTown1 == 1 //Makes a couple of defend platoons
            DefenderPlatoon[0] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecTown1 platoon of size 30 * RecruitSizeModifier
            enable platoon DefenderPlatoon[0] respond to town AztecTown1 attack
            wait until not DefenderPlatoon[0] recruiting
            
            DefenderPlatoon[1] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecTown1 platoon of size 30 * RecruitSizeModifier
            enable platoon DefenderPlatoon[1] respond to town AztecTown1 attack
            wait until not DefenderPlatoon[1] recruiting
            
            DefendRecruitTimer1 = create timer for 180 * RecruitModifier seconds
        end if

        PlayerPlatoon = get platoon of player 0 nearest {AztecTown2} radius 250
        if PlayerPlatoon exists and DefenderPlatoon[2] not exists and DefenderPlatoon[3] not exists and get DefendRecruitTimer2 time remaining <= 0 and PLAYER of AztecTown2 == 1 //Makes a couple of defend platoons
            DefenderPlatoon[2] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecTown2 platoon of size 30 * RecruitSizeModifier
            enable platoon DefenderPlatoon[2] respond to town AztecTown2 attack
            wait until not DefenderPlatoon[2] recruiting
            
            DefenderPlatoon[3] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecTown2 platoon of size 30 * RecruitSizeModifier
            enable platoon DefenderPlatoon[3] respond to town AztecTown2 attack
            wait until not DefenderPlatoon[3] recruiting

            DefendRecruitTimer2 = create timer for 180 * RecruitModifier seconds
        end if

        PlayerPlatoon = get platoon of player 0 nearest {AztecCapital} radius 250
        if PlayerPlatoon exists and DefenderPlatoon[4] not exists and DefenderPlatoon[5] not exists and get DefendRecruitTimer3 time remaining <= 0 and PLAYER of AztecCapital == 1 //Makes a couple of defend platoons
            DefenderPlatoon[4] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 35 * RecruitSizeModifier
            enable platoon DefenderPlatoon[4] respond to town AztecCapital attack
            wait until not DefenderPlatoon[4] recruiting
            
            DefenderPlatoon[5] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 35 * RecruitSizeModifier
            enable platoon DefenderPlatoon[5] respond to town AztecCapital attack
            wait until not DefenderPlatoon[5] recruiting
            
            DefendRecruitTimer3 = create timer for 180 * RecruitModifier seconds
        end if
    end loop

end script LC13_DefendPlatoons


begin script LC13_GetNearestSettlement

    NearestTown = 0

start

begin loop
    if PLAYER of AztecCapital == 0
        NearestTown = AztecCapital

    elsif PLAYER of AztecTown1 == 0
        NearestTown = AztecTown1

    elsif PLAYER of AztecTown2 == 0
        NearestTown = AztecTown2

    elsif PLAYER of MinorTown2 == 0
        NearestTown = MinorTown2

    elsif PLAYER of MinorTown3 == 0
        NearestTown = MinorTown3

    elsif PLAYER of MinorTown4 == 0
        NearestTown = MinorTown4

    elsif PLAYER of MinorTown5 == 0
        NearestTown = MinorTown5

    elsif PLAYER of MinorTown6 == 0
        NearestTown = MinorTown6

    else
        NearestTown = PlayerTown

    end if

    NearestSettlement = NearestTown
    wait 45 seconds
end loop

end script LC13_GetNearestSettlement


begin script LC13_AttackNearestTownTimer

start

begin loop

    if get AttackNearestTownTimer time remaining <= 0
        wait 45 seconds
        AttackNearestTownTimer = create timer for 1200 * RecruitModifier seconds
    end if

end loop

end script LC13_AttackNearestTownTimer


begin script DisableLocalPlatoonResponse

    Counter = 0

start

begin loop
    if Counter > 99
        Counter = 0
        wait 30 seconds
    end if
    if LC13_Platoon[Counter] exists
        disable platoon LC13_Platoon[Counter] respond to local platoon attack
    end if
    if LC13_WallArcher[Counter] exists
        disable platoon LC13_WallArcher[Counter] respond to local platoon attack
    end if

    Counter++
end loop

end script DisableLocalPlatoonResponse


begin script LC13_AztecCapitalRessourceManager

start

begin loop

    wait 5 seconds

    if PLAYER of AztecCapital == 1
        if (get town AztecCapital RESOURCE_TYPE_ORE total < 25000)
            add resource RESOURCE_TYPE_ORE number from 100 to 500 to AztecCapital
        elsif (get town AztecCapital RESOURCE_TYPE_WOOD total < 25000)
            add resource RESOURCE_TYPE_WOOD number from 500 to 1000 to AztecCapital
        elsif (get town AztecCapital RESOURCE_TYPE_FOOD total < 25000)
            add resource RESOURCE_TYPE_FOOD number from 500 to 1500 to AztecCapital
        end if
    end if
    until PLAYER of AztecCapital != 1
end loop    

end script LC13_AztecCapitalRessourceManager

begin script LC13_AztecCapitalVillagerManager

    Counter = 0
    Villager = 0
    HousesBuilt = 0
    RoadPos = marker at {481.25,408.44,1058.25}
    Road = 0

start

begin loop

    wait 900 * BuilderModifier seconds
    Counter = 0

    if PLAYER of AztecCapital == 1
        if HousesBuilt == 0
            HousesBuilt = 1
            build all town AztecCapital buildings in group 10
            Road = build building at {RoadPos} desire 1
            release Road
        end if
        begin loop
            Villager = create random villager of tribe TRIBE_TYPE_AZTEC at {AztecCapital} + {number from -12 to 12, 0, number from -12 to 12}//create VILLAGER VILLAGER_INFO_JAPANESE_FORESTER_MALE at {1013.581, 132.333, 2002.798} + {number from -3 to 3, 0, number from -3 to 3}
            attach Villager to AztecCapital
            release Villager
            
            wait number from 6 to 10 seconds
            Counter++
            until Counter >= 50 or PLAYER of AztecCapital != 1
        end loop
    end if

end loop

end script LC13_AztecCapitalVillagerManager

begin script LC13_AztecTown1RessourceManager

start

begin loop

    wait 5 seconds

    if PLAYER of AztecTown1 == 1
        if (get town AztecTown1 RESOURCE_TYPE_ORE total < 17000)
            add resource RESOURCE_TYPE_ORE number from 100 to 500 to AztecTown1
        elsif (get town AztecTown1 RESOURCE_TYPE_WOOD total < 17000)
            add resource RESOURCE_TYPE_WOOD number from 500 to 1000 to AztecTown1
        elsif (get town AztecTown1 RESOURCE_TYPE_FOOD total < 17000)
            add resource RESOURCE_TYPE_FOOD number from 500 to 1500 to AztecTown1
        end if
    end if

end loop    

end script LC13_AztecTown1RessourceManager

begin script LC13_AztecTown1VillagerManager

    Counter = 0
    Villager = 0
    HousesBuilt = 0

start

begin loop

    wait 900 * BuilderModifier seconds
    Counter = 0

    if PLAYER of AztecTown1 == 1
        if HousesBuilt == 0
            HousesBuilt = 1
            build all town AztecTown1 buildings in group 10
        end if
        begin loop
            Villager = create random villager of tribe TRIBE_TYPE_AZTEC at {AztecTown1} + {number from -12 to 12, 0, number from -12 to 12}//create VILLAGER VILLAGER_INFO_JAPANESE_FORESTER_MALE at {1013.581, 132.333, 2002.798} + {number from -3 to 3, 0, number from -3 to 3}
            attach Villager to AztecTown1
            release Villager
            
            wait number from 6 to 10 seconds
            Counter++
            until Counter >= 20 or PLAYER of AztecTown1 != 1
        end loop
    end if

end loop

end script LC13_AztecTown1VillagerManager

begin script LC13_AztecTown2RessourceManager

start

begin loop

    wait 5 seconds

    if PLAYER of AztecTown2 == 1
        if (get town AztecTown2 RESOURCE_TYPE_ORE total < 35000)
            add resource RESOURCE_TYPE_ORE number from 100 to 500 to AztecTown2
        elsif (get town AztecTown2 RESOURCE_TYPE_WOOD total < 35000)
            add resource RESOURCE_TYPE_WOOD number from 500 to 1000 to AztecTown2
        elsif (get town AztecTown2 RESOURCE_TYPE_FOOD total < 35000)
            add resource RESOURCE_TYPE_FOOD number from 500 to 1500 to AztecTown2
        end if
    end if

end loop    

end script LC13_AztecTown2RessourceManager

begin script LC13_AztecTown2VillagerManager

    Counter = 0
    Villager = 0
    HousesBuilt = 0

start

begin loop

    wait 900 * BuilderModifier seconds
    Counter = 0

    if PLAYER of AztecTown2 == 1
        if HousesBuilt == 0
            HousesBuilt = 1
            build all town AztecTown2 buildings in group 10
        end if
        begin loop
            Villager = create random villager of tribe TRIBE_TYPE_GREEK at {AztecTown2} + {number from -12 to 12, 0, number from -12 to 12}//create VILLAGER VILLAGER_INFO_JAPANESE_FORESTER_MALE at {1013.581, 132.333, 2002.798} + {number from -3 to 3, 0, number from -3 to 3}
            attach Villager to AztecTown2
            release Villager
            
            wait number from 6 to 10 seconds
            Counter++
            until Counter >= 20 or PLAYER of AztecTown2 != 1
        end loop
    end if

end loop

end script LC13_AztecTown2VillagerManager


begin script LC13_DeathSpell(PlayerID,SpellPosition,GodPosition)

    myEffect = 0
    myWonder = 0
    AttackingPosition = 0
    AttackingPositionFallBack = 0
    SacrificePoint = marker at {977.41,279.34,1748.11}

start

    //Effects here
    myWonder = make player 1 throw miracle MIRACLE_TYPE_METEOR from ({GodPosition} + {0,-1.25,0}) heading ({SpellPosition} + {0,0,0} - {GodPosition})
    set myWonder color red 148 green 0 blue 211
    wait 2.5 seconds
    delete myWonder

    myEffect = create visual effect VISUAL_MIRACLE_METEOR_GROUND at {SpellPosition} time 25
    set myWonder color red 148 green 0 blue 211
    SCALE of myWonder = 1.0
    wait 1.5 seconds
    myEffect = create visual effect VISUAL_MIRACLE_HEAL_GROUND at {SpellPosition}  + {0,5,0} time 25
    set myWonder color red 148 green 0 blue 211
    SCALE of myWonder = 2.5

    //Spawn Skeletons here
    if SkeletonsWave == 0 or SkeletonsWave == 1
        LC13_NumberOfSkeletonPlatoons = 2
        wait 5 seconds

        //Platoon1
        LC13_Platoon[16] = create platoon ARMY_UNIT_TYPE_MELEE_8 at {SacrificePoint} + {0,0,0} with 1 men and 0 women
        LC13_RecruitTimer2 = create timer for 240 * RecruitModifier seconds
        PLAYER of LC13_Platoon[16] = 1
        enable platoon LC13_Platoon[16] respond to town AztecCapital attack
        run background script LC13_CreateUndeadPlatoon(LC13_Platoon[16],1,40 * RecruitSizeModifier,s_skeletonadultland2)

        //Platoon2
        LC13_Platoon[17] = create platoon ARMY_UNIT_TYPE_MELEE_8 at {SacrificePoint} + {20,0,0} with 1 men and 0 women
        LC13_RecruitTimer2 = create timer for 240 * RecruitModifier seconds
        PLAYER of LC13_Platoon[17] = 1
        enable platoon LC13_Platoon[17] respond to town AztecCapital attack
        run background script LC13_CreateUndeadPlatoon(LC13_Platoon[17],1,40 * RecruitSizeModifier,s_skeletonadultland2)

        //Activate Behaivours
        wait 15 seconds

        AttackingPosition = marker at {AttackPos[2]}
        AttackingPositionFallBack = marker at {AttackPos[3]}
        run background script LC13_ArmyBehaivours(LC13_Platoon[16],Melee,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)
        run background script LC13_GenericTalusSpeeches(LC13_Platoon[16],1)

        AttackingPosition = marker at {AttackPos[2]}
        AttackingPositionFallBack = marker at {AttackPos[3]}
        run background script LC13_ArmyBehaivours(LC13_Platoon[17],Melee,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)
        run background script LC13_GenericTalusSpeeches(LC13_Platoon[17],1)

        wait 15 seconds

        LC13_NumberOfSkeletonPlatoons = 0
    elsif SkeletonsWave == 2 or SkeletonsWave == 3
        LC13_NumberOfSkeletonPlatoons = 4
        wait 5 seconds

        //Platoon1
        LC13_Platoon[16] = create platoon ARMY_UNIT_TYPE_MELEE_8 at {SacrificePoint} + {0,0,0} with 1 men and 0 women
        LC13_RecruitTimer2 = create timer for 240 * RecruitModifier seconds
        PLAYER of LC13_Platoon[16] = 1
        enable platoon LC13_Platoon[16] respond to town AztecCapital attack
        run background script LC13_CreateUndeadPlatoon(LC13_Platoon[16],1,40 * RecruitSizeModifier,s_skeletonadultland2)

        //Platoon2
        LC13_Platoon[17] = create platoon ARMY_UNIT_TYPE_MELEE_8 at {SacrificePoint} + {20,0,0} with 1 men and 0 women
        LC13_RecruitTimer2 = create timer for 240 * RecruitModifier seconds
        PLAYER of LC13_Platoon[17] = 1
        enable platoon LC13_Platoon[17] respond to town AztecCapital attack
        run background script LC13_CreateUndeadPlatoon(LC13_Platoon[17],1,40 * RecruitSizeModifier,s_skeletonadultland2)

        //Platoon3
        LC13_Platoon[18] = create platoon ARMY_UNIT_TYPE_MELEE_8 at {SacrificePoint} + {-20,0,0} with 1 men and 0 women
        LC13_RecruitTimer2 = create timer for 240 * RecruitModifier seconds
        PLAYER of LC13_Platoon[18] = 1
        enable platoon LC13_Platoon[18] respond to town AztecCapital attack
        run background script LC13_CreateUndeadPlatoon(LC13_Platoon[18],1,40 * RecruitSizeModifier,s_skeletonadultland2)

        //Platoon4
        LC13_Platoon[19] = create platoon ARMY_UNIT_TYPE_MELEE_8 at {SacrificePoint} + {20,0,20} with 1 men and 0 women
        LC13_RecruitTimer2 = create timer for 240 * RecruitModifier seconds
        PLAYER of LC13_Platoon[19] = 1
        enable platoon LC13_Platoon[19] respond to town AztecCapital attack
        run background script LC13_CreateUndeadPlatoon(LC13_Platoon[19],1,40 * RecruitSizeModifier,s_skeletonadultland2)

        //Activate Behaivours
        wait 15 seconds

        AttackingPosition = marker at {AttackPos[2]} + {33,0,0}
        AttackingPositionFallBack = marker at {AttackPos[3]} + {33,0,0}
        run background script LC13_ArmyBehaivours(LC13_Platoon[16],Melee,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)
        run background script LC13_GenericTalusSpeeches(LC13_Platoon[16],1)

        AttackingPosition = marker at {AttackPos[2]} + {-33,0,0}
        AttackingPositionFallBack = marker at {AttackPos[3]} + {-33,0,0}
        run background script LC13_ArmyBehaivours(LC13_Platoon[17],Melee,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)
        run background script LC13_GenericTalusSpeeches(LC13_Platoon[17],1)

        AttackingPosition = marker at {AttackPos[0]} + {33,0,0}
        AttackingPositionFallBack = marker at {AttackPos[1]} + {33,0,0}
        run background script LC13_ArmyBehaivours(LC13_Platoon[18],Melee,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)
        run background script LC13_GenericTalusSpeeches(LC13_Platoon[18],1)

        AttackingPosition = marker at {AttackPos[0]} + {-33,0,0}
        AttackingPositionFallBack = marker at {AttackPos[1]} + {-33,0,0}
        run background script LC13_ArmyBehaivours(LC13_Platoon[19],Melee,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)
        run background script LC13_GenericTalusSpeeches(LC13_Platoon[19],1)

        wait 15 seconds

        LC13_NumberOfSkeletonPlatoons = 0

    elsif SkeletonsWave >= 4
        LC13_NumberOfSkeletonPlatoons = 4
        wait 5 seconds

        //Platoon1
        LC13_Platoon[16] = create platoon ARMY_UNIT_TYPE_MELEE_8 at {SacrificePoint} + {0,0,0} with 1 men and 0 women
        PLAYER of LC13_Platoon[16] = 1
        enable platoon LC13_Platoon[16] respond to town AztecCapital attack
        run background script LC13_CreateUndeadPlatoon(LC13_Platoon[16],1,40 * RecruitSizeModifier,s_skeletonadultland2)

        //Platoon2
        LC13_Platoon[17] = create platoon ARMY_UNIT_TYPE_MELEE_8 at {SacrificePoint} + {20,0,0} with 1 men and 0 women
        PLAYER of LC13_Platoon[17] = 1
        enable platoon LC13_Platoon[17] respond to town AztecCapital attack
        run background script LC13_CreateUndeadPlatoon(LC13_Platoon[17],1,40 * RecruitSizeModifier,s_skeletonadultland2)

        //Platoon3
        LC13_Platoon[18] = create platoon ARMY_UNIT_TYPE_MELEE_8 at {SacrificePoint} + {-20,0,0} with 1 men and 0 women
        PLAYER of LC13_Platoon[18] = 1
        enable platoon LC13_Platoon[18] respond to town AztecCapital attack
        run background script LC13_CreateUndeadPlatoon(LC13_Platoon[18],1,40 * RecruitSizeModifier,s_skeletonadultland2)

        //Platoon4
        LC13_Platoon[19] = create platoon ARMY_UNIT_TYPE_MELEE_8 at {SacrificePoint} + {20,0,20} with 1 men and 0 women
        PLAYER of LC13_Platoon[19] = 1
        enable platoon LC13_Platoon[19] respond to town AztecCapital attack
        run background script LC13_CreateUndeadPlatoon(LC13_Platoon[19],1,40 * RecruitSizeModifier,s_skeletonadultland2)

        //Platoon5
        LC13_Platoon[20] = create platoon ARMY_UNIT_TYPE_MELEE_8 at {SacrificePoint} + {20,0,-20} with 1 men and 0 women
        PLAYER of LC13_Platoon[20] = 1
        enable platoon LC13_Platoon[20] respond to town AztecCapital attack
        run background script LC13_CreateUndeadPlatoon(LC13_Platoon[20],1,40 * RecruitSizeModifier,s_skeletonadultland2)

        //Platoon6
        LC13_Platoon[21] = create platoon ARMY_UNIT_TYPE_MELEE_8 at {SacrificePoint} + {-20,0,-20} with 1 men and 0 women
        PLAYER of LC13_Platoon[21] = 1
        enable platoon LC13_Platoon[21] respond to town AztecCapital attack
        run background script LC13_CreateUndeadPlatoon(LC13_Platoon[21],1,40 * RecruitSizeModifier,s_skeletonadultland2)

        //Activate Behaivours
        wait 15 seconds

        AttackingPosition = marker at {AttackPos[2]} + {33,0,0}
        AttackingPositionFallBack = marker at {AttackPos[3]} + {33,0,0}
        run background script LC13_ArmyBehaivours(LC13_Platoon[16],Melee,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)
        run background script LC13_GenericTalusSpeeches(LC13_Platoon[16],1)

        AttackingPosition = marker at {AttackPos[2]} + {-33,0,0}
        AttackingPositionFallBack = marker at {AttackPos[3]} + {-33,0,0}
        run background script LC13_ArmyBehaivours(LC13_Platoon[17],Melee,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)
        run background script LC13_GenericTalusSpeeches(LC13_Platoon[17],1)

        AttackingPosition = marker at {AttackPos[0]} + {33,0,0}
        AttackingPositionFallBack = marker at {AttackPos[1]} + {33,0,0}
        run background script LC13_ArmyBehaivours(LC13_Platoon[18],Melee,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)
        run background script LC13_GenericTalusSpeeches(LC13_Platoon[18],1)

        AttackingPosition = marker at {AttackPos[0]} + {-33,0,0}
        AttackingPositionFallBack = marker at {AttackPos[1]} + {-33,0,0}
        run background script LC13_ArmyBehaivours(LC13_Platoon[19],Melee,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)
        run background script LC13_GenericTalusSpeeches(LC13_Platoon[19],1)

        AttackingPosition = marker at {AttackPos[4]} + {33,0,30}
        AttackingPositionFallBack = marker at {AttackPos[5]} + {33,0,30}
        run background script LC13_ArmyBehaivours(LC13_Platoon[20],Melee,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)
        run background script LC13_GenericTalusSpeeches(LC13_Platoon[20],1)

        AttackingPosition = marker at {AttackPos[4]} + {-33,0,30}
        AttackingPositionFallBack = marker at {AttackPos[5]} + {-33,0,30}
        run background script LC13_ArmyBehaivours(LC13_Platoon[21],Melee,Special,0,AttackingPosition,AttackingPositionFallBack,0,0)
        run background script LC13_GenericTalusSpeeches(LC13_Platoon[21],1)

        wait 15 seconds

        LC13_NumberOfSkeletonPlatoons = 0
    end if

    SkeletonsWave++
end script LC13_DeathSpell


begin script LC13_PlatoonBehaivors

start

begin loop
    if town AztecCapital is under takeover from player 0
        enable platoon LC13_Platoon[0] respond to town AztecCapital attack
        enable platoon LC13_Platoon[1] respond to town AztecCapital attack
        enable platoon LC13_Platoon[2] respond to town AztecCapital attack
        enable platoon LC13_Platoon[3] respond to town AztecCapital attack
        enable platoon LC13_Platoon[4] respond to town AztecCapital attack
        enable platoon LC13_Platoon[5] respond to town AztecCapital attack
        enable platoon LC13_WallArcher[0] respond to town AztecCapital attack
        enable platoon LC13_WallArcher[1] respond to town AztecCapital attack
        enable platoon LC13_WallArcher[2] respond to town AztecCapital attack
        enable platoon LC13_WallArcher[3] respond to town AztecCapital attack
        enable platoon LC13_WallArcher[4] respond to town AztecCapital attack
        enable platoon LC13_WallArcher[5] respond to town AztecCapital attack
        enable platoon LC13_WallArcher[6] respond to town AztecCapital attack
        enable platoon LC13_WallArcher[7] respond to town AztecCapital attack
        enable platoon LC13_WallArcher[8] respond to town AztecCapital attack
        enable platoon LC13_WallArcher[9] respond to town AztecCapital attack
        enable platoon LC13_WallArcher[10] respond to town AztecCapital attack
        enable platoon LC13_WallArcher[11] respond to town AztecCapital attack
    else
        disable platoon LC13_Platoon[0] respond to town AztecCapital attack
        disable platoon LC13_Platoon[1] respond to town AztecCapital attack
        disable platoon LC13_Platoon[2] respond to town AztecCapital attack
        disable platoon LC13_Platoon[3] respond to town AztecCapital attack
        disable platoon LC13_WallArcher[0] respond to town AztecCapital attack
        disable platoon LC13_WallArcher[1] respond to town AztecCapital attack
        disable platoon LC13_WallArcher[2] respond to town AztecCapital attack
        disable platoon LC13_WallArcher[3] respond to town AztecCapital attack
        disable platoon LC13_WallArcher[4] respond to town AztecCapital attack
        disable platoon LC13_WallArcher[5] respond to town AztecCapital attack
        disable platoon LC13_WallArcher[6] respond to town AztecCapital attack
        disable platoon LC13_WallArcher[7] respond to town AztecCapital attack
        disable platoon LC13_WallArcher[8] respond to town AztecCapital attack
        disable platoon LC13_WallArcher[9] respond to town AztecCapital attack
        disable platoon LC13_WallArcher[10] respond to town AztecCapital attack
        disable platoon LC13_WallArcher[11] respond to town AztecCapital attack
    end if
    wait number from 5 to 10 seconds
end loop

end script LC13_PlatoonBehaivors


begin script LC13_CheckStonehenge(whichPlatoon,whichWeather)

AttackingPosition = 0
AttackingPositionFallBack = 0
myCounter = 0

start

whichWeather = create SCRIPT_OBJECT_TYPE_WEATHER_THING WEATHER_INFO_MEDIUM_CLOUD at {1253.43,133.39,803.14}
set cloud for whichWeather above {1253.43,133.39,803.14} + {0, 30, 0}
set whichWeather properties rainfall 1 snowfall 0 overcast 0.9
disable whichWeather affected by wind

wait until {whichPlatoon} near {1253.43,133.39,803.14} radius 80 or whichPlatoon not exists

if whichPlatoon exists
    wait 3.33 seconds
    while myCounter < 4
        set lightning strike at {whichPlatoon} + {number from -50 to 50,number from -50 to 50} from whichWeather scale 0.66
        wait number from 2 to 4 seconds
        myCounter++
    end while
    set lightning strike at {whichPlatoon} from whichWeather scale 1.0
    add effect EFFECT_TYPE_BURN at {whichPlatoon} strength 9 radius 15
    add effect EFFECT_TYPE_CRUSH at {whichPlatoon} strength 5 radius 15
    wait until whichPlatoon not exists or 7.5 seconds
    HEALTH of whichPlatoon = 0.0
    
    wait 5 seconds

    whichPlatoon = create platoon ARMY_UNIT_TYPE_MELEE_8 at {1253.43,133.39,803.14} + {0,0,0} with 1 men and 0 women
    PLAYER of whichPlatoon = 1
    enable platoon whichPlatoon respond to town AztecCapital attack
    run background script LC13_CreateUndeadPlatoon(whichPlatoon,1,60 * RecruitSizeModifier,s_aztecwarrior_ghost)
    AttackingPosition = marker at {AttackPos[0]} + {number from -50 to 50,number from -50 to 50}
    AttackingPositionFallBack = marker at {AttackPos[1]} + {number from -50 to 50,number from -50 to 50}
    run background script LC13_ArmyBehaivours(whichPlatoon,Melee,Attacker,0,AttackingPosition,AttackingPositionFallBack,0,0)
    run background script LC13_GenericTalusSpeeches(whichPlatoon,1)
end if

wait number from 20 to 40 seconds
delete whichWeather

end script LC13_CheckStonehenge