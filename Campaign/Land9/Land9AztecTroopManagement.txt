///////////////////////////////////////////////////////////////////////////////
//    Land 9 Aztec Troop-Management
//    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
//
//    Start date:         19.04.18            By: Boxhead
//    Update date:        19.04.18            By: Boxhead
///////////////////////////////////////////////////////////////////////////////

//-----------------------------------------------------------------------------
//    Globals
//-----------------------------------------------------------------------------

define LC9_NUM_OF_DEFENDERS               = 0 //Unused
define LC9_NUM_OF_PLATOONS                = 45
define LC9_NUM_OF_SIEGE_CATAPULTS         = 25
define LC9_NUM_OF_WALL_ARCHERS            = 20
//Army Types
define Melee                              = 0
define Ranged                             = 1
//Army Behaivours
define Attacker                           = 0
define Escort                             = 1
define Conqueror                          = 2 //Nearest Settlement Attacker
define Patrol                             = 3
define Special                            = 4

define script LC9_StaticPlatoonsActions(Pos,Type,Platoon)
define script Waypoints

global LC9_Defender[LC9_NUM_OF_DEFENDERS]
global LC9_Platoon[LC9_NUM_OF_PLATOONS]
global LC9_SiegeCatapult[LC9_NUM_OF_SIEGE_CATAPULTS]
global LC9_WallArcher[LC9_NUM_OF_WALL_ARCHERS]

global PlatoonPos[25]
global StaticSiegePos[10]
global AttackPos[5]
global SiegePlatoonPos[3]
global SiegeRoute1[5]
global SiegeRoute2[5]
global SiegeRoute3[5]
global SiegeRoute4[4]
global SiegeRoute5[4]
global SiegeRoute6[3]
global SiegeRoute7[3]
global SiegeRoute8[4]
global SiegeRoute9[4]
global PlayerWallPos[2]

global SiegeAttackPrePos[4]
global SiegeAttackPos[4]

global PatrolRouteA[4]
global WaypointsA = 0
global PatrolRouteB[4]
global WaypointsB = 0
global PatrolRouteC[4]
global WaypointsC = 0

//-----------------------------------------------------------------------------

//-----------------------------------------------------------------------------
//    Setting up waypoints for AI actions
//-----------------------------------------------------------------------------

run script Waypoints

begin script Waypoints

start

    SiegeAttackPrePos[0] = marker at {1765.98,44.97,1253.20}

    SiegeAttackPos[0] = marker at {2063.16,55.61,1297.50}

    PlayerWallPos[0] = marker at {1296.29,151.23,864.95}
    PlayerWallPos[1] = marker at {1660.86,158.43,799.39}

    //AztecCapital
    PlatoonPos[0] = marker at {315.78,228.81,2117.76}
    PlatoonPos[1] = marker at {303.75,228.81,2080.45}
    PlatoonPos[2] = marker at {308.44,224.61,1876.69}
    PlatoonPos[3] = marker at {537.44,158.22,1840.15}
    PlatoonPos[4] = marker at {307.24,156.66,1569.05}
    PlatoonPos[5] = marker at {355.79,203.71,1817.03}
    PlatoonPos[6] = marker at {937.74,21.10,792.38}
    PlatoonPos[7] = marker at {1358.45,51.83,1784.49}
    PlatoonPos[8] = marker at {1390.38,59.80,1832.42}

    //AztecTown1
    PlatoonPos[9] = marker at {1046.37,22.53,1209.33}
    PlatoonPos[10] = marker at {1067.69,22.53,1223.96}
    PlatoonPos[11] = marker at {1008.57,21.50,1283.12}
    PlatoonPos[12] = marker at {934.44,31.68,1397.08}

    //AztecTown2
    PlatoonPos[13] = marker at {1675.78,79.74,1002.17}
    PlatoonPos[14] = marker at {1653.94,80.10,974.02}
    PlatoonPos[15] = marker at {1931.05,24.72,941.34}
    PlatoonPos[16] = marker at {1765.82,23.97,1055.40}
    PlatoonPos[17] = marker at {1964.71,28.90,1158.88}

    //AztecTown3
    PlatoonPos[18] = marker at {657.80,35.05,972.93}
    PlatoonPos[19] = marker at {630.80,42.41,952.00}

    //Epic
    PlatoonPos[20] = marker at {1317.86,84.91,829.75}
    PlatoonPos[21] = marker at {1354.39,79.62,852.85}

    AttackPos[0] = marker at {1397.90,44.40,336.70}//FrontAttackpos
    AttackPos[1] = marker at {1110.03,21.31,512.33}//FrontFallback
    AttackPos[2] = marker at {1844.61,25.69,594.50}//BackdoorAttackpos
    AttackPos[3] = marker at {1942.81,24.71,816.65}//BackdoorFallback

    //AztecCapital to PlayerTown
    SiegeRoute1[0] = marker at {304.91,156.61,1563.30}//Not variable
    SiegeRoute1[1] = marker at {509.28,41.92,1260.41}
    SiegeRoute1[2] = marker at {935.27,21.52,783.41}//Not variable
    SiegeRoute1[3] = marker at {1163.28,24.37,487.26}
    SiegeRoute1[4] = marker at {1392.85,43.30,353.86}

    SiegeRoute2[0] = marker at {304.91,156.61,1563.30}//Not variable
    SiegeRoute2[1] = marker at {509.28,41.92,1260.41} + {-20,0,-20}
    SiegeRoute2[2] = marker at {935.27,21.52,783.41}//Not variable
    SiegeRoute2[3] = marker at {1163.28,24.37,487.26} + {-20,0,-20}
    SiegeRoute2[4] = marker at {1392.85,43.30,353.86} + {-20,0,-20}

    SiegeRoute3[0] = marker at {304.91,156.61,1563.30}//Not variable
    SiegeRoute3[1] = marker at {509.28,41.92,1260.41} + {20,0,20}
    SiegeRoute3[2] = marker at {935.27,21.52,783.41}//Not variable
    SiegeRoute3[3] = marker at {1163.28,24.37,487.26} + {20,0,20}
    SiegeRoute3[4] = marker at {1392.85,43.30,353.86} + {20,0,20}

    //AztecTown1 to PlayerTown
    SiegeRoute4[0] = marker at {1069.95,22.53,1201.20}//Not variable
    SiegeRoute4[1] = marker at {936.70,21.45,787.10} //Not variable
    SiegeRoute4[2] = marker at {1150.11,21.83,478.56}
    SiegeRoute4[3] = marker at {1384.72,47.39,272.62}

    SiegeRoute5[0] = marker at {1069.95,22.53,1201.20}//Not variable
    SiegeRoute5[1] = marker at {936.70,21.45,787.10} //Not variable
    SiegeRoute5[2] = marker at {1150.11,21.83,478.56} + {20,0,20}
    SiegeRoute5[3] = marker at {1384.72,47.39,272.62} + {20,0,20}

    //AztecTown2 to PlayerTown
    SiegeRoute6[0] = marker at {1935.01,24.88,879.29}//Not variable
    SiegeRoute6[1] = marker at {1934.95,25.41,678.67}
    SiegeRoute6[2] = marker at {1818.82,27.04,575.48}

    SiegeRoute7[0] = marker at {1935.01,24.88,879.29}//Not variable
    SiegeRoute7[1] = marker at {1934.95,25.41,678.67} + {20,0,20}
    SiegeRoute7[2] = marker at {1818.82,27.04,575.48} + {20,0,20}

    //AztecTown3 to PlayerTown
    SiegeRoute8[0] = marker at {679.59,17.59,1021.64}//Not variable
    SiegeRoute8[1] = marker at {933.22,21.50,785.40}//Not variable
    SiegeRoute8[2] = marker at {1155.84,23.41,487.29}
    SiegeRoute8[3] = marker at {1400.84,42.48,465.01}

    SiegeRoute9[0] = marker at {679.59,17.59,1021.64}//Not variable
    SiegeRoute9[1] = marker at {933.22,21.50,785.40}//Not variable
    SiegeRoute9[2] = marker at {1155.84,23.41,487.29} + {20,0,20}
    SiegeRoute9[3] = marker at {1400.84,42.48,465.01} + {20,0,20}

    SiegePlatoonPos[0] = marker at {1338.13,88.79,1329.34}//JapaneseTown2

    PatrolRouteA[0] = marker at {957.44,21.18,600.74}
    PatrolRouteA[1] = marker at {1160.36,20.81,436.83}
    PatrolRouteA[2] = marker at {1148.17,24.00,304.61}
    PatrolRouteA[3] = marker at {1154.98,20.98,449.30}

    PatrolRouteB[0] = marker at {679.15,154.61,2010.80}
    PatrolRouteB[1] = marker at {1010.20,88.76,1813.21}
    PatrolRouteB[2] = marker at {1366.29,63.38,1849.28}
    PatrolRouteB[3] = marker at {955.13,97.47,1823.00}

    PatrolRouteC[0] = marker at {1130.08,22.95,310.16}
    PatrolRouteC[1] = marker at {1142.29,21.03,461.51}
    PatrolRouteC[2] = marker at {1344.92,47.28,497.95}
    PatrolRouteC[3] = marker at {1142.29,21.03,461.51}

    StaticSiegePos[0] = marker at {429.74,222.68,1854.82}
    StaticSiegePos[1] = marker at {712.61,43.76,889.43}
    StaticSiegePos[2] = marker at {609.77,42.62,990.34}
    StaticSiegePos[3] = marker at {1367.91,89.49,766.59}
    StaticSiegePos[4] = marker at {1688.61,76.67,1038.55}

    WaypointsA = create SCRIPT_OBJECT_TYPE_WAYPOINTROUTE at {0, 0, 0}

    add {PatrolRouteA[0]} to waypoint list WaypointsA
    add {PatrolRouteA[1]} to waypoint list WaypointsA
    add {PatrolRouteA[2]} to waypoint list WaypointsA
    add {PatrolRouteA[3]} to waypoint list WaypointsA

    WaypointsB = create SCRIPT_OBJECT_TYPE_WAYPOINTROUTE at {0, 0, 0}

    add {PatrolRouteB[0]} to waypoint list WaypointsB
    add {PatrolRouteB[1]} to waypoint list WaypointsB
    add {PatrolRouteB[2]} to waypoint list WaypointsB
    add {PatrolRouteB[3]} to waypoint list WaypointsB

    WaypointsC = create SCRIPT_OBJECT_TYPE_WAYPOINTROUTE at {0, 0, 0}

    add {PatrolRouteC[0]} to waypoint list WaypointsC
    add {PatrolRouteC[1]} to waypoint list WaypointsC
    add {PatrolRouteC[2]} to waypoint list WaypointsC
    add {PatrolRouteC[3]} to waypoint list WaypointsC


end script Waypoints

//-----------------------------------------------------------------------------

begin script LC9_StaticPlatoonsActions(Pos,Type,Platoon)

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    Catapult = 0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    PlayerSettlement = 0

start

begin loop

    if Type == Melee
        PlayerCreature = get distance from {Platoon} to {oCreature}
        if PlayerCreature <= 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and Platoon can navigate to {oCreature}
            clear Platoon action queue
            begin loop
                PlayerCreature = get distance from {Platoon} to {oCreature}
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to Platoon action queue
                NumPat1 = get number of villagers in platoon Platoon
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not Platoon can navigate to {oCreature} or PlayerCreature > 200
            end loop
            clear Platoon action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {Platoon} radius 200
        Catapult = get siege weapon of player 0 nearest {Platoon} radius 155
        if PlayerPlatoon1 exists and Platoon can navigate to {PlayerPlatoon1}
            clear Platoon action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {Platoon} radius 200
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to Platoon action queue
                NumPat1 = get number of villagers in platoon Platoon
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not Platoon can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear Platoon action queue
        elsif Catapult exists and Platoon can navigate to {Catapult}
            clear Platoon action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {Platoon} radius 155
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to Platoon action queue
                NumPat1 = get number of villagers in platoon Platoon
                PlayerPlatoon1 = get platoon of player 0 nearest {Platoon} radius 200
                if PlayerPlatoon1 exists and Platoon can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not Platoon can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear Platoon action queue
            a = 0
        end if

    elsif Type == Ranged
        PlayerCreature = get distance from {Platoon} to {oCreature}
        if PlayerCreature <= 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and Platoon can navigate to {oCreature}
            clear Platoon action queue
            begin loop
                PlayerCreature = get distance from {Platoon} to {oCreature}
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using oCreature to Platoon action queue
                NumPat1 = get number of villagers in platoon Platoon
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not Platoon can navigate to {oCreature} or PlayerCreature > 200
            end loop
            clear Platoon action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {Platoon} radius 200
        Catapult = get siege weapon of player 0 nearest {Platoon} radius 155
        if PlayerPlatoon1 exists and Platoon can navigate to {PlayerPlatoon1}
            clear Platoon action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {Platoon} radius 200
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using PlayerPlatoon1 to Platoon action queue
                NumPat1 = get number of villagers in platoon Platoon
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not Platoon can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear Platoon action queue
        elsif Catapult exists and Platoon can navigate to {Catapult}
            clear Platoon action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {Platoon} radius 155
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using Catapult to Platoon action queue
                NumPat1 = get number of villagers in platoon Platoon
                PlayerPlatoon1 = get platoon of player 0 nearest {Platoon} radius 200
                if PlayerPlatoon1 exists and Platoon can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not Platoon can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear Platoon action queue
            a = 0
        end if
    end if

    if get size of Platoon action queue < 1 and {Platoon} not near {Pos} radius 25
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {Pos} to Platoon action queue
    end if

    until Platoon not exists
end loop

end script LC9_StaticPlatoonsActions

begin script LC9_Platoon20Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    PlayerSettlement = 0
    
start

begin loop    

    if LC9_Platoon[20] not exists
        //PlatoonKilled = 1
        wait until LC9_Platoon[20] exists
    end if
        
    PlayerCreature = get distance from {LC9_Platoon[20]} to {oCreature}
    if PlayerCreature <= 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC9_Platoon[20] can navigate to {oCreature}
        clear LC9_Platoon[20] action queue
        begin loop
            PlayerCreature = get distance from {LC9_Platoon[20]} to {oCreature}
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC9_Platoon[20] action queue
            NumPat1 = get number of villagers in platoon LC9_Platoon[20]
            until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC9_Platoon[20] can navigate to {oCreature} or PlayerCreature > 200
        end loop
        clear LC9_Platoon[20] action queue
    end if
        
    PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[20]} radius 200
    Catapult = get siege weapon of player 0 nearest {LC9_Platoon[20]} radius 155
    if PlayerPlatoon1 exists and LC9_Platoon[20] can navigate to {PlayerPlatoon1}
        clear LC9_Platoon[20] action queue
        begin loop
            PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[20]} radius 200
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC9_Platoon[20] action queue
            NumPat1 = get number of villagers in platoon LC9_Platoon[20]
            HeTeste1 = get number of villagers in platoon PlayerPlatoon1
            until NumPat1 == 0 or HeTeste1 == 0 or not LC9_Platoon[20] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
        end loop
        clear LC9_Platoon[20] action queue
    elsif Catapult exists and LC9_Platoon[20] can navigate to {Catapult}
        clear LC9_Platoon[20] action queue
        a = 0
        begin loop
            Catapult = get siege weapon of player 0 nearest {LC9_Platoon[20]} radius 155
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC9_Platoon[20] action queue
            NumPat1 = get number of villagers in platoon LC9_Platoon[20]
            PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[20]} radius 200
            if PlayerPlatoon1 exists and LC9_Platoon[20] can navigate to {PlayerPlatoon1}
                a = 1
            end if
            until NumPat1 == 0 or Catapult not exists or not LC9_Platoon[20] can navigate to {Catapult} or a == 1 or Catapult not exists
        end loop
        clear LC9_Platoon[20] action queue
        a = 0
    end if
        
    if get size of LC9_Platoon[20] action queue < 1
        move LC9_Platoon[20] along WaypointsA with patrol WAYPOINTROUTE_TRAVERSAL_TYPE_CIRCULAR
    end if
        
end loop

end script LC9_Platoon20Actions

begin script LC9_Platoon21Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    PlayerSettlement = 0
    
start

begin loop    

    if LC9_Platoon[21] not exists
        //PlatoonKilled = 1
        wait until LC9_Platoon[21] exists
    end if
        
    PlayerCreature = get distance from {LC9_Platoon[21]} to {oCreature}
    if PlayerCreature <= 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC9_Platoon[21] can navigate to {oCreature}
        clear LC9_Platoon[21] action queue
        begin loop
            PlayerCreature = get distance from {LC9_Platoon[21]} to {oCreature}
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC9_Platoon[21] action queue
            NumPat1 = get number of villagers in platoon LC9_Platoon[21]
            until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC9_Platoon[21] can navigate to {oCreature} or PlayerCreature > 200
        end loop
        clear LC9_Platoon[21] action queue
    end if
        
    PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[21]} radius 200
    Catapult = get siege weapon of player 0 nearest {LC9_Platoon[21]} radius 155
    if PlayerPlatoon1 exists and LC9_Platoon[21] can navigate to {PlayerPlatoon1}
        clear LC9_Platoon[21] action queue
        begin loop
            PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[21]} radius 200
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC9_Platoon[21] action queue
            NumPat1 = get number of villagers in platoon LC9_Platoon[21]
            HeTeste1 = get number of villagers in platoon PlayerPlatoon1
            until NumPat1 == 0 or HeTeste1 == 0 or not LC9_Platoon[21] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
        end loop
        clear LC9_Platoon[21] action queue
    elsif Catapult exists and LC9_Platoon[21] can navigate to {Catapult}
        clear LC9_Platoon[21] action queue
        a = 0
        begin loop
            Catapult = get siege weapon of player 0 nearest {LC9_Platoon[21]} radius 155
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC9_Platoon[21] action queue
            NumPat1 = get number of villagers in platoon LC9_Platoon[21]
            PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[21]} radius 200
            if PlayerPlatoon1 exists and LC9_Platoon[21] can navigate to {PlayerPlatoon1}
                a = 1
            end if
            until NumPat1 == 0 or Catapult not exists or not LC9_Platoon[21] can navigate to {Catapult} or a == 1 or Catapult not exists
        end loop
        clear LC9_Platoon[21] action queue
        a = 0
    end if
        
    if get size of LC9_Platoon[21] action queue < 1
        move LC9_Platoon[21] along WaypointsB with patrol WAYPOINTROUTE_TRAVERSAL_TYPE_CIRCULAR
    end if
        
end loop

end script LC9_Platoon21Actions

begin script LC9_Platoon32Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC9_Platoon[32] exists and LC9_Platoon[33] exists and LC9_Platoon[34] exists and LC9_SiegeCatapult[5] exists and LC9_SiegeCatapult[6] exists and LC9_SiegeCatapult[7] exists and ({LC9_SiegeCatapult[5]} near {AztecCapital} radius 500) and ({LC9_SiegeCatapult[6]} near {AztecCapital} radius 500) and ({LC9_SiegeCatapult[7]} near {AztecCapital} radius 500) and ALLOWED_TO_ATTACK == 1
    begin loop

        PlayerCreature = get distance from {LC9_Platoon[32]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC9_Platoon[32] can navigate to {oCreature}
            clear LC9_Platoon[32] action queue
            begin loop
                PlayerCreature = get distance from {LC9_Platoon[32]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC9_Platoon[32] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[32]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC9_Platoon[32] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC9_Platoon[32] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[32]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC9_Platoon[32]} radius 50
        if PlayerPlatoon1 exists and LC9_Platoon[32] can navigate to {PlayerPlatoon1}
            clear LC9_Platoon[32] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[32]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC9_Platoon[32] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[32]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC9_Platoon[32] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC9_Platoon[32] action queue
        elsif Catapult exists and LC9_Platoon[32] can navigate to {Catapult}
            clear LC9_Platoon[32] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC9_Platoon[32]} radius 50
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC9_Platoon[32] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[32]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[32]} radius 150
                if PlayerPlatoon1 exists and LC9_Platoon[32] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC9_Platoon[32] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC9_Platoon[32] action queue
            a = 0
        end if

        PlayerSettlement = get nearest town at {LC9_Platoon[32]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0
            if LC9_Platoon[32] can navigate to object Armory
                if TownCapturePlatoons[2] < 2
                    TownCapturePlatoons[2]++
                    clear LC9_Platoon[32] action queue
                    set LC9_Platoon[32] attack PlayerSettlement with severity 0.3 for takeover
                    a = 1
                    begin loop
                        PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[32]} radius 150
                        PlayerCreature = get distance from {LC9_Platoon[32]} to {oCreature}
                        if PlayerPlatoon1 exists
                            a = 0
                        elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                            a = 0
                        elsif not LC9_Platoon[32] can navigate to object Armory
                            a = 0
                        elsif LC9_Platoon[32] not exists
                            a = 0
                        end if
                        until a == 0 or LC9_Platoon[32] not exists or PLAYER of PlayerSettlement == 1
                    end loop
                    TownCapturePlatoons[2]--
                end if
                clear LC9_Platoon[32] action queue
            end if
        end if

        //if get size of LC9_Platoon[32] action queue < 1
            if LC9_Platoon[32] can navigate to object oTownCentre and PLAYER of PlayerTown == 0
                wait number from 5 to 25 seconds
                a = 1
                clear LC9_Platoon[32] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC9_Platoon[32] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[32] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[32] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[32] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[32] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[32] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[32] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[0] < 2
                        TownCapturePlatoons[0]++
                        set LC9_Platoon[32] attack PlayerTown with severity 0.3 for takeover
                    else
                        a = 0
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[32]} radius 150
                    TestCreature2 = get distance from {LC9_Platoon[32]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC9_Platoon[32]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC9_Platoon[32] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC9_Platoon[32] can navigate to object oTownCentre
                            a = 0
                        elsif LC9_Platoon[32] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC9_Platoon[32] not exists
                end loop
                TownCapturePlatoons[0]--
                clear LC9_Platoon[32] action queue
            elsif LC9_Platoon[32] can navigate to {AttackPos[0]} + {-20,0,-20}
                clear LC9_Platoon[32] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[0]} + {-20,0,-20} to LC9_Platoon[32] action queue
            else
                clear LC9_Platoon[32] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[1]} + {-20,0,-20} to LC9_Platoon[32] action queue
            end if
        //end if

        until LC9_Platoon[32] not exists
    end loop
    if LC9_Platoon[32] not exists
        //PlatoonKilled = 1
        wait until LC9_Platoon[32] exists
    end if
end loop

end script LC9_Platoon32Actions

begin script LC9_Platoon33Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC9_Platoon[32] exists and LC9_Platoon[33] exists and LC9_Platoon[34] exists and LC9_SiegeCatapult[5] exists and LC9_SiegeCatapult[6] exists and LC9_SiegeCatapult[7] exists and ({LC9_SiegeCatapult[5]} near {AztecCapital} radius 500) and ({LC9_SiegeCatapult[6]} near {AztecCapital} radius 500) and ({LC9_SiegeCatapult[7]} near {AztecCapital} radius 500) and ALLOWED_TO_ATTACK == 1
    begin loop

        PlayerCreature = get distance from {LC9_Platoon[33]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC9_Platoon[33] can navigate to {oCreature}
            clear LC9_Platoon[33] action queue
            begin loop
                PlayerCreature = get distance from {LC9_Platoon[33]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC9_Platoon[33] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[33]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC9_Platoon[33] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC9_Platoon[33] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[33]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC9_Platoon[33]} radius 50
        if PlayerPlatoon1 exists and LC9_Platoon[33] can navigate to {PlayerPlatoon1}
            clear LC9_Platoon[33] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[33]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC9_Platoon[33] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[33]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC9_Platoon[33] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC9_Platoon[33] action queue
        elsif Catapult exists and LC9_Platoon[33] can navigate to {Catapult}
            clear LC9_Platoon[33] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC9_Platoon[33]} radius 50
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC9_Platoon[33] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[33]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[33]} radius 150
                if PlayerPlatoon1 exists and LC9_Platoon[33] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC9_Platoon[33] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC9_Platoon[33] action queue
            a = 0
        end if

        PlayerSettlement = get nearest town at {LC9_Platoon[33]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0
            if LC9_Platoon[33] can navigate to object Armory
                if TownCapturePlatoons[2] < 2
                    TownCapturePlatoons[2]++
                    clear LC9_Platoon[33] action queue
                    set LC9_Platoon[33] attack PlayerSettlement with severity 0.3 for takeover
                    a = 1
                    begin loop
                        PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[33]} radius 150
                        PlayerCreature = get distance from {LC9_Platoon[33]} to {oCreature}
                        if PlayerPlatoon1 exists
                            a = 0
                        elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                            a = 0
                        elsif not LC9_Platoon[33] can navigate to object Armory
                            a = 0
                        elsif LC9_Platoon[33] not exists
                            a = 0
                        end if
                        until a == 0 or LC9_Platoon[33] not exists or PLAYER of PlayerSettlement == 1
                    end loop
                    TownCapturePlatoons[2]--
                end if
                clear LC9_Platoon[33] action queue
            end if
        end if

        //if get size of LC9_Platoon[33] action queue < 1
            if LC9_Platoon[33] can navigate to object oTownCentre and PLAYER of PlayerTown == 0
                wait number from 5 to 25 seconds
                a = 1
                clear LC9_Platoon[33] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC9_Platoon[33] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[33] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[33] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[33] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[33] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[33] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[33] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[0] < 2
                        TownCapturePlatoons[0]++
                        set LC9_Platoon[33] attack PlayerTown with severity 0.3 for takeover
                    else 
                        a = 0
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[33]} radius 150
                    TestCreature2 = get distance from {LC9_Platoon[33]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC9_Platoon[33]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC9_Platoon[33] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC9_Platoon[33] can navigate to object oTownCentre
                            a = 0
                        elsif LC9_Platoon[33] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC9_Platoon[33] not exists
                end loop
                TownCapturePlatoons[0]--
                clear LC9_Platoon[33] action queue
            elsif LC9_Platoon[33] can navigate to {AttackPos[0]} + {0,0,0}
                clear LC9_Platoon[33] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[0]} + {0,0,0} to LC9_Platoon[33] action queue
            else
                clear LC9_Platoon[33] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[1]} + {0,0,0} to LC9_Platoon[33] action queue
            end if
        //end if

        until LC9_Platoon[33] not exists
    end loop
    if LC9_Platoon[33] not exists
        //PlatoonKilled = 1
        wait until LC9_Platoon[33] exists
    end if
end loop

end script LC9_Platoon33Actions

begin script LC9_Platoon34Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC9_Platoon[32] exists and LC9_Platoon[33] exists and LC9_Platoon[34] exists and LC9_SiegeCatapult[5] exists and LC9_SiegeCatapult[6] exists and LC9_SiegeCatapult[7] exists and ({LC9_SiegeCatapult[5]} near {AztecCapital} radius 500) and ({LC9_SiegeCatapult[6]} near {AztecCapital} radius 500) and ({LC9_SiegeCatapult[7]} near {AztecCapital} radius 500) and ALLOWED_TO_ATTACK == 1
    begin loop

        PlayerCreature = get distance from {LC9_Platoon[34]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC9_Platoon[34] can navigate to {oCreature}
            clear LC9_Platoon[34] action queue
            begin loop
                PlayerCreature = get distance from {LC9_Platoon[34]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using oCreature to LC9_Platoon[34] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[34]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC9_Platoon[34] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC9_Platoon[34] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[34]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC9_Platoon[34]} radius 50
        if PlayerPlatoon1 exists and LC9_Platoon[34] can navigate to {PlayerPlatoon1}
            clear LC9_Platoon[34] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[34]} radius 150
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using PlayerPlatoon1 to LC9_Platoon[34] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[34]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC9_Platoon[34] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC9_Platoon[34] action queue
        elsif Catapult exists and LC9_Platoon[34] can navigate to {Catapult}
            clear LC9_Platoon[34] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC9_Platoon[34]} radius 50
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using Catapult to LC9_Platoon[34] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[34]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[34]} radius 150
                if PlayerPlatoon1 exists and LC9_Platoon[34] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC9_Platoon[34] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC9_Platoon[34] action queue
            a = 0
        end if

        PlayerSettlement = get nearest town at {LC9_Platoon[34]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0
            if LC9_Platoon[34] can navigate to object Armory
                if TownCapturePlatoons[2] < 2
                    TownCapturePlatoons[2]++
                    clear LC9_Platoon[34] action queue
                    set LC9_Platoon[34] attack PlayerSettlement with severity 0.3 for takeover
                    a = 1
                    begin loop
                        PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[34]} radius 150
                        PlayerCreature = get distance from {LC9_Platoon[34]} to {oCreature}
                        if PlayerPlatoon1 exists
                            a = 0
                        elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                            a = 0
                        elsif not LC9_Platoon[34] can navigate to object Armory
                            a = 0
                        elsif LC9_Platoon[34] not exists
                            a = 0
                        end if
                        until a == 0 or LC9_Platoon[34] not exists or PLAYER of PlayerSettlement == 1
                    end loop
                    TownCapturePlatoons[2]--
                end if
                clear LC9_Platoon[34] action queue
            end if
        end if

        //if get size of LC9_Platoon[34] action queue < 1
            if LC9_Platoon[34] can navigate to object oTownCentre and PLAYER of PlayerTown == 0
                wait number from 5 to 25 seconds
                a = 1
                clear LC9_Platoon[34] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC9_Platoon[34] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[34] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[34] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[34] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[34] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[34] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[34] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[0] < 2
                        TownCapturePlatoons[0]++
                        set LC9_Platoon[34] attack PlayerTown with severity 0.3 for takeover
                    else
                        a = 0
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[34]} radius 150
                    TestCreature2 = get distance from {LC9_Platoon[34]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC9_Platoon[34]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC9_Platoon[34] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC9_Platoon[34] can navigate to object oTownCentre
                            a = 0
                        elsif LC9_Platoon[34] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC9_Platoon[34] not exists
                end loop
                TownCapturePlatoons[0]--
                clear LC9_Platoon[34] action queue
            elsif LC9_Platoon[34] can navigate to {AttackPos[0]} + {20,0,20}
                clear LC9_Platoon[34] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[0]} + {20,0,20} to LC9_Platoon[34] action queue
            else
                clear LC9_Platoon[34] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[1]} + {20,0,20} to LC9_Platoon[34] action queue
            end if
        //end if

        until LC9_Platoon[34] not exists
    end loop
    if LC9_Platoon[34] not exists
        //PlatoonKilled = 1
        wait until LC9_Platoon[34] exists
    end if
end loop

end script LC9_Platoon34Actions

begin script LC9_SiegeCatapult5Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = create timer for 0 seconds
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 0
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC9_Platoon[32] exists and LC9_Platoon[33] exists and LC9_Platoon[34] exists and LC9_SiegeCatapult[5] exists and LC9_SiegeCatapult[6] exists and LC9_SiegeCatapult[7] exists and ({LC9_SiegeCatapult[5]} near {AztecCapital} radius 500) and ({LC9_SiegeCatapult[6]} near {AztecCapital} radius 500) and ({LC9_SiegeCatapult[7]} near {AztecCapital} radius 500) and ALLOWED_TO_ATTACK == 1
    wait 2 seconds
    begin loop
        PlayerCreature = get distance from {LC9_SiegeCatapult[5]} to {oCreature}
        PlayerPlatoon1 = get platoon of player 0 nearest {LC9_SiegeCatapult[5]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC9_SiegeCatapult[5]} radius 150
        
        if PlayerCreature > 10 and PlayerPlatoon1 not exists and Catapult not exists
            if PlayerPlatoon1 not exists
                a = 1
            elsif PlayerCreature > 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                a = 1
            elsif Catapult not exists
                a = 1
            end if
        end if
        
        if PlayerCreature <= 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
            clear siege weapon LC9_SiegeCatapult[5] action queue
            a = 0
        elsif PlayerPlatoon1 exists and LC9_SiegeCatapult[5] can navigate to {PlayerPlatoon1}
            clear siege weapon LC9_SiegeCatapult[5] action queue
            a = 0
        elsif Catapult exists and LC9_SiegeCatapult[5] can navigate to {Catapult}
            clear siege weapon LC9_SiegeCatapult[5] action queue
            a = 0
        elsif PointOn != 5 and a == 1
            begin loop
                if LC9_SiegeCatapult[5] exists
                    if get SiegeOnPointTimer time remaining <= 0
                        SiegeWeaponPoint = marker at {LC9_SiegeCatapult[5]}
                        SiegeOnPointTimer = create timer for 40 seconds
                    elsif get SiegeOnPointTimer time remaining <= 5
                        if {LC9_SiegeCatapult[5]} near {SiegeWeaponPoint} radius 10
                            clear siege weapon LC9_SiegeCatapult[5] action queue
                            delete LC9_SiegeCatapult[5]
                            SiegeStucked = 1
                        end if
                    end if
                    if get CatapultMoveTimer1 time remaining <= 0
                        if get size of LC9_SiegeCatapult[5] action queue < 1

                            if PointOn == 0
                                if LC9_SiegeCatapult[5] can navigate to {SiegeRoute1[0]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute1[0]} to siege weapon LC9_SiegeCatapult[5] action queue
                                end if
                    
                            elsif PointOn == 1
                                if LC9_SiegeCatapult[5] can navigate to {SiegeRoute1[1]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute1[1]} to siege weapon LC9_SiegeCatapult[5] action queue
                                end if

                            elsif PointOn == 2
                                if LC9_SiegeCatapult[5] can navigate to {SiegeRoute1[2]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute1[2]} to siege weapon LC9_SiegeCatapult[5] action queue
                                end if

                            elsif PointOn == 3
                                if LC9_SiegeCatapult[5] can navigate to {SiegeRoute1[3]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute1[3]} to siege weapon LC9_SiegeCatapult[5] action queue
                                end if

                            elsif PointOn == 4
                                if LC9_SiegeCatapult[5] can navigate to {SiegeRoute1[4]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute1[4]} to siege weapon LC9_SiegeCatapult[5] action queue
                                end if

                            CatapultMoveTimer1 = create timer for 10 seconds
                            
                            end if
                        end if
                    end if        

                    if {LC9_SiegeCatapult[5]} near {SiegeRoute1[0]} radius 15 and PointOn != 1 or 60 seconds
                        PointOn = 1
                    elsif {LC9_SiegeCatapult[5]} near {SiegeRoute1[1]} radius 15 and PointOn != 2 or 60 seconds
                        PointOn = 2
                    elsif {LC9_SiegeCatapult[5]} near {SiegeRoute1[2]} radius 15 and PointOn != 3 or 60 seconds
                        PointOn = 3
                    elsif {LC9_SiegeCatapult[5]} near {SiegeRoute1[3]} radius 15 and PointOn != 4 or 60 seconds
                        PointOn = 4
                    elsif {LC9_SiegeCatapult[5]} near {SiegeRoute1[4]} radius 15 and PointOn != 5 or 60 seconds
                        PointOn = 5
                    elsif not LC9_SiegeCatapult[5] can navigate to {SiegeRoute1[4]} and {LC9_SiegeCatapult[5]} near {SiegeRoute1[3]} radius 15 and PointOn != 5
                        PointOn = 5
                    end if
                end if
            until LC9_SiegeCatapult[5] not exists or PointOn == 5 or 180 seconds
            end loop
        end if
        
        until PointOn == 5 or LC9_SiegeCatapult[5] not exists or 180 seconds
    end loop

    wait 5 seconds

    enable siege weapon LC9_SiegeCatapult[5] auto attack

    begin loop
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 5
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get HOUSE GATEHOUSE at {LC9_SiegeCatapult[5]} radius 250
                if GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE_F at {LC9_SiegeCatapult[5]} radius 250
                end if
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon LC9_SiegeCatapult[5] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[5]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[5] action queue
                elsif GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE at {LC9_SiegeCatapult[5]} radius 750
                    if GateHouse not exists
                        GateHouse = get HOUSE GATEHOUSE_F at {LC9_SiegeCatapult[5]} radius 750
                    end if
                    clear siege weapon LC9_SiegeCatapult[5] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[5]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[5] action queue
                else
                    GateHouse = get random abode of type GATEHOUSE in town PlayerTown
                    if GateHouse not exists
                        GateHouse = get random abode of type GATEHOUSE_F in town PlayerTown
                    end if
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon LC9_SiegeCatapult[5] action queue
                        Target = marker at get target from {LC9_SiegeCatapult[5]} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[5] action queue
                    else
                        ActionTimer = create timer for 2 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {LC9_SiegeCatapult[5]} radius 750
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC9_SiegeCatapult[5] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[5]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC9_SiegeCatapult[5] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            else
                House = get building ALTAR in PlayerTown min built 0.75
                if House exists and PLAYER of House == 0 and LC9_SiegeCatapult[5] can navigate to object oTownCentre
                    clear siege weapon LC9_SiegeCatapult[5] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[5]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC9_SiegeCatapult[5] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            end if
        end if

        until LC9_SiegeCatapult[5] not exists
    end loop
    
    if SiegeAttacking == 1 and UnderAttack != 0
        UnderAttack = UnderAttack - 1
    end if

    if LC9_SiegeCatapult[5] not exists and SiegeStucked == 0
        //CatapultDestroyed = 1
    end if
    
end loop

end script LC9_SiegeCatapult5Actions

begin script LC9_SiegeCatapult6Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = create timer for 0 seconds
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 0
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC9_Platoon[32] exists and LC9_Platoon[33] exists and LC9_Platoon[34] exists and LC9_SiegeCatapult[5] exists and LC9_SiegeCatapult[6] exists and LC9_SiegeCatapult[7] exists and ({LC9_SiegeCatapult[5]} near {AztecCapital} radius 500) and ({LC9_SiegeCatapult[6]} near {AztecCapital} radius 500) and ({LC9_SiegeCatapult[7]} near {AztecCapital} radius 500) and ALLOWED_TO_ATTACK == 1
    wait 2 seconds
    begin loop
        PlayerCreature = get distance from {LC9_SiegeCatapult[6]} to {oCreature}
        PlayerPlatoon1 = get platoon of player 0 nearest {LC9_SiegeCatapult[6]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC9_SiegeCatapult[6]} radius 150
        
        if PlayerCreature > 10 and PlayerPlatoon1 not exists and Catapult not exists
            if PlayerPlatoon1 not exists
                a = 1
            elsif PlayerCreature > 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                a = 1
            elsif Catapult not exists
                a = 1
            end if
        end if
        
        if PlayerCreature <= 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
            clear siege weapon LC9_SiegeCatapult[6] action queue
            a = 0
        elsif PlayerPlatoon1 exists and LC9_SiegeCatapult[6] can navigate to {PlayerPlatoon1}
            clear siege weapon LC9_SiegeCatapult[6] action queue
            a = 0
        elsif Catapult exists and LC9_SiegeCatapult[6] can navigate to {Catapult}
            clear siege weapon LC9_SiegeCatapult[6] action queue
            a = 0
        elsif PointOn != 5 and a == 1
            begin loop
                if LC9_SiegeCatapult[6] exists
                    if get SiegeOnPointTimer time remaining <= 0
                        SiegeWeaponPoint = marker at {LC9_SiegeCatapult[6]}
                        SiegeOnPointTimer = create timer for 40 seconds
                    elsif get SiegeOnPointTimer time remaining <= 5
                        if {LC9_SiegeCatapult[6]} near {SiegeWeaponPoint} radius 10
                            clear siege weapon LC9_SiegeCatapult[6] action queue
                            delete LC9_SiegeCatapult[6]
                            SiegeStucked = 1
                        end if
                    end if
                    if get CatapultMoveTimer1 time remaining <= 0
                        if get size of LC9_SiegeCatapult[6] action queue < 1

                            if PointOn == 0
                                if LC9_SiegeCatapult[6] can navigate to {SiegeRoute2[0]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute2[0]} to siege weapon LC9_SiegeCatapult[6] action queue
                                end if
                    
                            elsif PointOn == 1
                                if LC9_SiegeCatapult[6] can navigate to {SiegeRoute2[1]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute2[1]} to siege weapon LC9_SiegeCatapult[6] action queue
                                end if

                            elsif PointOn == 2
                                if LC9_SiegeCatapult[6] can navigate to {SiegeRoute2[2]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute2[2]} to siege weapon LC9_SiegeCatapult[6] action queue
                                end if

                            elsif PointOn == 3
                                if LC9_SiegeCatapult[6] can navigate to {SiegeRoute2[3]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute2[3]} to siege weapon LC9_SiegeCatapult[6] action queue
                                end if

                            elsif PointOn == 4
                                if LC9_SiegeCatapult[6] can navigate to {SiegeRoute2[4]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute2[4]} to siege weapon LC9_SiegeCatapult[6] action queue
                                end if

                            CatapultMoveTimer1 = create timer for 10 seconds
                            
                            end if
                        end if
                    end if        

                    if {LC9_SiegeCatapult[6]} near {SiegeRoute2[0]} radius 15 and PointOn != 1 or 60 seconds
                        PointOn = 1
                    elsif {LC9_SiegeCatapult[6]} near {SiegeRoute2[1]} radius 15 and PointOn != 2 or 60 seconds
                        PointOn = 2
                    elsif {LC9_SiegeCatapult[6]} near {SiegeRoute2[2]} radius 15 and PointOn != 3 or 60 seconds
                        PointOn = 3
                    elsif {LC9_SiegeCatapult[6]} near {SiegeRoute2[3]} radius 15 and PointOn != 4 or 60 seconds
                        PointOn = 4
                    elsif {LC9_SiegeCatapult[6]} near {SiegeRoute2[4]} radius 15 and PointOn != 5 or 60 seconds
                        PointOn = 5
                    elsif not LC9_SiegeCatapult[6] can navigate to {SiegeRoute2[4]} and {LC9_SiegeCatapult[6]} near {SiegeRoute2[3]} radius 15 and PointOn != 5
                        PointOn = 5
                    end if
                end if
            until LC9_SiegeCatapult[6] not exists or PointOn == 5 or 180 seconds
            end loop
        end if
        
        until PointOn == 5 or LC9_SiegeCatapult[6] not exists or 180 seconds
    end loop

    wait 5 seconds

    enable siege weapon LC9_SiegeCatapult[6] auto attack

    begin loop
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 5
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get HOUSE GATEHOUSE at {LC9_SiegeCatapult[6]} radius 250
                if GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE_F at {LC9_SiegeCatapult[6]} radius 250
                end if
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon LC9_SiegeCatapult[6] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[6]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[6] action queue
                elsif GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE at {LC9_SiegeCatapult[6]} radius 750
                    if GateHouse not exists
                        GateHouse = get HOUSE GATEHOUSE_F at {LC9_SiegeCatapult[6]} radius 750
                    end if
                    clear siege weapon LC9_SiegeCatapult[6] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[6]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[6] action queue
                else
                    GateHouse = get random abode of type GATEHOUSE in town PlayerTown
                    if GateHouse not exists
                        GateHouse = get random abode of type GATEHOUSE_F in town PlayerTown
                    end if
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon LC9_SiegeCatapult[6] action queue
                        Target = marker at get target from {LC9_SiegeCatapult[6]} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[6] action queue
                    else
                        ActionTimer = create timer for 2 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {LC9_SiegeCatapult[6]} radius 750
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC9_SiegeCatapult[6] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[6]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC9_SiegeCatapult[6] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            else
                House = get building ALTAR in PlayerTown min built 0.75
                if House exists and PLAYER of House == 0 and LC9_SiegeCatapult[6] can navigate to object oTownCentre
                    clear siege weapon LC9_SiegeCatapult[6] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[6]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC9_SiegeCatapult[6] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            end if
        end if

        until LC9_SiegeCatapult[6] not exists
    end loop
    
    if SiegeAttacking == 1 and UnderAttack != 0
        UnderAttack = UnderAttack - 1
    end if

    if LC9_SiegeCatapult[6] not exists and SiegeStucked == 0
        //CatapultDestroyed = 1
    end if
    
end loop

end script LC9_SiegeCatapult6Actions

begin script LC9_SiegeCatapult7Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = create timer for 0 seconds
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 0
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC9_Platoon[32] exists and LC9_Platoon[33] exists and LC9_Platoon[34] exists and LC9_SiegeCatapult[5] exists and LC9_SiegeCatapult[6] exists and LC9_SiegeCatapult[7] exists and ({LC9_SiegeCatapult[5]} near {AztecCapital} radius 500) and ({LC9_SiegeCatapult[6]} near {AztecCapital} radius 500) and ({LC9_SiegeCatapult[7]} near {AztecCapital} radius 500) and ALLOWED_TO_ATTACK == 1
    wait 2 seconds
    begin loop
        PlayerCreature = get distance from {LC9_SiegeCatapult[7]} to {oCreature}
        PlayerPlatoon1 = get platoon of player 0 nearest {LC9_SiegeCatapult[7]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC9_SiegeCatapult[7]} radius 150
        
        if PlayerCreature > 10 and PlayerPlatoon1 not exists and Catapult not exists
            if PlayerPlatoon1 not exists
                a = 1
            elsif PlayerCreature > 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                a = 1
            elsif Catapult not exists
                a = 1
            end if
        end if
        
        if PlayerCreature <= 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
            clear siege weapon LC9_SiegeCatapult[7] action queue
            a = 0
        elsif PlayerPlatoon1 exists and LC9_SiegeCatapult[7] can navigate to {PlayerPlatoon1}
            clear siege weapon LC9_SiegeCatapult[7] action queue
            a = 0
        elsif Catapult exists and LC9_SiegeCatapult[7] can navigate to {Catapult}
            clear siege weapon LC9_SiegeCatapult[7] action queue
            a = 0
        elsif PointOn != 5 and a == 1
            begin loop
                if LC9_SiegeCatapult[7] exists
                    if get SiegeOnPointTimer time remaining <= 0
                        SiegeWeaponPoint = marker at {LC9_SiegeCatapult[7]}
                        SiegeOnPointTimer = create timer for 40 seconds
                    elsif get SiegeOnPointTimer time remaining <= 5
                        if {LC9_SiegeCatapult[7]} near {SiegeWeaponPoint} radius 10
                            clear siege weapon LC9_SiegeCatapult[7] action queue
                            delete LC9_SiegeCatapult[7]
                            SiegeStucked = 1
                        end if
                    end if
                    if get CatapultMoveTimer1 time remaining <= 0
                        if get size of LC9_SiegeCatapult[7] action queue < 1

                            if PointOn == 0
                                if LC9_SiegeCatapult[7] can navigate to {SiegeRoute3[0]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute3[0]} to siege weapon LC9_SiegeCatapult[7] action queue
                                end if
                    
                            elsif PointOn == 1
                                if LC9_SiegeCatapult[7] can navigate to {SiegeRoute3[1]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute3[1]} to siege weapon LC9_SiegeCatapult[7] action queue
                                end if

                            elsif PointOn == 2
                                if LC9_SiegeCatapult[7] can navigate to {SiegeRoute3[2]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute3[2]} to siege weapon LC9_SiegeCatapult[7] action queue
                                end if

                            elsif PointOn == 3
                                if LC9_SiegeCatapult[7] can navigate to {SiegeRoute3[3]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute3[3]} to siege weapon LC9_SiegeCatapult[7] action queue
                                end if

                            elsif PointOn == 4
                                if LC9_SiegeCatapult[7] can navigate to {SiegeRoute3[4]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute3[4]} to siege weapon LC9_SiegeCatapult[7] action queue
                                end if

                            CatapultMoveTimer1 = create timer for 10 seconds
                            
                            end if
                        end if
                    end if        

                    if {LC9_SiegeCatapult[7]} near {SiegeRoute3[0]} radius 15 and PointOn != 1 or 60 seconds
                        PointOn = 1
                    elsif {LC9_SiegeCatapult[7]} near {SiegeRoute3[1]} radius 15 and PointOn != 2 or 60 seconds
                        PointOn = 2
                    elsif {LC9_SiegeCatapult[7]} near {SiegeRoute3[2]} radius 15 and PointOn != 3 or 60 seconds
                        PointOn = 3
                    elsif {LC9_SiegeCatapult[7]} near {SiegeRoute3[3]} radius 15 and PointOn != 4 or 60 seconds
                        PointOn = 4
                    elsif {LC9_SiegeCatapult[7]} near {SiegeRoute3[4]} radius 15 and PointOn != 5 or 60 seconds
                        PointOn = 5
                    elsif not LC9_SiegeCatapult[7] can navigate to {SiegeRoute3[4]} and {LC9_SiegeCatapult[7]} near {SiegeRoute3[3]} radius 15 and PointOn != 5
                        PointOn = 5
                    end if
                end if
            until LC9_SiegeCatapult[7] not exists or PointOn == 5 or 180 seconds
            end loop
        end if
        
        until PointOn == 5 or LC9_SiegeCatapult[7] not exists or 180 seconds
    end loop

    wait 5 seconds

    enable siege weapon LC9_SiegeCatapult[7] auto attack

    begin loop
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 5
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get HOUSE GATEHOUSE at {LC9_SiegeCatapult[7]} radius 250
                if GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE_F at {LC9_SiegeCatapult[7]} radius 250
                end if
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon LC9_SiegeCatapult[7] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[7]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[7] action queue
                elsif GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE at {LC9_SiegeCatapult[7]} radius 750
                    if GateHouse not exists
                        GateHouse = get HOUSE GATEHOUSE_F at {LC9_SiegeCatapult[7]} radius 750
                    end if
                    clear siege weapon LC9_SiegeCatapult[7] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[7]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[7] action queue
                else
                    GateHouse = get random abode of type GATEHOUSE in town PlayerTown
                    if GateHouse not exists
                        GateHouse = get random abode of type GATEHOUSE_F in town PlayerTown
                    end if
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon LC9_SiegeCatapult[7] action queue
                        Target = marker at get target from {LC9_SiegeCatapult[7]} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[7] action queue
                    else
                        ActionTimer = create timer for 2 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {LC9_SiegeCatapult[7]} radius 750
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC9_SiegeCatapult[7] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[7]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC9_SiegeCatapult[7] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            else
                House = get building ALTAR in PlayerTown min built 0.75
                if House exists and PLAYER of House == 0 and LC9_SiegeCatapult[7] can navigate to object oTownCentre
                    clear siege weapon LC9_SiegeCatapult[7] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[7]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC9_SiegeCatapult[7] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            end if
        end if

        until LC9_SiegeCatapult[7] not exists
    end loop
    
    if SiegeAttacking == 1 and UnderAttack != 0
        UnderAttack = UnderAttack - 1
    end if

    if LC9_SiegeCatapult[7] not exists and SiegeStucked == 0
        //CatapultDestroyed = 1
    end if
    
end loop

end script LC9_SiegeCatapult7Actions

begin script LC9_Platoon35Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC9_Platoon[35] exists
    LargeAttackCounter += 1
    wait until ALLOWED_TO_ATTACK == 1
    begin loop

        PlayerCreature = get distance from {LC9_Platoon[35]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC9_Platoon[35] can navigate to {oCreature}
            clear LC9_Platoon[35] action queue
            begin loop
                PlayerCreature = get distance from {LC9_Platoon[35]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC9_Platoon[35] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[35]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC9_Platoon[35] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC9_Platoon[35] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[35]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC9_Platoon[35]} radius 50
        if PlayerPlatoon1 exists and LC9_Platoon[35] can navigate to {PlayerPlatoon1}
            clear LC9_Platoon[35] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[35]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC9_Platoon[35] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[35]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC9_Platoon[35] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC9_Platoon[35] action queue
        elsif Catapult exists and LC9_Platoon[35] can navigate to {Catapult}
            clear LC9_Platoon[35] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC9_Platoon[35]} radius 50
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC9_Platoon[35] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[35]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[35]} radius 150
                if PlayerPlatoon1 exists and LC9_Platoon[35] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC9_Platoon[35] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC9_Platoon[35] action queue
            a = 0
        end if

        PlayerSettlement = get nearest town at {LC9_Platoon[35]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0
            if LC9_Platoon[35] can navigate to object Armory
                if TownCapturePlatoons[2] < 2
                    TownCapturePlatoons[2]++
                    clear LC9_Platoon[35] action queue
                    set LC9_Platoon[35] attack PlayerSettlement with severity 0.3 for takeover
                    a = 1
                    begin loop
                        PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[35]} radius 150
                        PlayerCreature = get distance from {LC9_Platoon[35]} to {oCreature}
                        if PlayerPlatoon1 exists
                            a = 0
                        elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                            a = 0
                        elsif not LC9_Platoon[35] can navigate to object Armory
                            a = 0
                        elsif LC9_Platoon[35] not exists
                            a = 0
                        end if
                        until a == 0 or LC9_Platoon[35] not exists or PLAYER of PlayerSettlement == 1
                    end loop
                    TownCapturePlatoons[2]--
                end if
                clear LC9_Platoon[35] action queue
            end if
        end if

        //if get size of LC9_Platoon[35] action queue < 1
            if LC9_Platoon[35] can navigate to object oTownCentre and PLAYER of PlayerTown == 0
                wait number from 5 to 25 seconds
                a = 1
                clear LC9_Platoon[35] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC9_Platoon[35] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[35] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[35] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[35] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[35] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[35] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[35] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[0] < 2
                        TownCapturePlatoons[0]++
                        set LC9_Platoon[35] attack PlayerTown with severity 0.3 for takeover
                    else
                        a = 0
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[35]} radius 150
                    TestCreature2 = get distance from {LC9_Platoon[35]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC9_Platoon[35]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC9_Platoon[35] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC9_Platoon[35] can navigate to object oTownCentre
                            a = 0
                        elsif LC9_Platoon[35] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC9_Platoon[35] not exists
                end loop
                TownCapturePlatoons[0]--
                clear LC9_Platoon[35] action queue
            elsif LC9_Platoon[35] can navigate to {AttackPos[0]} + {10,0,10}
                clear LC9_Platoon[35] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[0]} + {10,0,10} to LC9_Platoon[35] action queue
            else
                clear LC9_Platoon[35] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[1]} + {10,0,10} to LC9_Platoon[35] action queue
            end if
        //end if

        until LC9_Platoon[35] not exists
    end loop
    if LC9_Platoon[35] not exists
        //PlatoonKilled = 1
        wait until LC9_Platoon[35] exists
    end if
end loop

end script LC9_Platoon35Actions

begin script LC9_Platoon36Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC9_Platoon[36] exists
    LargeAttackCounter += 1
    wait until ALLOWED_TO_ATTACK == 1
    begin loop

        PlayerCreature = get distance from {LC9_Platoon[36]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC9_Platoon[36] can navigate to {oCreature}
            clear LC9_Platoon[36] action queue
            begin loop
                PlayerCreature = get distance from {LC9_Platoon[36]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using oCreature to LC9_Platoon[36] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[36]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC9_Platoon[36] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC9_Platoon[36] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[36]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC9_Platoon[36]} radius 50
        if PlayerPlatoon1 exists and LC9_Platoon[36] can navigate to {PlayerPlatoon1}
            clear LC9_Platoon[36] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[36]} radius 150
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using PlayerPlatoon1 to LC9_Platoon[36] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[36]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC9_Platoon[36] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC9_Platoon[36] action queue
        elsif Catapult exists and LC9_Platoon[36] can navigate to {Catapult}
            clear LC9_Platoon[36] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC9_Platoon[36]} radius 50
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using Catapult to LC9_Platoon[36] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[36]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[36]} radius 150
                if PlayerPlatoon1 exists and LC9_Platoon[36] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC9_Platoon[36] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC9_Platoon[36] action queue
            a = 0
        end if

        PlayerSettlement = get nearest town at {LC9_Platoon[36]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0
            if LC9_Platoon[36] can navigate to object Armory
                if TownCapturePlatoons[1] < 2
                    TownCapturePlatoons[1]++
                    clear LC9_Platoon[36] action queue
                    set LC9_Platoon[36] attack PlayerSettlement with severity 0.3 for takeover
                    a = 1
                    begin loop
                        PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[36]} radius 150
                        PlayerCreature = get distance from {LC9_Platoon[36]} to {oCreature}
                        if PlayerPlatoon1 exists
                            a = 0
                        elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                            a = 0
                        elsif not LC9_Platoon[36] can navigate to object Armory
                            a = 0
                        elsif LC9_Platoon[36] not exists
                            a = 0
                        end if
                        until a == 0 or LC9_Platoon[36] not exists or PLAYER of PlayerSettlement == 1
                    end loop
                    TownCapturePlatoons[1]--
                end if
                clear LC9_Platoon[36] action queue
            end if
        end if

        //if get size of LC9_Platoon[36] action queue < 1
            if LC9_Platoon[36] can navigate to object oTownCentre and PLAYER of PlayerTown == 0
                wait number from 5 to 25 seconds
                a = 1
                clear LC9_Platoon[36] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC9_Platoon[36] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[36] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[36] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[36] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[36] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[36] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[36] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[0] < 2
                        TownCapturePlatoons[0]++
                        set LC9_Platoon[36] attack PlayerTown with severity 0.3 for takeover
                    else
                        a = 0
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[36]} radius 150
                    TestCreature2 = get distance from {LC9_Platoon[36]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC9_Platoon[36]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC9_Platoon[36] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC9_Platoon[36] can navigate to object oTownCentre
                            a = 0
                        elsif LC9_Platoon[36] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC9_Platoon[36] not exists
                end loop
                TownCapturePlatoons[0]--
                clear LC9_Platoon[36] action queue
            elsif LC9_Platoon[36] can navigate to {AttackPos[0]} + {30,0,30}
                clear LC9_Platoon[36] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[0]} + {30,0,30} to LC9_Platoon[36] action queue
            else
                clear LC9_Platoon[36] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[1]} + {30,0,30} to LC9_Platoon[36] action queue
            end if
        //end if

        until LC9_Platoon[36] not exists
    end loop
    if LC9_Platoon[36] not exists
        //PlatoonKilled = 1
        wait until LC9_Platoon[36] exists
    end if
end loop

end script LC9_Platoon36Actions

begin script LC9_Platoon37Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC9_Platoon[37] exists
    LargeAttackCounter += 1
    wait until ALLOWED_TO_ATTACK == 1
    begin loop

        PlayerCreature = get distance from {LC9_Platoon[37]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC9_Platoon[37] can navigate to {oCreature}
            clear LC9_Platoon[37] action queue
            begin loop
                PlayerCreature = get distance from {LC9_Platoon[37]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC9_Platoon[37] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[37]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC9_Platoon[37] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC9_Platoon[37] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[37]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC9_Platoon[37]} radius 50
        if PlayerPlatoon1 exists and LC9_Platoon[37] can navigate to {PlayerPlatoon1}
            clear LC9_Platoon[37] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[37]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC9_Platoon[37] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[37]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC9_Platoon[37] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC9_Platoon[37] action queue
        elsif Catapult exists and LC9_Platoon[37] can navigate to {Catapult}
            clear LC9_Platoon[37] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC9_Platoon[37]} radius 50
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC9_Platoon[37] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[37]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[37]} radius 150
                if PlayerPlatoon1 exists and LC9_Platoon[37] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC9_Platoon[37] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC9_Platoon[37] action queue
            a = 0
        end if

        PlayerSettlement = get nearest town at {LC9_Platoon[37]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0
            if LC9_Platoon[37] can navigate to object Armory
                if TownCapturePlatoons[1] < 2
                    TownCapturePlatoons[1]++
                    clear LC9_Platoon[37] action queue
                    set LC9_Platoon[37] attack PlayerSettlement with severity 0.3 for takeover
                    a = 1
                    begin loop
                        PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[37]} radius 150
                        PlayerCreature = get distance from {LC9_Platoon[37]} to {oCreature}
                        if PlayerPlatoon1 exists
                            a = 0
                        elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                            a = 0
                        elsif not LC9_Platoon[37] can navigate to object Armory
                            a = 0
                        elsif LC9_Platoon[37] not exists
                            a = 0
                        end if
                        until a == 0 or LC9_Platoon[37] not exists or PLAYER of PlayerSettlement == 1
                    end loop
                    TownCapturePlatoons[1]--
                end if
                clear LC9_Platoon[37] action queue
            end if
        end if

        //if get size of LC9_Platoon[37] action queue < 1
            if LC9_Platoon[37] can navigate to object oTownCentre and PLAYER of PlayerTown == 0
                wait number from 5 to 25 seconds
                a = 1
                clear LC9_Platoon[37] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC9_Platoon[37] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[37] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[37] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[37] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[37] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[37] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[37] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[0] < 2
                        TownCapturePlatoons[0]++
                        set LC9_Platoon[37] attack PlayerTown with severity 0.3 for takeover
                    else
                        a = 0
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[37]} radius 150
                    TestCreature2 = get distance from {LC9_Platoon[37]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC9_Platoon[37]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC9_Platoon[37] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC9_Platoon[37] can navigate to object oTownCentre
                            a = 0
                        elsif LC9_Platoon[37] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC9_Platoon[37] not exists
                end loop
                TownCapturePlatoons[0]--
                clear LC9_Platoon[37] action queue
            elsif LC9_Platoon[37] can navigate to {AttackPos[2]} + {10,0,10}
                clear LC9_Platoon[37] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[2]} + {10,0,10} to LC9_Platoon[37] action queue
            else
                clear LC9_Platoon[37] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[3]} + {10,0,10} to LC9_Platoon[37] action queue
            end if
        //end if

        until LC9_Platoon[37] not exists
    end loop
    if LC9_Platoon[37] not exists
        //PlatoonKilled = 1
        wait until LC9_Platoon[37] exists
    end if
end loop

end script LC9_Platoon37Actions

begin script LC9_Platoon38Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC9_Platoon[38] exists
    LargeAttackCounter += 1
    wait until ALLOWED_TO_ATTACK == 1
    begin loop

        PlayerCreature = get distance from {LC9_Platoon[38]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC9_Platoon[38] can navigate to {oCreature}
            clear LC9_Platoon[38] action queue
            begin loop
                PlayerCreature = get distance from {LC9_Platoon[38]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using oCreature to LC9_Platoon[38] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[38]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC9_Platoon[38] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC9_Platoon[38] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[38]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC9_Platoon[38]} radius 50
        if PlayerPlatoon1 exists and LC9_Platoon[38] can navigate to {PlayerPlatoon1}
            clear LC9_Platoon[38] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[38]} radius 150
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using PlayerPlatoon1 to LC9_Platoon[38] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[38]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC9_Platoon[38] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC9_Platoon[38] action queue
        elsif Catapult exists and LC9_Platoon[38] can navigate to {Catapult}
            clear LC9_Platoon[38] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC9_Platoon[38]} radius 50
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using Catapult to LC9_Platoon[38] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[38]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[38]} radius 150
                if PlayerPlatoon1 exists and LC9_Platoon[38] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC9_Platoon[38] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC9_Platoon[38] action queue
            a = 0
        end if

        PlayerSettlement = get nearest town at {LC9_Platoon[38]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0
            if LC9_Platoon[38] can navigate to object Armory
                if TownCapturePlatoons[1] < 2
                    TownCapturePlatoons[1]++
                    clear LC9_Platoon[38] action queue
                    set LC9_Platoon[38] attack PlayerSettlement with severity 0.3 for takeover
                    a = 1
                    begin loop
                        PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[38]} radius 150
                        PlayerCreature = get distance from {LC9_Platoon[38]} to {oCreature}
                        if PlayerPlatoon1 exists
                            a = 0
                        elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                            a = 0
                        elsif not LC9_Platoon[38] can navigate to object Armory
                            a = 0
                        elsif LC9_Platoon[38] not exists
                            a = 0
                        end if
                        until a == 0 or LC9_Platoon[38] not exists or PLAYER of PlayerSettlement == 1
                    end loop
                    TownCapturePlatoons[1]--
                end if
                clear LC9_Platoon[38] action queue
            end if
        end if

        //if get size of LC9_Platoon[38] action queue < 1
            if LC9_Platoon[38] can navigate to object oTownCentre and PLAYER of PlayerTown == 0
                wait number from 5 to 25 seconds
                a = 1
                clear LC9_Platoon[38] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC9_Platoon[38] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[38] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[38] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[38] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[38] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[38] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[38] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[0] < 2
                        TownCapturePlatoons[0]++
                        set LC9_Platoon[38] attack PlayerTown with severity 0.3 for takeover
                    else
                        a = 0
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[38]} radius 150
                    TestCreature2 = get distance from {LC9_Platoon[38]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC9_Platoon[38]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC9_Platoon[38] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC9_Platoon[38] can navigate to object oTownCentre
                            a = 0
                        elsif LC9_Platoon[38] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC9_Platoon[38] not exists
                end loop
                TownCapturePlatoons[0]--
                clear LC9_Platoon[38] action queue
            elsif LC9_Platoon[38] can navigate to {AttackPos[2]} + {30,0,30}
                clear LC9_Platoon[38] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[2]} + {30,0,30} to LC9_Platoon[38] action queue
            else
                clear LC9_Platoon[38] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[3]} + {30,0,30} to LC9_Platoon[38] action queue
            end if
        //end if

        until LC9_Platoon[38] not exists
    end loop
    if LC9_Platoon[38] not exists
        //PlatoonKilled = 1
        wait until LC9_Platoon[38] exists
    end if
end loop

end script LC9_Platoon38Actions

begin script LC9_Platoon39Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC9_Platoon[39] exists
    LargeAttackCounter += 1
    wait until ALLOWED_TO_ATTACK == 1
    begin loop

        PlayerCreature = get distance from {LC9_Platoon[39]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC9_Platoon[39] can navigate to {oCreature}
            clear LC9_Platoon[39] action queue
            begin loop
                PlayerCreature = get distance from {LC9_Platoon[39]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC9_Platoon[39] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[39]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC9_Platoon[39] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC9_Platoon[39] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[39]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC9_Platoon[39]} radius 50
        if PlayerPlatoon1 exists and LC9_Platoon[39] can navigate to {PlayerPlatoon1}
            clear LC9_Platoon[39] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[39]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC9_Platoon[39] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[39]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC9_Platoon[39] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC9_Platoon[39] action queue
        elsif Catapult exists and LC9_Platoon[39] can navigate to {Catapult}
            clear LC9_Platoon[39] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC9_Platoon[39]} radius 50
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC9_Platoon[39] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[39]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[39]} radius 150
                if PlayerPlatoon1 exists and LC9_Platoon[39] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC9_Platoon[39] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC9_Platoon[39] action queue
            a = 0
        end if

        PlayerSettlement = get nearest town at {LC9_Platoon[39]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0
            if LC9_Platoon[39] can navigate to object Armory
                if TownCapturePlatoons[2] < 2
                    TownCapturePlatoons[2]++
                    clear LC9_Platoon[39] action queue
                    set LC9_Platoon[39] attack PlayerSettlement with severity 0.3 for takeover
                    a = 1
                    begin loop
                        PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[39]} radius 150
                        PlayerCreature = get distance from {LC9_Platoon[39]} to {oCreature}
                        if PlayerPlatoon1 exists
                            a = 0
                        elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                            a = 0
                        elsif not LC9_Platoon[39] can navigate to object Armory
                            a = 0
                        elsif LC9_Platoon[39] not exists
                            a = 0
                        end if
                        until a == 0 or LC9_Platoon[39] not exists or PLAYER of PlayerSettlement == 1
                    end loop
                    TownCapturePlatoons[2]--
                end if
                clear LC9_Platoon[39] action queue
            end if
        end if

        //if get size of LC9_Platoon[39] action queue < 1
            if LC9_Platoon[39] can navigate to object oTownCentre and PLAYER of PlayerTown == 0
                wait number from 5 to 25 seconds
                a = 1
                clear LC9_Platoon[39] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC9_Platoon[39] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[39] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[39] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[39] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[39] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[39] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[39] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[0] < 2
                        TownCapturePlatoons[0]++
                        set LC9_Platoon[39] attack PlayerTown with severity 0.3 for takeover
                    else
                        a = 0
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[39]} radius 150
                    TestCreature2 = get distance from {LC9_Platoon[39]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC9_Platoon[39]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC9_Platoon[39] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC9_Platoon[39] can navigate to object oTownCentre
                            a = 0
                        elsif LC9_Platoon[39] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC9_Platoon[39] not exists
                end loop
                TownCapturePlatoons[0]--
                clear LC9_Platoon[39] action queue
            elsif LC9_Platoon[39] can navigate to {AttackPos[0]} + {-10,0,-10}
                clear LC9_Platoon[39] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[0]} + {-10,0,-10} to LC9_Platoon[39] action queue
            else
                clear LC9_Platoon[39] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[1]} + {-10,0,-10} to LC9_Platoon[39] action queue
            end if
        //end if

        until LC9_Platoon[39] not exists
    end loop
    if LC9_Platoon[39] not exists
        //PlatoonKilled = 1
        wait until LC9_Platoon[39] exists
    end if
end loop

end script LC9_Platoon39Actions

begin script LC9_Platoon40Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC9_Platoon[40] exists
    LargeAttackCounter += 1
    wait until ALLOWED_TO_ATTACK == 1
    begin loop

        PlayerCreature = get distance from {LC9_Platoon[40]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC9_Platoon[40] can navigate to {oCreature}
            clear LC9_Platoon[40] action queue
            begin loop
                PlayerCreature = get distance from {LC9_Platoon[40]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using oCreature to LC9_Platoon[40] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[40]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC9_Platoon[40] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC9_Platoon[40] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[40]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC9_Platoon[40]} radius 50
        if PlayerPlatoon1 exists and LC9_Platoon[40] can navigate to {PlayerPlatoon1}
            clear LC9_Platoon[40] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[40]} radius 150
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using PlayerPlatoon1 to LC9_Platoon[40] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[40]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC9_Platoon[40] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC9_Platoon[40] action queue
        elsif Catapult exists and LC9_Platoon[40] can navigate to {Catapult}
            clear LC9_Platoon[40] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC9_Platoon[40]} radius 50
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using Catapult to LC9_Platoon[40] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[40]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[40]} radius 150
                if PlayerPlatoon1 exists and LC9_Platoon[40] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC9_Platoon[40] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC9_Platoon[40] action queue
            a = 0
        end if

        PlayerSettlement = get nearest town at {LC9_Platoon[40]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0
            if LC9_Platoon[40] can navigate to object Armory
                if TownCapturePlatoons[2] < 2
                    TownCapturePlatoons[2]++
                    clear LC9_Platoon[40] action queue
                    set LC9_Platoon[40] attack PlayerSettlement with severity 0.3 for takeover
                    a = 1
                    begin loop
                        PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[40]} radius 150
                        PlayerCreature = get distance from {LC9_Platoon[40]} to {oCreature}
                        if PlayerPlatoon1 exists
                            a = 0
                        elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                            a = 0
                        elsif not LC9_Platoon[40] can navigate to object Armory
                            a = 0
                        elsif LC9_Platoon[40] not exists
                            a = 0
                        end if
                        until a == 0 or LC9_Platoon[40] not exists or PLAYER of PlayerSettlement == 1
                    end loop
                    TownCapturePlatoons[2]--
                end if
                clear LC9_Platoon[40] action queue
            end if
        end if

        //if get size of LC9_Platoon[40] action queue < 1
            if LC9_Platoon[40] can navigate to object oTownCentre and PLAYER of PlayerTown == 0
                wait number from 5 to 25 seconds
                a = 1
                clear LC9_Platoon[40] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC9_Platoon[40] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[40] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[40] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[40] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[40] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[40] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[40] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[0] < 2
                        TownCapturePlatoons[0]++
                        set LC9_Platoon[40] attack PlayerTown with severity 0.3 for takeover
                    else
                        a = 0
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[40]} radius 150
                    TestCreature2 = get distance from {LC9_Platoon[40]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC9_Platoon[40]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC9_Platoon[40] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC9_Platoon[40] can navigate to object oTownCentre
                            a = 0
                        elsif LC9_Platoon[40] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC9_Platoon[40] not exists
                end loop
                TownCapturePlatoons[0]--
                clear LC9_Platoon[40] action queue
            elsif LC9_Platoon[40] can navigate to {AttackPos[0]} + {-30,0,-30}
                clear LC9_Platoon[40] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[0]} + {-30,0,-30} to LC9_Platoon[40] action queue
            else
                clear LC9_Platoon[40] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[1]} + {-30,0,-30} to LC9_Platoon[40] action queue
            end if
        //end if

        until LC9_Platoon[40] not exists
    end loop
    if LC9_Platoon[40] not exists
        //PlatoonKilled = 1
        wait until LC9_Platoon[40] exists
    end if
end loop

end script LC9_Platoon40Actions

begin script LC9_SiegeCatapult8Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = create timer for 0 seconds
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 0
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC9_SiegeCatapult[8] exists
    LargeAttackCounter += 1
    wait until ALLOWED_TO_ATTACK == 1
    wait 2 seconds
    begin loop
        PlayerCreature = get distance from {LC9_SiegeCatapult[8]} to {oCreature}
        PlayerPlatoon1 = get platoon of player 0 nearest {LC9_SiegeCatapult[8]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC9_SiegeCatapult[8]} radius 150
        
        if PlayerCreature > 10 and PlayerPlatoon1 not exists and Catapult not exists
            if PlayerPlatoon1 not exists
                a = 1
            elsif PlayerCreature > 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                a = 1
            elsif Catapult not exists
                a = 1
            end if
        end if
        
        if PlayerCreature <= 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
            clear siege weapon LC9_SiegeCatapult[8] action queue
            a = 0
        elsif PlayerPlatoon1 exists and LC9_SiegeCatapult[8] can navigate to {PlayerPlatoon1}
            clear siege weapon LC9_SiegeCatapult[8] action queue
            a = 0
        elsif Catapult exists and LC9_SiegeCatapult[8] can navigate to {Catapult}
            clear siege weapon LC9_SiegeCatapult[8] action queue
            a = 0
        elsif PointOn != 4 and a == 1
            begin loop
                if LC9_SiegeCatapult[8] exists
                    if get SiegeOnPointTimer time remaining <= 0
                        SiegeWeaponPoint = marker at {LC9_SiegeCatapult[8]}
                        SiegeOnPointTimer = create timer for 40 seconds
                    elsif get SiegeOnPointTimer time remaining <= 5
                        if {LC9_SiegeCatapult[8]} near {SiegeWeaponPoint} radius 10
                            clear siege weapon LC9_SiegeCatapult[8] action queue
                            delete LC9_SiegeCatapult[8]
                            SiegeStucked = 1
                        end if
                    end if
                    if get CatapultMoveTimer1 time remaining <= 0
                        if get size of LC9_SiegeCatapult[8] action queue < 1

                            if PointOn == 0
                                if LC9_SiegeCatapult[8] can navigate to {SiegeRoute4[0]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute4[0]} to siege weapon LC9_SiegeCatapult[8] action queue
                                end if
                    
                            elsif PointOn == 1
                                if LC9_SiegeCatapult[8] can navigate to {SiegeRoute4[1]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute4[1]} to siege weapon LC9_SiegeCatapult[8] action queue
                                end if

                            elsif PointOn == 2
                                if LC9_SiegeCatapult[8] can navigate to {SiegeRoute4[2]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute4[2]} to siege weapon LC9_SiegeCatapult[8] action queue
                                end if

                            elsif PointOn == 3
                                if LC9_SiegeCatapult[8] can navigate to {SiegeRoute4[3]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute4[3]} to siege weapon LC9_SiegeCatapult[8] action queue
                                end if

                            CatapultMoveTimer1 = create timer for 10 seconds
                            
                            end if
                        end if
                    end if        

                    if {LC9_SiegeCatapult[8]} near {SiegeRoute4[0]} radius 15 and PointOn != 1 or 60 seconds
                        PointOn = 1
                    elsif {LC9_SiegeCatapult[8]} near {SiegeRoute4[1]} radius 15 and PointOn != 2 or 60 seconds
                        PointOn = 2
                    elsif {LC9_SiegeCatapult[8]} near {SiegeRoute4[2]} radius 15 and PointOn != 3 or 60 seconds
                        PointOn = 3
                    elsif {LC9_SiegeCatapult[8]} near {SiegeRoute4[3]} radius 15 and PointOn != 5 or 60 seconds
                        PointOn = 4
                    elsif not LC9_SiegeCatapult[8] can navigate to {SiegeRoute4[3]} and {LC9_SiegeCatapult[8]} near {SiegeRoute4[2]} radius 15 and PointOn != 4
                        PointOn = 4
                    end if
                end if
            until LC9_SiegeCatapult[8] not exists or PointOn == 4 or 180 seconds
            end loop
        end if
        
        until PointOn == 4 or LC9_SiegeCatapult[8] not exists or 180 seconds
    end loop

    wait 5 seconds

    enable siege weapon LC9_SiegeCatapult[8] auto attack

    begin loop
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 5
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get HOUSE GATEHOUSE at {LC9_SiegeCatapult[8]} radius 250
                if GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE_F at {LC9_SiegeCatapult[8]} radius 250
                end if
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon LC9_SiegeCatapult[8] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[8]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[8] action queue
                elsif GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE at {LC9_SiegeCatapult[8]} radius 750
                    if GateHouse not exists
                        GateHouse = get HOUSE GATEHOUSE_F at {LC9_SiegeCatapult[8]} radius 750
                    end if
                    clear siege weapon LC9_SiegeCatapult[8] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[8]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[8] action queue
                else
                    GateHouse = get random abode of type GATEHOUSE in town PlayerTown
                    if GateHouse not exists
                        GateHouse = get random abode of type GATEHOUSE_F in town PlayerTown
                    end if
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon LC9_SiegeCatapult[8] action queue
                        Target = marker at get target from {LC9_SiegeCatapult[8]} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[8] action queue
                    else
                        ActionTimer = create timer for 2 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {LC9_SiegeCatapult[8]} radius 750
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC9_SiegeCatapult[8] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[8]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC9_SiegeCatapult[8] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            else
                House = get building ALTAR in PlayerTown min built 0.75
                if House exists and PLAYER of House == 0 and LC9_SiegeCatapult[8] can navigate to object oTownCentre
                    clear siege weapon LC9_SiegeCatapult[8] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[8]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC9_SiegeCatapult[8] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            end if
        end if

        until LC9_SiegeCatapult[8] not exists
    end loop
    
    if SiegeAttacking == 1 and UnderAttack != 0
        UnderAttack = UnderAttack - 1
    end if

    if LC9_SiegeCatapult[8] not exists and SiegeStucked == 0
        //CatapultDestroyed = 1
    end if
    
end loop

end script LC9_SiegeCatapult8Actions

begin script LC9_SiegeCatapult9Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = create timer for 0 seconds
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 0
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC9_SiegeCatapult[9] exists
    LargeAttackCounter += 1
    wait until ALLOWED_TO_ATTACK == 1
    wait 2 seconds
    begin loop
        PlayerCreature = get distance from {LC9_SiegeCatapult[9]} to {oCreature}
        PlayerPlatoon1 = get platoon of player 0 nearest {LC9_SiegeCatapult[9]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC9_SiegeCatapult[9]} radius 150
        
        if PlayerCreature > 10 and PlayerPlatoon1 not exists and Catapult not exists
            if PlayerPlatoon1 not exists
                a = 1
            elsif PlayerCreature > 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                a = 1
            elsif Catapult not exists
                a = 1
            end if
        end if
        
        if PlayerCreature <= 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
            clear siege weapon LC9_SiegeCatapult[9] action queue
            a = 0
        elsif PlayerPlatoon1 exists and LC9_SiegeCatapult[9] can navigate to {PlayerPlatoon1}
            clear siege weapon LC9_SiegeCatapult[9] action queue
            a = 0
        elsif Catapult exists and LC9_SiegeCatapult[9] can navigate to {Catapult}
            clear siege weapon LC9_SiegeCatapult[9] action queue
            a = 0
        elsif PointOn != 4 and a == 1
            begin loop
                if LC9_SiegeCatapult[9] exists
                    if get SiegeOnPointTimer time remaining <= 0
                        SiegeWeaponPoint = marker at {LC9_SiegeCatapult[9]}
                        SiegeOnPointTimer = create timer for 40 seconds
                    elsif get SiegeOnPointTimer time remaining <= 5
                        if {LC9_SiegeCatapult[9]} near {SiegeWeaponPoint} radius 10
                            clear siege weapon LC9_SiegeCatapult[9] action queue
                            delete LC9_SiegeCatapult[9]
                            SiegeStucked = 1
                        end if
                    end if
                    if get CatapultMoveTimer1 time remaining <= 0
                        if get size of LC9_SiegeCatapult[9] action queue < 1

                            if PointOn == 0
                                if LC9_SiegeCatapult[9] can navigate to {SiegeRoute5[0]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute5[0]} to siege weapon LC9_SiegeCatapult[9] action queue
                                end if
                    
                            elsif PointOn == 1
                                if LC9_SiegeCatapult[9] can navigate to {SiegeRoute5[1]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute5[1]} to siege weapon LC9_SiegeCatapult[9] action queue
                                end if

                            elsif PointOn == 2
                                if LC9_SiegeCatapult[9] can navigate to {SiegeRoute5[2]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute5[2]} to siege weapon LC9_SiegeCatapult[9] action queue
                                end if

                            elsif PointOn == 3
                                if LC9_SiegeCatapult[9] can navigate to {SiegeRoute5[3]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute5[3]} to siege weapon LC9_SiegeCatapult[9] action queue
                                end if

                            CatapultMoveTimer1 = create timer for 10 seconds
                            
                            end if
                        end if
                    end if        

                    if {LC9_SiegeCatapult[9]} near {SiegeRoute5[0]} radius 15 and PointOn != 1 or 60 seconds
                        PointOn = 1
                    elsif {LC9_SiegeCatapult[9]} near {SiegeRoute5[1]} radius 15 and PointOn != 2 or 60 seconds
                        PointOn = 2
                    elsif {LC9_SiegeCatapult[9]} near {SiegeRoute5[2]} radius 15 and PointOn != 3 or 60 seconds
                        PointOn = 3
                    elsif {LC9_SiegeCatapult[9]} near {SiegeRoute5[3]} radius 15 and PointOn != 5 or 60 seconds
                        PointOn = 4
                    elsif not LC9_SiegeCatapult[9] can navigate to {SiegeRoute5[3]} and {LC9_SiegeCatapult[9]} near {SiegeRoute5[2]} radius 15 and PointOn != 4
                        PointOn = 4
                    end if
                end if
            until LC9_SiegeCatapult[9] not exists or PointOn == 4 or 180 seconds
            end loop
        end if
        
        until PointOn == 4 or LC9_SiegeCatapult[9] not exists or 180 seconds
    end loop

    wait 5 seconds

    enable siege weapon LC9_SiegeCatapult[9] auto attack

    begin loop
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 5
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get HOUSE GATEHOUSE at {LC9_SiegeCatapult[9]} radius 250
                if GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE_F at {LC9_SiegeCatapult[9]} radius 250
                end if
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon LC9_SiegeCatapult[9] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[9]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[9] action queue
                elsif GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE at {LC9_SiegeCatapult[9]} radius 750
                    if GateHouse not exists
                        GateHouse = get HOUSE GATEHOUSE_F at {LC9_SiegeCatapult[9]} radius 750
                    end if
                    clear siege weapon LC9_SiegeCatapult[9] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[9]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[9] action queue
                else
                    GateHouse = get random abode of type GATEHOUSE in town PlayerTown
                    if GateHouse not exists
                        GateHouse = get random abode of type GATEHOUSE_F in town PlayerTown
                    end if
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon LC9_SiegeCatapult[9] action queue
                        Target = marker at get target from {LC9_SiegeCatapult[9]} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[9] action queue
                    else
                        ActionTimer = create timer for 2 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {LC9_SiegeCatapult[9]} radius 750
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC9_SiegeCatapult[9] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[9]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC9_SiegeCatapult[9] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            else
                House = get building ALTAR in PlayerTown min built 0.75
                if House exists and PLAYER of House == 0 and LC9_SiegeCatapult[9] can navigate to object oTownCentre
                    clear siege weapon LC9_SiegeCatapult[9] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[9]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC9_SiegeCatapult[9] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            end if
        end if

        until LC9_SiegeCatapult[9] not exists
    end loop
    
    if SiegeAttacking == 1 and UnderAttack != 0
        UnderAttack = UnderAttack - 1
    end if

    if LC9_SiegeCatapult[9] not exists and SiegeStucked == 0
        //CatapultDestroyed = 1
    end if
    
end loop

end script LC9_SiegeCatapult9Actions

begin script LC9_SiegeCatapult10Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = create timer for 0 seconds
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 0
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC9_SiegeCatapult[10] exists
    LargeAttackCounter += 1
    wait until ALLOWED_TO_ATTACK == 1
    wait 2 seconds
    begin loop
        PlayerCreature = get distance from {LC9_SiegeCatapult[10]} to {oCreature}
        PlayerPlatoon1 = get platoon of player 0 nearest {LC9_SiegeCatapult[10]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC9_SiegeCatapult[10]} radius 150
        
        if PlayerCreature > 10 and PlayerPlatoon1 not exists and Catapult not exists
            if PlayerPlatoon1 not exists
                a = 1
            elsif PlayerCreature > 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                a = 1
            elsif Catapult not exists
                a = 1
            end if
        end if
        
        if PlayerCreature <= 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
            clear siege weapon LC9_SiegeCatapult[10] action queue
            a = 0
        elsif PlayerPlatoon1 exists and LC9_SiegeCatapult[10] can navigate to {PlayerPlatoon1}
            clear siege weapon LC9_SiegeCatapult[10] action queue
            a = 0
        elsif Catapult exists and LC9_SiegeCatapult[10] can navigate to {Catapult}
            clear siege weapon LC9_SiegeCatapult[10] action queue
            a = 0
        elsif PointOn != 3 and a == 1
            begin loop
                if LC9_SiegeCatapult[10] exists
                    if get SiegeOnPointTimer time remaining <= 0
                        SiegeWeaponPoint = marker at {LC9_SiegeCatapult[10]}
                        SiegeOnPointTimer = create timer for 40 seconds
                    elsif get SiegeOnPointTimer time remaining <= 5
                        if {LC9_SiegeCatapult[10]} near {SiegeWeaponPoint} radius 10
                            clear siege weapon LC9_SiegeCatapult[10] action queue
                            delete LC9_SiegeCatapult[10]
                            SiegeStucked = 1
                        end if
                    end if
                    if get CatapultMoveTimer1 time remaining <= 0
                        if get size of LC9_SiegeCatapult[10] action queue < 1

                            if PointOn == 0
                                if LC9_SiegeCatapult[10] can navigate to {SiegeRoute6[0]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute6[0]} to siege weapon LC9_SiegeCatapult[10] action queue
                                end if
                    
                            elsif PointOn == 1
                                if LC9_SiegeCatapult[10] can navigate to {SiegeRoute6[1]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute6[1]} to siege weapon LC9_SiegeCatapult[10] action queue
                                end if

                            elsif PointOn == 2
                                if LC9_SiegeCatapult[10] can navigate to {SiegeRoute6[2]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute6[2]} to siege weapon LC9_SiegeCatapult[10] action queue
                                end if

                            CatapultMoveTimer1 = create timer for 10 seconds
                            
                            end if
                        end if
                    end if        

                    if {LC9_SiegeCatapult[10]} near {SiegeRoute6[0]} radius 15 and PointOn != 1 or 60 seconds
                        PointOn = 1
                    elsif {LC9_SiegeCatapult[10]} near {SiegeRoute6[1]} radius 15 and PointOn != 2 or 60 seconds
                        PointOn = 2
                    elsif {LC9_SiegeCatapult[10]} near {SiegeRoute6[2]} radius 15 and PointOn != 5 or 60 seconds
                        PointOn = 3
                    elsif not LC9_SiegeCatapult[10] can navigate to {SiegeRoute6[2]} and {LC9_SiegeCatapult[10]} near {SiegeRoute6[1]} radius 15 and PointOn != 3
                        PointOn = 3
                    end if
                end if
            until LC9_SiegeCatapult[10] not exists or PointOn == 3 or 180 seconds
            end loop
        end if
        
        until PointOn == 3 or LC9_SiegeCatapult[10] not exists or 180 seconds
    end loop

    wait 5 seconds

    enable siege weapon LC9_SiegeCatapult[10] auto attack

    begin loop
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 5
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get HOUSE GATEHOUSE at {LC9_SiegeCatapult[10]} radius 250
                if GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE_F at {LC9_SiegeCatapult[10]} radius 250
                end if
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon LC9_SiegeCatapult[10] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[10]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[10] action queue
                elsif GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE at {LC9_SiegeCatapult[10]} radius 750
                    if GateHouse not exists
                        GateHouse = get HOUSE GATEHOUSE_F at {LC9_SiegeCatapult[10]} radius 750
                    end if
                    clear siege weapon LC9_SiegeCatapult[10] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[10]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[10] action queue
                else
                    GateHouse = get random abode of type GATEHOUSE in town PlayerTown
                    if GateHouse not exists
                        GateHouse = get random abode of type GATEHOUSE_F in town PlayerTown
                    end if
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon LC9_SiegeCatapult[10] action queue
                        Target = marker at get target from {LC9_SiegeCatapult[10]} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[10] action queue
                    else
                        ActionTimer = create timer for 2 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {LC9_SiegeCatapult[10]} radius 750
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC9_SiegeCatapult[10] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[10]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC9_SiegeCatapult[10] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            else
                House = get building ALTAR in PlayerTown min built 0.75
                if House exists and PLAYER of House == 0 and LC9_SiegeCatapult[10] can navigate to object oTownCentre
                    clear siege weapon LC9_SiegeCatapult[10] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[10]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC9_SiegeCatapult[10] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            end if
        end if

        until LC9_SiegeCatapult[10] not exists
    end loop
    
    if SiegeAttacking == 1 and UnderAttack != 0
        UnderAttack = UnderAttack - 1
    end if

    if LC9_SiegeCatapult[10] not exists and SiegeStucked == 0
        //CatapultDestroyed = 1
    end if
    
end loop

end script LC9_SiegeCatapult10Actions

begin script LC9_SiegeCatapult11Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = create timer for 0 seconds
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 0
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC9_SiegeCatapult[11] exists
    LargeAttackCounter += 1
    wait until ALLOWED_TO_ATTACK == 1
    wait 2 seconds
    begin loop
        PlayerCreature = get distance from {LC9_SiegeCatapult[11]} to {oCreature}
        PlayerPlatoon1 = get platoon of player 0 nearest {LC9_SiegeCatapult[11]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC9_SiegeCatapult[11]} radius 150
        
        if PlayerCreature > 10 and PlayerPlatoon1 not exists and Catapult not exists
            if PlayerPlatoon1 not exists
                a = 1
            elsif PlayerCreature > 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                a = 1
            elsif Catapult not exists
                a = 1
            end if
        end if
        
        if PlayerCreature <= 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
            clear siege weapon LC9_SiegeCatapult[11] action queue
            a = 0
        elsif PlayerPlatoon1 exists and LC9_SiegeCatapult[11] can navigate to {PlayerPlatoon1}
            clear siege weapon LC9_SiegeCatapult[11] action queue
            a = 0
        elsif Catapult exists and LC9_SiegeCatapult[11] can navigate to {Catapult}
            clear siege weapon LC9_SiegeCatapult[11] action queue
            a = 0
        elsif PointOn != 3 and a == 1
            begin loop
                if LC9_SiegeCatapult[11] exists
                    if get SiegeOnPointTimer time remaining <= 0
                        SiegeWeaponPoint = marker at {LC9_SiegeCatapult[11]}
                        SiegeOnPointTimer = create timer for 40 seconds
                    elsif get SiegeOnPointTimer time remaining <= 5
                        if {LC9_SiegeCatapult[11]} near {SiegeWeaponPoint} radius 10
                            clear siege weapon LC9_SiegeCatapult[11] action queue
                            delete LC9_SiegeCatapult[11]
                            SiegeStucked = 1
                        end if
                    end if
                    if get CatapultMoveTimer1 time remaining <= 0
                        if get size of LC9_SiegeCatapult[11] action queue < 1

                            if PointOn == 0
                                if LC9_SiegeCatapult[11] can navigate to {SiegeRoute7[0]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute7[0]} to siege weapon LC9_SiegeCatapult[11] action queue
                                end if
                    
                            elsif PointOn == 1
                                if LC9_SiegeCatapult[11] can navigate to {SiegeRoute7[1]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute7[1]} to siege weapon LC9_SiegeCatapult[11] action queue
                                end if

                            elsif PointOn == 2
                                if LC9_SiegeCatapult[11] can navigate to {SiegeRoute7[2]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute7[2]} to siege weapon LC9_SiegeCatapult[11] action queue
                                end if

                            CatapultMoveTimer1 = create timer for 10 seconds
                            
                            end if
                        end if
                    end if        

                    if {LC9_SiegeCatapult[11]} near {SiegeRoute7[0]} radius 15 and PointOn != 1 or 60 seconds
                        PointOn = 1
                    elsif {LC9_SiegeCatapult[11]} near {SiegeRoute7[1]} radius 15 and PointOn != 2 or 60 seconds
                        PointOn = 2
                    elsif {LC9_SiegeCatapult[11]} near {SiegeRoute7[2]} radius 15 and PointOn != 3 or 60 seconds
                        PointOn = 3
                    elsif not LC9_SiegeCatapult[11] can navigate to {SiegeRoute7[2]} and {LC9_SiegeCatapult[11]} near {SiegeRoute7[1]} radius 15 and PointOn != 3
                        PointOn = 3
                    end if
                end if
            until LC9_SiegeCatapult[11] not exists or PointOn == 3 or 180 seconds
            end loop
        end if
        
        until PointOn == 3 or LC9_SiegeCatapult[11] not exists or 180 seconds
    end loop

    wait 5 seconds

    enable siege weapon LC9_SiegeCatapult[11] auto attack

    begin loop
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 5
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get HOUSE GATEHOUSE at {LC9_SiegeCatapult[11]} radius 250
                if GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE_F at {LC9_SiegeCatapult[11]} radius 250
                end if
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon LC9_SiegeCatapult[11] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[11]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[11] action queue
                elsif GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE at {LC9_SiegeCatapult[11]} radius 750
                    if GateHouse not exists
                        GateHouse = get HOUSE GATEHOUSE_F at {LC9_SiegeCatapult[11]} radius 750
                    end if
                    clear siege weapon LC9_SiegeCatapult[11] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[11]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[11] action queue
                else
                    GateHouse = get random abode of type GATEHOUSE in town PlayerTown
                    if GateHouse not exists
                        GateHouse = get random abode of type GATEHOUSE_F in town PlayerTown
                    end if
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon LC9_SiegeCatapult[11] action queue
                        Target = marker at get target from {LC9_SiegeCatapult[11]} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[11] action queue
                    else
                        ActionTimer = create timer for 2 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {LC9_SiegeCatapult[11]} radius 750
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC9_SiegeCatapult[11] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[11]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC9_SiegeCatapult[11] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            else
                House = get building ALTAR in PlayerTown min built 0.75
                if House exists and PLAYER of House == 0 and LC9_SiegeCatapult[11] can navigate to object oTownCentre
                    clear siege weapon LC9_SiegeCatapult[11] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[11]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC9_SiegeCatapult[11] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            end if
        end if

        until LC9_SiegeCatapult[11] not exists
    end loop
    
    if SiegeAttacking == 1 and UnderAttack != 0
        UnderAttack = UnderAttack - 1
    end if

    if LC9_SiegeCatapult[11] not exists and SiegeStucked == 0
        //CatapultDestroyed = 1
    end if
    
end loop

end script LC9_SiegeCatapult11Actions

begin script LC9_SiegeCatapult12Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = create timer for 0 seconds
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 0
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC9_SiegeCatapult[12] exists
    LargeAttackCounter += 1
    wait until ALLOWED_TO_ATTACK == 1
    wait 2 seconds
    begin loop
        PlayerCreature = get distance from {LC9_SiegeCatapult[12]} to {oCreature}
        PlayerPlatoon1 = get platoon of player 0 nearest {LC9_SiegeCatapult[12]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC9_SiegeCatapult[12]} radius 150
        
        if PlayerCreature > 10 and PlayerPlatoon1 not exists and Catapult not exists
            if PlayerPlatoon1 not exists
                a = 1
            elsif PlayerCreature > 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                a = 1
            elsif Catapult not exists
                a = 1
            end if
        end if
        
        if PlayerCreature <= 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
            clear siege weapon LC9_SiegeCatapult[12] action queue
            a = 0
        elsif PlayerPlatoon1 exists and LC9_SiegeCatapult[12] can navigate to {PlayerPlatoon1}
            clear siege weapon LC9_SiegeCatapult[12] action queue
            a = 0
        elsif Catapult exists and LC9_SiegeCatapult[12] can navigate to {Catapult}
            clear siege weapon LC9_SiegeCatapult[12] action queue
            a = 0
        elsif PointOn != 4 and a == 1
            begin loop
                if LC9_SiegeCatapult[12] exists
                    if get SiegeOnPointTimer time remaining <= 0
                        SiegeWeaponPoint = marker at {LC9_SiegeCatapult[12]}
                        SiegeOnPointTimer = create timer for 40 seconds
                    elsif get SiegeOnPointTimer time remaining <= 5
                        if {LC9_SiegeCatapult[12]} near {SiegeWeaponPoint} radius 10
                            clear siege weapon LC9_SiegeCatapult[12] action queue
                            delete LC9_SiegeCatapult[12]
                            SiegeStucked = 1
                        end if
                    end if
                    if get CatapultMoveTimer1 time remaining <= 0
                        if get size of LC9_SiegeCatapult[12] action queue < 1

                            if PointOn == 0
                                if LC9_SiegeCatapult[12] can navigate to {SiegeRoute8[0]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute8[0]} to siege weapon LC9_SiegeCatapult[12] action queue
                                end if
                    
                            elsif PointOn == 1
                                if LC9_SiegeCatapult[12] can navigate to {SiegeRoute8[1]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute8[1]} to siege weapon LC9_SiegeCatapult[12] action queue
                                end if

                            elsif PointOn == 2
                                if LC9_SiegeCatapult[12] can navigate to {SiegeRoute8[2]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute8[2]} to siege weapon LC9_SiegeCatapult[12] action queue
                                end if

                            elsif PointOn == 3
                                if LC9_SiegeCatapult[12] can navigate to {SiegeRoute8[3]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute8[3]} to siege weapon LC9_SiegeCatapult[12] action queue
                                end if

                            CatapultMoveTimer1 = create timer for 10 seconds
                            
                            end if
                        end if
                    end if        

                    if {LC9_SiegeCatapult[12]} near {SiegeRoute8[0]} radius 15 and PointOn != 1 or 60 seconds
                        PointOn = 1
                    elsif {LC9_SiegeCatapult[12]} near {SiegeRoute8[1]} radius 15 and PointOn != 2 or 60 seconds
                        PointOn = 2
                    elsif {LC9_SiegeCatapult[12]} near {SiegeRoute8[2]} radius 15 and PointOn != 3 or 60 seconds
                        PointOn = 3
                    elsif {LC9_SiegeCatapult[12]} near {SiegeRoute8[3]} radius 15 and PointOn != 5 or 60 seconds
                        PointOn = 4
                    elsif not LC9_SiegeCatapult[12] can navigate to {SiegeRoute8[3]} and {LC9_SiegeCatapult[12]} near {SiegeRoute8[2]} radius 15 and PointOn != 4
                        PointOn = 4
                    end if
                end if
            until LC9_SiegeCatapult[12] not exists or PointOn == 4 or 180 seconds
            end loop
        end if
        
        until PointOn == 4 or LC9_SiegeCatapult[12] not exists or 180 seconds
    end loop

    wait 5 seconds

    enable siege weapon LC9_SiegeCatapult[12] auto attack

    begin loop
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 5
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get HOUSE GATEHOUSE at {LC9_SiegeCatapult[12]} radius 250
                if GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE_F at {LC9_SiegeCatapult[12]} radius 250
                end if
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon LC9_SiegeCatapult[12] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[12]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[12] action queue
                elsif GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE at {LC9_SiegeCatapult[12]} radius 750
                    if GateHouse not exists
                        GateHouse = get HOUSE GATEHOUSE_F at {LC9_SiegeCatapult[12]} radius 750
                    end if
                    clear siege weapon LC9_SiegeCatapult[12] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[12]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[12] action queue
                else
                    GateHouse = get random abode of type GATEHOUSE in town PlayerTown
                    if GateHouse not exists
                        GateHouse = get random abode of type GATEHOUSE_F in town PlayerTown
                    end if
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon LC9_SiegeCatapult[12] action queue
                        Target = marker at get target from {LC9_SiegeCatapult[12]} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[12] action queue
                    else
                        ActionTimer = create timer for 2 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {LC9_SiegeCatapult[12]} radius 750
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC9_SiegeCatapult[12] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[12]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC9_SiegeCatapult[12] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            else
                House = get building ALTAR in PlayerTown min built 0.75
                if House exists and PLAYER of House == 0 and LC9_SiegeCatapult[12] can navigate to object oTownCentre
                    clear siege weapon LC9_SiegeCatapult[12] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[12]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC9_SiegeCatapult[12] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            end if
        end if

        until LC9_SiegeCatapult[12] not exists
    end loop
    
    if SiegeAttacking == 1 and UnderAttack != 0
        UnderAttack = UnderAttack - 1
    end if

    if LC9_SiegeCatapult[12] not exists and SiegeStucked == 0
        //CatapultDestroyed = 1
    end if
    
end loop

end script LC9_SiegeCatapult12Actions

begin script LC9_SiegeCatapult13Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = create timer for 0 seconds
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 0
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC9_SiegeCatapult[13] exists
    LargeAttackCounter += 1
    wait until ALLOWED_TO_ATTACK == 1
    wait 2 seconds
    begin loop
        PlayerCreature = get distance from {LC9_SiegeCatapult[13]} to {oCreature}
        PlayerPlatoon1 = get platoon of player 0 nearest {LC9_SiegeCatapult[13]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC9_SiegeCatapult[13]} radius 150
        
        if PlayerCreature > 10 and PlayerPlatoon1 not exists and Catapult not exists
            if PlayerPlatoon1 not exists
                a = 1
            elsif PlayerCreature > 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                a = 1
            elsif Catapult not exists
                a = 1
            end if
        end if
        
        if PlayerCreature <= 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
            clear siege weapon LC9_SiegeCatapult[13] action queue
            a = 0
        elsif PlayerPlatoon1 exists and LC9_SiegeCatapult[13] can navigate to {PlayerPlatoon1}
            clear siege weapon LC9_SiegeCatapult[13] action queue
            a = 0
        elsif Catapult exists and LC9_SiegeCatapult[13] can navigate to {Catapult}
            clear siege weapon LC9_SiegeCatapult[13] action queue
            a = 0
        elsif PointOn != 4 and a == 1
            begin loop
                if LC9_SiegeCatapult[13] exists
                    if get SiegeOnPointTimer time remaining <= 0
                        SiegeWeaponPoint = marker at {LC9_SiegeCatapult[13]}
                        SiegeOnPointTimer = create timer for 40 seconds
                    elsif get SiegeOnPointTimer time remaining <= 5
                        if {LC9_SiegeCatapult[13]} near {SiegeWeaponPoint} radius 10
                            clear siege weapon LC9_SiegeCatapult[13] action queue
                            delete LC9_SiegeCatapult[13]
                            SiegeStucked = 1
                        end if
                    end if
                    if get CatapultMoveTimer1 time remaining <= 0
                        if get size of LC9_SiegeCatapult[13] action queue < 1

                            if PointOn == 0
                                if LC9_SiegeCatapult[13] can navigate to {SiegeRoute9[0]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute9[0]} to siege weapon LC9_SiegeCatapult[13] action queue
                                end if
                    
                            elsif PointOn == 1
                                if LC9_SiegeCatapult[13] can navigate to {SiegeRoute9[1]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute9[1]} to siege weapon LC9_SiegeCatapult[13] action queue
                                end if

                            elsif PointOn == 2
                                if LC9_SiegeCatapult[13] can navigate to {SiegeRoute9[2]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute9[2]} to siege weapon LC9_SiegeCatapult[13] action queue
                                end if

                            elsif PointOn == 3
                                if LC9_SiegeCatapult[13] can navigate to {SiegeRoute9[3]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute9[3]} to siege weapon LC9_SiegeCatapult[13] action queue
                                end if

                            CatapultMoveTimer1 = create timer for 10 seconds
                            
                            end if
                        end if
                    end if        

                    if {LC9_SiegeCatapult[13]} near {SiegeRoute9[0]} radius 15 and PointOn != 1 or 60 seconds
                        PointOn = 1
                    elsif {LC9_SiegeCatapult[13]} near {SiegeRoute9[1]} radius 15 and PointOn != 2 or 60 seconds
                        PointOn = 2
                    elsif {LC9_SiegeCatapult[13]} near {SiegeRoute9[2]} radius 15 and PointOn != 3 or 60 seconds
                        PointOn = 3
                    elsif {LC9_SiegeCatapult[13]} near {SiegeRoute9[3]} radius 15 and PointOn != 5 or 60 seconds
                        PointOn = 4
                    elsif not LC9_SiegeCatapult[13] can navigate to {SiegeRoute9[3]} and {LC9_SiegeCatapult[13]} near {SiegeRoute9[2]} radius 15 and PointOn != 4
                        PointOn = 4
                    end if
                end if
            until LC9_SiegeCatapult[13] not exists or PointOn == 4 or 180 seconds
            end loop
        end if
        
        until PointOn == 4 or LC9_SiegeCatapult[13] not exists or 180 seconds
    end loop

    wait 5 seconds

    enable siege weapon LC9_SiegeCatapult[13] auto attack

    begin loop
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 5
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get HOUSE GATEHOUSE at {LC9_SiegeCatapult[13]} radius 250
                if GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE_F at {LC9_SiegeCatapult[13]} radius 250
                end if
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon LC9_SiegeCatapult[13] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[13]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[13] action queue
                elsif GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE at {LC9_SiegeCatapult[13]} radius 750
                    if GateHouse not exists
                        GateHouse = get HOUSE GATEHOUSE_F at {LC9_SiegeCatapult[13]} radius 750
                    end if
                    clear siege weapon LC9_SiegeCatapult[13] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[13]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[13] action queue
                else
                    GateHouse = get random abode of type GATEHOUSE in town PlayerTown
                    if GateHouse not exists
                        GateHouse = get random abode of type GATEHOUSE_F in town PlayerTown
                    end if
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon LC9_SiegeCatapult[13] action queue
                        Target = marker at get target from {LC9_SiegeCatapult[13]} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[13] action queue
                    else
                        ActionTimer = create timer for 2 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {LC9_SiegeCatapult[13]} radius 750
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC9_SiegeCatapult[13] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[13]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC9_SiegeCatapult[13] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            else
                House = get building ALTAR in PlayerTown min built 0.75
                if House exists and PLAYER of House == 0 and LC9_SiegeCatapult[13] can navigate to object oTownCentre
                    clear siege weapon LC9_SiegeCatapult[13] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[13]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC9_SiegeCatapult[13] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            end if
        end if

        until LC9_SiegeCatapult[13] not exists
    end loop
    
    if SiegeAttacking == 1 and UnderAttack != 0
        UnderAttack = UnderAttack - 1
    end if

    if LC9_SiegeCatapult[13] not exists and SiegeStucked == 0
        //CatapultDestroyed = 1
    end if
    
end loop

end script LC9_SiegeCatapult13Actions

begin script LC9_Platoon41Actions//Lady Mohc

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    PlayerSettlement = 0
    
start

begin loop    

    if LC9_Platoon[41] not exists
        //PlatoonKilled = 1
        wait until LC9_Platoon[41] exists and ALLOWED_TO_ATTACK == 1
    end if
        
    PlayerCreature = get distance from {LC9_Platoon[41]} to {oCreature}
    if PlayerCreature <= 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC9_Platoon[41] can navigate to {oCreature}
        clear LC9_Platoon[41] action queue
        begin loop
            PlayerCreature = get distance from {LC9_Platoon[41]} to {oCreature}
            add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using oCreature to LC9_Platoon[41] action queue
            NumPat1 = get number of villagers in platoon LC9_Platoon[41]
            until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC9_Platoon[41] can navigate to {oCreature} or PlayerCreature > 200
        end loop
        clear LC9_Platoon[41] action queue
    end if
        
    PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[41]} radius 200
    Catapult = get siege weapon of player 0 nearest {LC9_Platoon[41]} radius 155
    if PlayerPlatoon1 exists and LC9_Platoon[41] can navigate to {PlayerPlatoon1}
        clear LC9_Platoon[41] action queue
        begin loop
            PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[41]} radius 200
            add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using PlayerPlatoon1 to LC9_Platoon[41] action queue
            NumPat1 = get number of villagers in platoon LC9_Platoon[41]
            HeTeste1 = get number of villagers in platoon PlayerPlatoon1
            until NumPat1 == 0 or HeTeste1 == 0 or not LC9_Platoon[41] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
        end loop
        clear LC9_Platoon[41] action queue
    elsif Catapult exists and LC9_Platoon[41] can navigate to {Catapult}
        clear LC9_Platoon[41] action queue
        a = 0
        begin loop
            Catapult = get siege weapon of player 0 nearest {LC9_Platoon[41]} radius 155
            add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using Catapult to LC9_Platoon[41] action queue
            NumPat1 = get number of villagers in platoon LC9_Platoon[41]
            PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[41]} radius 200
            if PlayerPlatoon1 exists and LC9_Platoon[41] can navigate to {PlayerPlatoon1}
                a = 1
            end if
            until NumPat1 == 0 or Catapult not exists or not LC9_Platoon[41] can navigate to {Catapult} or a == 1 or Catapult not exists
        end loop
        clear LC9_Platoon[41] action queue
        a = 0
    end if
        
    PlayerSettlement = get nearest town at {LC9_Platoon[41]} for player 0 radius 800
    //Not a Armory, it's a towncentre.
    Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
    if Armory exists and PLAYER of PlayerSettlement == 0
        if LC9_Platoon[41] can navigate to object Armory
            if TownCapturePlatoons[2] < 2
                TownCapturePlatoons[2]++
                clear LC9_Platoon[41] action queue
                set LC9_Platoon[41] attack PlayerSettlement with severity 0.3 for takeover
                a = 1
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[41]} radius 150
                    PlayerCreature = get distance from {LC9_Platoon[41]} to {oCreature}
                    if PlayerPlatoon1 exists
                        a = 0
                    elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                        a = 0
                    elsif not LC9_Platoon[41] can navigate to object Armory
                        a = 0
                    elsif LC9_Platoon[41] not exists
                        a = 0
                    end if
                    until a == 0 or LC9_Platoon[41] not exists or PLAYER of PlayerSettlement == 1
                end loop
                TownCapturePlatoons[2]--
                clear LC9_Platoon[41] action queue
            end if
        end if
    end if

    if get size of LC9_Platoon[41] action queue < 1
        move LC9_Platoon[41] along WaypointsC with patrol WAYPOINTROUTE_TRAVERSAL_TYPE_CIRCULAR
    end if
        
end loop

end script LC9_Platoon41Actions

begin script LC9_Platoon42Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC9_Platoon[42] exists
    begin loop

        PlayerCreature = get distance from {LC9_Platoon[42]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC9_Platoon[42] can navigate to {oCreature}
            clear LC9_Platoon[42] action queue
            begin loop
                PlayerCreature = get distance from {LC9_Platoon[42]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using oCreature to LC9_Platoon[42] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[42]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC9_Platoon[42] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC9_Platoon[42] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[42]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC9_Platoon[42]} radius 150
        if PlayerPlatoon1 exists and LC9_Platoon[42] can navigate to {PlayerPlatoon1}
            clear LC9_Platoon[42] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[42]} radius 150
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using PlayerPlatoon1 to LC9_Platoon[42] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[42]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC9_Platoon[42] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC9_Platoon[42] action queue
        elsif Catapult exists and LC9_Platoon[42] can navigate to {Catapult}
            clear LC9_Platoon[42] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC9_Platoon[42]} radius 150
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using Catapult to LC9_Platoon[42] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[42]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[42]} radius 150
                if PlayerPlatoon1 exists and LC9_Platoon[42] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC9_Platoon[42] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC9_Platoon[42] action queue
            a = 0
        end if
        
        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in NearestSettlement min built 1.0
        if not LC9_Platoon[42] can navigate to object oTownCentre and LC9_SiegeCatapult[14] exists
            add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {LC9_SiegeCatapult[14]} to LC9_Platoon[42] action queue
            wait 5 seconds
        end if

        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in NearestSettlement min built 1.0
        //if get size of LC9_Platoon[42] action queue < 1
            if LC9_Platoon[42] can navigate to object oTownCentre
                wait number from 5 to 25 seconds
                a = 1
                clear LC9_Platoon[42] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    if TownCapturePlatoons[1] < 2
                        TownCapturePlatoons[1]++
                        set LC9_Platoon[42] attack NearestSettlement with severity 0.2 for takeover
                    else
                        a = 0
                    end if
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[42] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[42] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[42] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[42] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[42] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[42] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[1] < 2
                        TownCapturePlatoons[1]++
                        set LC9_Platoon[42] attack NearestSettlement with severity 0.3 for takeover
                    else
                        a = 0
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[42]} radius 150
                    TestCreature2 = get distance from {LC9_Platoon[42]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC9_Platoon[42]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC9_Platoon[42] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town NearestSettlement is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town NearestSettlement is under takeover from player 1
                            a = 0
                        elsif not LC9_Platoon[42] can navigate to object oTownCentre
                            a = 0
                        elsif LC9_Platoon[42] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town NearestSettlement is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC9_Platoon[42] not exists
                end loop
                TownCapturePlatoons[1]--
                clear LC9_Platoon[42] action queue
            else
                clear LC9_Platoon[42] action queue
            end if
        //end if

        until LC9_Platoon[42] not exists
    end loop
    if LC9_Platoon[42] not exists
        //PlatoonKilled = 1
        wait until LC9_Platoon[42] exists
    end if
end loop

end script LC9_Platoon42Actions

begin script LC9_Platoon43Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC9_Platoon[43] exists
    begin loop

        PlayerCreature = get distance from {LC9_Platoon[43]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC9_Platoon[43] can navigate to {oCreature}
            clear LC9_Platoon[43] action queue
            begin loop
                PlayerCreature = get distance from {LC9_Platoon[43]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC9_Platoon[43] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[43]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC9_Platoon[43] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC9_Platoon[43] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[43]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC9_Platoon[43]} radius 150
        if PlayerPlatoon1 exists and LC9_Platoon[43] can navigate to {PlayerPlatoon1}
            clear LC9_Platoon[43] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[43]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC9_Platoon[43] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[43]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC9_Platoon[43] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC9_Platoon[43] action queue
        elsif Catapult exists and LC9_Platoon[43] can navigate to {Catapult}
            clear LC9_Platoon[43] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC9_Platoon[43]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC9_Platoon[43] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[43]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[43]} radius 150
                if PlayerPlatoon1 exists and LC9_Platoon[43] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC9_Platoon[43] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC9_Platoon[43] action queue
            a = 0
        end if
        
        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in NearestSettlement min built 1.0
        if not LC9_Platoon[43] can navigate to object oTownCentre and LC9_SiegeCatapult[15] exists
            add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {LC9_SiegeCatapult[15]} to LC9_Platoon[43] action queue
            wait 5 seconds
        end if

        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in NearestSettlement min built 1.0
        //if get size of LC9_Platoon[43] action queue < 1
            if LC9_Platoon[43] can navigate to object oTownCentre
                wait number from 5 to 25 seconds
                a = 1
                clear LC9_Platoon[43] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    if TownCapturePlatoons[1] < 2
                        TownCapturePlatoons[1]++
                        set LC9_Platoon[43] attack NearestSettlement with severity 0.2 for takeover
                    else
                        a = 0
                    end if
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[43] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[43] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[43] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[43] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[43] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[43] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[1] < 2
                        TownCapturePlatoons[1]++
                        set LC9_Platoon[43] attack NearestSettlement with severity 0.3 for takeover
                    else
                        a = 0
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[43]} radius 150
                    TestCreature2 = get distance from {LC9_Platoon[43]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC9_Platoon[43]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC9_Platoon[43] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town NearestSettlement is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town NearestSettlement is under takeover from player 1
                            a = 0
                        elsif not LC9_Platoon[43] can navigate to object oTownCentre
                            a = 0
                        elsif LC9_Platoon[43] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town NearestSettlement is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC9_Platoon[43] not exists
                end loop
                TownCapturePlatoons[1]--
                clear LC9_Platoon[43] action queue
            else
                clear LC9_Platoon[43] action queue
            end if
        //end if

        until LC9_Platoon[43] not exists
    end loop
    if LC9_Platoon[43] not exists
        //PlatoonKilled = 1
        wait until LC9_Platoon[43] exists
    end if
end loop

end script LC9_Platoon43Actions

begin script LC9_Platoon44Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC9_Platoon[44] exists
    begin loop

        PlayerCreature = get distance from {LC9_Platoon[44]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC9_Platoon[44] can navigate to {oCreature}
            clear LC9_Platoon[44] action queue
            begin loop
                PlayerCreature = get distance from {LC9_Platoon[44]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC9_Platoon[44] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[44]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC9_Platoon[44] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC9_Platoon[44] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[44]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC9_Platoon[44]} radius 150
        if PlayerPlatoon1 exists and LC9_Platoon[44] can navigate to {PlayerPlatoon1}
            clear LC9_Platoon[44] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[44]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC9_Platoon[44] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[44]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC9_Platoon[44] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC9_Platoon[44] action queue
        elsif Catapult exists and LC9_Platoon[44] can navigate to {Catapult}
            clear LC9_Platoon[44] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC9_Platoon[44]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC9_Platoon[44] action queue
                NumPat1 = get number of villagers in platoon LC9_Platoon[44]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[44]} radius 150
                if PlayerPlatoon1 exists and LC9_Platoon[44] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC9_Platoon[44] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC9_Platoon[44] action queue
            a = 0
        end if
        
        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in NearestSettlement min built 1.0
        if not LC9_Platoon[44] can navigate to object oTownCentre and LC9_SiegeCatapult[15] exists
            add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {LC9_SiegeCatapult[15]} + {20,0,20} to LC9_Platoon[44] action queue
            wait 5 seconds
        end if

        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in NearestSettlement min built 1.0
        //if get size of LC9_Platoon[44] action queue < 1
            if LC9_Platoon[44] can navigate to object oTownCentre
                wait number from 5 to 25 seconds
                a = 1
                clear LC9_Platoon[44] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    if TownCapturePlatoons[1] < 2
                        TownCapturePlatoons[1]++
                        set LC9_Platoon[44] attack NearestSettlement with severity 0.2 for takeover
                    else
                        a = 0
                    end if
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[44] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[44] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[44] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[44] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[44] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC9_Platoon[44] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[1] < 2
                        TownCapturePlatoons[1]++
                        set LC9_Platoon[44] attack NearestSettlement with severity 0.2 for takeover
                    else
                        a = 0
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC9_Platoon[44]} radius 150
                    TestCreature2 = get distance from {LC9_Platoon[44]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC9_Platoon[44]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC9_Platoon[44] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town NearestSettlement is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town NearestSettlement is under takeover from player 1
                            a = 0
                        elsif not LC9_Platoon[44] can navigate to object oTownCentre
                            a = 0
                        elsif LC9_Platoon[44] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town NearestSettlement is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC9_Platoon[44] not exists
                end loop
                TownCapturePlatoons[1]--
                clear LC9_Platoon[44] action queue
            else
                clear LC9_Platoon[44] action queue
            end if
        //end if

        until LC9_Platoon[44] not exists
    end loop
    if LC9_Platoon[44] not exists
        //PlatoonKilled = 1
        wait until LC9_Platoon[44] exists
    end if
end loop

end script LC9_Platoon44Actions

begin script LC9_SiegeCatapult14Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = 5
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 3
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC9_SiegeCatapult[14] exists
    wait 15 seconds

    clear siege weapon LC9_SiegeCatapult[14] action queue

    begin loop
        if get SiegeOnPointTimer time remaining <= 0
            SiegeWeaponPoint = marker at {LC9_SiegeCatapult[14]}
            SiegeOnPointTimer = create timer for 160 seconds
        elsif get SiegeOnPointTimer time remaining <= 5 and not {LC9_SiegeCatapult[14]} near {NearestSettlement} radius 400
            if {LC9_SiegeCatapult[14]} near {SiegeWeaponPoint} radius 10
                clear siege weapon LC9_SiegeCatapult[14] action queue
                delete LC9_SiegeCatapult[14]
                SiegeStucked = 1
            end if
        end if
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 7
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get random abode of type GATEHOUSE in town NearestSettlement
                if GateHouse not exists
                    GateHouse = get random abode of type GATEHOUSE_F in town NearestSettlement
                end if
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon LC9_SiegeCatapult[14] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[14]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[14] action queue
                else
                    GateHouse = get HOUSE GATEHOUSE at {LC9_SiegeCatapult[14]} radius 750
                    if GateHouse not exists
                        GateHouse = get HOUSE GATEHOUSE_F at {LC9_SiegeCatapult[14]} radius 750
                    end if
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon LC9_SiegeCatapult[14] action queue
                        Target = marker at get target from {LC9_SiegeCatapult[14]} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[14] action queue
                    else
                        ActionTimer = create timer for 2 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {NearestSettlement} radius 400
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC9_SiegeCatapult[14] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[14]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC9_SiegeCatapult[14] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            elsif NumPat1 == 4 or NumPat1 == 5
                House = get building ALTAR in NearestSettlement min built 0.75
                if House exists and PLAYER of House == 0 and LC9_SiegeCatapult[14] can navigate to object oTownCentre
                    clear siege weapon LC9_SiegeCatapult[14] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[14]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC9_SiegeCatapult[14] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            elsif NumPat1 == 6
                House = get building STORAGE_YARD in NearestSettlement min built 0.75
                if House exists and PLAYER of House == 0 and LC9_SiegeCatapult[14] can navigate to object oTownCentre
                    clear siege weapon LC9_SiegeCatapult[14] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[14]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC9_SiegeCatapult[14] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            else
                House = get building TEMPLE in NearestSettlement min built 0.75
                if House exists and PLAYER of House == 0 and LC9_SiegeCatapult[14] can navigate to object oTownCentre
                    clear siege weapon LC9_SiegeCatapult[14] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[14]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC9_SiegeCatapult[14] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            end if
        end if
        until LC9_SiegeCatapult[14] not exists
    end loop
    
end loop

end script LC9_SiegeCatapult14Actions

begin script LC9_SiegeCatapult15Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = 5
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 3
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC9_SiegeCatapult[15] exists
    wait 15 seconds

    clear siege weapon LC9_SiegeCatapult[15] action queue

    begin loop
        if get SiegeOnPointTimer time remaining <= 0
            SiegeWeaponPoint = marker at {LC9_SiegeCatapult[15]}
            SiegeOnPointTimer = create timer for 160 seconds
        elsif get SiegeOnPointTimer time remaining <= 5 and not {LC9_SiegeCatapult[15]} near {NearestSettlement} radius 400
            if {LC9_SiegeCatapult[15]} near {SiegeWeaponPoint} radius 10
                clear siege weapon LC9_SiegeCatapult[15] action queue
                delete LC9_SiegeCatapult[15]
                SiegeStucked = 1
            end if
        end if
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 7
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get random abode of type GATEHOUSE in town NearestSettlement
                if GateHouse not exists
                    GateHouse = get random abode of type GATEHOUSE_F in town NearestSettlement
                end if
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon LC9_SiegeCatapult[15] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[15]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[15] action queue
                else
                    GateHouse = get HOUSE GATEHOUSE at {LC9_SiegeCatapult[15]} radius 750
                    if GateHouse not exists
                        GateHouse = get HOUSE GATEHOUSE_F at {LC9_SiegeCatapult[15]} radius 750
                    end if
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon LC9_SiegeCatapult[15] action queue
                        Target = marker at get target from {LC9_SiegeCatapult[15]} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC9_SiegeCatapult[15] action queue
                    else
                        ActionTimer = create timer for 2 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {NearestSettlement} radius 400
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC9_SiegeCatapult[15] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[15]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC9_SiegeCatapult[15] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            elsif NumPat1 == 4 or NumPat1 == 5
                House = get building ALTAR in NearestSettlement min built 0.75
                if House exists and PLAYER of House == 0 and LC9_SiegeCatapult[15] can navigate to object oTownCentre
                    clear siege weapon LC9_SiegeCatapult[15] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[15]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC9_SiegeCatapult[15] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            elsif NumPat1 == 6
                House = get building STORAGE_YARD in NearestSettlement min built 0.75
                if House exists and PLAYER of House == 0 and LC9_SiegeCatapult[15] can navigate to object oTownCentre
                    clear siege weapon LC9_SiegeCatapult[15] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[15]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC9_SiegeCatapult[15] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            else
                House = get building TEMPLE in NearestSettlement min built 0.75
                if House exists and PLAYER of House == 0 and LC9_SiegeCatapult[15] can navigate to object oTownCentre
                    clear siege weapon LC9_SiegeCatapult[15] action queue
                    Target = marker at get target from {LC9_SiegeCatapult[15]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC9_SiegeCatapult[15] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            end if
        end if
        until LC9_SiegeCatapult[15] not exists
    end loop
    
end loop

end script LC9_SiegeCatapult15Actions