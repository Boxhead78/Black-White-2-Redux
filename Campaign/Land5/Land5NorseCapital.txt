///////////////////////////////////////////////////////////////////////////////
//    Land 5 Norse-Strategy
//    ~~~~~~~~~~~~~~~~~~~~~~~~~~~
//
///////////////////////////////////////////////////////////////////////////////

define script LC5_Norse_Capital_Impressiveness
define script LC5_TownConversion
define script LC5_Tribute
define script LC5_Speeches
define script LC5_GenericSpeeches(whichUnit,PlayerOfUnit)
define script LC5_GetPlayerUnits
define script LC5_Norse_Capital
define script LC5_GetNearestSettlement
define script LC5_ResourceManagerNorseCapital
define script LC5_VillagerManagerNorseCapital
define script LC5_ResourceManagerNorseTown1
define script LC5_VillagerManagerNorseTown1
define script LC5_ResourceManagerNorseTown2
define script LC5_VillagerManagerNorseTown2
define script LC5_ResourceManagerNorseTown3
define script LC5_VillagerManagerNorseTown3
define script LC5_NorseCommanderIntro
define script DisableLocalPlatoonResponse

begin script LC5_Norse_Capital_Impressiveness

    Threshold = 0

start

    Threshold = get town MinorTown1 impressiveness
    Threshold = Threshold / 3
    set migration threshold from MinorTown1 to PlayerTown MINOR_TOWN1_IMPRESSIVENESS - Threshold

    Threshold = get town MinorTown2 impressiveness
    Threshold = Threshold / 3
    set migration threshold from MinorTown2 to PlayerTown MINOR_TOWN2_IMPRESSIVENESS - Threshold

    Threshold = get town MinorTown3 impressiveness
    Threshold = Threshold / 3
    set migration threshold from MinorTown3 to PlayerTown MINOR_TOWN3_IMPRESSIVENESS - Threshold

    Threshold = get town MinorTown4 impressiveness
    Threshold = Threshold / 3
    set migration threshold from MinorTown4 to PlayerTown MINOR_TOWN4_IMPRESSIVENESS - Threshold

    Threshold = get town NorseTown1 impressiveness
    Threshold = Threshold / 3
    set migration threshold from NorseTown1 to PlayerTown NORSE_TOWN1_IMPRESSIVENESS - Threshold

    Threshold = get town NorseTown2 impressiveness
    Threshold = Threshold / 3
    set migration threshold from NorseTown2 to PlayerTown NORSE_TOWN2_IMPRESSIVENESS - Threshold

    Threshold = get town NorseTown3 impressiveness
    Threshold = Threshold / 3
    set migration threshold from NorseTown3 to PlayerTown NORSE_TOWN3_IMPRESSIVENESS - Threshold

    Threshold = get town NorseCapital impressiveness
    Threshold = Threshold / 3
    set migration threshold from NorseCapital to PlayerTown NORSE_CAPITAL_IMPRESSIVENESS - Threshold

end script LC5_Norse_Capital_Impressiveness

begin script LC5_TownConversion

    isConverted1 = 0
    isConverted2 = 0
    isConverted3 = 0
    isConverted4 = 0
    isConverted5 = 0
    isConverted6 = 0
    isConverted7 = 0
    isConverted8 = 0
    a = 0
    b = 0
    c = 0
    d = 0
    e = 0
    f = 0
    g = 0
    h = 0
    i = 0

start

disable migration from PlayerTown to MinorTown1
disable migration from PlayerTown to MinorTown2
disable migration from PlayerTown to MinorTown3
disable migration from PlayerTown to MinorTown4
disable migration from PlayerTown to NorseTown1
disable migration from PlayerTown to NorseTown2
disable migration from PlayerTown to NorseTown3
disable migration from PlayerTown to NorseCapital

begin loop

    isConverted1 = variable get town MinorTown1 method of last conversion
    isConverted2 = variable get town MinorTown2 method of last conversion
    isConverted3 = variable get town MinorTown3 method of last conversion
    isConverted4 = variable get town MinorTown4 method of last conversion
    isConverted5 = variable get town NorseTown1 method of last conversion
    isConverted6 = variable get town NorseTown2 method of last conversion
    isConverted7 = variable get town NorseTown3 method of last conversion
    isConverted8 = variable get town NorseCapital method of last conversion

    if isConverted1 != 0 and a == 0
        if variable get town MinorTown1 status == variable TOWN_STATUS_MIGRATION_STARTED or PLAYER of MinorTown1 == 0
            if PLAYER of get town MinorTown1 is migrating to == 0 or PLAYER of MinorTown1 == 0
                a = 1
                TownsConverted = TownsConverted + 1
                if isConverted1 == 1
                    TownsAggressiveConverted = TownsAggressiveConverted + 1
                elsif isConverted1 == 2
                    TownsPeacefulConverted = TownsPeacefulConverted + 1
                end if
            end if
        end if
    end if

    if isConverted1 == 1
        if PLAYER of NorseCapital == 1
            disable migration from MinorTown1 to MinorTown2
            disable migration from MinorTown1 to MinorTown3
            disable migration from MinorTown1 to MinorTown4
            disable migration from MinorTown1 to NorseTown1
            disable migration from MinorTown1 to NorseTown2
            disable migration from MinorTown1 to NorseTown3
            disable migration from MinorTown1 to NorseCapital
            disable migration from MinorTown1 to PlayerTown
        else
            enable migration from MinorTown1 to MinorTown2
            enable migration from MinorTown1 to MinorTown3
            enable migration from MinorTown1 to MinorTown4
            enable migration from MinorTown1 to NorseTown1
            enable migration from MinorTown1 to NorseTown2
            enable migration from MinorTown1 to NorseTown3
            enable migration from MinorTown1 to NorseCapital
            enable migration from MinorTown1 to PlayerTown
        end if
    else
        enable migration from MinorTown1 to MinorTown2
        enable migration from MinorTown1 to MinorTown3
        enable migration from MinorTown1 to MinorTown4
        enable migration from MinorTown1 to NorseTown1
        enable migration from MinorTown1 to NorseTown2
        enable migration from MinorTown1 to NorseTown3
        enable migration from MinorTown1 to NorseCapital
        enable migration from MinorTown1 to PlayerTown
    end if
    
    if isConverted2 != 0 and b == 0
        if variable get town MinorTown2 status == variable TOWN_STATUS_MIGRATION_STARTED or PLAYER of MinorTown2 == 0
            if PLAYER of get town MinorTown2 is migrating to == 0 or PLAYER of MinorTown2 == 0
                b = 1
                TownsConverted = TownsConverted + 1
                if isConverted2 == 1
                    TownsAggressiveConverted = TownsAggressiveConverted + 1
                elsif isConverted2 == 2
                    TownsPeacefulConverted = TownsPeacefulConverted + 1
                end if
            end if
        end if
    end if
    
    if isConverted2 == 1
        if PLAYER of NorseCapital == 1
            disable migration from MinorTown2 to MinorTown1
            disable migration from MinorTown2 to MinorTown3
            disable migration from MinorTown2 to MinorTown4
            disable migration from MinorTown2 to NorseTown1
            disable migration from MinorTown2 to NorseTown2
            disable migration from MinorTown2 to NorseTown3
            disable migration from MinorTown2 to NorseCapital
            disable migration from MinorTown2 to PlayerTown
        else
            enable migration from MinorTown2 to MinorTown1
            enable migration from MinorTown2 to MinorTown3
            enable migration from MinorTown2 to MinorTown4
            enable migration from MinorTown2 to NorseTown1
            enable migration from MinorTown2 to NorseTown2
            enable migration from MinorTown2 to NorseTown3
            enable migration from MinorTown2 to NorseCapital
            enable migration from MinorTown2 to PlayerTown
        end if
    else
        enable migration from MinorTown2 to MinorTown1
        enable migration from MinorTown2 to MinorTown3
        enable migration from MinorTown2 to MinorTown4
        enable migration from MinorTown2 to NorseTown1
        enable migration from MinorTown2 to NorseTown2
        enable migration from MinorTown2 to NorseTown3
        enable migration from MinorTown2 to NorseCapital
        enable migration from MinorTown2 to PlayerTown
    end if

    if isConverted3 != 0 and c == 0
        if variable get town MinorTown3 status == variable TOWN_STATUS_MIGRATION_STARTED or PLAYER of MinorTown3 == 0
            if PLAYER of get town MinorTown3 is migrating to == 0 or PLAYER of MinorTown3 == 0
                c = 1
                TownsConverted = TownsConverted + 1
                if isConverted3 == 1
                    TownsAggressiveConverted = TownsAggressiveConverted + 1
                elsif isConverted3 == 2
                    TownsPeacefulConverted = TownsPeacefulConverted + 1
                end if
            end if
        end if
    end if

    if isConverted3 == 1
        if PLAYER of NorseCapital == 1
            disable migration from MinorTown3 to MinorTown1
            disable migration from MinorTown3 to MinorTown2
            disable migration from MinorTown3 to MinorTown4
            disable migration from MinorTown3 to NorseTown1
            disable migration from MinorTown3 to NorseTown2
            disable migration from MinorTown3 to NorseTown3
            disable migration from MinorTown3 to NorseCapital
            disable migration from MinorTown3 to PlayerTown
        else
            enable migration from MinorTown3 to MinorTown1
            enable migration from MinorTown3 to MinorTown2
            enable migration from MinorTown3 to MinorTown4
            enable migration from MinorTown3 to NorseTown1
            enable migration from MinorTown3 to NorseTown2
            enable migration from MinorTown3 to NorseTown3
            enable migration from MinorTown3 to NorseCapital
            enable migration from MinorTown3 to PlayerTown
        end if
    else
        enable migration from MinorTown3 to MinorTown1
        enable migration from MinorTown3 to MinorTown2
        enable migration from MinorTown3 to MinorTown4
        enable migration from MinorTown3 to NorseTown1
        enable migration from MinorTown3 to NorseTown2
        enable migration from MinorTown3 to NorseTown3
        enable migration from MinorTown3 to NorseCapital
        enable migration from MinorTown3 to PlayerTown
    end if
    
    if isConverted4 != 0 and d == 0
        if variable get town MinorTown4 status == variable TOWN_STATUS_MIGRATION_STARTED or PLAYER of MinorTown4 == 0
            if PLAYER of get town MinorTown4 is migrating to == 0 or PLAYER of MinorTown4 == 0
                d = 1
                TownsConverted = TownsConverted + 1
                if isConverted4 == 1
                    TownsAggressiveConverted = TownsAggressiveConverted + 1
                elsif isConverted4 == 2
                    TownsPeacefulConverted = TownsPeacefulConverted + 1
                end if
            end if
        end if
    end if

    if isConverted4 == 1
        if PLAYER of NorseCapital == 1
            disable migration from MinorTown4 to MinorTown1
            disable migration from MinorTown4 to MinorTown2
            disable migration from MinorTown4 to MinorTown3
            disable migration from MinorTown4 to NorseTown1
            disable migration from MinorTown4 to NorseTown2
            disable migration from MinorTown4 to NorseTown3
            disable migration from MinorTown4 to NorseCapital
            disable migration from MinorTown4 to PlayerTown
        else
            enable migration from MinorTown4 to MinorTown1
            enable migration from MinorTown4 to MinorTown2
            enable migration from MinorTown4 to MinorTown3
            enable migration from MinorTown4 to NorseTown1
            enable migration from MinorTown4 to NorseTown2
            enable migration from MinorTown4 to NorseTown3
            enable migration from MinorTown4 to NorseCapital
            enable migration from MinorTown4 to PlayerTown
        end if
    else
        enable migration from MinorTown4 to MinorTown1
        enable migration from MinorTown4 to MinorTown2
        enable migration from MinorTown4 to MinorTown3
        enable migration from MinorTown4 to NorseTown1
        enable migration from MinorTown4 to NorseCapital
        enable migration from MinorTown4 to PlayerTown
    end if
    
    if isConverted5 != 0 and f == 0
        if variable get town NorseTown1 status == variable TOWN_STATUS_MIGRATION_STARTED or PLAYER of NorseTown1 == 0
            if PLAYER of get town NorseTown1 is migrating to == 0 or PLAYER of NorseTown1 == 0
                f = 1
                TownsConverted = TownsConverted + 1
                if isConverted5 == 1
                    TownsAggressiveConverted = TownsAggressiveConverted + 1
                elsif isConverted5 == 2
                    TownsPeacefulConverted = TownsPeacefulConverted + 1
                end if
            end if
        end if
    end if
    
    if isConverted5 == 1
        if PLAYER of NorseCapital == 1
            disable migration from NorseTown1 to MinorTown1
            disable migration from NorseTown1 to MinorTown2
            disable migration from NorseTown1 to MinorTown3
            disable migration from NorseTown1 to MinorTown4
            disable migration from NorseTown1 to NorseTown2
            disable migration from NorseTown1 to NorseTown3
            disable migration from NorseTown1 to NorseCapital
            disable migration from NorseTown1 to PlayerTown
        else
            enable migration from NorseTown1 to MinorTown1
            enable migration from NorseTown1 to MinorTown2
            enable migration from NorseTown1 to MinorTown3
            enable migration from NorseTown1 to MinorTown4
            enable migration from NorseTown1 to NorseTown2
            enable migration from NorseTown1 to NorseTown3
            enable migration from NorseTown1 to NorseCapital
            enable migration from NorseTown1 to PlayerTown
        end if
    else
        enable migration from NorseTown1 to MinorTown1
        enable migration from NorseTown1 to MinorTown2
        enable migration from NorseTown1 to MinorTown3
        enable migration from NorseTown1 to MinorTown4
        enable migration from NorseTown1 to NorseTown2
        enable migration from NorseTown1 to NorseTown3
        enable migration from NorseTown1 to NorseCapital
        enable migration from NorseTown1 to PlayerTown
    end if

    if isConverted6 != 0 and g == 0
        if variable get town NorseTown2 status == variable TOWN_STATUS_MIGRATION_STARTED or PLAYER of NorseTown2 == 0
            if PLAYER of get town NorseTown2 is migrating to == 0 or PLAYER of NorseTown2 == 0
                g = 1
                TownsConverted = TownsConverted + 1
                if isConverted6 == 1
                    TownsAggressiveConverted = TownsAggressiveConverted + 1
                elsif isConverted6 == 2
                    TownsPeacefulConverted = TownsPeacefulConverted + 1
                end if
            end if
        end if
    end if
    
    if isConverted6 == 1
        if PLAYER of NorseCapital == 1
            disable migration from NorseTown2 to MinorTown1
            disable migration from NorseTown2 to MinorTown2
            disable migration from NorseTown2 to MinorTown3
            disable migration from NorseTown2 to MinorTown4
            disable migration from NorseTown2 to NorseTown1
            disable migration from NorseTown2 to NorseTown3
            disable migration from NorseTown2 to NorseCapital
            disable migration from NorseTown2 to PlayerTown
        else
            enable migration from NorseTown2 to MinorTown1
            enable migration from NorseTown2 to MinorTown2
            enable migration from NorseTown2 to MinorTown3
            enable migration from NorseTown2 to MinorTown4
            enable migration from NorseTown2 to NorseTown1
            enable migration from NorseTown2 to NorseTown3
            enable migration from NorseTown2 to NorseCapital
            enable migration from NorseTown2 to PlayerTown
        end if
    else
        enable migration from NorseTown2 to MinorTown1
        enable migration from NorseTown2 to MinorTown2
        enable migration from NorseTown2 to MinorTown3
        enable migration from NorseTown2 to MinorTown4
        enable migration from NorseTown2 to NorseTown1
        enable migration from NorseTown2 to NorseTown3
        enable migration from NorseTown2 to NorseCapital
        enable migration from NorseTown2 to PlayerTown
    end if

    if isConverted7 != 0 and h == 0
        if variable get town NorseTown3 status == variable TOWN_STATUS_MIGRATION_STARTED or PLAYER of NorseTown3 == 0
            if PLAYER of get town NorseTown3 is migrating to == 0 or PLAYER of NorseTown3 == 0
                h = 1
                TownsConverted = TownsConverted + 1
                if isConverted7 == 1
                    TownsAggressiveConverted = TownsAggressiveConverted + 1
                elsif isConverted7 == 2
                    TownsPeacefulConverted = TownsPeacefulConverted + 1 
                end if
            end if
        end if
    end if
    
    if isConverted7 == 1
        if PLAYER of NorseCapital == 1
            disable migration from NorseTown3 to MinorTown1
            disable migration from NorseTown3 to MinorTown2
            disable migration from NorseTown3 to MinorTown3
            disable migration from NorseTown3 to MinorTown4
            disable migration from NorseTown3 to NorseTown1
            disable migration from NorseTown3 to NorseTown2
            disable migration from NorseTown3 to NorseCapital
            disable migration from NorseTown3 to PlayerTown
        else
            enable migration from NorseTown3 to MinorTown1
            enable migration from NorseTown3 to MinorTown2
            enable migration from NorseTown3 to MinorTown3
            enable migration from NorseTown3 to MinorTown4
            enable migration from NorseTown3 to NorseTown1
            enable migration from NorseTown3 to NorseTown2
            enable migration from NorseTown3 to NorseCapital
            enable migration from NorseTown3 to PlayerTown
        end if
    else
        enable migration from NorseTown3 to MinorTown1
        enable migration from NorseTown3 to MinorTown2
        enable migration from NorseTown3 to MinorTown3
        enable migration from NorseTown3 to MinorTown4
        enable migration from NorseTown3 to NorseTown1
        enable migration from NorseTown3 to NorseTown2
        enable migration from NorseTown3 to NorseCapital
        enable migration from NorseTown3 to PlayerTown
    end if

    if isConverted8 != 0 and i == 0
        if variable get town NorseCapital status == variable TOWN_STATUS_MIGRATION_STARTED or PLAYER of NorseCapital == 0
            if PLAYER of get town NorseCapital is migrating to == 0 or PLAYER of NorseCapital == 0
                i = 1
                TownsConverted = TownsConverted + 1
                if isConverted8 == 1
                    TownsAggressiveConverted = TownsAggressiveConverted + 1
                elsif isConverted8 == 2
                    TownsPeacefulConverted = TownsPeacefulConverted + 1
                end if
            end if
        end if
    end if

    //Always enable migration from NorseCapital on this land
    enable migration from NorseCapital to MinorTown1
    enable migration from NorseCapital to MinorTown2
    enable migration from NorseCapital to MinorTown3
    enable migration from NorseCapital to MinorTown4
    enable migration from NorseCapital to NorseTown1
    enable migration from NorseCapital to NorseTown2
    enable migration from NorseCapital to NorseTown3
    enable migration from NorseCapital to PlayerTown 

end loop

end script LC5_TownConversion

begin script LC5_Tribute

    mig1 = 0
    mig2 = 0
    mig3 = 0
    mig4 = 0
    mig5 = 0
    mig6 = 0
    mig7 = 0
    mig8 = 0
    a = 0

start

begin loop

    if (variable get town MinorTown1 status == variable MIGRATION_MIGRATED) and mig1 == 0
        mig1 = 1
        MigrationsAccepted = MigrationsAccepted + 1
    end if
    
    if (variable get town MinorTown2 status == variable MIGRATION_MIGRATED) and mig2 == 0
        mig2 = 1
        MigrationsAccepted = MigrationsAccepted + 1
    end if
    
    if (variable get town MinorTown3 status == variable MIGRATION_MIGRATED) and mig3 == 0
        mig3 = 1
        MigrationsAccepted = MigrationsAccepted + 1
    end if
    
    if (variable get town MinorTown4 status == variable MIGRATION_MIGRATED) and mig4 == 0
        mig4 = 1
        MigrationsAccepted = MigrationsAccepted + 1
    end if
    
    if (variable get town NorseTown1 status == variable MIGRATION_MIGRATED) and mig5 == 0
        mig5 = 1
        MigrationsAccepted = MigrationsAccepted + 1
    end if
    
    if (variable get town NorseTown2 status == variable MIGRATION_MIGRATED) and mig6 == 0
        mig6 = 1
        MigrationsAccepted = MigrationsAccepted + 1
    end if
    
    if (variable get town NorseTown3 status == variable MIGRATION_MIGRATED) and mig7 == 0
        mig7 = 1
        MigrationsAccepted = MigrationsAccepted + 1
    end if

    if (variable get town NorseCapital status == variable MIGRATION_MIGRATED) and mig8 == 0
        mig8 = 1
        MigrationsAccepted = MigrationsAccepted + 1
    end if

    if MigrationsAccepted >= 1 and a == 0
        a = 1
        increment tribute by 2500
    end if
    
    if MigrationsAccepted >= 2 and a == 1
        a = 2
        increment tribute by 2500
    end if
    
    if MigrationsAccepted >= 3 and a == 2
        a = 3
        increment tribute by 2500
    end if
    
    if MigrationsAccepted >= 4 and a == 3
        a = 4
        increment tribute by 5000
    end if
    
    if MigrationsAccepted >= 5 and a == 4
        a = 5
        increment tribute by 5000
    end if
    
    if MigrationsAccepted >= 6 and a == 5
        a = 6
        increment tribute by 7500
    end if
    
    if MigrationsAccepted >= 7 and a == 6
        a = 7
        increment tribute by 7500
    end if
    
    if MigrationsAccepted >= 8 and a == 7
        a = 8
        increment tribute by 10000
    end if

end loop
    
end script LC5_Tribute

begin script LC5_Speeches
    
    LoseDialogue1 = 0
    
    Number = 0
    
    AttackTimer = create timer for 0 seconds
    LoseTimer = create timer for 0 seconds
    
    PlayerPlatoon = 0
    
    a = 0
    b = 0
    c = 0
    d = 0
    e = 0
    f = 0
    g = 0
    astory = 0
    bstory = 0
    
    aa = 0

    ab = 0
    ac = 0
    ad = 0
    ae = 0
    af = 0
    ag = 0
    ah = 0
    ai = 0
    aj = 0
    ak = 0
    
    Dialogue1said = 0
    Dialogue2said = 0
    Dialogue3said = 0
    Dialogue2 = 0
    TownDialogue = 1
    
    StoryDialogue = 0
    StoryDialogueTimer = create timer for 400 seconds

    StartDialogueSaid = 0
    ObjectiveCommentSaid = 0
    ArmyCommentSaid = 0
    Army100CommentSaid = 0
    Army200CommentSaid = 0
    PlayerPlatoonWithinNorseWallsSaid = 0
    PlayerPlatoonAttackingNorseTCSaid = 0
    PlatoonDummy = 0

    PlatoonKilledTimer = create timer for 0 seconds

    NumberPlatoon = 0

start

begin loop

    if (PLAYER of PlayerTown != 0 and PLAYER of MinorTown1 != 0 and PLAYER of MinorTown2 != 0 and PLAYER of MinorTown3 != 0 and PLAYER of MinorTown4 != 0 and PLAYER of NorseTown1 != 0 and PLAYER of NorseTown2 != 0 and PLAYER of NorseTown3 != 0 and PLAYER of NorseCapital != 0) and get LoseTimer time remaining <= 0 and GB_DialogueIsRunning == 0
        GB_DialogueIsRunning = 1
        LoseDialogue1 = number from 1 to 5
        wait until dialogue ready
        if LoseDialogue1 == 1
            begin dialogue
                make good spirit appear
                say "BW2T_SCRIPT_GENERIC_ADVISORS_SUGGEST_RESTART_10"
                wait until read
                send good spirit home
            end dialogue
        end if
        
        if LoseDialogue1 == 2
            begin dialogue
                make evil spirit appear
                say "BW2T_SCRIPT_GENERIC_ADVISORS_SUGGEST_RESTART_20"
                wait until read
                send evil spirit home
            end dialogue
        end if
        
        if LoseDialogue1 == 3
            begin dialogue
                make good spirit appear
                say "BW2T_SCRIPT_GENERIC_ADVISORS_SUGGEST_RESTART_30"
                wait until read
                send good spirit home
            end dialogue
        end if
        
        if LoseDialogue1 == 4
            begin dialogue
                make evil spirit appear
                say "BW2T_SCRIPT_GENERIC_ADVISORS_SUGGEST_RESTART_40"
                wait until read
                send evil spirit home
            end dialogue
        end if
        
        if LoseDialogue1 == 5
            begin dialogue
                make evil spirit appear
                say "BW2T_SCRIPT_GENERIC_ADVISORS_SUGGEST_RESTART_50"
                wait until read
                send evil spirit home
            end dialogue
        end if
        
        GB_DialogueIsRunning = 0
        LoseTimer = create timer for 75 seconds
    end if
    
    if StartDialogueSaid == 0
        GB_DialogueIsRunning = 1
        StartDialogueSaid = 1
        wait until dialogue ready
        wait 2 seconds
        begin dialogue
            make good spirit appear
            make evil spirit appear
            say "BW2T_SCRIPT_04FINAL_ADVISORS_INTRO_10"
            wait until read
            say "BW2T_SCRIPT_04FINAL_ADVISORS_INTRO_20"
            wait until read
            say "BW2T_SCRIPT_04FINAL_ADVISORS_INTRO_12"
            wait until read
            say "BW2T_SCRIPT_04FINAL_ADVISORS_INTRO_14"
            wait until read
            make good spirit disappear
            make evil spirit disappear
        end dialogue
        GB_DialogueIsRunning = 0
    end if

    if NorseCommanderArrived == 1
        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 0 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 1
            wait until dialogue ready
            begin dialogue
                say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_20"
                wait until read
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 400 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 1 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 2
            wait until dialogue ready
            begin dialogue
                say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_40"
                wait until read
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 400 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 2 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 3
            wait until dialogue ready
            begin dialogue
                say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_50"
                wait until read
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 400 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 3 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 4
            wait until dialogue ready
            begin dialogue
                say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_90"
                wait until read
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 400 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 4 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 5
            wait until dialogue ready
            begin dialogue
                say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_110"
                wait until read
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 400 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 5 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 6
            wait until dialogue ready
            begin dialogue
                say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_140"
                wait until read
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 400 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 6 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 7
            wait until dialogue ready
            begin dialogue
                say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_150"
                wait until read
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 400 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 7 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 8
            wait until dialogue ready
            begin dialogue
                say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_210"
                wait until read
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 400 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 8 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 9
            wait until dialogue ready
            begin dialogue
                say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_290"
                wait until read
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 400 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 9 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 10
            wait until dialogue ready
            begin dialogue
                say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_280"
                wait until read
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 400 seconds
        end if

        if get StoryDialogueTimer time remaining <= 0 and StoryDialogue == 10 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            StoryDialogue = 0
            wait until dialogue ready
            begin dialogue
                say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_270"
                wait until read
            end dialogue
            GB_DialogueIsRunning = 0
            StoryDialogueTimer = create timer for 400 seconds
        end if

        if PlayerPlatoonWithinNorseWallsSaid == 0
            PlatoonDummy = get platoon of player 0 nearest {NorseCapital} radius 400
            if PlatoonDummy exists
                PlayerPlatoonWithinNorseWallsSaid = 1
                wait until dialogue ready
                begin dialogue
                    eject evil spirit
                    //EA: Here we go, here we go, here we go!
                    say "BW2T_SCRIPT_04FINAL_PLAYTHROUGH30_60"
                    wait until read
                    //EA "Yeah! This is it! Attack!"
                    say "BW2T_SCRIPT_03FINAL_PLAYTHROUGH29_280"
                    wait until read
                    send evil spirit home
                    //GEN: Their force is overwhelming.
                    say "BW2T_SCRIPT_04FINAL_PLAYTHROUGH30_70"
                    wait until read
                end dialogue
            end if
        end if

        if a == 0 PlayerPlatoon = get platoon of player 0 nearest {PlayerTown} radius 500 end if
        if PlayerPlatoon exists and a == 0 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            a = 1
            wait until dialogue ready
            begin dialogue
                say "BW2T_SCRIPT_04FINAL_ADVISORS_LAND_DONE_240"
                wait until read
            end dialogue
            GB_DialogueIsRunning = 0
        end if
        
        if (get building ABODE_NUMBER_MELEE_ARMOURY in PlayerTown min built 0.0 exists or get building ABODE_NUMBER_RANGED_ARMOURY in PlayerTown min built 0.0 exists) and aa == 0 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            aa = 1
            wait until dialogue ready
            if NorseCommanderArrived == 1
                begin dialogue
                    say "BW2T_SCRIPT_04FINAL_ADVISORS_LAND_DONE_220"
                    wait until read
                end dialogue
            end if
            GB_DialogueIsRunning = 0
        end if

        if PLAYER of NorseCapital == 1 and Dialogue2said == 0 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            Dialogue2said = 1
            wait until dialogue ready
            begin dialogue
                say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_50"
                wait until read
            end dialogue
            GB_DialogueIsRunning = 0
        end if

        /*
        if get CreatureMockTimer time remaining <= 0 and Dialogue3said == 0 and GB_DialogueIsRunning == 0
            GB_DialogueIsRunning = 1
            Dialogue3said = 1
            wait until dialogue ready
            begin dialogue
                say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_40"
                wait until read
            end dialogue
            GB_DialogueIsRunning = 0
        end if
        */

        if TownsConverted >= 3 and GB_DialogueIsRunning == 0 and bstory == 0
            GB_DialogueIsRunning = 1
            bstory = 1
            wait until dialogue ready
            begin dialogue
                say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_GREEKS_TAKE_TOWNS_30"
                wait until read
            end dialogue
            GB_DialogueIsRunning = 0
        end if

        if TownsConverted >= 5 and GB_DialogueIsRunning == 0 and bstory == 1
            GB_DialogueIsRunning = 1
            bstory = 2
            wait until dialogue ready
            begin dialogue
                say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_GREEKS_TAKE_TOWNS_40"
                wait until read
            end dialogue
            GB_DialogueIsRunning = 0
        end if

        if TownsConverted >= 7 and GB_DialogueIsRunning == 0 and bstory == 2
            GB_DialogueIsRunning = 1
            bstory = 3
            wait until dialogue ready
            begin dialogue
                say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_GREEKS_TAKE_TOWNS_50"
                wait until read
            end dialogue
            GB_DialogueIsRunning = 0
        end if
    end if

    if FirstArmyCreated == 1 and Dialogue1said == 0 and GB_DialogueIsRunning == 0
        GB_DialogueIsRunning = 1
        Dialogue1said = 1
        wait until dialogue ready
        if NorseCommanderArrived == 1
            begin dialogue
                say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_GREEK_ARMIES_150"
                wait until read
            end dialogue
        end if
        GB_DialogueIsRunning = 0
    end if

    if get number of type HOUSE ABODE_NUMBER_A in NorseCapital min built 1.0 > 3 and ac == 0 and GB_DialogueIsRunning == 0
        GB_DialogueIsRunning = 1
        ac = 1
        wait until dialogue ready
        if NorseCommanderArrived == 1
            begin dialogue
                say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_BUILD_ABODE_01"
                wait until read
            end dialogue
        end if
        GB_DialogueIsRunning = 0
    end if
    
    /*
    if get number of type HOUSE ABODE_NUMBER_A in NorseCapital min built 1.0 > 6 and ad == 0 and GB_DialogueIsRunning == 0
        GB_DialogueIsRunning = 1
        ad = 1
        wait until dialogue ready
        if NorseCommanderArrived == 1
            begin dialogue
                say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_BUILD_ABODE_02"
                wait until read
            end dialogue
        end if
        GB_DialogueIsRunning = 0
    end if

    if get number of type HOUSE ABODE_NUMBER_B in NorseCapital min built 1.0 > 3 and ae == 0 and GB_DialogueIsRunning == 0
        GB_DialogueIsRunning = 1
        ae = 1
        wait until dialogue ready
        if NorseCommanderArrived == 1
            begin dialogue
                say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_BUILD_ABODE_04"
                wait until read
            end dialogue
        end if
        GB_DialogueIsRunning = 0
    end if

    if get number of type HOUSE ABODE_NUMBER_B in NorseCapital min built 1.0 > 6 and af == 0 and GB_DialogueIsRunning == 0
        GB_DialogueIsRunning = 1
        af = 1
        wait until dialogue ready
        if NorseCommanderArrived == 1
            begin dialogue
                say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_BUILD_ABODE_05"
                wait until read
            end dialogue
        end if
        GB_DialogueIsRunning = 0
    end if
    */

    if get building ABODE_NUMBER_MELEE_ARMOURY in NorseCapital min built 1.0 exists and ag == 0 and GB_DialogueIsRunning == 0
        GB_DialogueIsRunning = 1
        ag = 1
        wait until dialogue ready
        if NorseCommanderArrived == 1
            begin dialogue
                say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_BUILD_ARMOURY"
                wait until read
            end dialogue
        end if
        GB_DialogueIsRunning = 0
    end if

    if get building ABODE_NUMBER_LUMBERMILL in NorseCapital min built 1.0 exists and ah == 0 and GB_DialogueIsRunning == 0
        GB_DialogueIsRunning = 1
        ah = 1
        wait until dialogue ready
        if NorseCommanderArrived == 1
            begin dialogue
                say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_BUILD_LUMBERMILL"
                wait until read
            end dialogue
        end if
        GB_DialogueIsRunning = 0
    end if

    if get building ABODE_NUMBER_CRECHE in NorseCapital min built 1.0 exists and ai == 0 and GB_DialogueIsRunning == 0
        GB_DialogueIsRunning = 1
        ai = 1
        wait until dialogue ready
        if NorseCommanderArrived == 1
            begin dialogue
                say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_BUILD_NURSERY"
                wait until read
            end dialogue
        end if
        GB_DialogueIsRunning = 0
    end if

    if get building ABODE_NUMBER_PUB in NorseCapital min built 1.0 exists and aj == 0 and GB_DialogueIsRunning == 0
        GB_DialogueIsRunning = 1
        aj = 1
        wait until dialogue ready
        if NorseCommanderArrived == 1
            begin dialogue
                say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_BUILD_TAVERN"
                wait until read
            end dialogue
        end if
        GB_DialogueIsRunning = 0
    end if

    if get building ABODE_NUMBER_TEMPLE in NorseCapital min built 1.0 exists and ak == 0 and GB_DialogueIsRunning == 0
        GB_DialogueIsRunning = 1
        ak = 1
        wait until dialogue ready
        if NorseCommanderArrived == 1
            begin dialogue
                say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_BUILD_TEMPLE"
                wait until read
            end dialogue
        end if
        GB_DialogueIsRunning = 0
    end if

end loop

end script LC5_Speeches


begin script LC5_GenericSpeeches(whichUnit,PlayerOfUnit)

    Number = 0

start

begin loop
    wait number from 1 to 10 seconds
    until whichUnit not exists
end loop

//Unit Dead Comment
if get UnitDeadTimer time remaining <= 0 and GB_DialogueIsRunning == 0
    if PlayerOfUnit == 0
        GB_DialogueIsRunning = 1
        Number = number from 1 to 11
        wait until dialogue ready
        begin dialogue
            if NorseCommanderArrived == 1
                if Number == 1
                    say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_GREEKS_LOSE_BATTLES_10"
                    wait until read
                elsif Number == 2
                    say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_GREEKS_LOSE_BATTLES_20"
                    wait until read
                elsif Number == 3
                    say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_GREEKS_LOSE_BATTLES_30"
                    wait until read
                elsif Number == 4
                    say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_GREEKS_LOSE_BATTLES_40"
                    wait until read
                elsif Number == 5
                    say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_GREEKS_LOSE_BATTLES_50"
                    wait until read
                elsif Number == 6
                    say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_GREEKS_LOSE_BATTLES_60"
                    wait until read
                elsif Number == 7
                    say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_GREEKS_LOSE_BATTLES_70"
                    wait until read
                elsif Number == 8
                    say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_GREEKS_LOSE_BATTLES_80"
                    wait until read
                elsif Number == 9
                    say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_GREEKS_LOSE_BATTLES_90"
                    wait until read
                elsif Number == 10
                    say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_GREEKS_LOSE_BATTLES_100"
                    wait until read
                elsif Number == 11
                    say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_GREEKS_LOSE_BATTLES_110"
                    wait until read
                end if
            end if
        end dialogue
        GB_DialogueIsRunning = 0
    else
        GB_DialogueIsRunning = 1
        Number = number from 1 to 4
        wait until dialogue ready
        begin dialogue
            if NorseCommanderArrived == 1
                if Number == 1
                    say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_GREEKS_WIN_BATTLES_30"
                    wait until read
                elsif Number == 2
                    say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_GREEKS_WIN_BATTLES_40"
                    wait until read
                elsif Number == 3
                    say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_GREEKS_WIN_BATTLES_60"
                    wait until read
                elsif Number == 4
                    say "BW2T_SCRIPT_04FINAL_ADVISORS_NORSE_TAUNTS_GREEKS_WIN_BATTLES_90"
                    wait until read
                end if
            end if
        end dialogue
        GB_DialogueIsRunning = 0
    end if
    UnitDeadTimer = create timer for number from 15 to 45 seconds
end if

end script LC5_GenericSpeeches


begin script LC5_GetPlayerUnits

    MyPlatoon = 0

start

begin loop
    wait 2.5 seconds
    MyPlatoon = get platoon of player 0 nearest hand position radius 100 excluding scripted
    if MyPlatoon exists
        run background script LC5_GenericSpeeches(MyPlatoon,0)
    end if
end loop

end script LC5_GetPlayerUnits


begin script LC5_Norse_Capital

    RecruitTimer1 = 0
    RecruitTimer2 = 0
    RecruitTimer3 = 0
    RecruitTimer4 = 0
    WallCounter = 0
    NearestSettlementTownCentre = 0
    AttackingPlatoons = 0
    PlayerPlatoon = 0
    AttackingPosition = 0
    AttackingPositionFallBack = 0
    HardModeAttackTimer = create timer for 999999 seconds
    SiegeWaypoint1 = 0
    SiegeWaypoint2 = 0
    SiegeWaypoint3 = 0
    RecruitTimerGeneric[16]
    GenericTown = 0
    GenericTownCounter = 0
    GenericTownBuildingInitialTimer = create timer for 99999 * BuilderModifier seconds
    GenericTownBuildingTimer = create timer for 0 * BuilderModifier seconds
    GenericTownPlatoonTimer = create timer for 0 * RecruitModifier seconds
    AlignmentTownBuildingTimer1 = create timer for 99999 * BuilderModifier seconds
    AlignmentTownBuildingTimer2 = create timer for 99999 * BuilderModifier seconds
    AlignmentTownBuildingTimer3 = create timer for 99999 * BuilderModifier seconds
    AlignmentTownBuildingTimer4 = create timer for 99999 * BuilderModifier seconds
    AlignmentTownBuildingTimer5 = create timer for 99999 * BuilderModifier seconds
    AlignmentTownBuildingPhase = 0
    ConquerorTimer = create timer for 99999 * RecruitModifier seconds
    ConquerorResetTimer = create timer for 0 seconds
    AnotherPlatoon = 0
    Number = 0
    TimersActivated = 0
    NorseCommanderArrival = create timer for 2400 seconds//2400 seconds
    NorseCommanderIntroPlayed = 0
    TargetFound = 0
    FirstAttack1 = 0
    FirstAttack2 = 0
    BuildingDefendersAllowed[5]
    BuildingDefendersAllowedTimer = create timer for 0 seconds
    Counter = 0

start

    BuildingDefendersAllowed[0] = 1
    BuildingDefendersAllowed[1] = 1
    BuildingDefendersAllowed[2] = 1
    BuildingDefendersAllowed[3] = 1
    BuildingDefendersAllowed[4] = 1

    //extend town NorseCapital influence by 40

    add resource WOOD 2100 to MinorTown1
    add resource FOOD 750 to MinorTown1

    add resource WOOD 4000 to MinorTown4
    add resource FOOD 9000 to MinorTown4

    if PlayerAlignmentFinal < 0.0
        ConquerorTimer = create timer for 2400 * RecruitModifier seconds
    elsif PlayerAlignmentFinal >= 0.0
        ConquerorTimer = create timer for 4800 * RecruitModifier seconds
    end if

    //----Create P2 Platoons----//
    LC5_Platoon[0] = create platoon PLATOON_INFO_NORSE_MELEE_1 at {PlatoonPos[0]} with 12 * RecruitSizeModifier men and 0 women
    attach LC5_Platoon[0] to NorseTown1
    PLAYER of LC5_Platoon[0] = 2
    run background script LC5_StaticPlatoonsActions(PlatoonPos[0],Melee,LC5_Platoon[0],NorseTown1)
    run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[0],2)
    enable platoon LC5_Platoon[0] respond to town NorseTown1 attack
    set LC5_Platoon[0] focus to {PlatoonPos[0]}

    LC5_Platoon[1] = create platoon PLATOON_INFO_NORSE_MELEE_1 at {PlatoonPos[1]} with 12 * RecruitSizeModifier men and 0 women
    attach LC5_Platoon[1] to NorseTown1
    PLAYER of LC5_Platoon[1] = 2
    run background script LC5_StaticPlatoonsActions(PlatoonPos[1],Melee,LC5_Platoon[1],NorseTown1)
    run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[1],2)
    enable platoon LC5_Platoon[1] respond to town NorseTown1 attack
    set LC5_Platoon[1] focus to {PlatoonPos[1]}

    LC5_Platoon[2] = create platoon PLATOON_INFO_NORSE_MELEE_1 at {PlatoonPos[2]} with 12 * RecruitSizeModifier men and 0 women
    attach LC5_Platoon[2] to NorseTown1
    PLAYER of LC5_Platoon[2] = 2
    run background script LC5_StaticPlatoonsActions(PlatoonPos[2],Melee,LC5_Platoon[2],NorseTown1)
    run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[2],2)
    enable platoon LC5_Platoon[2] respond to town NorseTown1 attack
    set LC5_Platoon[2] focus to {PlatoonPos[2]}

    //----Create P3 Platoons----//
    LC5_Platoon[3] = create platoon PLATOON_INFO_NORSE_MELEE_1 at {PlatoonPos[3]} with 30 * RecruitSizeModifier men and 0 women
    attach LC5_Platoon[3] to NorseTown2
    PLAYER of LC5_Platoon[3] = 3
    run background script LC5_StaticPlatoonsActions(PlatoonPos[3],Melee,LC5_Platoon[3],NorseTown2)
    run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[3],3)
    enable platoon LC5_Platoon[3] respond to town NorseTown2 attack
    set LC5_Platoon[3] focus to {PlatoonPos[3]}

    LC5_Platoon[4] = create platoon PLATOON_INFO_NORSE_MELEE_1 at {PlatoonPos[4]} with 30 * RecruitSizeModifier men and 0 women
    attach LC5_Platoon[4] to NorseTown2
    PLAYER of LC5_Platoon[4] = 3
    run background script LC5_StaticPlatoonsActions(PlatoonPos[4],Melee,LC5_Platoon[4],NorseTown2)
    run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[4],3)
    enable platoon LC5_Platoon[4] respond to town NorseTown2 attack
    set LC5_Platoon[4] focus to {PlatoonPos[4]}

    //----Create P4 Platoons----//
    LC5_Platoon[5] = create platoon PLATOON_INFO_NORSE_MELEE_1 at {PlatoonPos[5]} with 50 * RecruitSizeModifier men and 0 women
    attach LC5_Platoon[5] to NorseTown3
    PLAYER of LC5_Platoon[5] = 4
    run background script LC5_StaticPlatoonsActions(PlatoonPos[5],Melee,LC5_Platoon[5],NorseTown3)
    run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[5],3)
    enable platoon LC5_Platoon[5] respond to town NorseTown3 attack
    set LC5_Platoon[5] focus to {PlatoonPos[5]}

    LC5_Platoon[6] = create platoon PLATOON_INFO_NORSE_MELEE_1 at {PlatoonPos[6]} with 50 * RecruitSizeModifier men and 0 women
    attach LC5_Platoon[6] to NorseTown3
    PLAYER of LC5_Platoon[6] = 4
    run background script LC5_StaticPlatoonsActions(PlatoonPos[6],Melee,LC5_Platoon[6],NorseTown3)
    run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[6],4)
    enable platoon LC5_Platoon[6] respond to town NorseTown3 attack
    set LC5_Platoon[6] focus to {PlatoonPos[6]}

    LC5_Platoon[7] = create platoon PLATOON_INFO_NORSE_MELEE_1 at {PlatoonPos[7]} with 50 * RecruitSizeModifier men and 0 women
    attach LC5_Platoon[7] to NorseTown3
    PLAYER of LC5_Platoon[7] = 4
    run background script LC5_StaticPlatoonsActions(PlatoonPos[7],Melee,LC5_Platoon[7],NorseTown3)
    run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[7],4)
    enable platoon LC5_Platoon[7] respond to town NorseTown3 attack
    set LC5_Platoon[7] focus to {PlatoonPos[7]}

    //RecruitTimers for different towns
    RecruitTimer1 = create timer for 60 seconds
    RecruitTimer2 = create timer for 60 seconds
    RecruitTimer3 = create timer for 60 seconds
    RecruitTimer4 = create timer for 60 seconds

    begin loop
        set player 1 alignment 0.0
        set player 2 alignment 0.0
        set player 3 alignment 0.0
        set player 4 alignment 0.0

        if get RecruitTimer1 time remaining <= 0
            if LC5_Platoon[8] not exists and PLAYER of NorseCapital == 1 and not town NorseCapital is under takeover from player 0 and not town NorseCapital is under takeover from player 2 and not town NorseCapital is under takeover from player 3 and not town NorseCapital is under takeover from player 4 and BuildingDefendersAllowed[0] == 1
                LC5_Platoon[8] = recruit ARMY_UNIT_TYPE_MELEE_1 town NorseCapital platoon of size 20 * RecruitSizeModifier
                RecruitTimer1 = create timer for (20 * 2.0) * NORSERECRUITMENTMODIFIER * RecruitModifier seconds
                enable platoon LC5_Platoon[8] respond to town NorseCapital attack
                run background script LC5_StaticPlatoonsActions(PlatoonPos[8],Melee,LC5_Platoon[8],NorseCapital)
                run background script LC5_GenericSpeeches(LC5_Platoon[8],1)
                run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[8],1)
                BuildingDefendersAllowed[0] = 0

            elsif LC5_Platoon[9] not exists and PLAYER of NorseCapital == 1 and not town NorseCapital is under takeover from player 0 and not town NorseCapital is under takeover from player 2 and not town NorseCapital is under takeover from player 3 and not town NorseCapital is under takeover from player 4 and BuildingDefendersAllowed[0] == 1
                LC5_Platoon[9] = recruit ARMY_UNIT_TYPE_MELEE_1 town NorseCapital platoon of size 20 * RecruitSizeModifier
                RecruitTimer1 = create timer for (20 * 2.0) * NORSERECRUITMENTMODIFIER * RecruitModifier seconds
                enable platoon LC5_Platoon[9] respond to town NorseCapital attack
                run background script LC5_StaticPlatoonsActions(PlatoonPos[9],Melee,LC5_Platoon[9],NorseCapital)
                run background script LC5_GenericSpeeches(LC5_Platoon[9],1)
                run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[9],1)
                BuildingDefendersAllowed[0] = 0

            elsif LC5_Platoon[10] not exists and PLAYER of NorseCapital == 1 and not town NorseCapital is under takeover from player 0 and not town NorseCapital is under takeover from player 2 and not town NorseCapital is under takeover from player 3 and not town NorseCapital is under takeover from player 4 and BuildingDefendersAllowed[0] == 1
                LC5_Platoon[10] = recruit ARMY_UNIT_TYPE_MELEE_1 town NorseCapital platoon of size 20 * RecruitSizeModifier
                RecruitTimer1 = create timer for (20 * 2.0) * NORSERECRUITMENTMODIFIER * RecruitModifier seconds
                enable platoon LC5_Platoon[10] respond to town NorseCapital attack
                run background script LC5_StaticPlatoonsActions(PlatoonPos[10],Melee,LC5_Platoon[10],NorseCapital)
                run background script LC5_GenericSpeeches(LC5_Platoon[10],1)
                run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[10],1)
                BuildingDefendersAllowed[0] = 0

            elsif LC5_Platoon[25] not exists and PLAYER of NorseCapital == 1 and not town NorseCapital is under takeover from player 0 and not town NorseCapital is under takeover from player 2 and not town NorseCapital is under takeover from player 3 and not town NorseCapital is under takeover from player 4 and BuildingDefendersAllowed[0] == 1
                LC5_Platoon[25] = recruit ARMY_UNIT_TYPE_MELEE_1 town NorseCapital platoon of size 35 * RecruitSizeModifier
                RecruitTimer1 = create timer for (35 * 2.0) * NORSERECRUITMENTMODIFIER * RecruitModifier seconds
                run background script PT_CreateHeavyNorsePlatoon(LC5_Platoon[25],1)
                disable platoon LC5_Platoon[25] respond to town NorseCapital attack
                wait until not LC5_Platoon[25] recruiting
                run background script LC5_ArmyBehaivours(LC5_Platoon[25],Melee,Patrol,0,0,Alerted,0,0,0,0,0,WaypointsA,0,0)
                FirstArmyCreated = 1
                BuildingDefendersAllowed[0] = 0
            //Attackers
            //Random Attacks Evil Alignment
            //Direct large attack #1
            elsif (RndAttack[0] == 1 or RndAttack[0] == 2) and PlayerAlignmentFinal < 0.0 and AttackersSent[0] == 0
                if LC5_Platoon[15] not exists and PLAYER of NorseCapital == 1 and not town NorseCapital is under takeover from player 0 and not town NorseCapital is under takeover from player 2 and not town NorseCapital is under takeover from player 3 and not town NorseCapital is under takeover from player 4
                    LC5_Platoon[15] = recruit ARMY_UNIT_TYPE_MELEE_1 town NorseCapital platoon of size 15 * RecruitSizeModifier
                    RecruitTimer1 = create timer for (15 * 2.0) * NORSERECRUITMENTMODIFIER * RecruitModifier seconds
                    AttackingPosition = marker at {AttackPos[0]} + {0,0}
                    AttackingPositionFallBack = marker at {AttackPos[1]} + {0,0}
                    if AttackingPlatoons == 0
                        run script PlatoonTargetingMetric(15 * RecruitSizeModifier,PlayerTown)
                        run background script LC5_ArmyBehaivours(LC5_Platoon[15],Melee,Attacker,0,PlatoonTargetingMetricFocusResult,Neutral,AttackingPosition,AttackingPositionFallBack,AttackPosFront[0],AttackPosFront[1],AttackPosFront[2],0,0,0)
                    elsif AttackingPlatoons == 1
                        run script PlatoonTargetingMetric(15 * RecruitSizeModifier,NearestSettlement)
                        run background script LC5_ArmyBehaivours(LC5_Platoon[15],Melee,Conqueror,0,PlatoonTargetingMetricFocusResult,Neutral,AttackingPosition,AttackingPositionFallBack,AttackPosFront[0],AttackPosFront[1],AttackPosFront[2],0,0,0)
                    end if
                    run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[15],1)
                    enable platoon LC5_Platoon[15] respond to town NorseCapital attack
                    BuildingDefendersAllowed[0] = 1

                elsif LC5_Platoon[16] not exists and PLAYER of NorseCapital == 1 and not town NorseCapital is under takeover from player 0 and not town NorseCapital is under takeover from player 2 and not town NorseCapital is under takeover from player 3 and not town NorseCapital is under takeover from player 4
                    LC5_Platoon[16] = recruit ARMY_UNIT_TYPE_MELEE_1 town NorseCapital platoon of size 15 * RecruitSizeModifier
                    RecruitTimer1 = create timer for (15 * 2.0) * NORSERECRUITMENTMODIFIER * RecruitModifier seconds
                    AttackingPosition = marker at {AttackPos[0]} + {30,30}
                    AttackingPositionFallBack = marker at {AttackPos[1]} + {30,30}
                    if AttackingPlatoons == 0
                        run script PlatoonTargetingMetric(15 * RecruitSizeModifier,PlayerTown)
                        run background script LC5_ArmyBehaivours(LC5_Platoon[16],Melee,Attacker,0,PlatoonTargetingMetricFocusResult,Neutral,AttackingPosition,AttackingPositionFallBack,AttackPosFront[0],AttackPosFront[1],AttackPosFront[2],0,0,0)
                    elsif AttackingPlatoons == 1
                        run script PlatoonTargetingMetric(15 * RecruitSizeModifier,NearestSettlement)
                        run background script LC5_ArmyBehaivours(LC5_Platoon[16],Melee,Conqueror,0,PlatoonTargetingMetricFocusResult,Neutral,AttackingPosition,AttackingPositionFallBack,AttackPosFront[0],AttackPosFront[1],AttackPosFront[2],0,0,0)
                    end if
                    run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[16],1)
                    enable platoon LC5_Platoon[16] respond to town NorseCapital attack
                    BuildingDefendersAllowed[0] = 1
                    
                end if
            //Backdoor small attack #2
            elsif (RndAttack[0] == 3 or RndAttack[0] == 4) and PlayerAlignmentFinal < 0.0 and AttackersSent[0] == 0
                if LC5_Platoon[17] not exists and PLAYER of NorseCapital == 1 and not town NorseCapital is under takeover from player 0 and not town NorseCapital is under takeover from player 2 and not town NorseCapital is under takeover from player 3 and not town NorseCapital is under takeover from player 4
                    LC5_Platoon[17] = recruit ARMY_UNIT_TYPE_MELEE_1 town NorseCapital platoon of size 20 * RecruitSizeModifier
                    RecruitTimer1 = create timer for (20 * 2.0) * NORSERECRUITMENTMODIFIER * RecruitModifier seconds
                    AttackingPosition = marker at {AttackPos[2]} + {0,0}
                    AttackingPositionFallBack = marker at {AttackPos[3]} + {0,0}
                    if AttackingPlatoons == 0
                        run script PlatoonTargetingMetric(20 * RecruitSizeModifier,PlayerTown)
                        run background script LC5_ArmyBehaivours(LC5_Platoon[17],Melee,Attacker,0,PlatoonTargetingMetricFocusResult,Neutral,AttackingPosition,AttackingPositionFallBack,AttackPosBack[0],AttackPosBack[1],AttackPosBack[2],0,0,0)
                    elsif AttackingPlatoons == 1
                        run script PlatoonTargetingMetric(20 * RecruitSizeModifier,NearestSettlement)
                        run background script LC5_ArmyBehaivours(LC5_Platoon[17],Melee,Conqueror,0,PlatoonTargetingMetricFocusResult,Neutral,AttackingPosition,AttackingPositionFallBack,AttackPosBack[0],AttackPosBack[1],AttackPosBack[2],0,0,0)
                    end if
                    run background script PT_CreateChargerNorsePlatoon(LC5_Platoon[17],1)
                    enable platoon LC5_Platoon[17] respond to town NorseCapital attack
                    BuildingDefendersAllowed[0] = 1

                end if
            //Backdoor small attack #3
            elsif (RndAttack[0] == 5) and PlayerAlignmentFinal < 0.0 and AttackersSent[0] == 0
                if LC5_Platoon[18] not exists and PLAYER of NorseCapital == 1 and not town NorseCapital is under takeover from player 0 and not town NorseCapital is under takeover from player 2 and not town NorseCapital is under takeover from player 3 and not town NorseCapital is under takeover from player 4
                    LC5_Platoon[18] = recruit ARMY_UNIT_TYPE_MELEE_1 town NorseCapital platoon of size 25 * RecruitSizeModifier
                    RecruitTimer1 = create timer for (25 * 2.0) * NORSERECRUITMENTMODIFIER * RecruitModifier seconds
                    AttackingPosition = marker at {AttackPos[2]} + {0,0}
                    AttackingPositionFallBack = marker at {AttackPos[3]} + {0,0}
                    if AttackingPlatoons == 0
                        run script PlatoonTargetingMetric(25 * RecruitSizeModifier,PlayerTown)
                        run background script LC5_ArmyBehaivours(LC5_Platoon[18],Melee,Attacker,0,PlatoonTargetingMetricFocusResult,Passive,AttackingPosition,AttackingPositionFallBack,AttackPosBack[0],AttackPosBack[1],AttackPosBack[2],0,0,0)
                    elsif AttackingPlatoons == 1
                        run script PlatoonTargetingMetric(25 * RecruitSizeModifier,NearestSettlement)
                        run background script LC5_ArmyBehaivours(LC5_Platoon[18],Melee,Conqueror,0,PlatoonTargetingMetricFocusResult,Passive,AttackingPosition,AttackingPositionFallBack,AttackPosBack[0],AttackPosBack[1],AttackPosBack[2],0,0,0)
                    end if
                    run background script PT_CreateChargerNorsePlatoon(LC5_Platoon[18],1)
                    enable platoon LC5_Platoon[18] respond to town NorseCapital attack
                    BuildingDefendersAllowed[0] = 1

                end if

            //Random Attacks Good Alignment
            //Direct large attack #1
            elsif (RndAttack[0] == 1 or RndAttack[0] == 2) and PlayerAlignmentFinal >= 0.0 and AttackersSent[0] == 0
                if LC5_Platoon[19] not exists and PLAYER of NorseCapital == 1 and not town NorseCapital is under takeover from player 0 and not town NorseCapital is under takeover from player 2 and not town NorseCapital is under takeover from player 3 and not town NorseCapital is under takeover from player 4
                    LC5_Platoon[19] = recruit ARMY_UNIT_TYPE_MELEE_1 town NorseCapital platoon of size 20 * RecruitSizeModifier
                    RecruitTimer1 = create timer for (20 * 2.0) * NORSERECRUITMENTMODIFIER * RecruitModifier seconds
                    AttackingPosition = marker at {AttackPos[0]} + {0,0}
                    AttackingPositionFallBack = marker at {AttackPos[1]} + {0,0}
                    if AttackingPlatoons == 0
                        run script PlatoonTargetingMetric(20 * RecruitSizeModifier,PlayerTown)
                        run background script LC5_ArmyBehaivours(LC5_Platoon[19],Melee,Attacker,0,PlatoonTargetingMetricFocusResult,Neutral,AttackingPosition,AttackingPositionFallBack,AttackPosFront[0],AttackPosFront[1],AttackPosFront[2],0,0,0)
                    elsif AttackingPlatoons == 1
                        run script PlatoonTargetingMetric(20 * RecruitSizeModifier,NearestSettlement)
                        run background script LC5_ArmyBehaivours(LC5_Platoon[19],Melee,Conqueror,0,PlatoonTargetingMetricFocusResult,Neutral,AttackingPosition,AttackingPositionFallBack,AttackPosFront[0],AttackPosFront[1],AttackPosFront[2],0,0,0)
                    end if
                    run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[19],1)
                    enable platoon LC5_Platoon[19] respond to town NorseCapital attack
                    BuildingDefendersAllowed[0] = 1

                elsif LC5_Platoon[20] not exists and PLAYER of NorseCapital == 1 and not town NorseCapital is under takeover from player 0 and not town NorseCapital is under takeover from player 2 and not town NorseCapital is under takeover from player 3 and not town NorseCapital is under takeover from player 4
                    LC5_Platoon[20] = recruit ARMY_UNIT_TYPE_MELEE_1 town NorseCapital platoon of size 20 * RecruitSizeModifier
                    RecruitTimer1 = create timer for (20 * 2.0) * NORSERECRUITMENTMODIFIER * RecruitModifier seconds
                    AttackingPosition = marker at {AttackPos[0]} + {-30,-30}
                    AttackingPositionFallBack = marker at {AttackPos[1]} + {-30,-30}
                    if AttackingPlatoons == 0
                        run script PlatoonTargetingMetric(20 * RecruitSizeModifier,PlayerTown)
                        run background script LC5_ArmyBehaivours(LC5_Platoon[20],Melee,Attacker,0,PlatoonTargetingMetricFocusResult,Neutral,AttackingPosition,AttackingPositionFallBack,AttackPosFront[0],AttackPosFront[1],AttackPosFront[2],0,0,0)
                    elsif AttackingPlatoons == 1
                        run script PlatoonTargetingMetric(20 * RecruitSizeModifier,NearestSettlement)
                        run background script LC5_ArmyBehaivours(LC5_Platoon[20],Melee,Conqueror,0,PlatoonTargetingMetricFocusResult,Neutral,AttackingPosition,AttackingPositionFallBack,AttackPosFront[0],AttackPosFront[1],AttackPosFront[2],0,0,0)
                    end if
                    run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[20],1)
                    enable platoon LC5_Platoon[20] respond to town NorseCapital attack
                    BuildingDefendersAllowed[0] = 1

                elsif LC5_Platoon[21] not exists and PLAYER of NorseCapital == 1 and not town NorseCapital is under takeover from player 0 and not town NorseCapital is under takeover from player 2 and not town NorseCapital is under takeover from player 3 and not town NorseCapital is under takeover from player 4
                    LC5_Platoon[21] = recruit ARMY_UNIT_TYPE_MELEE_1 town NorseCapital platoon of size 20 * RecruitSizeModifier
                    RecruitTimer1 = create timer for (20 * 2.0) * NORSERECRUITMENTMODIFIER * RecruitModifier seconds
                    AttackingPosition = marker at {AttackPos[0]} + {30,30}
                    AttackingPositionFallBack = marker at {AttackPos[1]} + {30,30}
                    if AttackingPlatoons == 0
                        run script PlatoonTargetingMetric(20 * RecruitSizeModifier,PlayerTown)
                        run background script LC5_ArmyBehaivours(LC5_Platoon[21],Melee,Attacker,0,PlatoonTargetingMetricFocusResult,Neutral,AttackingPosition,AttackingPositionFallBack,AttackPosFront[0],AttackPosFront[1],AttackPosFront[2],0,0,0)
                    elsif AttackingPlatoons == 1
                        run script PlatoonTargetingMetric(20 * RecruitSizeModifier,NearestSettlement)
                        run background script LC5_ArmyBehaivours(LC5_Platoon[21],Melee,Conqueror,0,PlatoonTargetingMetricFocusResult,Neutral,AttackingPosition,AttackingPositionFallBack,AttackPosFront[0],AttackPosFront[1],AttackPosFront[2],0,0,0)
                    end if
                    run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[21],1)
                    enable platoon LC5_Platoon[21] respond to town NorseCapital attack
                    BuildingDefendersAllowed[0] = 1

                end if
            //Direct large attack #2
            elsif (RndAttack[0] == 3 or RndAttack[0] == 4) and PlayerAlignmentFinal >= 0.0 and AttackersSent[0] == 0
                if LC5_Platoon[22] not exists and PLAYER of NorseCapital == 1 and not town NorseCapital is under takeover from player 0 and not town NorseCapital is under takeover from player 2 and not town NorseCapital is under takeover from player 3 and not town NorseCapital is under takeover from player 4
                    LC5_Platoon[22] = recruit ARMY_UNIT_TYPE_MELEE_1 town NorseCapital platoon of size 30 * RecruitSizeModifier
                    RecruitTimer1 = create timer for (30 * 2.0) * NORSERECRUITMENTMODIFIER * RecruitModifier seconds
                    AttackingPosition = marker at {AttackPos[0]} + {0,0}
                    AttackingPositionFallBack = marker at {AttackPos[1]} + {0,0}
                    if AttackingPlatoons == 0
                        run script PlatoonTargetingMetric(30 * RecruitSizeModifier,PlayerTown)
                        run background script LC5_ArmyBehaivours(LC5_Platoon[22],Melee,Attacker,0,PlatoonTargetingMetricFocusResult,Neutral,AttackingPosition,AttackingPositionFallBack,AttackPosFront[0],AttackPosFront[1],AttackPosFront[2],0,0,0)
                    elsif AttackingPlatoons == 1
                        run script PlatoonTargetingMetric(30 * RecruitSizeModifier,NearestSettlement)
                        run background script LC5_ArmyBehaivours(LC5_Platoon[22],Melee,Conqueror,0,PlatoonTargetingMetricFocusResult,Neutral,AttackingPosition,AttackingPositionFallBack,AttackPosFront[0],AttackPosFront[1],AttackPosFront[2],0,0,0)
                    end if
                    run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[22],1)
                    enable platoon LC5_Platoon[22] respond to town NorseCapital attack
                    BuildingDefendersAllowed[0] = 1

                elsif LC5_Platoon[23] not exists and PLAYER of NorseCapital == 1 and not town NorseCapital is under takeover from player 0 and not town NorseCapital is under takeover from player 2 and not town NorseCapital is under takeover from player 3 and not town NorseCapital is under takeover from player 4
                    LC5_Platoon[23] = recruit ARMY_UNIT_TYPE_MELEE_1 town NorseCapital platoon of size 30 * RecruitSizeModifier
                    RecruitTimer1 = create timer for (30 * 2.0) * NORSERECRUITMENTMODIFIER * RecruitModifier seconds
                    AttackingPosition = marker at {AttackPos[0]} + {30,30}
                    AttackingPositionFallBack = marker at {AttackPos[1]} + {30,30}
                    if AttackingPlatoons == 0
                        run script PlatoonTargetingMetric(30 * RecruitSizeModifier,PlayerTown)
                        run background script LC5_ArmyBehaivours(LC5_Platoon[23],Melee,Attacker,0,PlatoonTargetingMetricFocusResult,Neutral,AttackingPosition,AttackingPositionFallBack,AttackPosFront[0],AttackPosFront[1],AttackPosFront[2],0,0,0)
                    elsif AttackingPlatoons == 1
                        run script PlatoonTargetingMetric(30 * RecruitSizeModifier,NearestSettlement)
                        run background script LC5_ArmyBehaivours(LC5_Platoon[23],Melee,Conqueror,0,PlatoonTargetingMetricFocusResult,Neutral,AttackingPosition,AttackingPositionFallBack,AttackPosFront[0],AttackPosFront[1],AttackPosFront[2],0,0,0)
                    end if
                    run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[23],1)
                    enable platoon LC5_Platoon[23] respond to town NorseCapital attack
                    BuildingDefendersAllowed[0] = 1

                end if
            //Backdoor small attack #3
            elsif (RndAttack[0] == 5) and PlayerAlignmentFinal >= 0.0 and AttackersSent[0] == 0
                if LC5_Platoon[24] not exists and PLAYER of NorseCapital == 1 and not town NorseCapital is under takeover from player 0 and not town NorseCapital is under takeover from player 2 and not town NorseCapital is under takeover from player 3 and not town NorseCapital is under takeover from player 4
                    LC5_Platoon[24] = recruit ARMY_UNIT_TYPE_MELEE_1 town NorseCapital platoon of size 40 * RecruitSizeModifier
                    RecruitTimer1 = create timer for (40 * 2.0) * NORSERECRUITMENTMODIFIER * RecruitModifier seconds
                    AttackingPosition = marker at {AttackPos[2]} + {0,0}
                    AttackingPositionFallBack = marker at {AttackPos[3]} + {0,0}
                    if AttackingPlatoons == 0
                        run script PlatoonTargetingMetric(40 * RecruitSizeModifier,PlayerTown)
                        run background script LC5_ArmyBehaivours(LC5_Platoon[24],Melee,Attacker,0,PlatoonTargetingMetricFocusResult,Passive,AttackingPosition,AttackingPositionFallBack,AttackPosBack[0],AttackPosBack[1],AttackPosBack[2],0,0,0)
                    elsif AttackingPlatoons == 1
                        run script PlatoonTargetingMetric(40 * RecruitSizeModifier,NearestSettlement)
                        run background script LC5_ArmyBehaivours(LC5_Platoon[24],Melee,Conqueror,0,PlatoonTargetingMetricFocusResult,Passive,AttackingPosition,AttackingPositionFallBack,AttackPosBack[0],AttackPosBack[1],AttackPosBack[2],0,0,0)
                    end if
                    run background script PT_CreateChargerNorsePlatoon(LC5_Platoon[24],1)
                    enable platoon LC5_Platoon[24] respond to town NorseCapital attack
                    BuildingDefendersAllowed[0] = 1

                end if
            end if
        end if
        if get RecruitTimer2 time remaining <= 0
            if LC5_Platoon[0] not exists and PLAYER of NorseTown1 == 2 and not town NorseTown1 is under takeover from player 0 and not town NorseTown1 is under takeover from player 1 and not town NorseTown1 is under takeover from player 3 and not town NorseTown1 is under takeover from player 4
                LC5_Platoon[0] = recruit ARMY_UNIT_TYPE_MELEE_1 town NorseTown1 platoon of size 15 * RecruitSizeModifier
                RecruitTimer2 = create timer for (15 * 4) * NORSERECRUITMENTMODIFIER * RecruitModifier seconds
                enable platoon LC5_Platoon[0] respond to town NorseTown1 attack
                run background script LC5_StaticPlatoonsActions(PlatoonPos[0],Melee,LC5_Platoon[0],NorseTown1)
                run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[0],2)
            elsif LC5_Platoon[1] not exists and PLAYER of NorseTown1 == 2 and not town NorseTown1 is under takeover from player 0 and not town NorseTown1 is under takeover from player 1 and not town NorseTown1 is under takeover from player 3 and not town NorseTown1 is under takeover from player 4
                LC5_Platoon[1] = recruit ARMY_UNIT_TYPE_MELEE_1 town NorseTown1 platoon of size 15 * RecruitSizeModifier
                RecruitTimer2 = create timer for (15 * 4) * NORSERECRUITMENTMODIFIER * RecruitModifier seconds
                enable platoon LC5_Platoon[1] respond to town NorseTown1 attack
                run background script LC5_StaticPlatoonsActions(PlatoonPos[1],Melee,LC5_Platoon[1],NorseTown1)
                run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[1],2)
            elsif LC5_Platoon[2] not exists and PLAYER of NorseTown1 == 2 and not town NorseTown1 is under takeover from player 0 and not town NorseTown1 is under takeover from player 1 and not town NorseTown1 is under takeover from player 3 and not town NorseTown1 is under takeover from player 4
                LC5_Platoon[2] = recruit ARMY_UNIT_TYPE_MELEE_1 town NorseTown1 platoon of size 15 * RecruitSizeModifier
                RecruitTimer2 = create timer for (15 * 4) * NORSERECRUITMENTMODIFIER * RecruitModifier seconds
                enable platoon LC5_Platoon[2] respond to town NorseTown1 attack
                run background script LC5_StaticPlatoonsActions(PlatoonPos[2],Melee,LC5_Platoon[2],NorseTown1)
                run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[2],2)
            //Attacker
            elsif LC5_Platoon[13] not exists and PLAYER of NorseTown1 == 2 and NorseCommanderArrived == 1 and not town NorseTown1 is under takeover from player 0 and not town NorseTown1 is under takeover from player 1 and not town NorseTown1 is under takeover from player 3 and not town NorseTown1 is under takeover from player 4
                LC5_Platoon[13] = recruit ARMY_UNIT_TYPE_MELEE_1 town NorseTown1 platoon of size 10 * RecruitSizeModifier
                RecruitTimer2 = create timer for (10 * 10) * NORSERECRUITMENTMODIFIER * RecruitModifier seconds
                enable platoon LC5_Platoon[13] respond to town NorseTown1 attack
                run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[13],2)
                begin loop
                    Number = number from 1 to 3
                    if Number == 1 and LC5_Platoon[13] can navigate to object get building ABODE_NUMBER_TOWN_CENTRE in PlayerTown min built 1.0 and PLAYER of PlayerTown != 2 and FirstAttack1 == 1
                        TargetFound = 1
                        run background script LC5_AttackEnemyTown(LC5_Platoon[13],PlayerTown)
                    elsif Number == 2 and PLAYER of NorseTown2 != 2
                        FirstAttack1 = 1
                        TargetFound = 1
                        run background script LC5_AttackEnemyTown(LC5_Platoon[13],NorseTown2)
                    elsif PLAYER of NorseCapital != 2
                        FirstAttack1 = 1
                        TargetFound = 1
                        run background script LC5_AttackEnemyTown(LC5_Platoon[13],NorseCapital)
                    end if
                    until TargetFound == 1
                end loop
                TargetFound = 0
            end if
        end if
        if get RecruitTimer3 time remaining <= 0
            if LC5_Platoon[3] not exists and PLAYER of NorseTown2 == 3 and not town NorseTown2 is under takeover from player 0 and not town NorseTown2 is under takeover from player 1 and not town NorseTown2 is under takeover from player 2 and not town NorseTown2 is under takeover from player 4
                LC5_Platoon[3] = recruit ARMY_UNIT_TYPE_MELEE_1 town NorseTown2 platoon of size 20 * RecruitSizeModifier
                RecruitTimer3 = create timer for (20 * 4) * NORSERECRUITMENTMODIFIER * RecruitModifier seconds
                enable platoon LC5_Platoon[3] respond to town NorseTown2 attack
                run background script LC5_StaticPlatoonsActions(PlatoonPos[3],Melee,LC5_Platoon[3],NorseTown2)
                run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[3],3)
            elsif LC5_Platoon[4] not exists and PLAYER of NorseTown2 == 3 and not town NorseTown2 is under takeover from player 0 and not town NorseTown2 is under takeover from player 1 and not town NorseTown2 is under takeover from player 2 and not town NorseTown2 is under takeover from player 4
                LC5_Platoon[4] = recruit ARMY_UNIT_TYPE_MELEE_1 town NorseTown2 platoon of size 20 * RecruitSizeModifier
                RecruitTimer3 = create timer for (20 * 4) * NORSERECRUITMENTMODIFIER * RecruitModifier seconds
                enable platoon LC5_Platoon[4] respond to town NorseTown2 attack
                run background script LC5_StaticPlatoonsActions(PlatoonPos[4],Melee,LC5_Platoon[4],NorseTown2)
                run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[4],3)
            end if
        end if
        if get RecruitTimer4 time remaining <= 0
            if LC5_Platoon[5] not exists and PLAYER of NorseTown3 == 4 and not town NorseTown3 is under takeover from player 0 and not town NorseTown3 is under takeover from player 1 and not town NorseTown3 is under takeover from player 2 and not town NorseTown3 is under takeover from player 3
                LC5_Platoon[5] = recruit ARMY_UNIT_TYPE_MELEE_1 town NorseTown3 platoon of size 25 * RecruitSizeModifier
                RecruitTimer4 = create timer for (25 * 4) * NORSERECRUITMENTMODIFIER * RecruitModifier seconds
                enable platoon LC5_Platoon[5] respond to town NorseTown3 attack
                run background script LC5_StaticPlatoonsActions(PlatoonPos[5],Melee,LC5_Platoon[5],NorseTown3)
                run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[5],4)
            elsif LC5_Platoon[6] not exists and PLAYER of NorseTown3 == 4 and not town NorseTown3 is under takeover from player 0 and not town NorseTown3 is under takeover from player 1 and not town NorseTown3 is under takeover from player 2 and not town NorseTown3 is under takeover from player 3
                LC5_Platoon[6] = recruit ARMY_UNIT_TYPE_MELEE_1 town NorseTown3 platoon of size 25 * RecruitSizeModifier
                RecruitTimer4 = create timer for (25 * 4) * NORSERECRUITMENTMODIFIER * RecruitModifier seconds
                enable platoon LC5_Platoon[6] respond to town NorseTown3 attack
                run background script LC5_StaticPlatoonsActions(PlatoonPos[6],Melee,LC5_Platoon[6],NorseTown3)
                run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[6],4)
            elsif LC5_Platoon[7] not exists and PLAYER of NorseTown3 == 4 and not town NorseTown3 is under takeover from player 0 and not town NorseTown3 is under takeover from player 1 and not town NorseTown3 is under takeover from player 2 and not town NorseTown3 is under takeover from player 3
                LC5_Platoon[7] = recruit ARMY_UNIT_TYPE_MELEE_1 town NorseTown3 platoon of size 25 * RecruitSizeModifier
                RecruitTimer4 = create timer for (25 * 4) * NORSERECRUITMENTMODIFIER * RecruitModifier seconds
                enable platoon LC5_Platoon[7] respond to town NorseTown3 attack
                run background script LC5_StaticPlatoonsActions(PlatoonPos[7],Melee,LC5_Platoon[7],NorseTown3)
                run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[7],4)
            //Attacker
            elsif LC5_Platoon[14] not exists and PLAYER of NorseTown3 == 4 and NorseCommanderArrived == 1 and not town NorseTown3 is under takeover from player 0 and not town NorseTown3 is under takeover from player 1 and not town NorseTown3 is under takeover from player 2 and not town NorseTown3 is under takeover from player 3
                LC5_Platoon[14] = recruit ARMY_UNIT_TYPE_MELEE_1 town NorseTown3 platoon of size 30 * RecruitSizeModifier
                RecruitTimer4 = create timer for (30 * 10) * NORSERECRUITMENTMODIFIER * RecruitModifier seconds
                enable platoon LC5_Platoon[14] respond to town NorseTown3 attack
                run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[14],4)
                begin loop
                    Number = number from 1 to 3
                    if Number == 1 and LC5_Platoon[14] can navigate to object get building ABODE_NUMBER_TOWN_CENTRE in PlayerTown min built 1.0 and PLAYER of PlayerTown != 4 and FirstAttack2 == 1
                        TargetFound = 1
                        run background script LC5_AttackEnemyTown(LC5_Platoon[14],PlayerTown)
                    elsif Number == 2 and PLAYER of NorseTown2 != 4
                        FirstAttack2 = 1
                        TargetFound = 1
                        run background script LC5_AttackEnemyTown(LC5_Platoon[14],NorseTown2)
                    elsif PLAYER of NorseCapital != 4
                        FirstAttack2 = 1
                        TargetFound = 1
                        run background script LC5_AttackEnemyTown(LC5_Platoon[14],NorseCapital)
                    end if
                    until TargetFound == 1
                end loop
                TargetFound = 0
            end if
        end if

        //Generic Town production
        //Dynamically build a few armories and minimum needed buildings for all towns + platoon recruitment for minor towns
        if get GenericTownBuildingInitialTimer time remaining <= 0
            GenericTown = get town with id GenericTownCounter
            if GenericTown exists
                if PLAYER of GenericTown == 1
                    if PlayerAlignmentFinal < 0.0
                        //Buildings
                        if get GenericTownBuildingTimer time remaining <= 0 and size of GenericTown > 0
                            if get number of type HOUSE ABODE_NUMBER_STORAGE_PIT in GenericTown min built 0.0 < 1
                                run background script AGB_BuildBuilding(GenericTown,AGB_STORAGEPIT,AGB_NORSE)

                            elsif get number of type HOUSE ABODE_NUMBER_MELEE_ARMOURY in GenericTown min built 0.0 < 2
                                run background script AGB_BuildBuilding(GenericTown,AGB_ARMORYMELEE,AGB_NORSE)

                            elsif get number of type HOUSE ABODE_NUMBER_RANGED_ARMOURY in GenericTown min built 0.0 < 2
                                run background script AGB_BuildBuilding(GenericTown,AGB_ARMORYRANGED,AGB_NORSE)

                            elsif adult capacity of GenericTown < 100
                                run background script AGB_BuildBuilding(GenericTown,AGB_HOUSE,AGB_NORSE)

                            end if
                            GenericTownBuildingTimer = create timer for 75 * BuilderModifier seconds
                        end if

                        //Platoons
                        if GenericTown != NorseCapital and GenericTown != NorseTown1 and GenericTown != NorseTown2 and GenericTown != NorseTown3 and GenericTown != PlayerTown
                            if get GenericTownPlatoonTimer time remaining <= 0
                                if get army size in town GenericTown < 30 * RecruitModifier
                                    Number = number from 1 to 3
                                    if Number == 1 or Number == 2
                                        AnotherPlatoon = recruit ARMY_UNIT_TYPE_MELEE_1 town GenericTown platoon of size 20 * RecruitSizeModifier
                                        enable platoon AnotherPlatoon respond to town GenericTown attack
                                        run background script LC5_StaticPlatoonsActions(marker at {GenericTown} + {number from -50 to 50,number from -50 to 50},Melee,AnotherPlatoon,GenericTown)
                                        wait until not AnotherPlatoon recruiting
                                        run background script PT_CreateBasicNorsePlatoon(AnotherPlatoon,1)
                                    else
                                        AnotherPlatoon = recruit ARMY_UNIT_TYPE_RANGED_1 town GenericTown platoon of size 20 * RecruitSizeModifier
                                        enable platoon AnotherPlatoon respond to town GenericTown attack
                                        run background script LC5_StaticPlatoonsActions(marker at {GenericTown} + {number from -50 to 50,number from -50 to 50},Melee,AnotherPlatoon,GenericTown)
                                        wait until not AnotherPlatoon recruiting
                                        run background script PT_CreateBasicNorsePlatoon(AnotherPlatoon,1)
                                    end if
                                    GenericTownPlatoonTimer = create timer for (20 * 2.0) * NORSERECRUITMENTMODIFIER * RecruitModifier seconds
                                end if
                            end if
                        end if

                    elsif PlayerAlignmentFinal >= 0.0
                        //Buildings
                        if get GenericTownBuildingTimer time remaining <= 0 and size of GenericTown > 0
                            if get number of type HOUSE ABODE_NUMBER_STORAGE_PIT in GenericTown min built 0.0 < 1
                                run background script AGB_BuildBuilding(GenericTown,AGB_STORAGEPIT,AGB_NORSE)

                            elsif get number of type HOUSE ABODE_NUMBER_TEMPLE in GenericTown min built 0.0 < 1
                                run background script AGB_BuildBuilding(GenericTown,AGB_TEMPLE,AGB_NORSE)

                            elsif get number of type HOUSE ABODE_NUMBER_MELEE_ARMOURY in GenericTown min built 0.0 < 1
                                run background script AGB_BuildBuilding(GenericTown,AGB_ARMORYMELEE,AGB_NORSE)

                            elsif get number of type HOUSE ABODE_NUMBER_RANGED_ARMOURY in GenericTown min built 0.0 < 1
                                run background script AGB_BuildBuilding(GenericTown,AGB_ARMORYRANGED,AGB_NORSE)

                            elsif adult capacity of GenericTown < 100
                                run background script AGB_BuildBuilding(GenericTown,AGB_HOUSE,AGB_NORSE)

                            end if
                            GenericTownBuildingTimer = create timer for 75 * BuilderModifier seconds
                        end if

                        //Platoons
                        if GenericTown != NorseCapital and GenericTown != NorseTown1 and GenericTown != NorseTown2 and GenericTown != NorseTown3 and GenericTown != PlayerTown
                            if get GenericTownPlatoonTimer time remaining <= 0
                                if get army size in town GenericTown < 30 * RecruitModifier
                                    Number = number from 1 to 3
                                    if Number == 1 or Number == 2
                                        AnotherPlatoon = recruit ARMY_UNIT_TYPE_MELEE_1 town GenericTown platoon of size 20 * RecruitSizeModifier
                                        enable platoon AnotherPlatoon respond to town GenericTown attack
                                        run background script LC5_StaticPlatoonsActions(marker at {GenericTown} + {number from -50 to 50,number from -50 to 50},Melee,AnotherPlatoon,GenericTown)
                                        wait until not AnotherPlatoon recruiting
                                        run background script PT_CreateBasicNorsePlatoon(AnotherPlatoon,1)
                                    else
                                        AnotherPlatoon = recruit ARMY_UNIT_TYPE_RANGED_1 town GenericTown platoon of size 20 * RecruitSizeModifier
                                        enable platoon AnotherPlatoon respond to town GenericTown attack
                                        run background script LC5_StaticPlatoonsActions(marker at {GenericTown} + {number from -50 to 50,number from -50 to 50},Melee,AnotherPlatoon,GenericTown)
                                        wait until not AnotherPlatoon recruiting
                                        run background script PT_CreateBasicNorsePlatoon(AnotherPlatoon,1)
                                    end if
                                    GenericTownPlatoonTimer = create timer for (20 * 2.0) * NORSERECRUITMENTMODIFIER * RecruitModifier seconds
                                end if
                            end if
                        end if
                    end if
                end if
            end if
            GenericTownCounter = number from 0 to 16
        end if

        //Town building depending on alignment
        if PlayerAlignmentFinal >= 0.0
            if AlignmentTownBuildingPhase == 0 and get AlignmentTownBuildingTimer1 time remaining <= 0
                AlignmentTownBuildingPhase = 1
                Counter = 0
                while Counter < 16
                    if PLAYER of get town with id Counter == 1
                        build all town get town with id Counter buildings in group 20
                    end if
                    Counter++
                end while

            elsif AlignmentTownBuildingPhase == 1 and get AlignmentTownBuildingTimer2 time remaining <= 0
                AlignmentTownBuildingPhase = 2
                Counter = 0
                while Counter < 16
                    if PLAYER of get town with id Counter == 1
                        build all town get town with id Counter buildings in group 21
                    end if
                    Counter++
                end while

            elsif AlignmentTownBuildingPhase == 2 and get AlignmentTownBuildingTimer3 time remaining <= 0
                AlignmentTownBuildingPhase = 3
                Counter = 0
                while Counter < 16
                    if PLAYER of get town with id Counter == 1
                        build all town get town with id Counter buildings in group 22
                    end if
                    Counter++
                end while

            elsif AlignmentTownBuildingPhase == 3 and get AlignmentTownBuildingTimer4 time remaining <= 0
                AlignmentTownBuildingPhase = 4
                Counter = 0
                while Counter < 16
                    if PLAYER of get town with id Counter == 1
                        build all town get town with id Counter buildings in group 23
                    end if
                    Counter++
                end while

            elsif AlignmentTownBuildingPhase == 4 and get AlignmentTownBuildingTimer5 time remaining <= 0
                AlignmentTownBuildingPhase = 5
                Counter = 0
                while Counter < 16
                    if PLAYER of get town with id Counter == 1
                        build all town get town with id Counter buildings in group 24
                    end if
                    Counter++
                end while

            end if
        elsif PlayerAlignmentFinal < 0.0
            if AlignmentTownBuildingPhase == 0 and get AlignmentTownBuildingTimer1 time remaining <= 0
                AlignmentTownBuildingPhase = 1
                Counter = 0
                while Counter < 16
                    if PLAYER of get town with id Counter == 1
                        build all town get town with id Counter buildings in group 30
                    end if
                    Counter++
                end while

            elsif AlignmentTownBuildingPhase == 1 and get AlignmentTownBuildingTimer2 time remaining <= 0
                AlignmentTownBuildingPhase = 2
                Counter = 0
                while Counter < 16
                    if PLAYER of get town with id Counter == 1
                        build all town get town with id Counter buildings in group 31
                    end if
                    Counter++
                end while

            elsif AlignmentTownBuildingPhase == 2 and get AlignmentTownBuildingTimer3 time remaining <= 0
                AlignmentTownBuildingPhase = 3
                Counter = 0
                while Counter < 16
                    if PLAYER of get town with id Counter == 1
                        build all town get town with id Counter buildings in group 32
                    end if
                    Counter++
                end while

            elsif AlignmentTownBuildingPhase == 3 and get AlignmentTownBuildingTimer4 time remaining <= 0
                AlignmentTownBuildingPhase = 4
                Counter = 0
                while Counter < 16
                    if PLAYER of get town with id Counter == 1
                        build all town get town with id Counter buildings in group 33
                    end if
                    Counter++
                end while

            elsif AlignmentTownBuildingPhase == 4 and get AlignmentTownBuildingTimer5 time remaining <= 0
                AlignmentTownBuildingPhase = 5
                Counter = 0
                while Counter < 16
                    if PLAYER of get town with id Counter == 1
                        build all town get town with id Counter buildings in group 34
                    end if
                    Counter++
                end while
            end if
        end if

        if get BuildingDefendersAllowedTimer time remaining <= 0
            BuildingDefendersAllowedTimer = create timer for 240 * RecruitModifier seconds
            BuildingDefendersAllowed[0] = 1
            BuildingDefendersAllowed[1] = 1
            BuildingDefendersAllowed[2] = 1
            BuildingDefendersAllowed[3] = 1
            BuildingDefendersAllowed[4] = 1
        end if

        if PLAYER of NorseTown1 == 0 or PLAYER of NorseTown2 == 0 or PLAYER of NorseTown3 == 0 or PLAYER of NorseCapital == 0 or PLAYER of NorseTown3 == 4 or get ConquerorTimer time remaining <= 0
            //Use platoons for settlements or minor towns
            if AttackingPlatoons == 0 and NearestSettlement != 0
                ConquerorResetTimer = create timer for 3000 seconds
                AttackingPlatoons = 1
            end if
        end if

        if AttackingPlatoons == 1 and get ConquerorResetTimer time remaining <= 0
            //Use platoons for PlayerTown
            ConquerorTimer = create timer for 2400 * RecruitModifier seconds
            AttackingPlatoons = 0
        end if

        if (TownsConverted >= 2 or get NorseCommanderArrival time remaining <= 0 or PLAYER of NorseTown1 != 2 or PLAYER of NorseTown2 != 3 or PLAYER of NorseTown3 != 4) and NorseCommanderIntroPlayed == 0
            NorseCommanderIntroPlayed = 1
            run background script LC5_NorseCommanderIntro
        end if

        if NorseCommanderArrived == 1 and TimersActivated == 0
            TimersActivated = 1
            GenericTownBuildingInitialTimer = create timer for 1805 * BuilderModifier seconds
            AlignmentTownBuildingTimer1 = create timer for 120 * BuilderModifier seconds
            AlignmentTownBuildingTimer2 = create timer for 360 * BuilderModifier seconds
            AlignmentTownBuildingTimer3 = create timer for 900 * BuilderModifier seconds
            AlignmentTownBuildingTimer4 = create timer for 1500 * BuilderModifier seconds
            AlignmentTownBuildingTimer5 = create timer for 1800 * BuilderModifier seconds
            ConquerorTimer = create timer for 3000 * RecruitModifier seconds
            CreatureMockTimer = create timer for 300 seconds
        end if
    end loop

end script LC5_Norse_Capital


begin script LC5_GetNearestSettlement

    NearestTown = 0
    NearestSettlementPlayerTownSwitch = 0

start

begin loop
    if PLAYER of NorseCapital != 1
        NearestTown = NorseCapital

    elsif PLAYER of NorseTown3 != 1
        NearestTown = NorseTown3

    elsif PLAYER of NorseCapital == 1 and PLAYER of NorseTown3 == 1
        begin loop
            NearestTown = get town with id number from 0 to 15
            if NearestTown exists and get building ABODE_NUMBER_TOWN_CENTRE in NearestTown min built 1.0 exists
                if variable get town NearestTown status == variable TOWN_STATUS_MIGRATION_STARTED
                    NearestTown = 0
                end if
            end if
            until PLAYER of NearestTown != 1 and NearestTown exists
        end loop
    end if
    if NearestTown exists and get building ABODE_NUMBER_TOWN_CENTRE in NearestTown min built 1.0 exists
        NearestSettlement = NearestTown
        wait until PLAYER of NearestSettlement == 1 or NearestSettlement not exists or 2400 seconds
    end if
end loop

end script LC5_GetNearestSettlement


begin script LC5_ResourceManagerNorseCapital

start

begin loop

    wait 5 seconds //To evade the sound bug if storage is burning...
    wait until get distance from camera position to {NorseCapital} > 300

    if PLAYER of NorseCapital == 1
        if (get town NorseCapital RESOURCE_TYPE_ORE total < 6000)
            add resource RESOURCE_TYPE_ORE number from 100 to 500 to NorseCapital
        elsif (get town NorseCapital RESOURCE_TYPE_WOOD total < 10000)
            add resource RESOURCE_TYPE_WOOD number from 500 to 1000 to NorseCapital
        elsif (get town NorseCapital RESOURCE_TYPE_FOOD total < 12500)
            add resource RESOURCE_TYPE_FOOD number from 500 to 1500 to NorseCapital
        end if
    end if
    
    until LandWon == 1
end loop    

end script LC5_ResourceManagerNorseCapital

begin script LC5_VillagerManagerNorseCapital

    Counter = 0
    Villager = 0
    HousesBuilt = 0

start

begin loop

    wait 600 * BuilderModifier seconds
    Counter = 0

    if PLAYER of NorseCapital == 1
        if HousesBuilt == 0
            HousesBuilt = 1
            build all town NorseCapital buildings in group 10
        end if
        begin loop
            wait until get distance from camera position to {NorseCapital} > 300
            Villager = create random villager of tribe TRIBE_TYPE_NORSE at {NorseCapital} + {number from -12 to 12, 0, number from -12 to 12}//create VILLAGER VILLAGER_INFO_JAPANESE_FORESTER_MALE at {1013.581, 132.333, 2002.798} + {number from -3 to 3, 0, number from -3 to 3}
            attach Villager to NorseCapital
            release Villager
            
            wait number from 6 to 10 seconds
            Counter++
            until Counter >= 30 or LandWon == 1 or (size of NorseCapital - get army size in town NorseCapital) >= 35
        end loop
    end if

end loop

end script LC5_VillagerManagerNorseCapital

begin script LC5_VillagerManagerNorseTown1

    Counter = 0
    Villager = 0
    HousesBuilt = 0

start

begin loop

    wait 600 * BuilderModifier seconds
    Counter = 0

    if PLAYER of NorseTown1 == 1
        if HousesBuilt == 0
            HousesBuilt = 1
            build all town NorseTown1 buildings in group 10
        end if
        begin loop
            wait until get distance from camera position to {NorseTown1} > 300
            Villager = create random villager of tribe TRIBE_TYPE_NORSE at {NorseTown1} + {number from -12 to 12, 0, number from -12 to 12}//create VILLAGER VILLAGER_INFO_JAPANESE_FORESTER_MALE at {1013.581, 132.333, 2002.798} + {number from -3 to 3, 0, number from -3 to 3}
            attach Villager to NorseTown1
            release Villager
            
            wait number from 6 to 10 seconds
            Counter++
            until Counter >= 20 or PLAYER of NorseTown1 != 2 or (size of NorseTown1 - get army size in town NorseTown1) >= 25
        end loop
    end if

end loop

end script LC5_VillagerManagerNorseTown1

begin script LC5_ResourceManagerNorseTown1

    Counter = 0

start

begin loop

    wait 5 seconds //To evade the sound bug if storage is burning...
    wait until get distance from camera position to {NorseTown1} > 300

    if PLAYER of NorseTown1 == 1
        if (get town NorseTown1 RESOURCE_TYPE_ORE total < 4000)
            add resource RESOURCE_TYPE_ORE number from 100 to 500 to NorseTown1
        elsif (get town NorseTown1 RESOURCE_TYPE_WOOD total < 6000)
            add resource RESOURCE_TYPE_WOOD number from 500 to 1000 to NorseTown1
        elsif (get town NorseTown1 RESOURCE_TYPE_FOOD total < 7500)
            add resource RESOURCE_TYPE_FOOD number from 500 to 1500 to NorseTown1
        end if
    end if
    
    until PLAYER of NorseTown1 != 2
end loop    

end script LC5_ResourceManagerNorseTown1


begin script LC5_VillagerManagerNorseTown2

    Counter = 0
    Villager = 0
    HousesBuilt = 0

start

begin loop

    wait 600 * BuilderModifier seconds
    Counter = 0

    if PLAYER of NorseTown2 == 1
        if HousesBuilt == 0
            HousesBuilt = 1
            build all town NorseTown2 buildings in group 10
        end if
        begin loop
            wait until get distance from camera position to {NorseTown2} > 300
            Villager = create random villager of tribe TRIBE_TYPE_NORSE at {NorseTown2} + {number from -12 to 12, 0, number from -12 to 12}//create VILLAGER VILLAGER_INFO_JAPANESE_FORESTER_MALE at {1013.581, 132.333, 2002.798} + {number from -3 to 3, 0, number from -3 to 3}
            attach Villager to NorseTown2
            release Villager
            
            wait number from 6 to 10 seconds
            Counter++
            until Counter >= 20 or PLAYER of NorseTown2 != 3 or (size of NorseTown2 - get army size in town NorseTown2) >= 25
        end loop
    end if

end loop

end script LC5_VillagerManagerNorseTown2

begin script LC5_ResourceManagerNorseTown2

    Counter = 0

start

begin loop

    wait 5 seconds //To evade the sound bug if storage is burning...
    wait until get distance from camera position to {NorseTown2} > 300

    if PLAYER of NorseTown2 == 1
        if (get town NorseTown2 RESOURCE_TYPE_ORE total < 4000)
            add resource RESOURCE_TYPE_ORE number from 100 to 500 to NorseTown2
        elsif (get town NorseTown2 RESOURCE_TYPE_WOOD total < 6000)
            add resource RESOURCE_TYPE_WOOD number from 500 to 1000 to NorseTown2
        elsif (get town NorseTown2 RESOURCE_TYPE_FOOD total < 7500)
            add resource RESOURCE_TYPE_FOOD number from 500 to 1500 to NorseTown2
        end if
    end if
    
    until PLAYER of NorseTown2 != 3
end loop    

end script LC5_ResourceManagerNorseTown2


begin script LC5_VillagerManagerNorseTown3

    Counter = 0
    Villager = 0
    HousesBuilt = 0

start

begin loop

    wait 600 * BuilderModifier seconds
    Counter = 0

    if PLAYER of NorseTown3 == 1
        if HousesBuilt == 0
            HousesBuilt = 1
            build all town NorseTown3 buildings in group 10
        end if
        begin loop
            wait until get distance from camera position to {NorseTown3} > 300
            Villager = create random villager of tribe TRIBE_TYPE_NORSE at {NorseTown3} + {number from -12 to 12, 0, number from -12 to 12}//create VILLAGER VILLAGER_INFO_JAPANESE_FORESTER_MALE at {1013.581, 132.333, 2002.798} + {number from -3 to 3, 0, number from -3 to 3}
            attach Villager to NorseTown3
            release Villager
            
            wait number from 6 to 10 seconds
            Counter++
            until Counter >= 20 or PLAYER of NorseTown3 != 4 or (size of NorseTown3 - get army size in town NorseTown3) >= 25
        end loop
    end if

end loop

end script LC5_VillagerManagerNorseTown3

begin script LC5_ResourceManagerNorseTown3

    Counter = 0

start

begin loop

    wait 5 seconds //To evade the sound bug if storage is burning...
    wait until get distance from camera position to {NorseTown3} > 300

    if PLAYER of NorseTown3 == 1
        if (get town NorseTown3 RESOURCE_TYPE_ORE total < 6000)
            add resource RESOURCE_TYPE_ORE number from 100 to 500 to NorseTown3
        elsif (get town NorseTown3 RESOURCE_TYPE_WOOD total < 8000)
            add resource RESOURCE_TYPE_WOOD number from 500 to 1000 to NorseTown3
        elsif (get town NorseTown3 RESOURCE_TYPE_FOOD total < 10000)
            add resource RESOURCE_TYPE_FOOD number from 500 to 1500 to NorseTown3
        end if
    end if
    
    until PLAYER of NorseTown3 != 4
end loop    

end script LC5_ResourceManagerNorseTown3


begin script LC5_NorseCommanderIntro

    AtmosMixer = create mixer
    Portal = 0
    PortalPos = marker at {1865.21,84.90,2217.89}
    IntroPlatoon[5]

start

    wait until NorseMaraudersTriggered == 1

    wait 60 seconds

    wait until dialogue ready and camera ready

    DM_DynamicMusicDisallowed = 1
    begin cinema
        store camera details
        set fade red 0 green 0 blue 0 time 2
        disable atmos sound
        //set atmos volume 0
        set mixer AtmosMixer channel AUDIO_MIXER_CHANNEL_ATMOS_MAP to 0.45
        set mixer AtmosMixer channel AUDIO_MIXER_CHANNEL_ATMOS_POSITIONAL to 0.45
        wait 2 seconds

        reset camera path
        queue camera move with position {1716.67,140.00,2203.78} focus {PortalPos} time 0.0
        queue camera move with position {1775.08,135.00,2212.85} focus {PortalPos} time 15.0

        Portal = create visual effect VISUAL_EFFECT_TELEPORTER_HOOP at {PortalPos} + {0, 3, 0} time -1
        SCALE of Portal = 3.0

        set fade in time 4
        play camera path with easein 2 easeout 12 method SCRIPT_CAMERAPATH_EQUALTIME
        set camera lens 50 time 15
        start music "norsemarchinglarge_01" loop -1

        wait 4 seconds

        IntroPlatoon[0] = create platoon PLATOON_INFO_NORSE_MELEE_1 at {PortalPos} with 40 * RecruitSizeModifier men and 0 women
        PLAYER of IntroPlatoon[0] = 1
        run background script PT_CreateBasicNorsePlatoon(IntroPlatoon[0],1)
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {1854.56,75.49,2271.48} to IntroPlatoon[0] action queue
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {1831.71,78.09,2268.52} to IntroPlatoon[0] action queue
        wait 1.25 seconds

        IntroPlatoon[1] = create platoon PLATOON_INFO_NORSE_MELEE_1 at {PortalPos} with 40 * RecruitSizeModifier men and 0 women
        PLAYER of IntroPlatoon[1] = 1
        run background script PT_CreateBasicNorsePlatoon(IntroPlatoon[1],1)
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {1824.28,85.01,2241.84} to IntroPlatoon[1] action queue
        wait 1.25 seconds

        IntroPlatoon[2] = create platoon PLATOON_INFO_NORSE_MELEE_1 at {PortalPos} with 40 * RecruitSizeModifier men and 0 women
        PLAYER of IntroPlatoon[2] = 1
        run background script PT_CreateBasicNorsePlatoon(IntroPlatoon[2],1)
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {1829.18,90.38,2210.49} to IntroPlatoon[2] action queue
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {1817.06,89.65,2220.78} to IntroPlatoon[2] action queue
        wait 1.25 seconds

        eject good spirit
        eject evil spirit
        wait 1 seconds
        say "BW2T_SCRIPT_03FINAL_FAMILY_INTRO_50"
        wait until read
        make good spirit play across 0.5 down 0.5 HELPDUDE_KM_04FINAL_INTRO_G_180_190
        make evil spirit play across 0.5 down 0.5 HELPDUDE_KM_04FINAL_INTRO_E_180_190
        wait 5 seconds

        IntroPlatoon[3] = create platoon PLATOON_INFO_NORSE_MELEE_1 at {PortalPos} with 60 * RecruitSizeModifier men and 0 women
        PLAYER of IntroPlatoon[3] = 1
        run background script PT_CreateBasicNorsePlatoon(IntroPlatoon[3],1)
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {1861.99,81.75,2238.82} to IntroPlatoon[3] action queue
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {1852.04,81.18,2248.11} to IntroPlatoon[3] action queue
        wait 1.25 seconds

        IntroPlatoon[4] = create platoon PLATOON_INFO_NORSE_MELEE_1 at {PortalPos} with 60 * RecruitSizeModifier men and 0 women
        PLAYER of IntroPlatoon[4] = 1
        run background script PT_CreateBasicNorsePlatoon(IntroPlatoon[4],1)
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {1847.06,88.26,2211.12} to IntroPlatoon[4] action queue
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {1834.66,89.15,2217.25} to IntroPlatoon[4] action queue
        wait 1.25 seconds

        wait until read
        say "BW2T_SCRIPT_04FINAL_ADVISORS_INTRO_200"
        wait until read

        reset camera path
        queue camera move with position {1515.25,130,2245.24} focus {PortalPos} + {0,-60,0} time 17.5
        play camera path with easein 4 easeout 4 method SCRIPT_CAMERAPATH_EQUALTIME
        set camera lens 70 time 5

        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {1641.37,94.22,2267.04} to IntroPlatoon[0] action queue
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {1626.57,103.72,2218.20} to IntroPlatoon[1] action queue
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {1677.42,96.58,2229.18} to IntroPlatoon[2] action queue
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {1702.35,93.17,2259.42} to IntroPlatoon[3] action queue
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {1669.20,102.75,2198.25} to IntroPlatoon[4] action queue

        say "BW2T_SCRIPT_04FINAL_ADVISORS_INTRO_40"

        wait 2 seconds
        delete Portal with fade

        wait until read
        //After Delay
        say "BW2T_SCRIPT_04FINAL_ADVISORS_INTRO_70"
        wait until read

        wait until camera ready
        wait 2.5 seconds

        send good spirit home
        send evil spirit home

        set fade red 0 green 0 blue 0 time 2
        wait 2 seconds
        run background script LC5_NorseCommanderSetup
        restore camera details
        enable atmos sound
        //set atmos volume 0.45
        set mixer AtmosMixer channel AUDIO_MIXER_CHANNEL_ATMOS_MAP to 0.45
        set mixer AtmosMixer channel AUDIO_MIXER_CHANNEL_ATMOS_POSITIONAL to 0.45
        set fade in time 4
    end cinema
    delete IntroPlatoon[0]
    delete IntroPlatoon[1]
    delete IntroPlatoon[2]
    delete IntroPlatoon[3]
    delete IntroPlatoon[4]
    wait 30 seconds
    stop music with fadetime 5
    DM_DynamicMusicDisallowed = 0

end script LC5_NorseCommanderIntro


begin script LC5_NorseCommanderSetup

start

    NorseCommanderArrived = 1
    //----Create P1 Platoons----//
    LC5_Platoon[8] = create platoon PLATOON_INFO_NORSE_MELEE_1 at {PlatoonPos[8]} with 40 * RecruitSizeModifier men and 0 women
    PLAYER of LC5_Platoon[8] = 1
    run background script LC5_StaticPlatoonsActions(PlatoonPos[8],Melee,LC5_Platoon[8],NorseCapital)
    run background script LC5_GenericSpeeches(LC5_Platoon[8],1)
    run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[8],1)
    enable platoon LC5_Platoon[8] respond to town NorseCapital attack
    set LC5_Platoon[8] focus to {PlatoonPos[8]}

    LC5_Platoon[9] = create platoon PLATOON_INFO_NORSE_MELEE_1 at {PlatoonPos[9]} with 40 * RecruitSizeModifier men and 0 women
    PLAYER of LC5_Platoon[9] = 1
    run background script LC5_StaticPlatoonsActions(PlatoonPos[9],Melee,LC5_Platoon[9],NorseCapital)
    run background script LC5_GenericSpeeches(LC5_Platoon[9],1)
    run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[9],1)
    enable platoon LC5_Platoon[9] respond to town NorseCapital attack
    set LC5_Platoon[9] focus to {PlatoonPos[9]}

    LC5_Platoon[10] = create platoon PLATOON_INFO_NORSE_MELEE_1 at {PlatoonPos[10]} with 40 * RecruitSizeModifier men and 0 women
    PLAYER of LC5_Platoon[10] = 1
    run background script LC5_StaticPlatoonsActions(PlatoonPos[10],Melee,LC5_Platoon[10],NorseCapital)
    run background script LC5_GenericSpeeches(LC5_Platoon[10],1)
    run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[10],1)
    enable platoon LC5_Platoon[10] respond to town NorseCapital attack
    set LC5_Platoon[10] focus to {PlatoonPos[10]}

    LC5_Platoon[11] = create platoon PLATOON_INFO_NORSE_MELEE_1 at {NorseCapital} + {20,20} with 60 * RecruitSizeModifier men and 0 women
    PLAYER of LC5_Platoon[11] = 1
    run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[11],1)
    run background script LC5_GenericSpeeches(LC5_Platoon[11],1)
    enable platoon LC5_Platoon[11] respond to town NorseCapital attack
    set LC5_Platoon[11] focus to {PlatoonPos[11]}

    LC5_Platoon[12] = create platoon PLATOON_INFO_NORSE_MELEE_1 at {NorseCapital} + {20,20} with 60 * RecruitSizeModifier men and 0 women
    PLAYER of LC5_Platoon[12] = 1
    run background script PT_CreateBasicNorsePlatoon(LC5_Platoon[12],1)
    run background script LC5_GenericSpeeches(LC5_Platoon[12],1)
    enable platoon LC5_Platoon[12] respond to town NorseCapital attack
    set LC5_Platoon[12] focus to {PlatoonPos[12]}

    set LC5_Platoon[11] attack NorseCapital with severity 1.0 for takeover
    set LC5_Platoon[12] attack NorseCapital with severity 1.0 for takeover

    wait until PLAYER of NorseCapital == 1 or (LC5_Platoon[11] not exists and LC5_Platoon[12] not exists)

    if LC5_Platoon[11] not exists and LC5_Platoon[12] not exists
        wait 60 seconds
        set LC5_Platoon[8] attack NorseCapital with severity 1.0 for takeover
        set LC5_Platoon[9] attack NorseCapital with severity 1.0 for takeover
        set LC5_Platoon[10] attack NorseCapital with severity 1.0 for takeover
    end if

    wait until PLAYER of NorseCapital == 1

    build all town NorseCapital buildings in group 1

    attach LC5_Platoon[8] to NorseCapital
    attach LC5_Platoon[9] to NorseCapital
    attach LC5_Platoon[10] to NorseCapital
    attach LC5_Platoon[11] to NorseCapital
    attach LC5_Platoon[12] to NorseCapital

    run background script LC5_AttackEnemyTown(LC5_Platoon[11],NorseTown3)
    run background script LC5_AttackEnemyTown(LC5_Platoon[12],NorseTown3)

end script LC5_NorseCommanderSetup


begin script DisableLocalPlatoonResponse

    Counter = 0

start

begin loop
    if Counter > 99
        Counter = 0
        wait 30 seconds
    end if
    if LC5_Platoon[Counter] exists
        disable platoon LC5_Platoon[Counter] respond to local platoon attack
    end if
    if LC5_WallArcher[Counter] exists
        disable platoon LC5_WallArcher[Counter] respond to local platoon attack
    end if

    Counter++
end loop

end script DisableLocalPlatoonResponse