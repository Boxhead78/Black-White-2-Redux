///////////////////////////////////////////////////////////////////////////////
//    Land 8 Japanese Troop-Management
//    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
//
//    Start date:         28.03.18            By: Boxhead
//    Update date:        04.04.18            By: Boxhead
///////////////////////////////////////////////////////////////////////////////

//-----------------------------------------------------------------------------
//    Globals
//-----------------------------------------------------------------------------

define LC8_NUM_OF_DEFENDERS                = 0 //Unused
define LC8_NUM_OF_PLATOONS                = 55
define LC8_NUM_OF_SIEGE_CATAPULTS         = 35
define LC8_NUM_OF_WALL_ARCHERS            = 20
//Army Types
define Melee                             = 0
define Ranged                            = 1
//Army Behaivours
define Attacker                          = 0
define Escort                            = 1
define Conqueror                         = 2 //Nearest Settlement Attacker
define Patrol                            = 3
define PatrolLinked                      = 4
define Special                           = 5

define script LC8_StaticPlatoonsActions(Pos,Type,Platoon)
define script Waypoints

global LC8_Defender[LC8_NUM_OF_DEFENDERS]
global LC8_Platoon[LC8_NUM_OF_PLATOONS]
global LC8_SiegeCatapult[LC8_NUM_OF_SIEGE_CATAPULTS]
global LC8_WallArcher[LC8_NUM_OF_WALL_ARCHERS]

global PlatoonPos[19]
global StaticSiegePos[10]
global AttackPos[5]
global SiegePlatoonPos[3]
global SiegeRoute1[4]
global SiegeRoute2[4]
global SiegeRoute3[4]
global SiegeRoute4[4]
global SiegeRoute5[4]
global LS_PrePos[7]//7 Platoons, 6 Siege Weapons
global LS_AttackPos[7]
global LS_SiegeRoute1[3]
global LS_SiegeRoute2[3]
global LS_SiegeRoute3[3]
global LS_SiegeRoute4[4]
global LS_SiegeRoute5[4]
global LS_SiegeRoute6[4]
global PortalPos[1]
global PlayerWallPos[2]

global SiegeAttackPrePos[4]
global SiegeAttackPos[4]

global PatrolRouteA[4]
global WaypointsA = 0
global PatrolRouteB[4]
global WaypointsB = 0

//-----------------------------------------------------------------------------

//-----------------------------------------------------------------------------
//    Setting up waypoints for AI actions
//-----------------------------------------------------------------------------

run script Waypoints

begin script Waypoints

start

    SiegeAttackPrePos[0] = marker at {1765.98,44.97,1253.20}

    SiegeAttackPos[0] = marker at {2063.16,55.61,1297.50}

    PlayerWallPos[0] = marker at {1296.29,151.23,864.95}
    PlayerWallPos[1] = marker at {1660.86,158.43,799.39}

    PlatoonPos[0] = marker at {1827.59,124.62,1850.60}
    PlatoonPos[1] = marker at {1615.74,144.03,2013.94}
    PlatoonPos[2] = marker at {1757.16,157.46,1981.57}
    PlatoonPos[3] = marker at {1236.15,120.61,1073.94}
    PlatoonPos[4] = marker at {1718.42,103.21,1162.01}
    PlatoonPos[5] = marker at {712.54,149.03,2107.67}
    PlatoonPos[6] = marker at {873.14,135.72,2072.00}
    PlatoonPos[7] = marker at {606.60,166.39,2055.45}
    PlatoonPos[8] = marker at {1338.61,71.29,1564.18}
    PlatoonPos[9] = marker at {1244.36,75.33,1644.25}
    PlatoonPos[10] = marker at {1827.71,146.73,1357.82}
    PlatoonPos[11] = marker at {1885.18,149.56,1413.33}
    PlatoonPos[12] = marker at {979.36,88.56,1347.32}
    PlatoonPos[13] = marker at {969.13,88.64,1446.79}
    PlatoonPos[14] = marker at {1403.51,134.12,972.46}
    PlatoonPos[15] = marker at {1439.65,132.05,991.67}
    
    PortalPos[0] = marker at {1170.67,128.59,2157.00}

    AttackPos[0] = marker at {1286.18,151.75,864.69}//FrontAttackpos
    AttackPos[1] = marker at {1212.43,120.48,1059.18}//FrontFallBack
    AttackPos[2] = marker at {1652.18,158.72,801.23}//BackdoorAttackpos
    AttackPos[3] = marker at {1703.65,126.25,988.27}//BackdoorFallBack

    //JapaneseTown2
    LS_PrePos[0] = marker at {1252.06,97.66,1248.33}
    LS_PrePos[1] = marker at {1293.16,95.90,1240.47}
    LS_PrePos[2] = marker at {1335.27,98.86,1236.22}
    LS_PrePos[3] = marker at {1367.86,101.35,1275.84}
    //JapaneseTown1
    LS_PrePos[4] = marker at {1031.41,88.59,1442.04}
    //JapaneseCapital
    LS_PrePos[5] = marker at {1718.75,103.36,1226.78}
    LS_PrePos[6] = marker at {1759.75,103.49,1224.12}

    //JapaneseTown2
    LS_AttackPos[0] = marker at {1213.78,136.38,926.88}
    LS_AttackPos[1] = marker at {1260.07,133.71,948.31}
    LS_AttackPos[2] = marker at {1316.87,141.31,910.64}
    LS_AttackPos[3] = marker at {1330.49,147.70,877.53}
    //JapaneseTown1
    LS_AttackPos[4] = marker at {1281.97,146.60,884.18}
    //JapaneseCapital
    LS_AttackPos[5] = marker at {1649.72,153.32,840.40}
    LS_AttackPos[6] = marker at {1687.64,156.13,801.26}

    //JapaneseTown2 to PlayerTown
    LS_SiegeRoute1[0] = marker at {1344.31,87.49,1363.58}//Not variable
    LS_SiegeRoute1[1] = marker at {1299.17,92.81,1282.63}
    LS_SiegeRoute1[2] = marker at {1267.89,133.44,958.69}

    LS_SiegeRoute2[0] = marker at {LS_SiegeRoute1[0]}//Not variable
    LS_SiegeRoute2[1] = marker at {LS_SiegeRoute1[1]} + {-20,0,-20}
    LS_SiegeRoute2[2] = marker at {LS_SiegeRoute1[2]} + {-20,0,-20}

    LS_SiegeRoute3[0] = marker at {LS_SiegeRoute1[0]}//Not variable
    LS_SiegeRoute3[1] = marker at {LS_SiegeRoute1[1]} + {20,0,20}
    LS_SiegeRoute3[2] = marker at {LS_SiegeRoute1[2]} + {20,0,20}

    //JapaneseTown1 to PlayerTown
    LS_SiegeRoute4[0] = marker at {756.71,132.93,1906.53}//Not variable
    LS_SiegeRoute4[1] = marker at {997.20,88.54,1458.75}
    LS_SiegeRoute4[2] = marker at {1221.86,107.41,1175.57}
    LS_SiegeRoute4[3] = marker at {1247.19,130.90,971.85}

    LS_SiegeRoute5[0] = marker at {LS_SiegeRoute4[0]}//Not variable
    LS_SiegeRoute5[1] = marker at {LS_SiegeRoute4[1]} + {20,0,20}
    LS_SiegeRoute5[2] = marker at {LS_SiegeRoute4[2]} + {20,0,20}
    LS_SiegeRoute5[3] = marker at {LS_SiegeRoute4[3]} + {20,0,20}

    //JapaneseCapital to PlayerTown
    LS_SiegeRoute6[0] = marker at {1758.82,124.19,1772.07}//Not variable
    LS_SiegeRoute6[1] = marker at {1598.61,115.84,1431.73}
    LS_SiegeRoute6[2] = marker at {1732.82,101.31,1200.37}
    LS_SiegeRoute6[3] = marker at {1673.42,148.02,853.58}

    //JapaneseTown2 to PlayerTown
    SiegeRoute1[0] = marker at {1344.73,87.27,1368.25}//Not variable
    SiegeRoute1[1] = marker at {1298.91,95.30,1249.21}
    SiegeRoute1[2] = marker at {1253.45,117.15,1109.68}
    SiegeRoute1[3] = marker at {1270.96,133.33,963.45}

    SiegeRoute2[0] = marker at {LS_SiegeRoute6[0]}//Not variable
    SiegeRoute2[1] = marker at {LS_SiegeRoute6[1]}
    SiegeRoute2[2] = marker at {LS_SiegeRoute6[2]}
    SiegeRoute2[3] = marker at {LS_SiegeRoute6[3]}

    SiegeRoute3[0] = marker at {LS_SiegeRoute4[0]}//Not variable
    SiegeRoute3[1] = marker at {LS_SiegeRoute4[1]}
    SiegeRoute3[2] = marker at {LS_SiegeRoute4[2]}
    SiegeRoute3[3] = marker at {LS_SiegeRoute4[3]}

    SiegeRoute4[0] = marker at {LS_SiegeRoute6[0]}//Not variable
    SiegeRoute4[1] = marker at {LS_SiegeRoute6[1]} + {20,0,20}
    SiegeRoute4[2] = marker at {LS_SiegeRoute6[2]} + {20,0,20}
    SiegeRoute4[3] = marker at {LS_SiegeRoute6[3]} + {20,0,20}

    SiegeRoute5[0] = marker at {LS_SiegeRoute4[0]}//Not variable
    SiegeRoute5[1] = marker at {LS_SiegeRoute4[1]} + {20,0,20}
    SiegeRoute5[2] = marker at {LS_SiegeRoute4[2]} + {20,0,20}
    SiegeRoute5[3] = marker at {LS_SiegeRoute4[3]} + {20,0,20}
    
    SiegePlatoonPos[0] = marker at {1338.13,88.79,1329.34}//JapaneseTown2
    SiegePlatoonPos[1] = marker at {770.09,127.70,1872.93}//JapaneseTown1
    SiegePlatoonPos[2] = marker at {1764.26,124.24,1745.59}//JapaneseCapital

    PatrolRouteA[0] = marker at {1759.00,127.23,1654.08}
    PatrolRouteA[1] = marker at {1577.86,108.41,1460.40}
    PatrolRouteA[2] = marker at {1741.90,102.17,1214.74}
    PatrolRouteA[3] = marker at {1889.29,149.56,1426.75}

    PatrolRouteB[0] = marker at {1690.80,103.50,1195.26}
    PatrolRouteB[1] = marker at {1309.47,96.06,1246.81}
    PatrolRouteB[2] = marker at {1222.77,106.90,1180.37}
    PatrolRouteB[3] = marker at {1077.65,92.85,1283.15}

    StaticSiegePos[0] = marker at {1848.84,174.41,1964.97}
    StaticSiegePos[1] = marker at {1824.88,174.47,1990.92}
    StaticSiegePos[2] = marker at {1765.23,145.61,1884.40}
    StaticSiegePos[3] = marker at {1288.69,87.85,1474.26}
    StaticSiegePos[4] = marker at {1221.62,85.39,1579.82}
    StaticSiegePos[5] = marker at {712.89,149.06,2069.05}
    StaticSiegePos[6] = marker at {753.45,148.94,2078.80}

    WaypointsA = create SCRIPT_OBJECT_TYPE_WAYPOINTROUTE at {0, 0, 0}

    add {PatrolRouteA[0]} to waypoint list WaypointsA
    add {PatrolRouteA[1]} to waypoint list WaypointsA
    add {PatrolRouteA[2]} to waypoint list WaypointsA
    add {PatrolRouteA[3]} to waypoint list WaypointsA

    WaypointsB = create SCRIPT_OBJECT_TYPE_WAYPOINTROUTE at {0, 0, 0}

    add {PatrolRouteB[0]} to waypoint list WaypointsB
    add {PatrolRouteB[1]} to waypoint list WaypointsB
    add {PatrolRouteB[2]} to waypoint list WaypointsB
    add {PatrolRouteB[3]} to waypoint list WaypointsB

end script Waypoints

//-----------------------------------------------------------------------------

begin script LC8_StaticPlatoonsActions(Pos,Type,Platoon)

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    Catapult = 0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    PlayerSettlement = 0

start

begin loop

    if Type == Melee
        PlayerCreature = get distance from {Platoon} to {oCreature}
        if PlayerCreature <= 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and Platoon can navigate to {oCreature}
            clear Platoon action queue
            begin loop
                PlayerCreature = get distance from {Platoon} to {oCreature}
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to Platoon action queue
                NumPat1 = get number of villagers in platoon Platoon
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not Platoon can navigate to {oCreature} or PlayerCreature > 200
            end loop
            clear Platoon action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {Platoon} radius 200
        Catapult = get siege weapon of player 0 nearest {Platoon} radius 155
        if PlayerPlatoon1 exists and Platoon can navigate to {PlayerPlatoon1}
            clear Platoon action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {Platoon} radius 200
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to Platoon action queue
                NumPat1 = get number of villagers in platoon Platoon
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not Platoon can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear Platoon action queue
        elsif Catapult exists and Platoon can navigate to {Catapult}
            clear Platoon action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {Platoon} radius 155
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to Platoon action queue
                NumPat1 = get number of villagers in platoon Platoon
                PlayerPlatoon1 = get platoon of player 0 nearest {Platoon} radius 200
                if PlayerPlatoon1 exists and Platoon can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not Platoon can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear Platoon action queue
            a = 0
        end if

    elsif Type == Ranged
        PlayerCreature = get distance from {Platoon} to {oCreature}
        if PlayerCreature <= 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and Platoon can navigate to {oCreature}
            clear Platoon action queue
            begin loop
                PlayerCreature = get distance from {Platoon} to {oCreature}
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK using oCreature to Platoon action queue
                NumPat1 = get number of villagers in platoon Platoon
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not Platoon can navigate to {oCreature} or PlayerCreature > 200
            end loop
            clear Platoon action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {Platoon} radius 200
        Catapult = get siege weapon of player 0 nearest {Platoon} radius 155
        if PlayerPlatoon1 exists and Platoon can navigate to {PlayerPlatoon1}
            clear Platoon action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {Platoon} radius 200
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK using PlayerPlatoon1 to Platoon action queue
                NumPat1 = get number of villagers in platoon Platoon
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not Platoon can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear Platoon action queue
        elsif Catapult exists and Platoon can navigate to {Catapult}
            clear Platoon action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {Platoon} radius 155
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK using Catapult to Platoon action queue
                NumPat1 = get number of villagers in platoon Platoon
                PlayerPlatoon1 = get platoon of player 0 nearest {Platoon} radius 200
                if PlayerPlatoon1 exists and Platoon can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not Platoon can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear Platoon action queue
            a = 0
        end if
    end if

    if get size of Platoon action queue < 1 and {Platoon} not near {Pos} radius 25
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {Pos} to Platoon action queue
    end if

    until Platoon not exists
end loop

end script LC8_StaticPlatoonsActions

begin script LC8_Platoon10Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    PlayerSettlement = 0
    
start

begin loop    

    if LC8_Platoon[10] not exists
        //PlatoonKilled = 1
        wait until LC8_Platoon[10] exists
    end if
        
    PlayerCreature = get distance from {LC8_Platoon[10]} to {oCreature}
    if PlayerCreature <= 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC8_Platoon[10] can navigate to {oCreature}
        clear LC8_Platoon[10] action queue
        begin loop
            PlayerCreature = get distance from {LC8_Platoon[10]} to {oCreature}
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC8_Platoon[10] action queue
            NumPat1 = get number of villagers in platoon LC8_Platoon[10]
            until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC8_Platoon[10] can navigate to {oCreature} or PlayerCreature > 200
        end loop
        clear LC8_Platoon[10] action queue
    end if
        
    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[10]} radius 200
    Catapult = get siege weapon of player 0 nearest {LC8_Platoon[10]} radius 155
    if PlayerPlatoon1 exists and LC8_Platoon[10] can navigate to {PlayerPlatoon1}
        clear LC8_Platoon[10] action queue
        begin loop
            PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[10]} radius 200
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC8_Platoon[10] action queue
            NumPat1 = get number of villagers in platoon LC8_Platoon[10]
            HeTeste1 = get number of villagers in platoon PlayerPlatoon1
            until NumPat1 == 0 or HeTeste1 == 0 or not LC8_Platoon[10] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
        end loop
        clear LC8_Platoon[10] action queue
    elsif Catapult exists and LC8_Platoon[10] can navigate to {Catapult}
        clear LC8_Platoon[10] action queue
        a = 0
        begin loop
            Catapult = get siege weapon of player 0 nearest {LC8_Platoon[10]} radius 155
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC8_Platoon[10] action queue
            NumPat1 = get number of villagers in platoon LC8_Platoon[10]
            PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[10]} radius 200
            if PlayerPlatoon1 exists and LC8_Platoon[10] can navigate to {PlayerPlatoon1}
                a = 1
            end if
            until NumPat1 == 0 or Catapult not exists or not LC8_Platoon[10] can navigate to {Catapult} or a == 1 or Catapult not exists
        end loop
        clear LC8_Platoon[10] action queue
        a = 0
    end if
        
    if get size of LC8_Platoon[10] action queue < 1
        move LC8_Platoon[10] along WaypointsA with patrol WAYPOINTROUTE_TRAVERSAL_TYPE_CIRCULAR
    end if
        
end loop

end script LC8_Platoon10Actions

begin script LC8_Platoon11Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    PlayerSettlement = 0
    
start

begin loop    

    if LC8_Platoon[11] not exists
        //PlatoonKilled = 1
        wait until LC8_Platoon[11] exists
    end if
        
    PlayerCreature = get distance from {LC8_Platoon[11]} to {oCreature}
    if PlayerCreature <= 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC8_Platoon[11] can navigate to {oCreature}
        clear LC8_Platoon[11] action queue
        begin loop
            PlayerCreature = get distance from {LC8_Platoon[11]} to {oCreature}
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC8_Platoon[11] action queue
            NumPat1 = get number of villagers in platoon LC8_Platoon[11]
            until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC8_Platoon[11] can navigate to {oCreature} or PlayerCreature > 200
        end loop
        clear LC8_Platoon[11] action queue
    end if
        
    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[11]} radius 200
    Catapult = get siege weapon of player 0 nearest {LC8_Platoon[11]} radius 155
    if PlayerPlatoon1 exists and LC8_Platoon[11] can navigate to {PlayerPlatoon1}
        clear LC8_Platoon[11] action queue
        begin loop
            PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[11]} radius 200
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC8_Platoon[11] action queue
            NumPat1 = get number of villagers in platoon LC8_Platoon[11]
            HeTeste1 = get number of villagers in platoon PlayerPlatoon1
            until NumPat1 == 0 or HeTeste1 == 0 or not LC8_Platoon[11] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
        end loop
        clear LC8_Platoon[11] action queue
    elsif Catapult exists and LC8_Platoon[11] can navigate to {Catapult}
        clear LC8_Platoon[11] action queue
        a = 0
        begin loop
            Catapult = get siege weapon of player 0 nearest {LC8_Platoon[11]} radius 155
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC8_Platoon[11] action queue
            NumPat1 = get number of villagers in platoon LC8_Platoon[11]
            PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[11]} radius 200
            if PlayerPlatoon1 exists and LC8_Platoon[11] can navigate to {PlayerPlatoon1}
                a = 1
            end if
            until NumPat1 == 0 or Catapult not exists or not LC8_Platoon[11] can navigate to {Catapult} or a == 1 or Catapult not exists
        end loop
        clear LC8_Platoon[11] action queue
        a = 0
    end if
        
    if get size of LC8_Platoon[11] action queue < 1
        move LC8_Platoon[11] along WaypointsB with patrol WAYPOINTROUTE_TRAVERSAL_TYPE_CIRCULAR
    end if
        
end loop

end script LC8_Platoon11Actions

begin script LC8_Platoon42Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    PlayerSettlement = 0
    
start

begin loop    

    if LC8_Platoon[42] not exists
        //PlatoonKilled = 1
        wait until LC8_Platoon[42] exists
    end if
        
    PlayerCreature = get distance from {LC8_Platoon[42]} to {oCreature}
    if PlayerCreature <= 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC8_Platoon[42] can navigate to {oCreature}
        clear LC8_Platoon[42] action queue
        begin loop
            PlayerCreature = get distance from {LC8_Platoon[42]} to {oCreature}
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC8_Platoon[42] action queue
            NumPat1 = get number of villagers in platoon LC8_Platoon[42]
            until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC8_Platoon[42] can navigate to {oCreature} or PlayerCreature > 200
        end loop
        clear LC8_Platoon[42] action queue
    end if
        
    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[42]} radius 200
    Catapult = get siege weapon of player 0 nearest {LC8_Platoon[42]} radius 155
    if PlayerPlatoon1 exists and LC8_Platoon[42] can navigate to {PlayerPlatoon1}
        clear LC8_Platoon[42] action queue
        begin loop
            PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[42]} radius 200
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC8_Platoon[42] action queue
            NumPat1 = get number of villagers in platoon LC8_Platoon[42]
            HeTeste1 = get number of villagers in platoon PlayerPlatoon1
            until NumPat1 == 0 or HeTeste1 == 0 or not LC8_Platoon[42] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
        end loop
        clear LC8_Platoon[42] action queue
    elsif Catapult exists and LC8_Platoon[42] can navigate to {Catapult}
        clear LC8_Platoon[42] action queue
        a = 0
        begin loop
            Catapult = get siege weapon of player 0 nearest {LC8_Platoon[42]} radius 155
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC8_Platoon[42] action queue
            NumPat1 = get number of villagers in platoon LC8_Platoon[42]
            PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[42]} radius 200
            if PlayerPlatoon1 exists and LC8_Platoon[42] can navigate to {PlayerPlatoon1}
                a = 1
            end if
            until NumPat1 == 0 or Catapult not exists or not LC8_Platoon[42] can navigate to {Catapult} or a == 1 or Catapult not exists
        end loop
        clear LC8_Platoon[42] action queue
        a = 0
    end if
        
    if LC8_Platoon[11] exists
        if get size of LC8_Platoon[42] action queue < 1
            add action PLATOON_AGENDA_ACTION_LINK_TO_ARMY_MEMBER using LC8_Platoon[11] to LC8_Platoon[42] action queue
        end if
    else
        if get size of LC8_Platoon[42] action queue < 1
            move LC8_Platoon[42] along WaypointsB with patrol WAYPOINTROUTE_TRAVERSAL_TYPE_CIRCULAR
        end if
    end if
        
end loop

end script LC8_Platoon42Actions

begin script LC8_Platoon22Actions

    oCreature = get player 0 creature
    HeTeste3 = 0
    TestCreature2 = 0
    NumPat = 0
    NumPat5 = 0
    PlayerPlatoon1 = 0
    WorrNum = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    ProPlatoonsLocation = 0
    AIPlatoon1 = 0
    Armory = 0
    Town8 = get town with id 8
    RandomActionP3 = 0
    a = 1
    Timer = create timer for 0 seconds
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    oWall = 0
    PlayerCatapult1 = 0
    PlayerPlatoonInRange = 0
    Number = 0
    NumPat1 = 0
    PlayerSettlement = 0
    PlayerCreature = 0
    AttackMode = 0
    Building = 0
    RecalculateTimer = create timer for 0 seconds

start

begin loop
    a = 1
    wait until LC8_Platoon[24] exists and LC8_SiegeCatapult[7] exists and LC8_Platoon[22] exists and ({LC8_SiegeCatapult[7]} near {JapaneseTown2} radius 300) and LC8_SiegeCatapult[8] exists and LC8_Platoon[23] exists and ({LC8_SiegeCatapult[8]} near {JapaneseTown2} radius 300)
    disable platoon LC8_Platoon[22] camp
    begin loop
        TestCreature2 = get distance from {LC8_Platoon[22]} to {oCreature}
        if TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC8_Platoon[22] can navigate to {oCreature}
            clear LC8_Platoon[22] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC8_Platoon[22] action queue
                NumPat5 = get number of villagers in platoon LC8_Platoon[22]
                TestCreature2 = get distance from {LC8_Platoon[22]} to {oCreature}
                until NumPat5 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC8_Platoon[22] can navigate to {oCreature} or TestCreature2 > 150
            end loop
        end if
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[22]} radius 150
        PlayerCatapult1 = get siege weapon of player 0 nearest {LC8_Platoon[22]} radius 100
        if PlayerPlatoon1 exists and LC8_Platoon[22] can navigate to {PlayerPlatoon1}
            clear LC8_Platoon[22] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC8_Platoon[22] action queue
                NumPat5 = get number of villagers in platoon LC8_Platoon[22]
                HeTeste3 = get number of villagers in platoon PlayerPlatoon1
                until NumPat5 == 0 or HeTeste3 == 0 or not LC8_Platoon[22] can navigate to {PlayerPlatoon1}
            end loop
        elsif PlayerCatapult1 exists and LC8_Platoon[22] can navigate to {PlayerCatapult1}
            clear LC8_Platoon[22] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using PlayerCatapult1 to LC8_Platoon[22] action queue
                NumPat5 = get number of villagers in platoon LC8_Platoon[22]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[22]} radius 150
                if PlayerPlatoon1 exists and LC8_Platoon[22] can navigate to {PlayerPlatoon1}
                    PlayerPlatoonInRange = 1
                end if
                until NumPat5 == 0 or PlayerCatapult1 not exists or not LC8_Platoon[22] can navigate to {PlayerCatapult1} or PlayerPlatoonInRange == 1
            end loop
            PlayerPlatoonInRange = 0
        end if
        PlayerSettlement = get nearest town at {LC8_Platoon[22]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0 and HEALTH of Armory == 1.0
            if LC8_Platoon[22] can navigate to object Armory
                if TownCapturePlatoons[2] < 2
                    TownCapturePlatoons[2]++
                    clear LC8_Platoon[22] action queue
                    set LC8_Platoon[22] attack PlayerSettlement with severity 0.3 for takeover
                    a = 1
                    begin loop
                        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[22]} radius 150
                        PlayerCreature = get distance from {LC8_Platoon[22]} to {oCreature}
                        if PlayerPlatoon1 exists
                            a = 0
                        elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                            a = 0
                        elsif not LC8_Platoon[22] can navigate to object Armory
                            a = 0
                        elsif LC8_Platoon[22] not exists
                            a = 0
                        end if
                        until a == 0 or LC8_Platoon[22] not exists or PLAYER of PlayerSettlement == 1
                    end loop
                    TownCapturePlatoons[2]--
                end if
                clear LC8_Platoon[22] action queue
            end if
        end if
        if LC8_SiegeCatapult[7] exists
            clear LC8_Platoon[22] action queue
            add action PLATOON_AGENDA_ACTION_DEFEND_OBJECT using LC8_SiegeCatapult[7] to LC8_Platoon[22] action queue
            begin loop
                TestCreature2 = get distance from {LC8_Platoon[22]} to {oCreature}
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[22]} radius 150
                PlayerSettlement = get nearest town at {LC8_Platoon[22]} for player 0 radius 500
                Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
                if Armory exists and HEALTH of Armory == 1.0 //Armory needs to exist, else game will crash
                    if PlayerSettlement == PlayerTown or not LC8_Platoon[22] can navigate to object Armory
                        PlayerSettlement = 0
                    end if
                end if
                until TestCreature2 <= 150 or PlayerPlatoon1 exists or LC8_Platoon[22] not exists or PlayerSettlement exists
            end loop
        end if
        until LC8_SiegeCatapult7IsAttacking == 1 or LC8_SiegeCatapult[7] not exists or LC8_Platoon[22] not exists
    end loop
    
    if LC8_SiegeCatapult[7] exists
        begin loop //Attack
            TestCreature2 = get distance from {LC8_Platoon[22]} to {oCreature}
            if TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC8_Platoon[22] can navigate to {oCreature}
                clear LC8_Platoon[22] action queue
                begin loop
                    add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC8_Platoon[22] action queue
                    NumPat5 = get number of villagers in platoon LC8_Platoon[22]
                    TestCreature2 = get distance from {LC8_Platoon[22]} to {oCreature}
                    until NumPat5 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC8_Platoon[22] can navigate to {oCreature} or TestCreature2 > 150
                end loop
            end if
            PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[22]} radius 150
            PlayerCatapult1 = get siege weapon of player 0 nearest {LC8_Platoon[22]} radius 100
            if PlayerPlatoon1 exists and LC8_Platoon[22] can navigate to {PlayerPlatoon1}
                clear LC8_Platoon[22] action queue
                begin loop
                    add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC8_Platoon[22] action queue
                    NumPat5 = get number of villagers in platoon LC8_Platoon[22]
                    HeTeste3 = get number of villagers in platoon PlayerPlatoon1
                    until NumPat5 == 0 or HeTeste3 == 0 or not LC8_Platoon[22] can navigate to {PlayerPlatoon1}
                end loop
            elsif PlayerCatapult1 exists and LC8_Platoon[22] can navigate to {PlayerCatapult1}
                clear LC8_Platoon[22] action queue
                begin loop
                    add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using PlayerCatapult1 to LC8_Platoon[22] action queue
                    NumPat5 = get number of villagers in platoon LC8_Platoon[22]
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[22]} radius 150
                    if PlayerPlatoon1 exists and LC8_Platoon[22] can navigate to {PlayerPlatoon1}
                        PlayerPlatoonInRange = 1
                    end if
                    until NumPat5 == 0 or PlayerCatapult1 not exists or not LC8_Platoon[22] can navigate to {PlayerCatapult1} or PlayerPlatoonInRange == 1
                end loop
                PlayerPlatoonInRange = 0
            end if
            PlayerSettlement = get nearest town at {LC8_Platoon[22]} for player 0 radius 500
            //Not a Armory, it's a towncentre.
            Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
            if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0 and HEALTH of Armory == 1.0
                if LC8_Platoon[22] can navigate to object Armory
                    if TownCapturePlatoons[2] < 2
                        TownCapturePlatoons[2]++
                        clear LC8_Platoon[22] action queue
                        set LC8_Platoon[22] attack PlayerSettlement with severity 0.3 for takeover
                        a = 1
                        begin loop
                            PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[22]} radius 150
                            PlayerCreature = get distance from {LC8_Platoon[22]} to {oCreature}
                            if PlayerPlatoon1 exists
                                a = 0
                            elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                                a = 0
                            elsif not LC8_Platoon[22] can navigate to object Armory
                                a = 0
                            elsif LC8_Platoon[22] not exists
                                a = 0
                            end if
                            until a == 0 or LC8_Platoon[22] not exists or PLAYER of PlayerSettlement == 1
                        end loop
                        TownCapturePlatoons[2]--
                    end if
                    clear LC8_Platoon[22] action queue
                end if
            end if
            if LC8_Platoon[22] can navigate to object oTownCentre and PLAYER of PlayerTown == 0
                wait number from 5 to 25 seconds
                a = 1
                clear LC8_Platoon[22] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC8_Platoon[22] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[22] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[22] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[22] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[22] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[22] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[22] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[0] < 2
                        TownCapturePlatoons[0]++
                        set LC8_Platoon[22] attack PlayerTown with severity 0.3 for takeover
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[22]} radius 150
                    TestCreature2 = get distance from {LC8_Platoon[22]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC8_Platoon[22]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC8_Platoon[22] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC8_Platoon[22] can navigate to object oTownCentre
                            a = 0
                        elsif LC8_Platoon[22] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC8_Platoon[22] not exists
                end loop
                if AttackMode == 0
                    TownCapturePlatoons[0]--
                end if
                clear LC8_Platoon[22] action queue
            elsif LC8_Platoon[22] can navigate to {AttackPos[0]}
                clear LC8_Platoon[22] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[0]} to LC8_Platoon[22] action queue
            else
                clear LC8_Platoon[22] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[1]} to LC8_Platoon[22] action queue
            end if
            until LC8_Platoon[22] not exists
        end loop
    else
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {SiegePlatoonPos[0]} to LC8_Platoon[22] action queue
    end if
    if LC8_Platoon[22] not exists
        //PlatoonKilled = 1
        wait until LC8_Platoon[22] exists
    end if
end loop

end script LC8_Platoon22Actions

begin script LC8_Platoon23Actions

    oCreature = get player 0 creature
    HeTeste3 = 0
    TestCreature2 = 0
    NumPat = 0
    NumPat5 = 0
    PlayerPlatoon1 = 0
    WorrNum = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    ProPlatoonsLocation = 0
    AIPlatoon1 = 0
    Armory = 0
    Town8 = get town with id 8
    RandomActionP3 = 0
    a = 1
    Timer = create timer for 0 seconds
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    oWall = 0
    PlayerCatapult1 = 0
    PlayerPlatoonInRange = 0
    Number = 0
    NumPat1 = 0
    PlayerSettlement = 0
    PlayerCreature = 0
    AttackMode = 0
    Building = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 1
    wait until LC8_Platoon[24] exists and LC8_SiegeCatapult[7] exists and LC8_Platoon[22] exists and ({LC8_SiegeCatapult[7]} near {JapaneseTown2} radius 300) and LC8_SiegeCatapult[8] exists and LC8_Platoon[23] exists and ({LC8_SiegeCatapult[8]} near {JapaneseTown2} radius 300)
    disable platoon LC8_Platoon[23] camp
    begin loop
        TestCreature2 = get distance from {LC8_Platoon[23]} to {oCreature}
        if TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC8_Platoon[23] can navigate to {oCreature}
            clear LC8_Platoon[23] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC8_Platoon[23] action queue
                NumPat5 = get number of villagers in platoon LC8_Platoon[23]
                TestCreature2 = get distance from {LC8_Platoon[23]} to {oCreature}
                until NumPat5 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC8_Platoon[23] can navigate to {oCreature} or TestCreature2 > 150
            end loop
        end if
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[23]} radius 150
        PlayerCatapult1 = get siege weapon of player 0 nearest {LC8_Platoon[23]} radius 100
        if PlayerPlatoon1 exists and LC8_Platoon[23] can navigate to {PlayerPlatoon1}
            clear LC8_Platoon[23] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC8_Platoon[23] action queue
                NumPat5 = get number of villagers in platoon LC8_Platoon[23]
                HeTeste3 = get number of villagers in platoon PlayerPlatoon1
                until NumPat5 == 0 or HeTeste3 == 0 or not LC8_Platoon[23] can navigate to {PlayerPlatoon1}
            end loop
        elsif PlayerCatapult1 exists and LC8_Platoon[23] can navigate to {PlayerCatapult1}
            clear LC8_Platoon[23] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using PlayerCatapult1 to LC8_Platoon[23] action queue
                NumPat5 = get number of villagers in platoon LC8_Platoon[23]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[23]} radius 150
                if PlayerPlatoon1 exists and LC8_Platoon[23] can navigate to {PlayerPlatoon1}
                    PlayerPlatoonInRange = 1
                end if
                until NumPat5 == 0 or PlayerCatapult1 not exists or not LC8_Platoon[23] can navigate to {PlayerCatapult1} or PlayerPlatoonInRange == 1
            end loop
            PlayerPlatoonInRange = 0
        end if
        PlayerSettlement = get nearest town at {LC8_Platoon[23]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0 and HEALTH of Armory == 1.0
            if LC8_Platoon[23] can navigate to object Armory
                if TownCapturePlatoons[2] < 2
                    TownCapturePlatoons[2]++
                    clear LC8_Platoon[23] action queue
                    set LC8_Platoon[23] attack PlayerSettlement with severity 0.3 for takeover
                    a = 1
                    begin loop
                        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[23]} radius 150
                        PlayerCreature = get distance from {LC8_Platoon[23]} to {oCreature}
                        if PlayerPlatoon1 exists
                            a = 0
                        elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                            a = 0
                        elsif not LC8_Platoon[23] can navigate to object Armory
                            a = 0
                        elsif LC8_Platoon[23] not exists
                            a = 0
                        end if
                        until a == 0 or LC8_Platoon[23] not exists or PLAYER of PlayerSettlement == 1
                    end loop
                    TownCapturePlatoons[2]--
                end if
                clear LC8_Platoon[23] action queue
            end if
        end if
        if LC8_SiegeCatapult[8] exists
            clear LC8_Platoon[23] action queue
            add action PLATOON_AGENDA_ACTION_DEFEND_OBJECT using LC8_SiegeCatapult[8] to LC8_Platoon[23] action queue
            begin loop
                TestCreature2 = get distance from {LC8_Platoon[23]} to {oCreature}
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[23]} radius 150
                PlayerSettlement = get nearest town at {LC8_Platoon[23]} for player 0 radius 500
                Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
                if Armory exists and HEALTH of Armory == 1.0 //Armory needs to exist, else game will crash
                    if PlayerSettlement == PlayerTown or not LC8_Platoon[23] can navigate to object Armory
                        PlayerSettlement = 0
                    end if
                end if
                until TestCreature2 <= 150 or PlayerPlatoon1 exists or LC8_Platoon[23] not exists or PlayerSettlement exists
            end loop
        end if
        until LC8_SiegeCatapult8IsAttacking == 1 or LC8_SiegeCatapult[8] not exists or LC8_Platoon[23] not exists
    end loop
    
    if LC8_SiegeCatapult[8] exists
        begin loop //Attack
            TestCreature2 = get distance from {LC8_Platoon[23]} to {oCreature}
            if TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC8_Platoon[23] can navigate to {oCreature}
                clear LC8_Platoon[23] action queue
                begin loop
                    add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC8_Platoon[23] action queue
                    NumPat5 = get number of villagers in platoon LC8_Platoon[23]
                    TestCreature2 = get distance from {LC8_Platoon[23]} to {oCreature}
                    until NumPat5 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC8_Platoon[23] can navigate to {oCreature} or TestCreature2 > 150
                end loop
            end if
            PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[23]} radius 150
            PlayerCatapult1 = get siege weapon of player 0 nearest {LC8_Platoon[23]} radius 100
            if PlayerPlatoon1 exists and LC8_Platoon[23] can navigate to {PlayerPlatoon1}
                clear LC8_Platoon[23] action queue
                begin loop
                    add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC8_Platoon[23] action queue
                    NumPat5 = get number of villagers in platoon LC8_Platoon[23]
                    HeTeste3 = get number of villagers in platoon PlayerPlatoon1
                    until NumPat5 == 0 or HeTeste3 == 0 or not LC8_Platoon[23] can navigate to {PlayerPlatoon1}
                end loop
            elsif PlayerCatapult1 exists and LC8_Platoon[23] can navigate to {PlayerCatapult1}
                clear LC8_Platoon[23] action queue
                begin loop
                    add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using PlayerCatapult1 to LC8_Platoon[23] action queue
                    NumPat5 = get number of villagers in platoon LC8_Platoon[23]
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[23]} radius 150
                    if PlayerPlatoon1 exists and LC8_Platoon[23] can navigate to {PlayerPlatoon1}
                        PlayerPlatoonInRange = 1
                    end if
                    until NumPat5 == 0 or PlayerCatapult1 not exists or not LC8_Platoon[23] can navigate to {PlayerCatapult1} or PlayerPlatoonInRange == 1
                end loop
                PlayerPlatoonInRange = 0
            end if
            PlayerSettlement = get nearest town at {LC8_Platoon[23]} for player 0 radius 500
            //Not a Armory, it's a towncentre.
            Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
            if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0 and HEALTH of Armory == 1.0
                if LC8_Platoon[23] can navigate to object Armory
                    if TownCapturePlatoons[2] < 2
                        TownCapturePlatoons[2]++
                        clear LC8_Platoon[23] action queue
                        set LC8_Platoon[23] attack PlayerSettlement with severity 0.3 for takeover
                        a = 1
                        begin loop
                            PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[23]} radius 150
                            PlayerCreature = get distance from {LC8_Platoon[23]} to {oCreature}
                            if PlayerPlatoon1 exists
                                a = 0
                            elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                                a = 0
                            elsif not LC8_Platoon[23] can navigate to object Armory
                                a = 0
                            elsif LC8_Platoon[23] not exists
                                a = 0
                            end if
                            until a == 0 or LC8_Platoon[23] not exists or PLAYER of PlayerSettlement == 1
                        end loop
                        TownCapturePlatoons[2]--
                    end if
                    clear LC8_Platoon[23] action queue
                end if
            end if
            if LC8_Platoon[23] can navigate to object oTownCentre and PLAYER of PlayerTown == 0
                wait number from 5 to 25 seconds
                a = 1
                clear LC8_Platoon[23] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC8_Platoon[23] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[23] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[23] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[23] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[23] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[23] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[23] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[0] < 2
                        TownCapturePlatoons[0]++
                        set LC8_Platoon[23] attack PlayerTown with severity 0.3 for takeover
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[23]} radius 150
                    TestCreature2 = get distance from {LC8_Platoon[23]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC8_Platoon[23]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC8_Platoon[23] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC8_Platoon[23] can navigate to object oTownCentre
                            a = 0
                        elsif LC8_Platoon[23] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC8_Platoon[23] not exists
                end loop
                if AttackMode == 0
                    TownCapturePlatoons[0]--
                end if
                clear LC8_Platoon[23] action queue
            elsif LC8_Platoon[23] can navigate to {AttackPos[0]} + {-30,0,10}
                clear LC8_Platoon[23] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[0]} + {-30,0,10} to LC8_Platoon[23] action queue
            else
                clear LC8_Platoon[23] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[1]} + {-30,0,10} to LC8_Platoon[23] action queue
            end if
            until LC8_Platoon[23] not exists
        end loop
    else
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {SiegePlatoonPos[0]} + {-10,0,-10} to LC8_Platoon[23] action queue
    end if
    if LC8_Platoon[23] not exists
        //PlatoonKilled = 1
        wait until LC8_Platoon[23] exists
    end if
end loop

end script LC8_Platoon23Actions

begin script LC8_Platoon24Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC8_Platoon[24] exists and LC8_SiegeCatapult[7] exists and LC8_Platoon[22] exists and ({LC8_SiegeCatapult[7]} near {JapaneseTown2} radius 300) and LC8_SiegeCatapult[8] exists and LC8_Platoon[23] exists and ({LC8_SiegeCatapult[8]} near {JapaneseTown2} radius 300)
    begin loop

        PlayerCreature = get distance from {LC8_Platoon[24]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC8_Platoon[24] can navigate to {oCreature}
            clear LC8_Platoon[24] action queue
            begin loop
                PlayerCreature = get distance from {LC8_Platoon[24]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK using oCreature to LC8_Platoon[24] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[24]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC8_Platoon[24] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC8_Platoon[24] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[24]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC8_Platoon[24]} radius 50
        if PlayerPlatoon1 exists and LC8_Platoon[24] can navigate to {PlayerPlatoon1}
            clear LC8_Platoon[24] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[24]} radius 150
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK using PlayerPlatoon1 to LC8_Platoon[24] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[24]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC8_Platoon[24] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC8_Platoon[24] action queue
        elsif Catapult exists and LC8_Platoon[24] can navigate to {Catapult}
            clear LC8_Platoon[24] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC8_Platoon[24]} radius 50
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK using Catapult to LC8_Platoon[24] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[24]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[24]} radius 150
                if PlayerPlatoon1 exists and LC8_Platoon[24] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC8_Platoon[24] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC8_Platoon[24] action queue
            a = 0
        end if

        PlayerSettlement = get nearest town at {LC8_Platoon[24]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0 and HEALTH of Armory == 1.0
            if LC8_Platoon[24] can navigate to object Armory
                if TownCapturePlatoons[2] < 2
                    TownCapturePlatoons[2]++
                    clear LC8_Platoon[24] action queue
                    set LC8_Platoon[24] attack PlayerSettlement with severity 0.3 for takeover
                    a = 1
                    begin loop
                        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[24]} radius 150
                        PlayerCreature = get distance from {LC8_Platoon[24]} to {oCreature}
                        if PlayerPlatoon1 exists
                            a = 0
                        elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                            a = 0
                        elsif not LC8_Platoon[24] can navigate to object Armory
                            a = 0
                        elsif LC8_Platoon[24] not exists
                            a = 0
                        end if
                        until a == 0 or LC8_Platoon[24] not exists or PLAYER of PlayerSettlement == 1
                    end loop
                    TownCapturePlatoons[2]--
                end if
                clear LC8_Platoon[24] action queue
            end if
        end if
        
        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in PlayerTown min built 1.0
        //if get size of LC8_Platoon[24] action queue < 1
            if LC8_Platoon[24] can navigate to object oTownCentre and PLAYER of PlayerTown == 0
                wait number from 5 to 25 seconds
                a = 1
                clear LC8_Platoon[24] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC8_Platoon[24] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[24] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[24] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[24] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[24] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[24] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[24] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[0] < 2
                        TownCapturePlatoons[0]++
                        set LC8_Platoon[24] attack PlayerTown with severity 0.3 for takeover
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[24]} radius 150
                    TestCreature2 = get distance from {LC8_Platoon[24]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC8_Platoon[24]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC8_Platoon[24] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC8_Platoon[24] can navigate to object oTownCentre
                            a = 0
                        elsif LC8_Platoon[24] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC8_Platoon[24] not exists
                end loop
                if AttackMode == 0
                    TownCapturePlatoons[0]--
                end if
                clear LC8_Platoon[24] action queue
            elsif LC8_Platoon[24] can navigate to {AttackPos[0]} + {20,0,-10}
                clear LC8_Platoon[24] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[0]} + {20,0,-10} to LC8_Platoon[24] action queue
            else
                clear LC8_Platoon[24] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[1]} + {20,0,-10} to LC8_Platoon[24] action queue
            end if
        //end if

        until LC8_Platoon[24] not exists
    end loop
    if LC8_Platoon[24] not exists
        //PlatoonKilled = 1
        wait until LC8_Platoon[24] exists
    end if
end loop

end script LC8_Platoon24Actions

begin script LC8_SiegeCatapult7Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = create timer for 0 seconds
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 0
    SiegeAttacking = 0
    SiegeStucked = 0
    LC8_SiegeCatapult7IsAttacking = 0
    wait until LC8_Platoon[24] exists and LC8_SiegeCatapult[7] exists and LC8_Platoon[22] exists and ({LC8_SiegeCatapult[7]} near {JapaneseTown2} radius 300) and LC8_SiegeCatapult[8] exists and LC8_Platoon[23] exists and ({LC8_SiegeCatapult[8]} near {JapaneseTown2} radius 300)
    wait 2 seconds
    begin loop
        PlayerCreature = get distance from {LC8_SiegeCatapult[7]} to {oCreature}
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_SiegeCatapult[7]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC8_SiegeCatapult[7]} radius 150
        
        if PlayerCreature > 10 and PlayerPlatoon1 not exists and Catapult not exists
            if PlayerPlatoon1 not exists
                a = 1
            elsif PlayerCreature > 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                a = 1
            elsif Catapult not exists
                a = 1
            end if
        end if
        
        if PlayerCreature <= 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
            clear siege weapon LC8_SiegeCatapult[7] action queue
            a = 0
        elsif PlayerPlatoon1 exists and LC8_SiegeCatapult[7] can navigate to {PlayerPlatoon1}
            clear siege weapon LC8_SiegeCatapult[7] action queue
            a = 0
        elsif Catapult exists and LC8_SiegeCatapult[7] can navigate to {Catapult}
            clear siege weapon LC8_SiegeCatapult[7] action queue
            a = 0
        elsif PointOn != 4 and a == 1
            begin loop
                if LC8_SiegeCatapult[7] exists 
                    if get SiegeOnPointTimer time remaining <= 0
                        SiegeWeaponPoint = marker at {LC8_SiegeCatapult[7]}
                        SiegeOnPointTimer = create timer for 160 seconds
                    elsif get SiegeOnPointTimer time remaining <= 5
                        if {LC8_SiegeCatapult[7]} near {SiegeWeaponPoint} radius 10
                            clear siege weapon LC8_SiegeCatapult[7] action queue
                            delete LC8_SiegeCatapult[7]
                            SiegeStucked = 1
                        end if
                    end if
                    if get CatapultMoveTimer1 time remaining <= 0
                        if get size of LC8_SiegeCatapult[7] action queue < 1

                            if PointOn == 0
                                if LC8_SiegeCatapult[7] can navigate to {SiegeRoute1[0]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute1[0]} to siege weapon LC8_SiegeCatapult[7] action queue
                                end if
                    
                            elsif PointOn == 1
                                if LC8_SiegeCatapult[7] can navigate to {SiegeRoute1[1]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute1[1]} to siege weapon LC8_SiegeCatapult[7] action queue
                                end if

                            elsif PointOn == 2
                                if LC8_SiegeCatapult[7] can navigate to {SiegeRoute1[2]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute1[2]} to siege weapon LC8_SiegeCatapult[7] action queue
                                end if

                            elsif PointOn == 3
                                if LC8_SiegeCatapult[7] can navigate to {SiegeRoute1[3]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute1[3]} to siege weapon LC8_SiegeCatapult[7] action queue
                                end if

                            CatapultMoveTimer1 = create timer for 10 seconds
                            
                            end if
                        end if
                    end if        

                    if {LC8_SiegeCatapult[7]} near {SiegeRoute1[0]} radius 15 and PointOn != 1 or 60 seconds
                        PointOn = 1
                    elsif {LC8_SiegeCatapult[7]} near {SiegeRoute1[1]} radius 15 and PointOn != 2 or 60 seconds
                        PointOn = 2
                    elsif {LC8_SiegeCatapult[7]} near {SiegeRoute1[2]} radius 15 and PointOn != 3 or 60 seconds
                        PointOn = 3
                    elsif {LC8_SiegeCatapult[7]} near {SiegeRoute1[3]} radius 15 and PointOn != 4 or 60 seconds
                        PointOn = 4
                    elsif not LC8_SiegeCatapult[7] can navigate to {SiegeRoute1[3]} and {LC8_SiegeCatapult[7]} near {SiegeRoute1[2]} radius 15 and PointOn != 4
                        PointOn = 4
                    end if
                end if
            until LC8_SiegeCatapult[7] not exists or PointOn == 4 or 180 seconds
            end loop
        end if
        
        until PointOn == 4 or LC8_SiegeCatapult[7] not exists or 180 seconds
    end loop

    wait 15 seconds
    
    LC8_SiegeCatapult7IsAttacking = 1
    
    wait 5 seconds

    enable siege weapon LC8_SiegeCatapult[7] auto attack

    begin loop
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 5
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get HOUSE GATEHOUSE at {LC8_SiegeCatapult[7]} radius 250
                if GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE_F at {LC8_SiegeCatapult[7]} radius 250
                end if
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon LC8_SiegeCatapult[7] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[7]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[7] action queue
                elsif GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE at {LC8_SiegeCatapult[7]} radius 750
                    if GateHouse not exists
                        GateHouse = get HOUSE GATEHOUSE_F at {LC8_SiegeCatapult[7]} radius 750
                    end if
                    clear siege weapon LC8_SiegeCatapult[7] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[7]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[7] action queue
                else
                    GateHouse = get random abode of type GATEHOUSE in town PlayerTown
                    if GateHouse not exists
                        GateHouse = get random abode of type GATEHOUSE_F in town PlayerTown
                    end if
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon LC8_SiegeCatapult[7] action queue
                        Target = marker at get target from {LC8_SiegeCatapult[7]} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[7] action queue
                    else
                        ActionTimer = create timer for 0.025 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {LC8_SiegeCatapult[7]} radius 750
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC8_SiegeCatapult[7] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[7]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC8_SiegeCatapult[7] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            else
                House = get building ALTAR in PlayerTown min built 0.75
                if House exists and PLAYER of House == 0 and LC8_SiegeCatapult[7] can navigate to object oTownCentre
                    clear siege weapon LC8_SiegeCatapult[7] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[7]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC8_SiegeCatapult[7] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            end if
        end if

        until LC8_SiegeCatapult[7] not exists
    end loop
    
    if SiegeAttacking == 1 and UnderAttack != 0
        UnderAttack = UnderAttack - 1
    end if

    if LC8_SiegeCatapult[7] not exists and SiegeStucked == 0
        //CatapultDestroyed = 1
    end if
    
end loop

end script LC8_SiegeCatapult7Actions

begin script LC8_SiegeCatapult8Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = create timer for 0 seconds
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 0
    SiegeAttacking = 0
    SiegeStucked = 0
    LC8_SiegeCatapult8IsAttacking = 0
    wait until LC8_Platoon[24] exists and LC8_SiegeCatapult[7] exists and LC8_Platoon[22] exists and ({LC8_SiegeCatapult[7]} near {JapaneseTown2} radius 300) and LC8_SiegeCatapult[8] exists and LC8_Platoon[23] exists and ({LC8_SiegeCatapult[8]} near {JapaneseTown2} radius 300)
    wait 2 seconds
    begin loop
        PlayerCreature = get distance from {LC8_SiegeCatapult[8]} to {oCreature}
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_SiegeCatapult[8]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC8_SiegeCatapult[8]} radius 150
        
        if PlayerCreature > 10 and PlayerPlatoon1 not exists and Catapult not exists
            if PlayerPlatoon1 not exists
                a = 1
            elsif PlayerCreature > 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                a = 1
            elsif Catapult not exists
                a = 1
            end if
        end if
        
        if PlayerCreature <= 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
            clear siege weapon LC8_SiegeCatapult[8] action queue
            a = 0
        elsif PlayerPlatoon1 exists and LC8_SiegeCatapult[8] can navigate to {PlayerPlatoon1}
            clear siege weapon LC8_SiegeCatapult[8] action queue
            a = 0
        elsif Catapult exists and LC8_SiegeCatapult[8] can navigate to {Catapult}
            clear siege weapon LC8_SiegeCatapult[8] action queue
            a = 0
        elsif PointOn != 4 and a == 1
            begin loop
                if LC8_SiegeCatapult[8] exists 
                    if get SiegeOnPointTimer time remaining <= 0
                        SiegeWeaponPoint = marker at {LC8_SiegeCatapult[8]}
                        SiegeOnPointTimer = create timer for 160 seconds
                    elsif get SiegeOnPointTimer time remaining <= 5
                        if {LC8_SiegeCatapult[8]} near {SiegeWeaponPoint} radius 10
                            clear siege weapon LC8_SiegeCatapult[8] action queue
                            delete LC8_SiegeCatapult[8]
                            SiegeStucked = 1
                        end if
                    end if
                    if get CatapultMoveTimer1 time remaining <= 0
                        if get size of LC8_SiegeCatapult[8] action queue < 1

                            if PointOn == 0
                                if LC8_SiegeCatapult[8] can navigate to {SiegeRoute1[0]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute1[0]} to siege weapon LC8_SiegeCatapult[8] action queue
                                end if
                    
                            elsif PointOn == 1
                                if LC8_SiegeCatapult[8] can navigate to {SiegeRoute1[1]} + {-10,0,10}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute1[1]} + {-10,0,10} to siege weapon LC8_SiegeCatapult[8] action queue
                                end if

                            elsif PointOn == 2
                                if LC8_SiegeCatapult[8] can navigate to {SiegeRoute1[2]} + {-20,0,10}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute1[2]} + {-20,0,10} to siege weapon LC8_SiegeCatapult[8] action queue
                                end if

                            elsif PointOn == 3
                                if LC8_SiegeCatapult[8] can navigate to {SiegeRoute1[3]} + {-30,0,10}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute1[3]} + {-30,0,10} to siege weapon LC8_SiegeCatapult[8] action queue
                                end if

                            CatapultMoveTimer1 = create timer for 10 seconds
                            
                            end if
                        end if
                    end if        

                    if {LC8_SiegeCatapult[8]} near {SiegeRoute1[0]} radius 15 and PointOn != 1 or 60 seconds
                        PointOn = 1
                    elsif {LC8_SiegeCatapult[8]} near {SiegeRoute1[1]} + {-10,0,10} radius 15 and PointOn != 2 or 60 seconds
                        PointOn = 2
                    elsif {LC8_SiegeCatapult[8]} near {SiegeRoute1[2]} + {-20,0,10} radius 15 and PointOn != 3 or 60 seconds
                        PointOn = 3
                    elsif {LC8_SiegeCatapult[8]} near {SiegeRoute1[3]} + {-30,0,10} radius 15 and PointOn != 4 or 60 seconds
                        PointOn = 4
                    elsif not LC8_SiegeCatapult[8] can navigate to {SiegeRoute1[3]} + {-30,0,10} and {LC8_SiegeCatapult[8]} near {SiegeRoute1[2]} + {-20,0,10} radius 15 and PointOn != 4
                        PointOn = 4
                    end if
                end if
            until LC8_SiegeCatapult[8] not exists or PointOn == 4 or 180 seconds
            end loop
        end if
        
        until PointOn == 4 or LC8_SiegeCatapult[8] not exists or 180 seconds
    end loop
    
    LC8_SiegeCatapult8IsAttacking = 1
    
    wait 5 seconds

    enable siege weapon LC8_SiegeCatapult[8] auto attack

    begin loop
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 5
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get HOUSE GATEHOUSE at {LC8_SiegeCatapult[8]} radius 250
                if GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE_F at {LC8_SiegeCatapult[8]} radius 250
                end if
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon LC8_SiegeCatapult[8] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[8]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[8] action queue
                elsif GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE at {LC8_SiegeCatapult[8]} radius 750
                    if GateHouse not exists
                        GateHouse = get HOUSE GATEHOUSE_F at {LC8_SiegeCatapult[8]} radius 750
                    end if
                    clear siege weapon LC8_SiegeCatapult[8] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[8]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[8] action queue
                else
                    GateHouse = get random abode of type GATEHOUSE in town PlayerTown
                    if GateHouse not exists
                        GateHouse = get random abode of type GATEHOUSE_F in town PlayerTown
                    end if
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon LC8_SiegeCatapult[8] action queue
                        Target = marker at get target from {LC8_SiegeCatapult[8]} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[8] action queue
                    else
                        ActionTimer = create timer for 0.025 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {LC8_SiegeCatapult[8]} radius 750
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC8_SiegeCatapult[8] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[8]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC8_SiegeCatapult[8] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            else
                House = get building ALTAR in PlayerTown min built 0.75
                if House exists and PLAYER of House == 0 and LC8_SiegeCatapult[8] can navigate to object oTownCentre
                    clear siege weapon LC8_SiegeCatapult[8] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[8]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC8_SiegeCatapult[8] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            end if
        end if

        until LC8_SiegeCatapult[8] not exists
    end loop
    
    if SiegeAttacking == 1 and UnderAttack != 0
        UnderAttack = UnderAttack - 1
    end if
    
    if LC8_SiegeCatapult[8] not exists and SiegeStucked == 0
        //CatapultDestroyed = 1
    end if

end loop

end script LC8_SiegeCatapult8Actions

begin script LC8_Platoon25Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC8_Platoon[25] exists
    begin loop

        PlayerCreature = get distance from {LC8_Platoon[25]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC8_Platoon[25] can navigate to {oCreature} and LC8_LargeSiegeLaunchAttack == 1
            clear LC8_Platoon[25] action queue
            begin loop
                PlayerCreature = get distance from {LC8_Platoon[25]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC8_Platoon[25] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[25]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC8_Platoon[25] can navigate to {oCreature} or PlayerCreature > 150 or LC8_LargeSiegeLaunchAttack == 0
            end loop
            clear LC8_Platoon[25] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[25]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC8_Platoon[25]} radius 50
        if PlayerPlatoon1 exists and LC8_Platoon[25] can navigate to {PlayerPlatoon1} and LC8_LargeSiegeLaunchAttack == 1
            clear LC8_Platoon[25] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[25]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC8_Platoon[25] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[25]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC8_Platoon[25] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists or LC8_LargeSiegeLaunchAttack == 0
            end loop
            clear LC8_Platoon[25] action queue
        elsif Catapult exists and LC8_Platoon[25] can navigate to {Catapult} and LC8_LargeSiegeLaunchAttack == 1
            clear LC8_Platoon[25] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC8_Platoon[25]} radius 50
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC8_Platoon[25] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[25]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[25]} radius 150
                if PlayerPlatoon1 exists and LC8_Platoon[25] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC8_Platoon[25] can navigate to {Catapult} or a == 1 or Catapult not exists or LC8_LargeSiegeLaunchAttack == 0
            end loop
            clear LC8_Platoon[25] action queue
            a = 0
        end if

        PlayerSettlement = get nearest town at {LC8_Platoon[25]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0 and LC8_LargeSiegeLaunchAttack == 1 and HEALTH of Armory == 1.0
            if LC8_Platoon[25] can navigate to object Armory
                if TownCapturePlatoons[2] < 2
                    TownCapturePlatoons[2]++
                    clear LC8_Platoon[25] action queue
                    set LC8_Platoon[25] attack PlayerSettlement with severity 0.3 for takeover
                    a = 1
                    begin loop
                        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[25]} radius 150
                        PlayerCreature = get distance from {LC8_Platoon[25]} to {oCreature}
                        if PlayerPlatoon1 exists
                            a = 0
                        elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                            a = 0
                        elsif not LC8_Platoon[25] can navigate to object Armory
                            a = 0
                        elsif LC8_Platoon[25] not exists
                            a = 0
                        end if
                        until a == 0 or LC8_Platoon[25] not exists or PLAYER of PlayerSettlement == 1
                    end loop
                    TownCapturePlatoons[2]--
                end if
                clear LC8_Platoon[25] action queue
            end if
        end if
        
        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in PlayerTown min built 1.0
        //if get size of LC8_Platoon[25] action queue < 1
            if LC8_Platoon[25] can navigate to object oTownCentre and LC8_LargeSiegeLaunchAttack == 1 and PLAYER of PlayerTown == 0
                wait number from 5 to 25 seconds
                a = 1
                clear LC8_Platoon[25] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC8_Platoon[25] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[25] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[25] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[25] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[25] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[25] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[25] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[0] < 2
                        TownCapturePlatoons[0]++
                        set LC8_Platoon[25] attack PlayerTown with severity 0.3 for takeover
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[25]} radius 150
                    TestCreature2 = get distance from {LC8_Platoon[25]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC8_Platoon[25]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC8_Platoon[25] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC8_Platoon[25] can navigate to object oTownCentre
                            a = 0
                        elsif LC8_Platoon[25] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC8_Platoon[25] not exists
                end loop
                if AttackMode == 0
                    TownCapturePlatoons[0]--
                end if
                clear LC8_Platoon[25] action queue
            elsif LC8_Platoon[25] can navigate to {LS_AttackPos[0]} and LC8_LargeSiegeLaunchAttack == 1
                clear LC8_Platoon[25] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {LS_AttackPos[0]} to LC8_Platoon[25] action queue
            elsif LC8_Platoon[25] can navigate to {LS_PrePos[0]} and LC8_LargeSiegeLaunchAttack == 0
                clear LC8_Platoon[25] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {LS_PrePos[0]} to LC8_Platoon[25] action queue
            end if
        //end if

        until LC8_Platoon[25] not exists
    end loop
    if LC8_Platoon[25] not exists
        //PlatoonKilled = 1
        wait until LC8_Platoon[25] exists
    end if
end loop

end script LC8_Platoon25Actions

begin script LC8_Platoon26Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC8_Platoon[26] exists
    begin loop

        PlayerCreature = get distance from {LC8_Platoon[26]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC8_Platoon[26] can navigate to {oCreature} and LC8_LargeSiegeLaunchAttack == 1
            clear LC8_Platoon[26] action queue
            begin loop
                PlayerCreature = get distance from {LC8_Platoon[26]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC8_Platoon[26] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[26]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC8_Platoon[26] can navigate to {oCreature} or PlayerCreature > 150 or LC8_LargeSiegeLaunchAttack == 0
            end loop
            clear LC8_Platoon[26] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[26]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC8_Platoon[26]} radius 50
        if PlayerPlatoon1 exists and LC8_Platoon[26] can navigate to {PlayerPlatoon1} and LC8_LargeSiegeLaunchAttack == 1
            clear LC8_Platoon[26] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[26]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC8_Platoon[26] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[26]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC8_Platoon[26] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists or LC8_LargeSiegeLaunchAttack == 0
            end loop
            clear LC8_Platoon[26] action queue
        elsif Catapult exists and LC8_Platoon[26] can navigate to {Catapult} and LC8_LargeSiegeLaunchAttack == 1
            clear LC8_Platoon[26] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC8_Platoon[26]} radius 50
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC8_Platoon[26] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[26]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[26]} radius 150
                if PlayerPlatoon1 exists and LC8_Platoon[26] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC8_Platoon[26] can navigate to {Catapult} or a == 1 or Catapult not exists or LC8_LargeSiegeLaunchAttack == 0
            end loop
            clear LC8_Platoon[26] action queue
            a = 0
        end if

        PlayerSettlement = get nearest town at {LC8_Platoon[26]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0 and LC8_LargeSiegeLaunchAttack == 1 and HEALTH of Armory == 1.0
            if LC8_Platoon[26] can navigate to object Armory
                if TownCapturePlatoons[2] < 2
                    TownCapturePlatoons[2]++
                    clear LC8_Platoon[26] action queue
                    set LC8_Platoon[26] attack PlayerSettlement with severity 0.3 for takeover
                    a = 1
                    begin loop
                        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[26]} radius 150
                        PlayerCreature = get distance from {LC8_Platoon[26]} to {oCreature}
                        if PlayerPlatoon1 exists
                            a = 0
                        elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                            a = 0
                        elsif not LC8_Platoon[26] can navigate to object Armory
                            a = 0
                        elsif LC8_Platoon[26] not exists
                            a = 0
                        end if
                        until a == 0 or LC8_Platoon[26] not exists or PLAYER of PlayerSettlement == 1
                    end loop
                    TownCapturePlatoons[2]--
                end if
                clear LC8_Platoon[26] action queue
            end if
        end if
        
        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in PlayerTown min built 1.0
        //if get size of LC8_Platoon[26] action queue < 1
            if LC8_Platoon[26] can navigate to object oTownCentre and LC8_LargeSiegeLaunchAttack == 1 and PLAYER of PlayerTown == 0
                wait number from 5 to 25 seconds
                a = 1
                clear LC8_Platoon[26] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC8_Platoon[26] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[26] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[26] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[26] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[26] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[26] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[26] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[0] < 2
                        TownCapturePlatoons[0]++
                        set LC8_Platoon[26] attack PlayerTown with severity 0.3 for takeover
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[26]} radius 150
                    TestCreature2 = get distance from {LC8_Platoon[26]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC8_Platoon[26]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC8_Platoon[26] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC8_Platoon[26] can navigate to object oTownCentre
                            a = 0
                        elsif LC8_Platoon[26] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC8_Platoon[26] not exists
                end loop
                if AttackMode == 0
                    TownCapturePlatoons[0]--
                end if
                clear LC8_Platoon[26] action queue
            elsif LC8_Platoon[26] can navigate to {LS_AttackPos[1]} and LC8_LargeSiegeLaunchAttack == 1
                clear LC8_Platoon[26] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {LS_AttackPos[1]} to LC8_Platoon[26] action queue
            elsif LC8_Platoon[26] can navigate to {LS_PrePos[1]} and LC8_LargeSiegeLaunchAttack == 0
                clear LC8_Platoon[26] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {LS_PrePos[1]} to LC8_Platoon[26] action queue
            end if
        //end if

        until LC8_Platoon[26] not exists
    end loop
    if LC8_Platoon[26] not exists
        //PlatoonKilled = 1
        wait until LC8_Platoon[26] exists
    end if
end loop

end script LC8_Platoon26Actions

begin script LC8_Platoon27Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC8_Platoon[27] exists
    begin loop

        PlayerCreature = get distance from {LC8_Platoon[27]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC8_Platoon[27] can navigate to {oCreature} and LC8_LargeSiegeLaunchAttack == 1
            clear LC8_Platoon[27] action queue
            begin loop
                PlayerCreature = get distance from {LC8_Platoon[27]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK using oCreature to LC8_Platoon[27] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[27]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC8_Platoon[27] can navigate to {oCreature} or PlayerCreature > 150 or LC8_LargeSiegeLaunchAttack == 0
            end loop
            clear LC8_Platoon[27] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[27]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC8_Platoon[27]} radius 50
        if PlayerPlatoon1 exists and LC8_Platoon[27] can navigate to {PlayerPlatoon1} and LC8_LargeSiegeLaunchAttack == 1
            clear LC8_Platoon[27] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[27]} radius 150
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK using PlayerPlatoon1 to LC8_Platoon[27] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[27]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC8_Platoon[27] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists or LC8_LargeSiegeLaunchAttack == 0
            end loop
            clear LC8_Platoon[27] action queue
        elsif Catapult exists and LC8_Platoon[27] can navigate to {Catapult} and LC8_LargeSiegeLaunchAttack == 1
            clear LC8_Platoon[27] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC8_Platoon[27]} radius 50
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK using Catapult to LC8_Platoon[27] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[27]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[27]} radius 150
                if PlayerPlatoon1 exists and LC8_Platoon[27] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC8_Platoon[27] can navigate to {Catapult} or a == 1 or Catapult not exists or LC8_LargeSiegeLaunchAttack == 0
            end loop
            clear LC8_Platoon[27] action queue
            a = 0
        end if
        
        PlayerSettlement = get nearest town at {LC8_Platoon[27]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0 and LC8_LargeSiegeLaunchAttack == 1 and HEALTH of Armory == 1.0
            if LC8_Platoon[27] can navigate to object Armory
                if TownCapturePlatoons[2] < 2
                    TownCapturePlatoons[2]++
                    clear LC8_Platoon[27] action queue
                    set LC8_Platoon[27] attack PlayerSettlement with severity 0.3 for takeover
                    a = 1
                    begin loop
                        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[27]} radius 150
                        PlayerCreature = get distance from {LC8_Platoon[27]} to {oCreature}
                        if PlayerPlatoon1 exists
                            a = 0
                        elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                            a = 0
                        elsif not LC8_Platoon[27] can navigate to object Armory
                            a = 0
                        elsif LC8_Platoon[27] not exists
                            a = 0
                        end if
                        until a == 0 or LC8_Platoon[27] not exists or PLAYER of PlayerSettlement == 1
                    end loop
                    TownCapturePlatoons[2]--
                end if
                clear LC8_Platoon[27] action queue
            end if
        end if

        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in PlayerTown min built 1.0
        //if get size of LC8_Platoon[27] action queue < 1
            if LC8_Platoon[27] can navigate to object oTownCentre and LC8_LargeSiegeLaunchAttack == 1 and PLAYER of PlayerTown == 0
                wait number from 5 to 25 seconds
                a = 1
                clear LC8_Platoon[27] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC8_Platoon[27] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[27] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[27] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[27] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[27] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[27] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[27] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[0] < 2
                        TownCapturePlatoons[0]++
                        set LC8_Platoon[27] attack PlayerTown with severity 0.3 for takeover
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[27]} radius 150
                    TestCreature2 = get distance from {LC8_Platoon[27]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC8_Platoon[27]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC8_Platoon[27] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC8_Platoon[27] can navigate to object oTownCentre
                            a = 0
                        elsif LC8_Platoon[27] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC8_Platoon[27] not exists
                end loop
                if AttackMode == 0
                    TownCapturePlatoons[0]--
                end if
                clear LC8_Platoon[27] action queue
            elsif LC8_Platoon[27] can navigate to {LS_AttackPos[2]} and LC8_LargeSiegeLaunchAttack == 1
                clear LC8_Platoon[27] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {LS_AttackPos[2]} to LC8_Platoon[27] action queue
            elsif LC8_Platoon[27] can navigate to {LS_PrePos[2]} and LC8_LargeSiegeLaunchAttack == 0
                clear LC8_Platoon[27] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {LS_PrePos[2]} to LC8_Platoon[27] action queue
            end if
        //end if

        until LC8_Platoon[27] not exists
    end loop
    if LC8_Platoon[27] not exists
        //PlatoonKilled = 1
        wait until LC8_Platoon[27] exists
    end if
end loop

end script LC8_Platoon27Actions

begin script LC8_Platoon28Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC8_Platoon[28] exists
    begin loop

        PlayerCreature = get distance from {LC8_Platoon[28]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC8_Platoon[28] can navigate to {oCreature} and LC8_LargeSiegeLaunchAttack == 1
            clear LC8_Platoon[28] action queue
            begin loop
                PlayerCreature = get distance from {LC8_Platoon[28]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK using oCreature to LC8_Platoon[28] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[28]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC8_Platoon[28] can navigate to {oCreature} or PlayerCreature > 150 or LC8_LargeSiegeLaunchAttack == 0
            end loop
            clear LC8_Platoon[28] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[28]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC8_Platoon[28]} radius 50
        if PlayerPlatoon1 exists and LC8_Platoon[28] can navigate to {PlayerPlatoon1} and LC8_LargeSiegeLaunchAttack == 1
            clear LC8_Platoon[28] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[28]} radius 150
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK using PlayerPlatoon1 to LC8_Platoon[28] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[28]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC8_Platoon[28] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists or LC8_LargeSiegeLaunchAttack == 0
            end loop
            clear LC8_Platoon[28] action queue
        elsif Catapult exists and LC8_Platoon[28] can navigate to {Catapult} and LC8_LargeSiegeLaunchAttack == 1
            clear LC8_Platoon[28] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC8_Platoon[28]} radius 50
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK using Catapult to LC8_Platoon[28] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[28]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[28]} radius 150
                if PlayerPlatoon1 exists and LC8_Platoon[28] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC8_Platoon[28] can navigate to {Catapult} or a == 1 or Catapult not exists or LC8_LargeSiegeLaunchAttack == 0
            end loop
            clear LC8_Platoon[28] action queue
            a = 0
        end if

        PlayerSettlement = get nearest town at {LC8_Platoon[28]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0 and LC8_LargeSiegeLaunchAttack == 1 and HEALTH of Armory == 1.0
            if LC8_Platoon[28] can navigate to object Armory
                if TownCapturePlatoons[2] < 2
                    TownCapturePlatoons[2]++
                    clear LC8_Platoon[28] action queue
                    set LC8_Platoon[28] attack PlayerSettlement with severity 0.3 for takeover
                    a = 1
                    begin loop
                        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[28]} radius 150
                        PlayerCreature = get distance from {LC8_Platoon[28]} to {oCreature}
                        if PlayerPlatoon1 exists
                            a = 0
                        elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                            a = 0
                        elsif not LC8_Platoon[28] can navigate to object Armory
                            a = 0
                        elsif LC8_Platoon[28] not exists
                            a = 0
                        end if
                        until a == 0 or LC8_Platoon[28] not exists or PLAYER of PlayerSettlement == 1
                    end loop
                    TownCapturePlatoons[2]--
                end if
                clear LC8_Platoon[28] action queue
            end if
        end if
        
        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in PlayerTown min built 1.0
        //if get size of LC8_Platoon[28] action queue < 1
            if LC8_Platoon[28] can navigate to object oTownCentre and LC8_LargeSiegeLaunchAttack == 1 and PLAYER of PlayerTown == 0
                wait number from 5 to 25 seconds
                a = 1
                clear LC8_Platoon[28] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC8_Platoon[28] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[28] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[28] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[28] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[28] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[28] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[28] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[0] < 2
                        TownCapturePlatoons[0]++
                        set LC8_Platoon[28] attack PlayerTown with severity 0.3 for takeover
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[28]} radius 150
                    TestCreature2 = get distance from {LC8_Platoon[28]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC8_Platoon[28]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC8_Platoon[28] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC8_Platoon[28] can navigate to object oTownCentre
                            a = 0
                        elsif LC8_Platoon[28] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC8_Platoon[28] not exists
                end loop
                if AttackMode == 0
                    TownCapturePlatoons[0]--
                end if
                clear LC8_Platoon[28] action queue
            elsif LC8_Platoon[28] can navigate to {LS_AttackPos[3]} and LC8_LargeSiegeLaunchAttack == 1
                clear LC8_Platoon[28] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {LS_AttackPos[3]} to LC8_Platoon[28] action queue
            elsif LC8_Platoon[28] can navigate to {LS_PrePos[3]} and LC8_LargeSiegeLaunchAttack == 0
                clear LC8_Platoon[28] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {LS_PrePos[3]} to LC8_Platoon[28] action queue
            end if
        //end if

        until LC8_Platoon[28] not exists
    end loop
    if LC8_Platoon[28] not exists
        //PlatoonKilled = 1
        wait until LC8_Platoon[28] exists
    end if
end loop

end script LC8_Platoon28Actions

begin script LC8_Platoon29Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC8_Platoon[29] exists
    begin loop

        PlayerCreature = get distance from {LC8_Platoon[29]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC8_Platoon[29] can navigate to {oCreature} and LC8_LargeSiegeLaunchAttack == 1
            clear LC8_Platoon[29] action queue
            begin loop
                PlayerCreature = get distance from {LC8_Platoon[29]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC8_Platoon[29] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[29]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC8_Platoon[29] can navigate to {oCreature} or PlayerCreature > 150 or LC8_LargeSiegeLaunchAttack == 0
            end loop
            clear LC8_Platoon[29] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[29]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC8_Platoon[29]} radius 50
        if PlayerPlatoon1 exists and LC8_Platoon[29] can navigate to {PlayerPlatoon1} and LC8_LargeSiegeLaunchAttack == 1
            clear LC8_Platoon[29] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[29]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC8_Platoon[29] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[29]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC8_Platoon[29] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists or LC8_LargeSiegeLaunchAttack == 0
            end loop
            clear LC8_Platoon[29] action queue
        elsif Catapult exists and LC8_Platoon[29] can navigate to {Catapult} and LC8_LargeSiegeLaunchAttack == 1
            clear LC8_Platoon[29] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC8_Platoon[29]} radius 50
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC8_Platoon[29] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[29]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[29]} radius 150
                if PlayerPlatoon1 exists and LC8_Platoon[29] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC8_Platoon[29] can navigate to {Catapult} or a == 1 or Catapult not exists or LC8_LargeSiegeLaunchAttack == 0
            end loop
            clear LC8_Platoon[29] action queue
            a = 0
        end if

        PlayerSettlement = get nearest town at {LC8_Platoon[29]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0 
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0 and LC8_LargeSiegeLaunchAttack == 1 and HEALTH of Armory == 1.0
            if LC8_Platoon[29] can navigate to object Armory
                if TownCapturePlatoons[2] < 2
                    TownCapturePlatoons[2]++
                    clear LC8_Platoon[29] action queue
                    set LC8_Platoon[29] attack PlayerSettlement with severity 0.3 for takeover
                    a = 1
                    begin loop
                        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[29]} radius 150
                        PlayerCreature = get distance from {LC8_Platoon[29]} to {oCreature}
                        if PlayerPlatoon1 exists
                            a = 0
                        elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                            a = 0
                        elsif not LC8_Platoon[29] can navigate to object Armory
                            a = 0
                        elsif LC8_Platoon[29] not exists
                            a = 0
                        end if
                        until a == 0 or LC8_Platoon[29] not exists or PLAYER of PlayerSettlement == 1
                    end loop
                    TownCapturePlatoons[2]--
                end if
                clear LC8_Platoon[29] action queue
            end if
        end if
        
        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in PlayerTown min built 1.0
        //if get size of LC8_Platoon[29] action queue < 1
            if LC8_Platoon[29] can navigate to object oTownCentre and LC8_LargeSiegeLaunchAttack == 1 and PLAYER of PlayerTown == 0
                wait number from 5 to 25 seconds
                a = 1
                clear LC8_Platoon[29] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC8_Platoon[29] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[29] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[29] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[29] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[29] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[29] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[29] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[0] < 2
                        TownCapturePlatoons[0]++
                        set LC8_Platoon[29] attack PlayerTown with severity 0.3 for takeover
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[29]} radius 150
                    TestCreature2 = get distance from {LC8_Platoon[29]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC8_Platoon[29]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC8_Platoon[29] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC8_Platoon[29] can navigate to object oTownCentre
                            a = 0
                        elsif LC8_Platoon[29] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC8_Platoon[29] not exists
                end loop
                if AttackMode == 0
                    TownCapturePlatoons[0]--
                end if
                clear LC8_Platoon[29] action queue
            elsif LC8_Platoon[29] can navigate to {LS_AttackPos[4]} and LC8_LargeSiegeLaunchAttack == 1
                clear LC8_Platoon[29] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {LS_AttackPos[4]} to LC8_Platoon[29] action queue
            elsif LC8_Platoon[29] can navigate to {LS_PrePos[4]} and LC8_LargeSiegeLaunchAttack == 0
                clear LC8_Platoon[29] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {LS_PrePos[4]} to LC8_Platoon[29] action queue
            end if
        //end if

        until LC8_Platoon[29] not exists
    end loop
    if LC8_Platoon[29] not exists
        //PlatoonKilled = 1
        wait until LC8_Platoon[29] exists
    end if
end loop

end script LC8_Platoon29Actions

begin script LC8_Platoon30Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC8_Platoon[30] exists
    begin loop

        PlayerCreature = get distance from {LC8_Platoon[30]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC8_Platoon[30] can navigate to {oCreature} and LC8_LargeSiegeLaunchAttack == 1
            clear LC8_Platoon[30] action queue
            begin loop
                PlayerCreature = get distance from {LC8_Platoon[30]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC8_Platoon[30] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[30]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC8_Platoon[30] can navigate to {oCreature} or PlayerCreature > 150 or LC8_LargeSiegeLaunchAttack == 0
            end loop
            clear LC8_Platoon[30] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[30]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC8_Platoon[30]} radius 50
        if PlayerPlatoon1 exists and LC8_Platoon[30] can navigate to {PlayerPlatoon1} and LC8_LargeSiegeLaunchAttack == 1
            clear LC8_Platoon[30] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[30]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC8_Platoon[30] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[30]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC8_Platoon[30] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists or LC8_LargeSiegeLaunchAttack == 0
            end loop
            clear LC8_Platoon[30] action queue
        elsif Catapult exists and LC8_Platoon[30] can navigate to {Catapult} and LC8_LargeSiegeLaunchAttack == 1
            clear LC8_Platoon[30] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC8_Platoon[30]} radius 50
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC8_Platoon[30] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[30]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[30]} radius 150
                if PlayerPlatoon1 exists and LC8_Platoon[30] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC8_Platoon[30] can navigate to {Catapult} or a == 1 or Catapult not exists or LC8_LargeSiegeLaunchAttack == 0
            end loop
            clear LC8_Platoon[30] action queue
            a = 0
        end if

        PlayerSettlement = get nearest town at {LC8_Platoon[30]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0 and LC8_LargeSiegeLaunchAttack == 1 and HEALTH of Armory == 1.0
            if LC8_Platoon[30] can navigate to object Armory
                if TownCapturePlatoons[1] < 2
                    TownCapturePlatoons[1]++
                    clear LC8_Platoon[30] action queue
                    set LC8_Platoon[30] attack PlayerSettlement with severity 0.3 for takeover
                    a = 1
                    begin loop
                        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[30]} radius 150
                        PlayerCreature = get distance from {LC8_Platoon[30]} to {oCreature}
                        if PlayerPlatoon1 exists
                            a = 0
                        elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                            a = 0
                        elsif not LC8_Platoon[30] can navigate to object Armory
                            a = 0
                        elsif LC8_Platoon[30] not exists
                            a = 0
                        end if
                        until a == 0 or LC8_Platoon[30] not exists or PLAYER of PlayerSettlement == 1
                    end loop
                    TownCapturePlatoons[1]--
                end if
                clear LC8_Platoon[30] action queue
            end if
        end if
        
        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in PlayerTown min built 1.0
        //if get size of LC8_Platoon[30] action queue < 1
            if LC8_Platoon[30] can navigate to object oTownCentre and LC8_LargeSiegeLaunchAttack == 1 and PLAYER of PlayerTown == 0
                wait number from 5 to 25 seconds
                a = 1
                clear LC8_Platoon[30] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC8_Platoon[30] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[30] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[30] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[30] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[30] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[30] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[30] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[0] < 2
                        TownCapturePlatoons[0]++
                        set LC8_Platoon[30] attack PlayerTown with severity 0.3 for takeover
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[30]} radius 150
                    TestCreature2 = get distance from {LC8_Platoon[30]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC8_Platoon[30]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC8_Platoon[30] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC8_Platoon[30] can navigate to object oTownCentre
                            a = 0
                        elsif LC8_Platoon[30] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC8_Platoon[30] not exists
                end loop
                if AttackMode == 0
                    TownCapturePlatoons[0]--
                end if
                clear LC8_Platoon[30] action queue
            elsif LC8_Platoon[30] can navigate to {LS_AttackPos[5]} and LC8_LargeSiegeLaunchAttack == 1
                clear LC8_Platoon[30] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {LS_AttackPos[5]} to LC8_Platoon[30] action queue
            elsif LC8_Platoon[30] can navigate to {LS_PrePos[5]} and LC8_LargeSiegeLaunchAttack == 0
                clear LC8_Platoon[30] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {LS_PrePos[5]} to LC8_Platoon[30] action queue
            end if
        //end if

        until LC8_Platoon[30] not exists
    end loop
    if LC8_Platoon[30] not exists
        //PlatoonKilled = 1
        wait until LC8_Platoon[30] exists
    end if
end loop

end script LC8_Platoon30Actions

begin script LC8_Platoon31Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC8_Platoon[31] exists
    begin loop

        PlayerCreature = get distance from {LC8_Platoon[31]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC8_Platoon[31] can navigate to {oCreature} and LC8_LargeSiegeLaunchAttack == 1
            clear LC8_Platoon[31] action queue
            begin loop
                PlayerCreature = get distance from {LC8_Platoon[31]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC8_Platoon[31] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[31]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC8_Platoon[31] can navigate to {oCreature} or PlayerCreature > 150 or LC8_LargeSiegeLaunchAttack == 0
            end loop
            clear LC8_Platoon[31] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[31]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC8_Platoon[31]} radius 50
        if PlayerPlatoon1 exists and LC8_Platoon[31] can navigate to {PlayerPlatoon1} and LC8_LargeSiegeLaunchAttack == 1
            clear LC8_Platoon[31] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[31]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC8_Platoon[31] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[31]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC8_Platoon[31] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists or LC8_LargeSiegeLaunchAttack == 0
            end loop
            clear LC8_Platoon[31] action queue
        elsif Catapult exists and LC8_Platoon[31] can navigate to {Catapult} and LC8_LargeSiegeLaunchAttack == 1
            clear LC8_Platoon[31] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC8_Platoon[31]} radius 50
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC8_Platoon[31] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[31]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[31]} radius 150
                if PlayerPlatoon1 exists and LC8_Platoon[31] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC8_Platoon[31] can navigate to {Catapult} or a == 1 or Catapult not exists or LC8_LargeSiegeLaunchAttack == 0
            end loop
            clear LC8_Platoon[31] action queue
            a = 0
        end if
        
        PlayerSettlement = get nearest town at {LC8_Platoon[31]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0 and LC8_LargeSiegeLaunchAttack == 1 and HEALTH of Armory == 1.0
            if LC8_Platoon[31] can navigate to object Armory
                if TownCapturePlatoons[1] < 2
                    TownCapturePlatoons[1]++
                    clear LC8_Platoon[31] action queue
                    set LC8_Platoon[31] attack PlayerSettlement with severity 0.3 for takeover
                    a = 1
                    begin loop
                        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[31]} radius 150
                        PlayerCreature = get distance from {LC8_Platoon[31]} to {oCreature}
                        if PlayerPlatoon1 exists
                            a = 0
                        elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                            a = 0
                        elsif not LC8_Platoon[31] can navigate to object Armory
                            a = 0
                        elsif LC8_Platoon[31] not exists
                            a = 0
                        end if
                        until a == 0 or LC8_Platoon[31] not exists or PLAYER of PlayerSettlement == 1
                    end loop
                    TownCapturePlatoons[1]--
                end if
                clear LC8_Platoon[31] action queue
            end if
        end if

        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in PlayerTown min built 1.0
        //if get size of LC8_Platoon[31] action queue < 1
            if LC8_Platoon[31] can navigate to object oTownCentre and LC8_LargeSiegeLaunchAttack == 1 and PLAYER of PlayerTown == 0
                wait number from 5 to 25 seconds
                a = 1
                clear LC8_Platoon[31] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC8_Platoon[31] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[31] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[31] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[31] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[31] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[31] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[31] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[0] < 2
                        TownCapturePlatoons[0]++
                        set LC8_Platoon[31] attack PlayerTown with severity 0.3 for takeover
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[31]} radius 150
                    TestCreature2 = get distance from {LC8_Platoon[31]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC8_Platoon[31]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC8_Platoon[31] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC8_Platoon[31] can navigate to object oTownCentre
                            a = 0
                        elsif LC8_Platoon[31] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC8_Platoon[31] not exists
                end loop
                if AttackMode == 0
                    TownCapturePlatoons[0]--
                end if
                clear LC8_Platoon[31] action queue
            elsif LC8_Platoon[31] can navigate to {LS_AttackPos[6]} and LC8_LargeSiegeLaunchAttack == 1
                clear LC8_Platoon[31] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {LS_AttackPos[6]} to LC8_Platoon[31] action queue
            elsif LC8_Platoon[31] can navigate to {LS_PrePos[6]} and LC8_LargeSiegeLaunchAttack == 0
                clear LC8_Platoon[31] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {LS_PrePos[6]} to LC8_Platoon[31] action queue
            end if
        //end if

        until LC8_Platoon[31] not exists
    end loop
    if LC8_Platoon[31] not exists
        //PlatoonKilled = 1
        wait until LC8_Platoon[31] exists
    end if
end loop

end script LC8_Platoon31Actions

begin script LC8_SiegeCatapult9Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = create timer for 0 seconds
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 0
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC8_SiegeCatapult[9] exists
    wait 2 seconds
    begin loop
        PlayerCreature = get distance from {LC8_SiegeCatapult[9]} to {oCreature}
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_SiegeCatapult[9]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC8_SiegeCatapult[9]} radius 150
        
        if PlayerCreature > 10 and PlayerPlatoon1 not exists and Catapult not exists
            if PlayerPlatoon1 not exists
                a = 1
            elsif PlayerCreature > 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                a = 1
            elsif Catapult not exists
                a = 1
            end if
        end if
        
        if PlayerCreature <= 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
            clear siege weapon LC8_SiegeCatapult[9] action queue
            a = 0
        elsif PlayerPlatoon1 exists and LC8_SiegeCatapult[9] can navigate to {PlayerPlatoon1}
            clear siege weapon LC8_SiegeCatapult[9] action queue
            a = 0
        elsif Catapult exists and LC8_SiegeCatapult[9] can navigate to {Catapult}
            clear siege weapon LC8_SiegeCatapult[9] action queue
            a = 0
        elsif PointOn != 3 and a == 1
            begin loop
                if LC8_SiegeCatapult[9] exists 
                    if get SiegeOnPointTimer time remaining <= 0 and LC8_LargeSiegeLaunchAttack == 1
                        SiegeWeaponPoint = marker at {LC8_SiegeCatapult[9]}
                        SiegeOnPointTimer = create timer for 160 seconds
                    elsif get SiegeOnPointTimer time remaining <= 5 and LC8_LargeSiegeLaunchAttack == 1
                        if {LC8_SiegeCatapult[9]} near {SiegeWeaponPoint} radius 10
                            clear siege weapon LC8_SiegeCatapult[9] action queue
                            delete LC8_SiegeCatapult[9]
                            SiegeStucked = 1
                        end if
                    end if
                    if get CatapultMoveTimer1 time remaining <= 0
                        if get size of LC8_SiegeCatapult[9] action queue < 1

                            if PointOn == 0
                                if LC8_SiegeCatapult[9] can navigate to {LS_SiegeRoute1[0]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {LS_SiegeRoute1[0]} to siege weapon LC8_SiegeCatapult[9] action queue
                                end if
                    
                            elsif PointOn == 1
                                if LC8_SiegeCatapult[9] can navigate to {LS_SiegeRoute1[1]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {LS_SiegeRoute1[1]} to siege weapon LC8_SiegeCatapult[9] action queue
                                end if

                            elsif PointOn == 2 and LC8_LargeSiegeLaunchAttack == 1
                                if LC8_SiegeCatapult[9] can navigate to {LS_SiegeRoute1[2]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {LS_SiegeRoute1[2]} to siege weapon LC8_SiegeCatapult[9] action queue
                                end if

                            CatapultMoveTimer1 = create timer for 10 seconds
                            
                            end if
                        end if
                    end if        

                    if {LC8_SiegeCatapult[9]} near {LS_SiegeRoute1[0]} radius 15 and PointOn != 1 or 60 seconds
                        PointOn = 1
                    elsif {LC8_SiegeCatapult[9]} near {LS_SiegeRoute1[1]} radius 15 and PointOn != 2 or 60 seconds
                        PointOn = 2
                    elsif {LC8_SiegeCatapult[9]} near {LS_SiegeRoute1[2]} radius 15 and PointOn != 3 and LC8_LargeSiegeLaunchAttack == 1 or 60 seconds
                        PointOn = 3
                    elsif not LC8_SiegeCatapult[9] can navigate to {LS_SiegeRoute1[2]} and {LC8_SiegeCatapult[9]} near {LS_SiegeRoute1[1]} radius 15 and PointOn != 3 and LC8_LargeSiegeLaunchAttack == 1
                        PointOn = 3
                    end if
                end if
            until LC8_SiegeCatapult[9] not exists or PointOn == 3 or 180 seconds
            end loop
        end if
        
        until PointOn == 3 or LC8_SiegeCatapult[9] not exists or 180 seconds
    end loop

    wait 5 seconds

    enable siege weapon LC8_SiegeCatapult[9] auto attack

    begin loop
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 5
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get HOUSE GATEHOUSE at {LC8_SiegeCatapult[9]} radius 250
                if GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE_F at {LC8_SiegeCatapult[9]} radius 250
                end if
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon LC8_SiegeCatapult[9] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[9]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[9] action queue
                elsif GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE at {LC8_SiegeCatapult[9]} radius 750
                    if GateHouse not exists
                        GateHouse = get HOUSE GATEHOUSE_F at {LC8_SiegeCatapult[9]} radius 750
                    end if
                    clear siege weapon LC8_SiegeCatapult[9] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[9]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[9] action queue
                else
                    GateHouse = get random abode of type GATEHOUSE in town PlayerTown
                    if GateHouse not exists
                        GateHouse = get random abode of type GATEHOUSE_F in town PlayerTown
                    end if
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon LC8_SiegeCatapult[9] action queue
                        Target = marker at get target from {LC8_SiegeCatapult[9]} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[9] action queue
                    else
                        ActionTimer = create timer for 0.025 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {LC8_SiegeCatapult[9]} radius 750
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC8_SiegeCatapult[9] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[9]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC8_SiegeCatapult[9] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            else
                House = get building ALTAR in PlayerTown min built 0.75
                if House exists and PLAYER of House == 0 and LC8_SiegeCatapult[9] can navigate to object oTownCentre
                    clear siege weapon LC8_SiegeCatapult[9] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[9]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC8_SiegeCatapult[9] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            end if
        end if

        until LC8_SiegeCatapult[9] not exists
    end loop
    
    if SiegeAttacking == 1 and UnderAttack != 0
        UnderAttack = UnderAttack - 1
    end if

    if LC8_SiegeCatapult[9] not exists and SiegeStucked == 0
        //CatapultDestroyed = 1
    end if
    
end loop

end script LC8_SiegeCatapult9Actions

begin script LC8_SiegeCatapult10Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = create timer for 0 seconds
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 0
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC8_SiegeCatapult[10] exists
    wait 2 seconds
    begin loop
        PlayerCreature = get distance from {LC8_SiegeCatapult[10]} to {oCreature}
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_SiegeCatapult[10]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC8_SiegeCatapult[10]} radius 150
        
        if PlayerCreature > 10 and PlayerPlatoon1 not exists and Catapult not exists
            if PlayerPlatoon1 not exists
                a = 1
            elsif PlayerCreature > 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                a = 1
            elsif Catapult not exists
                a = 1
            end if
        end if
        
        if PlayerCreature <= 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
            clear siege weapon LC8_SiegeCatapult[10] action queue
            a = 0
        elsif PlayerPlatoon1 exists and LC8_SiegeCatapult[10] can navigate to {PlayerPlatoon1}
            clear siege weapon LC8_SiegeCatapult[10] action queue
            a = 0
        elsif Catapult exists and LC8_SiegeCatapult[10] can navigate to {Catapult}
            clear siege weapon LC8_SiegeCatapult[10] action queue
            a = 0
        elsif PointOn != 3 and a == 1
            begin loop
                if LC8_SiegeCatapult[10] exists
                    if get SiegeOnPointTimer time remaining <= 0 and LC8_LargeSiegeLaunchAttack == 1
                        SiegeWeaponPoint = marker at {LC8_SiegeCatapult[10]}
                        SiegeOnPointTimer = create timer for 160 seconds
                    elsif get SiegeOnPointTimer time remaining <= 5 and LC8_LargeSiegeLaunchAttack == 1
                        if {LC8_SiegeCatapult[10]} near {SiegeWeaponPoint} radius 10
                            clear siege weapon LC8_SiegeCatapult[10] action queue
                            delete LC8_SiegeCatapult[10]
                            SiegeStucked = 1
                        end if
                    end if
                    if get CatapultMoveTimer1 time remaining <= 0
                        if get size of LC8_SiegeCatapult[10] action queue < 1

                            if PointOn == 0
                                if LC8_SiegeCatapult[10] can navigate to {LS_SiegeRoute2[0]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {LS_SiegeRoute2[0]} to siege weapon LC8_SiegeCatapult[10] action queue
                                end if
                    
                            elsif PointOn == 1
                                if LC8_SiegeCatapult[10] can navigate to {LS_SiegeRoute2[1]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {LS_SiegeRoute2[1]} to siege weapon LC8_SiegeCatapult[10] action queue
                                end if

                            elsif PointOn == 2 and LC8_LargeSiegeLaunchAttack == 1
                                if LC8_SiegeCatapult[10] can navigate to {LS_SiegeRoute2[2]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {LS_SiegeRoute2[2]} to siege weapon LC8_SiegeCatapult[10] action queue
                                end if

                            CatapultMoveTimer1 = create timer for 10 seconds
                            
                            end if
                        end if
                    end if        

                    if {LC8_SiegeCatapult[10]} near {LS_SiegeRoute2[0]} radius 15 and PointOn != 1 or 60 seconds
                        PointOn = 1
                    elsif {LC8_SiegeCatapult[10]} near {LS_SiegeRoute2[1]} radius 15 and PointOn != 2 or 60 seconds
                        PointOn = 2
                    elsif {LC8_SiegeCatapult[10]} near {LS_SiegeRoute2[2]} radius 15 and PointOn != 3 and LC8_LargeSiegeLaunchAttack == 1 or 60 seconds
                        PointOn = 3
                    elsif not LC8_SiegeCatapult[10] can navigate to {LS_SiegeRoute2[2]} and {LC8_SiegeCatapult[10]} near {LS_SiegeRoute2[1]} radius 15 and PointOn != 3 and LC8_LargeSiegeLaunchAttack == 1
                        PointOn = 3
                    end if
                end if
            until LC8_SiegeCatapult[10] not exists or PointOn == 3 or 180 seconds
            end loop
        end if
        
        until PointOn == 3 or LC8_SiegeCatapult[10] not exists or 180 seconds
    end loop

    wait 5 seconds

    enable siege weapon LC8_SiegeCatapult[10] auto attack

    begin loop
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 5
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get HOUSE GATEHOUSE at {LC8_SiegeCatapult[10]} radius 250
                if GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE_F at {LC8_SiegeCatapult[10]} radius 250
                end if
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon LC8_SiegeCatapult[10] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[10]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[10] action queue
                elsif GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE at {LC8_SiegeCatapult[10]} radius 750
                    if GateHouse not exists
                        GateHouse = get HOUSE GATEHOUSE_F at {LC8_SiegeCatapult[10]} radius 750
                    end if
                    clear siege weapon LC8_SiegeCatapult[10] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[10]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[10] action queue
                else
                    GateHouse = get random abode of type GATEHOUSE in town PlayerTown
                    if GateHouse not exists
                        GateHouse = get random abode of type GATEHOUSE_F in town PlayerTown
                    end if
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon LC8_SiegeCatapult[10] action queue
                        Target = marker at get target from {LC8_SiegeCatapult[10]} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[10] action queue
                    else
                        ActionTimer = create timer for 0.025 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {LC8_SiegeCatapult[10]} radius 750
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC8_SiegeCatapult[10] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[10]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC8_SiegeCatapult[10] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            else
                House = get building ALTAR in PlayerTown min built 0.75
                if House exists and PLAYER of House == 0 and LC8_SiegeCatapult[10] can navigate to object oTownCentre
                    clear siege weapon LC8_SiegeCatapult[10] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[10]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC8_SiegeCatapult[10] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            end if
        end if

        until LC8_SiegeCatapult[10] not exists
    end loop
    
    if SiegeAttacking == 1 and UnderAttack != 0
        UnderAttack = UnderAttack - 1
    end if

    if LC8_SiegeCatapult[10] not exists and SiegeStucked == 0
        //CatapultDestroyed = 1
    end if
    
end loop

end script LC8_SiegeCatapult10Actions

begin script LC8_SiegeCatapult11Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = create timer for 0 seconds
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 0
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC8_SiegeCatapult[11] exists
    wait 2 seconds
    begin loop
        PlayerCreature = get distance from {LC8_SiegeCatapult[11]} to {oCreature}
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_SiegeCatapult[11]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC8_SiegeCatapult[11]} radius 150
        
        if PlayerCreature > 10 and PlayerPlatoon1 not exists and Catapult not exists
            if PlayerPlatoon1 not exists
                a = 1
            elsif PlayerCreature > 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                a = 1
            elsif Catapult not exists
                a = 1
            end if
        end if
        
        if PlayerCreature <= 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
            clear siege weapon LC8_SiegeCatapult[11] action queue
            a = 0
        elsif PlayerPlatoon1 exists and LC8_SiegeCatapult[11] can navigate to {PlayerPlatoon1}
            clear siege weapon LC8_SiegeCatapult[11] action queue
            a = 0
        elsif Catapult exists and LC8_SiegeCatapult[11] can navigate to {Catapult}
            clear siege weapon LC8_SiegeCatapult[11] action queue
            a = 0
        elsif PointOn != 3 and a == 1
            begin loop
                if LC8_SiegeCatapult[11] exists
                    if get SiegeOnPointTimer time remaining <= 0 and LC8_LargeSiegeLaunchAttack == 1
                        SiegeWeaponPoint = marker at {LC8_SiegeCatapult[11]}
                        SiegeOnPointTimer = create timer for 160 seconds
                    elsif get SiegeOnPointTimer time remaining <= 5 and LC8_LargeSiegeLaunchAttack == 1
                        if {LC8_SiegeCatapult[11]} near {SiegeWeaponPoint} radius 10
                            clear siege weapon LC8_SiegeCatapult[11] action queue
                            delete LC8_SiegeCatapult[11]
                            SiegeStucked = 1
                        end if
                    end if
                    if get CatapultMoveTimer1 time remaining <= 0
                        if get size of LC8_SiegeCatapult[11] action queue < 1

                            if PointOn == 0
                                if LC8_SiegeCatapult[11] can navigate to {LS_SiegeRoute3[0]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {LS_SiegeRoute3[0]} to siege weapon LC8_SiegeCatapult[11] action queue
                                end if
                    
                            elsif PointOn == 1
                                if LC8_SiegeCatapult[11] can navigate to {LS_SiegeRoute3[1]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {LS_SiegeRoute3[1]} to siege weapon LC8_SiegeCatapult[11] action queue
                                end if

                            elsif PointOn == 2 and LC8_LargeSiegeLaunchAttack == 1
                                if LC8_SiegeCatapult[11] can navigate to {LS_SiegeRoute3[2]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {LS_SiegeRoute3[2]} to siege weapon LC8_SiegeCatapult[11] action queue
                                end if

                            CatapultMoveTimer1 = create timer for 10 seconds
                            
                            end if
                        end if
                    end if        

                    if {LC8_SiegeCatapult[11]} near {LS_SiegeRoute3[0]} radius 15 and PointOn != 1 or 60 seconds
                        PointOn = 1
                    elsif {LC8_SiegeCatapult[11]} near {LS_SiegeRoute3[1]} radius 15 and PointOn != 2 or 60 seconds
                        PointOn = 2
                    elsif {LC8_SiegeCatapult[11]} near {LS_SiegeRoute3[2]} radius 15 and PointOn != 3 and LC8_LargeSiegeLaunchAttack == 1 or 60 seconds
                        PointOn = 3
                    elsif not LC8_SiegeCatapult[11] can navigate to {LS_SiegeRoute3[2]} and {LC8_SiegeCatapult[11]} near {LS_SiegeRoute3[1]} radius 15 and PointOn != 3 and LC8_LargeSiegeLaunchAttack == 1
                        PointOn = 3
                    end if
                end if
            until LC8_SiegeCatapult[11] not exists or PointOn == 3 or 180 seconds
            end loop
        end if
        
        until PointOn == 3 or LC8_SiegeCatapult[11] not exists or 180 seconds
    end loop

    wait 5 seconds

    enable siege weapon LC8_SiegeCatapult[11] auto attack

    begin loop
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 5
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get HOUSE GATEHOUSE at {LC8_SiegeCatapult[11]} radius 250
                if GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE_F at {LC8_SiegeCatapult[11]} radius 250
                end if
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon LC8_SiegeCatapult[11] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[11]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[11] action queue
                elsif GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE at {LC8_SiegeCatapult[11]} radius 750
                    if GateHouse not exists
                        GateHouse = get HOUSE GATEHOUSE_F at {LC8_SiegeCatapult[11]} radius 750
                    end if
                    clear siege weapon LC8_SiegeCatapult[11] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[11]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[11] action queue
                else
                    GateHouse = get random abode of type GATEHOUSE in town PlayerTown
                    if GateHouse not exists
                        GateHouse = get random abode of type GATEHOUSE_F in town PlayerTown
                    end if
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon LC8_SiegeCatapult[11] action queue
                        Target = marker at get target from {LC8_SiegeCatapult[11]} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[11] action queue
                    else
                        ActionTimer = create timer for 0.025 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {LC8_SiegeCatapult[11]} radius 750
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC8_SiegeCatapult[11] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[11]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC8_SiegeCatapult[11] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            else
                House = get building ALTAR in PlayerTown min built 0.75
                if House exists and PLAYER of House == 0 and LC8_SiegeCatapult[11] can navigate to object oTownCentre
                    clear siege weapon LC8_SiegeCatapult[11] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[11]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC8_SiegeCatapult[11] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            end if
        end if

        until LC8_SiegeCatapult[11] not exists
    end loop
    
    if SiegeAttacking == 1 and UnderAttack != 0
        UnderAttack = UnderAttack - 1
    end if

    if LC8_SiegeCatapult[11] not exists and SiegeStucked == 0
        //CatapultDestroyed = 1
    end if
    
end loop

end script LC8_SiegeCatapult11Actions

begin script LC8_SiegeCatapult12Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = create timer for 0 seconds
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 0
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC8_SiegeCatapult[12] exists
    wait 2 seconds
    begin loop
        PlayerCreature = get distance from {LC8_SiegeCatapult[12]} to {oCreature}
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_SiegeCatapult[12]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC8_SiegeCatapult[12]} radius 150
        
        if PlayerCreature > 10 and PlayerPlatoon1 not exists and Catapult not exists
            if PlayerPlatoon1 not exists
                a = 1
            elsif PlayerCreature > 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                a = 1
            elsif Catapult not exists
                a = 1
            end if
        end if
        
        if PlayerCreature <= 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
            clear siege weapon LC8_SiegeCatapult[12] action queue
            a = 0
        elsif PlayerPlatoon1 exists and LC8_SiegeCatapult[12] can navigate to {PlayerPlatoon1}
            clear siege weapon LC8_SiegeCatapult[12] action queue
            a = 0
        elsif Catapult exists and LC8_SiegeCatapult[12] can navigate to {Catapult}
            clear siege weapon LC8_SiegeCatapult[12] action queue
            a = 0
        elsif PointOn != 4 and a == 1
            begin loop
                if LC8_SiegeCatapult[12] exists
                    if get SiegeOnPointTimer time remaining <= 0 and LC8_LargeSiegeLaunchAttack == 1
                        SiegeWeaponPoint = marker at {LC8_SiegeCatapult[12]}
                        SiegeOnPointTimer = create timer for 160 seconds
                    elsif get SiegeOnPointTimer time remaining <= 5 and LC8_LargeSiegeLaunchAttack == 1
                        if {LC8_SiegeCatapult[12]} near {SiegeWeaponPoint} radius 10
                            clear siege weapon LC8_SiegeCatapult[12] action queue
                            delete LC8_SiegeCatapult[12]
                            SiegeStucked = 1
                        end if
                    end if
                    if get CatapultMoveTimer1 time remaining <= 0
                        if get size of LC8_SiegeCatapult[12] action queue < 1

                            if PointOn == 0
                                if LC8_SiegeCatapult[12] can navigate to {LS_SiegeRoute4[0]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {LS_SiegeRoute4[0]} to siege weapon LC8_SiegeCatapult[12] action queue
                                end if
                    
                            elsif PointOn == 1
                                if LC8_SiegeCatapult[12] can navigate to {LS_SiegeRoute4[1]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {LS_SiegeRoute4[1]} to siege weapon LC8_SiegeCatapult[12] action queue
                                end if

                            elsif PointOn == 2 and LC8_LargeSiegeLaunchAttack == 1
                                if LC8_SiegeCatapult[12] can navigate to {LS_SiegeRoute4[2]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {LS_SiegeRoute4[2]} to siege weapon LC8_SiegeCatapult[12] action queue
                                end if

                            elsif PointOn == 3 and LC8_LargeSiegeLaunchAttack == 1
                                if LC8_SiegeCatapult[12] can navigate to {LS_SiegeRoute4[3]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {LS_SiegeRoute4[3]} to siege weapon LC8_SiegeCatapult[12] action queue
                                end if

                            CatapultMoveTimer1 = create timer for 10 seconds
                            
                            end if
                        end if
                    end if        

                    if {LC8_SiegeCatapult[12]} near {LS_SiegeRoute4[0]} radius 15 and PointOn != 1 or 60 seconds
                        PointOn = 1
                    elsif {LC8_SiegeCatapult[12]} near {LS_SiegeRoute4[1]} radius 15 and PointOn != 2 or 60 seconds
                        PointOn = 2
                    elsif {LC8_SiegeCatapult[12]} near {LS_SiegeRoute4[2]} radius 15 and PointOn != 3 or 60 seconds and LC8_LargeSiegeLaunchAttack == 1
                        PointOn = 3
                    elsif {LC8_SiegeCatapult[12]} near {LS_SiegeRoute4[3]} radius 15 and PointOn != 4 or 60 seconds and LC8_LargeSiegeLaunchAttack == 1
                        PointOn = 4
                    elsif not LC8_SiegeCatapult[12] can navigate to {LS_SiegeRoute4[3]} and {LC8_SiegeCatapult[12]} near {LS_SiegeRoute4[2]} radius 15 and PointOn != 4 and LC8_LargeSiegeLaunchAttack == 1
                        PointOn = 4
                    end if
                end if
            until LC8_SiegeCatapult[12] not exists or PointOn == 4 or 180 seconds
            end loop
        end if
        
        until PointOn == 4 or LC8_SiegeCatapult[12] not exists or 180 seconds
    end loop

    wait 5 seconds

    enable siege weapon LC8_SiegeCatapult[12] auto attack

    begin loop
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 5
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get HOUSE GATEHOUSE at {LC8_SiegeCatapult[12]} radius 250
                if GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE_F at {LC8_SiegeCatapult[12]} radius 250
                end if
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon LC8_SiegeCatapult[12] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[12]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[12] action queue
                elsif GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE at {LC8_SiegeCatapult[12]} radius 750
                    if GateHouse not exists
                        GateHouse = get HOUSE GATEHOUSE_F at {LC8_SiegeCatapult[12]} radius 750
                    end if
                    clear siege weapon LC8_SiegeCatapult[12] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[12]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[12] action queue
                else
                    GateHouse = get random abode of type GATEHOUSE in town PlayerTown
                    if GateHouse not exists
                        GateHouse = get random abode of type GATEHOUSE_F in town PlayerTown
                    end if
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon LC8_SiegeCatapult[12] action queue
                        Target = marker at get target from {LC8_SiegeCatapult[12]} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[12] action queue
                    else
                        ActionTimer = create timer for 0.025 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {LC8_SiegeCatapult[12]} radius 750
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC8_SiegeCatapult[12] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[12]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC8_SiegeCatapult[12] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            else
                House = get building ALTAR in PlayerTown min built 0.75
                if House exists and PLAYER of House == 0 and LC8_SiegeCatapult[12] can navigate to object oTownCentre
                    clear siege weapon LC8_SiegeCatapult[12] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[12]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC8_SiegeCatapult[12] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            end if
        end if

        until LC8_SiegeCatapult[12] not exists
    end loop
    
    if SiegeAttacking == 1 and UnderAttack != 0
        UnderAttack = UnderAttack - 1
    end if

    if LC8_SiegeCatapult[12] not exists and SiegeStucked == 0
        //CatapultDestroyed = 1
    end if
    
end loop

end script LC8_SiegeCatapult12Actions

begin script LC8_SiegeCatapult13Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = create timer for 0 seconds
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0

start

begin loop
    a = 1
    PointOn = 0
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC8_SiegeCatapult[13] exists
    wait 2 seconds
    begin loop
        PlayerCreature = get distance from {LC8_SiegeCatapult[13]} to {oCreature}
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_SiegeCatapult[13]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC8_SiegeCatapult[13]} radius 150
        
        if PlayerCreature > 10 and PlayerPlatoon1 not exists and Catapult not exists
            if PlayerPlatoon1 not exists
                a = 1
            elsif PlayerCreature > 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                a = 1
            elsif Catapult not exists
                a = 1
            end if
        end if
        
        if PlayerCreature <= 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
            clear siege weapon LC8_SiegeCatapult[13] action queue
            a = 0
        elsif PlayerPlatoon1 exists and LC8_SiegeCatapult[13] can navigate to {PlayerPlatoon1}
            clear siege weapon LC8_SiegeCatapult[13] action queue
            a = 0
        elsif Catapult exists and LC8_SiegeCatapult[13] can navigate to {Catapult}
            clear siege weapon LC8_SiegeCatapult[13] action queue
            a = 0
        elsif PointOn != 4 and a == 1
            begin loop
                if LC8_SiegeCatapult[13] exists
                    if get SiegeOnPointTimer time remaining <= 0 and LC8_LargeSiegeLaunchAttack == 1
                        SiegeWeaponPoint = marker at {LC8_SiegeCatapult[13]}
                        SiegeOnPointTimer = create timer for 160 seconds
                    elsif get SiegeOnPointTimer time remaining <= 5 and LC8_LargeSiegeLaunchAttack == 1
                        if {LC8_SiegeCatapult[13]} near {SiegeWeaponPoint} radius 10
                            clear siege weapon LC8_SiegeCatapult[13] action queue
                            delete LC8_SiegeCatapult[13]
                            SiegeStucked = 1
                        end if
                    end if
                    if get CatapultMoveTimer1 time remaining <= 0
                        if get size of LC8_SiegeCatapult[13] action queue < 1

                            if PointOn == 0
                                if LC8_SiegeCatapult[13] can navigate to {LS_SiegeRoute5[0]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {LS_SiegeRoute5[0]} to siege weapon LC8_SiegeCatapult[13] action queue
                                end if
                    
                            elsif PointOn == 1
                                if LC8_SiegeCatapult[13] can navigate to {LS_SiegeRoute5[1]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {LS_SiegeRoute5[1]} to siege weapon LC8_SiegeCatapult[13] action queue
                                end if

                            elsif PointOn == 2 and LC8_LargeSiegeLaunchAttack == 1
                                if LC8_SiegeCatapult[13] can navigate to {LS_SiegeRoute5[2]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {LS_SiegeRoute5[2]} to siege weapon LC8_SiegeCatapult[13] action queue
                                end if

                            elsif PointOn == 3 and LC8_LargeSiegeLaunchAttack == 1
                                if LC8_SiegeCatapult[13] can navigate to {LS_SiegeRoute5[3]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {LS_SiegeRoute5[3]} to siege weapon LC8_SiegeCatapult[13] action queue
                                end if

                            CatapultMoveTimer1 = create timer for 10 seconds
                            
                            end if
                        end if
                    end if        

                    if {LC8_SiegeCatapult[13]} near {LS_SiegeRoute5[0]} radius 15 and PointOn != 1 or 60 seconds
                        PointOn = 1
                    elsif {LC8_SiegeCatapult[13]} near {LS_SiegeRoute5[1]} radius 15 and PointOn != 2 or 60 seconds
                        PointOn = 2
                    elsif {LC8_SiegeCatapult[13]} near {LS_SiegeRoute5[2]} radius 15 and PointOn != 3 or 60 seconds and LC8_LargeSiegeLaunchAttack == 1
                        PointOn = 3
                    elsif {LC8_SiegeCatapult[13]} near {LS_SiegeRoute5[3]} radius 15 and PointOn != 4 or 60 seconds and LC8_LargeSiegeLaunchAttack == 1
                        PointOn = 4
                    elsif not LC8_SiegeCatapult[13] can navigate to {LS_SiegeRoute5[3]} and {LC8_SiegeCatapult[13]} near {LS_SiegeRoute5[2]} radius 15 and PointOn != 4 and LC8_LargeSiegeLaunchAttack == 1
                        PointOn = 4
                    end if
                end if
            until LC8_SiegeCatapult[13] not exists or PointOn == 4 or 180 seconds
            end loop
        end if
        
        until PointOn == 4 or LC8_SiegeCatapult[13] not exists or 180 seconds
    end loop

    wait 5 seconds

    enable siege weapon LC8_SiegeCatapult[13] auto attack

    begin loop
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 5
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get HOUSE GATEHOUSE at {LC8_SiegeCatapult[13]} radius 250
                if GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE_F at {LC8_SiegeCatapult[13]} radius 250
                end if
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon LC8_SiegeCatapult[13] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[13]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[13] action queue
                elsif GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE at {LC8_SiegeCatapult[13]} radius 750
                    if GateHouse not exists
                        GateHouse = get HOUSE GATEHOUSE_F at {LC8_SiegeCatapult[13]} radius 750
                    end if
                    clear siege weapon LC8_SiegeCatapult[13] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[13]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[13] action queue
                else
                    GateHouse = get random abode of type GATEHOUSE in town PlayerTown
                    if GateHouse not exists
                        GateHouse = get random abode of type GATEHOUSE_F in town PlayerTown
                    end if
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon LC8_SiegeCatapult[13] action queue
                        Target = marker at get target from {LC8_SiegeCatapult[13]} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[13] action queue
                    else
                        ActionTimer = create timer for 0.025 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {LC8_SiegeCatapult[13]} radius 750
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC8_SiegeCatapult[13] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[13]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC8_SiegeCatapult[13] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            else
                House = get building ALTAR in PlayerTown min built 0.75
                if House exists and PLAYER of House == 0 and LC8_SiegeCatapult[13] can navigate to object oTownCentre
                    clear siege weapon LC8_SiegeCatapult[13] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[13]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC8_SiegeCatapult[13] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            end if
        end if

        until LC8_SiegeCatapult[13] not exists
    end loop
    
    if SiegeAttacking == 1 and UnderAttack != 0
        UnderAttack = UnderAttack - 1
    end if

    if LC8_SiegeCatapult[13] not exists and SiegeStucked == 0
        //CatapultDestroyed = 1
    end if
    
end loop

end script LC8_SiegeCatapult13Actions

begin script LC8_SiegeCatapult14Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = create timer for 0 seconds
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 0
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC8_SiegeCatapult[14] exists
    wait 2 seconds
    begin loop
        PlayerCreature = get distance from {LC8_SiegeCatapult[14]} to {oCreature}
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_SiegeCatapult[14]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC8_SiegeCatapult[14]} radius 150
        
        if PlayerCreature > 10 and PlayerPlatoon1 not exists and Catapult not exists
            if PlayerPlatoon1 not exists
                a = 1
            elsif PlayerCreature > 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                a = 1
            elsif Catapult not exists
                a = 1
            end if
        end if
        
        if PlayerCreature <= 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
            clear siege weapon LC8_SiegeCatapult[14] action queue
            a = 0
        elsif PlayerPlatoon1 exists and LC8_SiegeCatapult[14] can navigate to {PlayerPlatoon1}
            clear siege weapon LC8_SiegeCatapult[14] action queue
            a = 0
        elsif Catapult exists and LC8_SiegeCatapult[14] can navigate to {Catapult}
            clear siege weapon LC8_SiegeCatapult[14] action queue
            a = 0
        elsif PointOn != 4 and a == 1
            begin loop
                if LC8_SiegeCatapult[14] exists
                    if get SiegeOnPointTimer time remaining <= 0 and LC8_LargeSiegeLaunchAttack == 1
                        SiegeWeaponPoint = marker at {LC8_SiegeCatapult[14]}
                        SiegeOnPointTimer = create timer for 160 seconds
                    elsif get SiegeOnPointTimer time remaining <= 5 and LC8_LargeSiegeLaunchAttack == 1
                        if {LC8_SiegeCatapult[14]} near {SiegeWeaponPoint} radius 10
                            clear siege weapon LC8_SiegeCatapult[14] action queue
                            delete LC8_SiegeCatapult[14]
                            SiegeStucked = 1
                        end if
                    end if
                    if get CatapultMoveTimer1 time remaining <= 0
                        if get size of LC8_SiegeCatapult[14] action queue < 1

                            if PointOn == 0
                                if LC8_SiegeCatapult[14] can navigate to {LS_SiegeRoute6[0]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {LS_SiegeRoute6[0]} to siege weapon LC8_SiegeCatapult[14] action queue
                                end if
                    
                            elsif PointOn == 1
                                if LC8_SiegeCatapult[14] can navigate to {LS_SiegeRoute6[1]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {LS_SiegeRoute6[1]} to siege weapon LC8_SiegeCatapult[14] action queue
                                end if

                            elsif PointOn == 2 and LC8_LargeSiegeLaunchAttack == 1
                                if LC8_SiegeCatapult[14] can navigate to {LS_SiegeRoute6[2]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {LS_SiegeRoute6[2]} to siege weapon LC8_SiegeCatapult[14] action queue
                                end if

                            elsif PointOn == 3 and LC8_LargeSiegeLaunchAttack == 1
                                if LC8_SiegeCatapult[14] can navigate to {LS_SiegeRoute6[3]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {LS_SiegeRoute6[3]} to siege weapon LC8_SiegeCatapult[14] action queue
                                end if

                            CatapultMoveTimer1 = create timer for 10 seconds
                            
                            end if
                        end if
                    end if        

                    if {LC8_SiegeCatapult[14]} near {LS_SiegeRoute6[0]} radius 15 and PointOn != 1 or 60 seconds
                        PointOn = 1
                    elsif {LC8_SiegeCatapult[14]} near {LS_SiegeRoute6[1]} radius 15 and PointOn != 2 or 60 seconds
                        PointOn = 2
                    elsif {LC8_SiegeCatapult[14]} near {LS_SiegeRoute6[2]} radius 15 and PointOn != 3 or 60 seconds and LC8_LargeSiegeLaunchAttack == 1
                        PointOn = 3
                    elsif {LC8_SiegeCatapult[14]} near {LS_SiegeRoute6[3]} radius 15 and PointOn != 4 or 60 seconds and LC8_LargeSiegeLaunchAttack == 1
                        PointOn = 4
                    elsif not LC8_SiegeCatapult[14] can navigate to {LS_SiegeRoute6[3]} and {LC8_SiegeCatapult[14]} near {LS_SiegeRoute6[2]} radius 15 and PointOn != 4 and LC8_LargeSiegeLaunchAttack == 1
                        PointOn = 4
                    end if
                end if
            until LC8_SiegeCatapult[14] not exists or PointOn == 4 or 180 seconds
            end loop
        end if
        
        until PointOn == 4 or LC8_SiegeCatapult[14] not exists or 180 seconds
    end loop

    wait 5 seconds

    enable siege weapon LC8_SiegeCatapult[14] auto attack

    begin loop
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 5
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get HOUSE GATEHOUSE at {LC8_SiegeCatapult[14]} radius 250
                if GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE_F at {LC8_SiegeCatapult[14]} radius 250
                end if
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon LC8_SiegeCatapult[14] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[14]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[14] action queue
                elsif GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE at {LC8_SiegeCatapult[14]} radius 750
                    if GateHouse not exists
                        GateHouse = get HOUSE GATEHOUSE_F at {LC8_SiegeCatapult[14]} radius 750
                    end if
                    clear siege weapon LC8_SiegeCatapult[14] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[14]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[14] action queue
                else
                    GateHouse = get random abode of type GATEHOUSE in town PlayerTown
                    if GateHouse not exists
                        GateHouse = get random abode of type GATEHOUSE_F in town PlayerTown
                    end if
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon LC8_SiegeCatapult[14] action queue
                        Target = marker at get target from {LC8_SiegeCatapult[14]} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[14] action queue
                    else
                        ActionTimer = create timer for 0.025 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {LC8_SiegeCatapult[14]} radius 750
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC8_SiegeCatapult[14] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[14]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC8_SiegeCatapult[14] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            else
                House = get building ALTAR in PlayerTown min built 0.75
                if House exists and PLAYER of House == 0 and LC8_SiegeCatapult[14] can navigate to object oTownCentre
                    clear siege weapon LC8_SiegeCatapult[14] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[14]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC8_SiegeCatapult[14] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            end if
        end if

        until LC8_SiegeCatapult[14] not exists
    end loop
    
    if SiegeAttacking == 1 and UnderAttack != 0
        UnderAttack = UnderAttack - 1
    end if

    if LC8_SiegeCatapult[14] not exists and SiegeStucked == 0
        //CatapultDestroyed = 1
    end if
    
end loop

end script LC8_SiegeCatapult14Actions

begin script LC8_Platoon32Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC8_Platoon[32] exists and LC8_Platoon[33] exists and LC8_SiegeCatapult[15] exists and LC8_SiegeCatapult[16] exists and ({LC8_SiegeCatapult[15]} near {JapaneseCapital} radius 500) and ({LC8_SiegeCatapult[16]} near {JapaneseCapital} radius 500)
    begin loop

        PlayerCreature = get distance from {LC8_Platoon[32]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC8_Platoon[32] can navigate to {oCreature}
            clear LC8_Platoon[32] action queue
            begin loop
                PlayerCreature = get distance from {LC8_Platoon[32]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC8_Platoon[32] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[32]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC8_Platoon[32] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC8_Platoon[32] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[32]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC8_Platoon[32]} radius 50
        if PlayerPlatoon1 exists and LC8_Platoon[32] can navigate to {PlayerPlatoon1}
            clear LC8_Platoon[32] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[32]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC8_Platoon[32] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[32]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC8_Platoon[32] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC8_Platoon[32] action queue
        elsif Catapult exists and LC8_Platoon[32] can navigate to {Catapult}
            clear LC8_Platoon[32] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC8_Platoon[32]} radius 50
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC8_Platoon[32] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[32]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[32]} radius 150
                if PlayerPlatoon1 exists and LC8_Platoon[32] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC8_Platoon[32] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC8_Platoon[32] action queue
            a = 0
        end if

        PlayerSettlement = get nearest town at {LC8_Platoon[32]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0 and HEALTH of Armory == 1.0
            if LC8_Platoon[32] can navigate to object Armory
                if TownCapturePlatoons[1] < 2
                    TownCapturePlatoons[1]++
                    clear LC8_Platoon[32] action queue
                    set LC8_Platoon[32] attack PlayerSettlement with severity 0.3 for takeover
                    a = 1
                    begin loop
                        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[32]} radius 150
                        PlayerCreature = get distance from {LC8_Platoon[32]} to {oCreature}
                        if PlayerPlatoon1 exists
                            a = 0
                        elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                            a = 0
                        elsif not LC8_Platoon[32] can navigate to object Armory
                            a = 0
                        elsif LC8_Platoon[32] not exists
                            a = 0
                        end if
                        until a == 0 or LC8_Platoon[32] not exists or PLAYER of PlayerSettlement == 1
                    end loop
                    TownCapturePlatoons[1]--
                end if
                clear LC8_Platoon[32] action queue
            end if
        end if

        //if get size of LC8_Platoon[32] action queue < 1
            if LC8_Platoon[32] can navigate to object oTownCentre and PLAYER of PlayerTown == 0
                wait number from 5 to 25 seconds
                a = 1
                clear LC8_Platoon[32] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC8_Platoon[32] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[32] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[32] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[32] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[32] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[32] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[32] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[0] < 2
                        TownCapturePlatoons[0]++
                        set LC8_Platoon[32] attack PlayerTown with severity 0.3 for takeover
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[32]} radius 150
                    TestCreature2 = get distance from {LC8_Platoon[32]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC8_Platoon[32]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC8_Platoon[32] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC8_Platoon[32] can navigate to object oTownCentre
                            a = 0
                        elsif LC8_Platoon[32] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC8_Platoon[32] not exists
                end loop
                if AttackMode == 0
                    TownCapturePlatoons[0]--
                end if
                clear LC8_Platoon[32] action queue
            elsif LC8_Platoon[32] can navigate to {AttackPos[2]}
                clear LC8_Platoon[32] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[2]} to LC8_Platoon[32] action queue
            else
                clear LC8_Platoon[32] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[3]} to LC8_Platoon[32] action queue
            end if
        //end if

        until LC8_Platoon[32] not exists
    end loop
    if LC8_Platoon[32] not exists
        //PlatoonKilled = 1
        wait until LC8_Platoon[32] exists
    end if
end loop

end script LC8_Platoon32Actions

begin script LC8_Platoon33Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC8_Platoon[32] exists and LC8_Platoon[33] exists and LC8_SiegeCatapult[15] exists and LC8_SiegeCatapult[16] exists and ({LC8_SiegeCatapult[15]} near {JapaneseCapital} radius 500) and ({LC8_SiegeCatapult[16]} near {JapaneseCapital} radius 500)
    begin loop

        PlayerCreature = get distance from {LC8_Platoon[33]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC8_Platoon[33] can navigate to {oCreature}
            clear LC8_Platoon[33] action queue
            begin loop
                PlayerCreature = get distance from {LC8_Platoon[33]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK using oCreature to LC8_Platoon[33] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[33]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC8_Platoon[33] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC8_Platoon[33] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[33]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC8_Platoon[33]} radius 50
        if PlayerPlatoon1 exists and LC8_Platoon[33] can navigate to {PlayerPlatoon1}
            clear LC8_Platoon[33] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[33]} radius 150
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK using PlayerPlatoon1 to LC8_Platoon[33] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[33]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC8_Platoon[33] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC8_Platoon[33] action queue
        elsif Catapult exists and LC8_Platoon[33] can navigate to {Catapult}
            clear LC8_Platoon[33] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC8_Platoon[33]} radius 50
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK using Catapult to LC8_Platoon[33] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[33]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[33]} radius 150
                if PlayerPlatoon1 exists and LC8_Platoon[33] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC8_Platoon[33] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC8_Platoon[33] action queue
            a = 0
        end if

        PlayerSettlement = get nearest town at {LC8_Platoon[33]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0 and HEALTH of Armory == 1.0
            if LC8_Platoon[33] can navigate to object Armory
                if TownCapturePlatoons[1] < 2
                    TownCapturePlatoons[1]++
                    clear LC8_Platoon[33] action queue
                    set LC8_Platoon[33] attack PlayerSettlement with severity 0.3 for takeover
                    a = 1
                    begin loop
                        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[33]} radius 150
                        PlayerCreature = get distance from {LC8_Platoon[33]} to {oCreature}
                        if PlayerPlatoon1 exists
                            a = 0
                        elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                            a = 0
                        elsif not LC8_Platoon[33] can navigate to object Armory
                            a = 0
                        elsif LC8_Platoon[33] not exists
                            a = 0
                        end if
                        until a == 0 or LC8_Platoon[33] not exists or PLAYER of PlayerSettlement == 1
                    end loop
                    TownCapturePlatoons[1]--
                end if
                clear LC8_Platoon[33] action queue
            end if
        end if

        //if get size of LC8_Platoon[33] action queue < 1
            if LC8_Platoon[33] can navigate to object oTownCentre and PLAYER of PlayerTown == 0
                wait number from 5 to 25 seconds
                a = 1
                clear LC8_Platoon[33] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC8_Platoon[33] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[33] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[33] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[33] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[33] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[33] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[33] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[0] < 2
                        TownCapturePlatoons[0]++
                        set LC8_Platoon[33] attack PlayerTown with severity 0.3 for takeover
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[33]} radius 150
                    TestCreature2 = get distance from {LC8_Platoon[33]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC8_Platoon[33]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC8_Platoon[33] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC8_Platoon[33] can navigate to object oTownCentre
                            a = 0
                        elsif LC8_Platoon[33] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC8_Platoon[33] not exists
                end loop
                if AttackMode == 0
                    TownCapturePlatoons[0]--
                end if
                clear LC8_Platoon[33] action queue
            elsif LC8_Platoon[33] can navigate to {AttackPos[2]} + {20,0,20}
                clear LC8_Platoon[33] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[2]} + {20,0,20} to LC8_Platoon[33] action queue
            else
                clear LC8_Platoon[33] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[3]} + {20,0,20} to LC8_Platoon[33] action queue
            end if
        //end if

        until LC8_Platoon[33] not exists
    end loop
    if LC8_Platoon[33] not exists
        //PlatoonKilled = 1
        wait until LC8_Platoon[33] exists
    end if
end loop

end script LC8_Platoon33Actions

begin script LC8_SiegeCatapult15Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = create timer for 0 seconds
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 0
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC8_Platoon[32] exists and LC8_Platoon[33] exists and LC8_SiegeCatapult[15] exists and LC8_SiegeCatapult[16] exists and ({LC8_SiegeCatapult[15]} near {JapaneseCapital} radius 500) and ({LC8_SiegeCatapult[16]} near {JapaneseCapital} radius 500)
    wait 2 seconds
    begin loop
        PlayerCreature = get distance from {LC8_SiegeCatapult[15]} to {oCreature}
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_SiegeCatapult[15]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC8_SiegeCatapult[15]} radius 150
        
        if PlayerCreature > 10 and PlayerPlatoon1 not exists and Catapult not exists
            if PlayerPlatoon1 not exists
                a = 1
            elsif PlayerCreature > 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                a = 1
            elsif Catapult not exists
                a = 1
            end if
        end if
        
        if PlayerCreature <= 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
            clear siege weapon LC8_SiegeCatapult[15] action queue
            a = 0
        elsif PlayerPlatoon1 exists and LC8_SiegeCatapult[15] can navigate to {PlayerPlatoon1}
            clear siege weapon LC8_SiegeCatapult[15] action queue
            a = 0
        elsif Catapult exists and LC8_SiegeCatapult[15] can navigate to {Catapult}
            clear siege weapon LC8_SiegeCatapult[15] action queue
            a = 0
        elsif PointOn != 4 and a == 1
            begin loop
                if LC8_SiegeCatapult[15] exists
                    if get SiegeOnPointTimer time remaining <= 0
                        SiegeWeaponPoint = marker at {LC8_SiegeCatapult[15]}
                        SiegeOnPointTimer = create timer for 160 seconds
                    elsif get SiegeOnPointTimer time remaining <= 5
                        if {LC8_SiegeCatapult[15]} near {SiegeWeaponPoint} radius 10
                            clear siege weapon LC8_SiegeCatapult[15] action queue
                            delete LC8_SiegeCatapult[15]
                            SiegeStucked = 1
                        end if
                    end if
                    if get CatapultMoveTimer1 time remaining <= 0
                        if get size of LC8_SiegeCatapult[15] action queue < 1

                            if PointOn == 0
                                if LC8_SiegeCatapult[15] can navigate to {SiegeRoute2[0]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute2[0]} to siege weapon LC8_SiegeCatapult[15] action queue
                                end if
                    
                            elsif PointOn == 1
                                if LC8_SiegeCatapult[15] can navigate to {SiegeRoute2[1]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute2[1]} to siege weapon LC8_SiegeCatapult[15] action queue
                                end if

                            elsif PointOn == 2
                                if LC8_SiegeCatapult[15] can navigate to {SiegeRoute2[2]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute2[2]} to siege weapon LC8_SiegeCatapult[15] action queue
                                end if

                            elsif PointOn == 3
                                if LC8_SiegeCatapult[15] can navigate to {SiegeRoute2[3]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute2[3]} to siege weapon LC8_SiegeCatapult[15] action queue
                                end if

                            CatapultMoveTimer1 = create timer for 10 seconds
                            
                            end if
                        end if
                    end if        

                    if {LC8_SiegeCatapult[15]} near {SiegeRoute2[0]} radius 15 and PointOn != 1 or 60 seconds
                        PointOn = 1
                    elsif {LC8_SiegeCatapult[15]} near {SiegeRoute2[1]} radius 15 and PointOn != 2 or 60 seconds
                        PointOn = 2
                    elsif {LC8_SiegeCatapult[15]} near {SiegeRoute2[2]} radius 15 and PointOn != 3 or 60 seconds
                        PointOn = 3
                    elsif {LC8_SiegeCatapult[15]} near {SiegeRoute2[3]} radius 15 and PointOn != 4 or 60 seconds
                        PointOn = 4
                    elsif not LC8_SiegeCatapult[15] can navigate to {SiegeRoute2[3]} and {LC8_SiegeCatapult[15]} near {SiegeRoute2[2]} radius 15 and PointOn != 4
                        PointOn = 4
                    end if
                end if
            until LC8_SiegeCatapult[15] not exists or PointOn == 4 or 180 seconds
            end loop
        end if
        
        until PointOn == 4 or LC8_SiegeCatapult[15] not exists or 180 seconds
    end loop

    wait 5 seconds

    enable siege weapon LC8_SiegeCatapult[15] auto attack

    begin loop
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 5
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get HOUSE GATEHOUSE at {LC8_SiegeCatapult[15]} radius 250
                if GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE_F at {LC8_SiegeCatapult[15]} radius 250
                end if
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon LC8_SiegeCatapult[15] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[15]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[15] action queue
                elsif GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE at {LC8_SiegeCatapult[15]} radius 750
                    if GateHouse not exists
                        GateHouse = get HOUSE GATEHOUSE_F at {LC8_SiegeCatapult[15]} radius 750
                    end if
                    clear siege weapon LC8_SiegeCatapult[15] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[15]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[15] action queue
                else
                    GateHouse = get random abode of type GATEHOUSE in town PlayerTown
                    if GateHouse not exists
                        GateHouse = get random abode of type GATEHOUSE_F in town PlayerTown
                    end if
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon LC8_SiegeCatapult[15] action queue
                        Target = marker at get target from {LC8_SiegeCatapult[15]} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[15] action queue
                    else
                        ActionTimer = create timer for 0.025 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {LC8_SiegeCatapult[15]} radius 750
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC8_SiegeCatapult[15] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[15]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC8_SiegeCatapult[15] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            else
                House = get building ALTAR in PlayerTown min built 0.75
                if House exists and PLAYER of House == 0 and LC8_SiegeCatapult[15] can navigate to object oTownCentre
                    clear siege weapon LC8_SiegeCatapult[15] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[15]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC8_SiegeCatapult[15] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            end if
        end if

        until LC8_SiegeCatapult[15] not exists
    end loop
    
    if SiegeAttacking == 1 and UnderAttack != 0
        UnderAttack = UnderAttack - 1
    end if

    if LC8_SiegeCatapult[15] not exists and SiegeStucked == 0
        //CatapultDestroyed = 1
    end if
    
end loop

end script LC8_SiegeCatapult15Actions

begin script LC8_SiegeCatapult16Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = create timer for 0 seconds
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 0
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC8_Platoon[32] exists and LC8_Platoon[33] exists and LC8_SiegeCatapult[15] exists and LC8_SiegeCatapult[16] exists and ({LC8_SiegeCatapult[15]} near {JapaneseCapital} radius 500) and ({LC8_SiegeCatapult[16]} near {JapaneseCapital} radius 500)
    wait 2 seconds
    begin loop
        PlayerCreature = get distance from {LC8_SiegeCatapult[16]} to {oCreature}
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_SiegeCatapult[16]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC8_SiegeCatapult[16]} radius 150
        
        if PlayerCreature > 10 and PlayerPlatoon1 not exists and Catapult not exists
            if PlayerPlatoon1 not exists
                a = 1
            elsif PlayerCreature > 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                a = 1
            elsif Catapult not exists
                a = 1
            end if
        end if
        
        if PlayerCreature <= 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
            clear siege weapon LC8_SiegeCatapult[16] action queue
            a = 0
        elsif PlayerPlatoon1 exists and LC8_SiegeCatapult[16] can navigate to {PlayerPlatoon1}
            clear siege weapon LC8_SiegeCatapult[16] action queue
            a = 0
        elsif Catapult exists and LC8_SiegeCatapult[16] can navigate to {Catapult}
            clear siege weapon LC8_SiegeCatapult[16] action queue
            a = 0
        elsif PointOn != 4 and a == 1
            begin loop
                if LC8_SiegeCatapult[16] exists
                    if get SiegeOnPointTimer time remaining <= 0
                        SiegeWeaponPoint = marker at {LC8_SiegeCatapult[16]}
                        SiegeOnPointTimer = create timer for 160 seconds
                    elsif get SiegeOnPointTimer time remaining <= 5
                        if {LC8_SiegeCatapult[16]} near {SiegeWeaponPoint} radius 10
                            clear siege weapon LC8_SiegeCatapult[16] action queue
                            delete LC8_SiegeCatapult[16]
                            SiegeStucked = 1
                        end if
                    end if
                    if get CatapultMoveTimer1 time remaining <= 0
                        if get size of LC8_SiegeCatapult[16] action queue < 1

                            if PointOn == 0
                                if LC8_SiegeCatapult[16] can navigate to {SiegeRoute4[0]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute4[0]} to siege weapon LC8_SiegeCatapult[16] action queue
                                end if
                    
                            elsif PointOn == 1
                                if LC8_SiegeCatapult[16] can navigate to {SiegeRoute4[1]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute4[1]} to siege weapon LC8_SiegeCatapult[16] action queue
                                end if

                            elsif PointOn == 2
                                if LC8_SiegeCatapult[16] can navigate to {SiegeRoute4[2]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute4[2]} to siege weapon LC8_SiegeCatapult[16] action queue
                                end if

                            elsif PointOn == 3
                                if LC8_SiegeCatapult[16] can navigate to {SiegeRoute4[3]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute4[3]} to siege weapon LC8_SiegeCatapult[16] action queue
                                end if

                            CatapultMoveTimer1 = create timer for 10 seconds
                            
                            end if
                        end if
                    end if        

                    if {LC8_SiegeCatapult[16]} near {SiegeRoute4[0]} radius 15 and PointOn != 1 or 60 seconds
                        PointOn = 1
                    elsif {LC8_SiegeCatapult[16]} near {SiegeRoute4[1]} radius 15 and PointOn != 2 or 60 seconds
                        PointOn = 2
                    elsif {LC8_SiegeCatapult[16]} near {SiegeRoute4[2]} radius 15 and PointOn != 3 or 60 seconds
                        PointOn = 3
                    elsif {LC8_SiegeCatapult[16]} near {SiegeRoute4[3]} radius 15 and PointOn != 4 or 60 seconds
                        PointOn = 4
                    elsif not LC8_SiegeCatapult[16] can navigate to {SiegeRoute4[3]} and {LC8_SiegeCatapult[16]} near {SiegeRoute4[2]} radius 15 and PointOn != 4
                        PointOn = 4
                    end if
                end if
            until LC8_SiegeCatapult[16] not exists or PointOn == 4 or 180 seconds
            end loop
        end if
        
        until PointOn == 4 or LC8_SiegeCatapult[16] not exists or 180 seconds
    end loop

    wait 5 seconds

    enable siege weapon LC8_SiegeCatapult[16] auto attack

    begin loop
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 5
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get HOUSE GATEHOUSE at {LC8_SiegeCatapult[16]} radius 250
                if GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE_F at {LC8_SiegeCatapult[16]} radius 250
                end if
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon LC8_SiegeCatapult[16] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[16]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[16] action queue
                elsif GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE at {LC8_SiegeCatapult[16]} radius 750
                    if GateHouse not exists
                        GateHouse = get HOUSE GATEHOUSE_F at {LC8_SiegeCatapult[16]} radius 750
                    end if
                    clear siege weapon LC8_SiegeCatapult[16] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[16]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[16] action queue
                else
                    GateHouse = get random abode of type GATEHOUSE in town PlayerTown
                    if GateHouse not exists
                        GateHouse = get random abode of type GATEHOUSE_F in town PlayerTown
                    end if
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon LC8_SiegeCatapult[16] action queue
                        Target = marker at get target from {LC8_SiegeCatapult[16]} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[16] action queue
                    else
                        ActionTimer = create timer for 0.025 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {LC8_SiegeCatapult[16]} radius 750
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC8_SiegeCatapult[16] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[16]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC8_SiegeCatapult[16] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            else
                House = get building ALTAR in PlayerTown min built 0.75
                if House exists and PLAYER of House == 0 and LC8_SiegeCatapult[16] can navigate to object oTownCentre
                    clear siege weapon LC8_SiegeCatapult[16] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[16]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC8_SiegeCatapult[16] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            end if
        end if

        until LC8_SiegeCatapult[16] not exists
    end loop
    
    if SiegeAttacking == 1 and UnderAttack != 0
        UnderAttack = UnderAttack - 1
    end if

    if LC8_SiegeCatapult[16] not exists and SiegeStucked == 0
        //CatapultDestroyed = 1
    end if
    
end loop

end script LC8_SiegeCatapult16Actions

begin script LC8_Platoon34Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC8_Platoon[34] exists and LC8_Platoon[35] exists and LC8_SiegeCatapult[17] exists and LC8_SiegeCatapult[18] exists and ({LC8_SiegeCatapult[17]} near {JapaneseTown1} radius 500) and ({LC8_SiegeCatapult[18]} near {JapaneseTown1} radius 500)
    begin loop

        PlayerCreature = get distance from {LC8_Platoon[34]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC8_Platoon[34] can navigate to {oCreature}
            clear LC8_Platoon[34] action queue
            begin loop
                PlayerCreature = get distance from {LC8_Platoon[34]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC8_Platoon[34] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[34]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC8_Platoon[34] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC8_Platoon[34] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[34]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC8_Platoon[34]} radius 50
        if PlayerPlatoon1 exists and LC8_Platoon[34] can navigate to {PlayerPlatoon1}
            clear LC8_Platoon[34] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[34]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC8_Platoon[34] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[34]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC8_Platoon[34] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC8_Platoon[34] action queue
        elsif Catapult exists and LC8_Platoon[34] can navigate to {Catapult}
            clear LC8_Platoon[34] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC8_Platoon[34]} radius 50
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC8_Platoon[34] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[34]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[34]} radius 150
                if PlayerPlatoon1 exists and LC8_Platoon[34] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC8_Platoon[34] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC8_Platoon[34] action queue
            a = 0
        end if

        PlayerSettlement = get nearest town at {LC8_Platoon[34]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0 and HEALTH of Armory == 1.0
            if LC8_Platoon[34] can navigate to object Armory
                if TownCapturePlatoons[2] < 2
                    TownCapturePlatoons[2]++
                    clear LC8_Platoon[34] action queue
                    set LC8_Platoon[34] attack PlayerSettlement with severity 0.3 for takeover
                    a = 1
                    begin loop
                        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[34]} radius 150
                        PlayerCreature = get distance from {LC8_Platoon[34]} to {oCreature}
                        if PlayerPlatoon1 exists
                            a = 0
                        elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                            a = 0
                        elsif not LC8_Platoon[34] can navigate to object Armory
                            a = 0
                        elsif LC8_Platoon[34] not exists
                            a = 0
                        end if
                        until a == 0 or LC8_Platoon[34] not exists or PLAYER of PlayerSettlement == 1
                    end loop
                    TownCapturePlatoons[2]--
                end if
                clear LC8_Platoon[34] action queue
            end if
        end if

        //if get size of LC8_Platoon[34] action queue < 1
            if LC8_Platoon[34] can navigate to object oTownCentre and PLAYER of PlayerTown == 0
                wait number from 5 to 25 seconds
                a = 1
                clear LC8_Platoon[34] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC8_Platoon[34] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[34] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[34] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[34] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[34] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[34] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[34] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[0] < 2
                        TownCapturePlatoons[0]++
                        set LC8_Platoon[34] attack PlayerTown with severity 0.3 for takeover
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[34]} radius 150
                    TestCreature2 = get distance from {LC8_Platoon[34]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC8_Platoon[34]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC8_Platoon[34] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC8_Platoon[34] can navigate to object oTownCentre
                            a = 0
                        elsif LC8_Platoon[34] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC8_Platoon[34] not exists
                end loop
                if AttackMode == 0
                    TownCapturePlatoons[0]--
                end if 
                clear LC8_Platoon[34] action queue
            elsif LC8_Platoon[34] can navigate to {AttackPos[0]}
                clear LC8_Platoon[34] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[0]} to LC8_Platoon[34] action queue
            else
                clear LC8_Platoon[34] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[1]} to LC8_Platoon[34] action queue
            end if
        //end if

        until LC8_Platoon[34] not exists
    end loop
    if LC8_Platoon[34] not exists
        //PlatoonKilled = 1
        wait until LC8_Platoon[34] exists
    end if
end loop

end script LC8_Platoon34Actions

begin script LC8_Platoon35Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC8_Platoon[34] exists and LC8_Platoon[35] exists and LC8_SiegeCatapult[17] exists and LC8_SiegeCatapult[18] exists and ({LC8_SiegeCatapult[17]} near {JapaneseTown1} radius 500) and ({LC8_SiegeCatapult[18]} near {JapaneseTown1} radius 500)
    begin loop

        PlayerCreature = get distance from {LC8_Platoon[35]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC8_Platoon[35] can navigate to {oCreature}
            clear LC8_Platoon[35] action queue
            begin loop
                PlayerCreature = get distance from {LC8_Platoon[35]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK using oCreature to LC8_Platoon[35] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[35]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC8_Platoon[35] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC8_Platoon[35] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[35]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC8_Platoon[35]} radius 50
        if PlayerPlatoon1 exists and LC8_Platoon[35] can navigate to {PlayerPlatoon1}
            clear LC8_Platoon[35] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[35]} radius 150
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK using PlayerPlatoon1 to LC8_Platoon[35] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[35]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC8_Platoon[35] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC8_Platoon[35] action queue
        elsif Catapult exists and LC8_Platoon[35] can navigate to {Catapult}
            clear LC8_Platoon[35] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC8_Platoon[35]} radius 50
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK using Catapult to LC8_Platoon[35] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[35]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[35]} radius 150
                if PlayerPlatoon1 exists and LC8_Platoon[35] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC8_Platoon[35] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC8_Platoon[35] action queue
            a = 0
        end if

        PlayerSettlement = get nearest town at {LC8_Platoon[35]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0 and HEALTH of Armory == 1.0
            if LC8_Platoon[35] can navigate to object Armory
                if TownCapturePlatoons[2] < 2
                    TownCapturePlatoons[2]++
                    clear LC8_Platoon[35] action queue
                    set LC8_Platoon[35] attack PlayerSettlement with severity 0.3 for takeover
                    a = 1
                    begin loop
                        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[35]} radius 150
                        PlayerCreature = get distance from {LC8_Platoon[35]} to {oCreature}
                        if PlayerPlatoon1 exists
                            a = 0
                        elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                            a = 0
                        elsif not LC8_Platoon[35] can navigate to object Armory
                            a = 0
                        elsif LC8_Platoon[35] not exists
                            a = 0
                        end if
                        until a == 0 or LC8_Platoon[35] not exists or PLAYER of PlayerSettlement == 1
                    end loop
                    TownCapturePlatoons[2]--
                end if
                clear LC8_Platoon[35] action queue
            end if
        end if

        //if get size of LC8_Platoon[35] action queue < 1
            if LC8_Platoon[35] can navigate to object oTownCentre and PLAYER of PlayerTown == 0
                wait number from 5 to 25 seconds
                a = 1
                clear LC8_Platoon[35] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC8_Platoon[35] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[35] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[35] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[35] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[35] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[35] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[35] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[0] < 2
                        TownCapturePlatoons[0]++
                        set LC8_Platoon[35] attack PlayerTown with severity 0.3 for takeover
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[35]} radius 150
                    TestCreature2 = get distance from {LC8_Platoon[35]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC8_Platoon[35]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC8_Platoon[35] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC8_Platoon[35] can navigate to object oTownCentre
                            a = 0
                        elsif LC8_Platoon[35] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC8_Platoon[35] not exists
                end loop
                if AttackMode == 0
                    TownCapturePlatoons[0]--
                end if
                clear LC8_Platoon[35] action queue
            elsif LC8_Platoon[35] can navigate to {AttackPos[0]} + {20,0,20}
                clear LC8_Platoon[35] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[0]} + {20,0,20} to LC8_Platoon[35] action queue
            else
                clear LC8_Platoon[35] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[1]} + {20,0,20} to LC8_Platoon[35] action queue
            end if
        //end if

        until LC8_Platoon[35] not exists
    end loop
    if LC8_Platoon[35] not exists
        //PlatoonKilled = 1
        wait until LC8_Platoon[35] exists
    end if
end loop

end script LC8_Platoon35Actions

begin script LC8_SiegeCatapult17Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = create timer for 0 seconds
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 0
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC8_Platoon[34] exists and LC8_Platoon[35] exists and LC8_SiegeCatapult[17] exists and LC8_SiegeCatapult[18] exists and ({LC8_SiegeCatapult[17]} near {JapaneseTown1} radius 500) and ({LC8_SiegeCatapult[18]} near {JapaneseTown1} radius 500)
    wait 2 seconds
    begin loop
        PlayerCreature = get distance from {LC8_SiegeCatapult[17]} to {oCreature}
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_SiegeCatapult[17]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC8_SiegeCatapult[17]} radius 150
        
        if PlayerCreature > 10 and PlayerPlatoon1 not exists and Catapult not exists
            if PlayerPlatoon1 not exists
                a = 1
            elsif PlayerCreature > 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                a = 1
            elsif Catapult not exists
                a = 1
            end if
        end if
        
        if PlayerCreature <= 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
            clear siege weapon LC8_SiegeCatapult[17] action queue
            a = 0
        elsif PlayerPlatoon1 exists and LC8_SiegeCatapult[17] can navigate to {PlayerPlatoon1}
            clear siege weapon LC8_SiegeCatapult[17] action queue
            a = 0
        elsif Catapult exists and LC8_SiegeCatapult[17] can navigate to {Catapult}
            clear siege weapon LC8_SiegeCatapult[17] action queue
            a = 0
        elsif PointOn != 4 and a == 1
            begin loop
                if LC8_SiegeCatapult[17] exists
                    if get SiegeOnPointTimer time remaining <= 0
                        SiegeWeaponPoint = marker at {LC8_SiegeCatapult[17]}
                        SiegeOnPointTimer = create timer for 160 seconds
                    elsif get SiegeOnPointTimer time remaining <= 5
                        if {LC8_SiegeCatapult[17]} near {SiegeWeaponPoint} radius 10
                            clear siege weapon LC8_SiegeCatapult[17] action queue
                            delete LC8_SiegeCatapult[17]
                            SiegeStucked = 1
                        end if
                    end if
                    if get CatapultMoveTimer1 time remaining <= 0
                        if get size of LC8_SiegeCatapult[17] action queue < 1

                            if PointOn == 0
                                if LC8_SiegeCatapult[17] can navigate to {SiegeRoute3[0]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute3[0]} to siege weapon LC8_SiegeCatapult[17] action queue
                                end if
                    
                            elsif PointOn == 1
                                if LC8_SiegeCatapult[17] can navigate to {SiegeRoute3[1]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute3[1]} to siege weapon LC8_SiegeCatapult[17] action queue
                                end if

                            elsif PointOn == 2
                                if LC8_SiegeCatapult[17] can navigate to {SiegeRoute3[2]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute3[2]} to siege weapon LC8_SiegeCatapult[17] action queue
                                end if

                            elsif PointOn == 3
                                if LC8_SiegeCatapult[17] can navigate to {SiegeRoute3[3]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute3[3]} to siege weapon LC8_SiegeCatapult[17] action queue
                                end if

                            CatapultMoveTimer1 = create timer for 10 seconds
                            
                            end if
                        end if
                    end if        

                    if {LC8_SiegeCatapult[17]} near {SiegeRoute3[0]} radius 15 and PointOn != 1 or 60 seconds
                        PointOn = 1
                    elsif {LC8_SiegeCatapult[17]} near {SiegeRoute3[1]} radius 15 and PointOn != 2 or 60 seconds
                        PointOn = 2
                    elsif {LC8_SiegeCatapult[17]} near {SiegeRoute3[2]} radius 15 and PointOn != 3 or 60 seconds
                        PointOn = 3
                    elsif {LC8_SiegeCatapult[17]} near {SiegeRoute3[3]} radius 15 and PointOn != 4 or 60 seconds
                        PointOn = 4
                    elsif not LC8_SiegeCatapult[17] can navigate to {SiegeRoute3[3]} and {LC8_SiegeCatapult[17]} near {SiegeRoute3[2]} radius 15 and PointOn != 4
                        PointOn = 4
                    end if
                end if
            until LC8_SiegeCatapult[17] not exists or PointOn == 4 or 180 seconds
            end loop
        end if
        
        until PointOn == 4 or LC8_SiegeCatapult[17] not exists or 180 seconds
    end loop

    wait 5 seconds

    enable siege weapon LC8_SiegeCatapult[17] auto attack

    begin loop
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 5
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get HOUSE GATEHOUSE at {LC8_SiegeCatapult[17]} radius 250
                if GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE_F at {LC8_SiegeCatapult[17]} radius 250
                end if
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon LC8_SiegeCatapult[17] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[17]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[17] action queue
                elsif GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE at {LC8_SiegeCatapult[17]} radius 750
                    if GateHouse not exists
                        GateHouse = get HOUSE GATEHOUSE_F at {LC8_SiegeCatapult[17]} radius 750
                    end if
                    clear siege weapon LC8_SiegeCatapult[17] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[17]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[17] action queue
                else
                    GateHouse = get random abode of type GATEHOUSE in town PlayerTown
                    if GateHouse not exists
                        GateHouse = get random abode of type GATEHOUSE_F in town PlayerTown
                    end if
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon LC8_SiegeCatapult[17] action queue
                        Target = marker at get target from {LC8_SiegeCatapult[17]} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[17] action queue
                    else
                        ActionTimer = create timer for 0.025 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {LC8_SiegeCatapult[17]} radius 750
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC8_SiegeCatapult[17] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[17]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC8_SiegeCatapult[17] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            else
                House = get building ALTAR in PlayerTown min built 0.75
                if House exists and PLAYER of House == 0 and LC8_SiegeCatapult[17] can navigate to object oTownCentre
                    clear siege weapon LC8_SiegeCatapult[17] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[17]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC8_SiegeCatapult[17] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            end if
        end if

        until LC8_SiegeCatapult[17] not exists
    end loop
    
    if SiegeAttacking == 1 and UnderAttack != 0
        UnderAttack = UnderAttack - 1
    end if

    if LC8_SiegeCatapult[17] not exists and SiegeStucked == 0
        //CatapultDestroyed = 1
    end if
    
end loop

end script LC8_SiegeCatapult17Actions

begin script LC8_SiegeCatapult18Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = create timer for 0 seconds
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 0
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC8_Platoon[34] exists and LC8_Platoon[35] exists and LC8_SiegeCatapult[17] exists and LC8_SiegeCatapult[18] exists and ({LC8_SiegeCatapult[17]} near {JapaneseTown1} radius 500) and ({LC8_SiegeCatapult[18]} near {JapaneseTown1} radius 500)
    wait 2 seconds
    begin loop
        PlayerCreature = get distance from {LC8_SiegeCatapult[18]} to {oCreature}
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_SiegeCatapult[18]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC8_SiegeCatapult[18]} radius 150
        
        if PlayerCreature > 10 and PlayerPlatoon1 not exists and Catapult not exists
            if PlayerPlatoon1 not exists
                a = 1
            elsif PlayerCreature > 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                a = 1
            elsif Catapult not exists
                a = 1
            end if
        end if
        
        if PlayerCreature <= 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
            clear siege weapon LC8_SiegeCatapult[18] action queue
            a = 0
        elsif PlayerPlatoon1 exists and LC8_SiegeCatapult[18] can navigate to {PlayerPlatoon1}
            clear siege weapon LC8_SiegeCatapult[18] action queue
            a = 0
        elsif Catapult exists and LC8_SiegeCatapult[18] can navigate to {Catapult}
            clear siege weapon LC8_SiegeCatapult[18] action queue
            a = 0
        elsif PointOn != 4 and a == 1
            begin loop
                if LC8_SiegeCatapult[18] exists
                    if get SiegeOnPointTimer time remaining <= 0
                        SiegeWeaponPoint = marker at {LC8_SiegeCatapult[18]}
                        SiegeOnPointTimer = create timer for 160 seconds
                    elsif get SiegeOnPointTimer time remaining <= 5
                        if {LC8_SiegeCatapult[18]} near {SiegeWeaponPoint} radius 10
                            clear siege weapon LC8_SiegeCatapult[18] action queue
                            delete LC8_SiegeCatapult[18]
                            SiegeStucked = 1
                        end if
                    end if
                    if get CatapultMoveTimer1 time remaining <= 0
                        if get size of LC8_SiegeCatapult[18] action queue < 1

                            if PointOn == 0
                                if LC8_SiegeCatapult[18] can navigate to {SiegeRoute5[0]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute5[0]} to siege weapon LC8_SiegeCatapult[18] action queue
                                end if
                    
                            elsif PointOn == 1
                                if LC8_SiegeCatapult[18] can navigate to {SiegeRoute5[1]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute5[1]} to siege weapon LC8_SiegeCatapult[18] action queue
                                end if

                            elsif PointOn == 2
                                if LC8_SiegeCatapult[18] can navigate to {SiegeRoute5[2]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute5[2]} to siege weapon LC8_SiegeCatapult[18] action queue
                                end if

                            elsif PointOn == 3
                                if LC8_SiegeCatapult[18] can navigate to {SiegeRoute5[3]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute5[3]} to siege weapon LC8_SiegeCatapult[18] action queue
                                end if

                            CatapultMoveTimer1 = create timer for 10 seconds
                            
                            end if
                        end if
                    end if        

                    if {LC8_SiegeCatapult[18]} near {SiegeRoute5[0]} radius 15 and PointOn != 1 or 60 seconds
                        PointOn = 1
                    elsif {LC8_SiegeCatapult[18]} near {SiegeRoute5[1]} radius 15 and PointOn != 2 or 60 seconds
                        PointOn = 2
                    elsif {LC8_SiegeCatapult[18]} near {SiegeRoute5[2]} radius 15 and PointOn != 3 or 60 seconds
                        PointOn = 3
                    elsif {LC8_SiegeCatapult[18]} near {SiegeRoute5[3]} radius 15 and PointOn != 4 or 60 seconds
                        PointOn = 4
                    elsif not LC8_SiegeCatapult[18] can navigate to {SiegeRoute5[3]} and {LC8_SiegeCatapult[18]} near {SiegeRoute5[2]} radius 15 and PointOn != 4
                        PointOn = 4
                    end if
                end if
            until LC8_SiegeCatapult[18] not exists or PointOn == 4 or 180 seconds
            end loop
        end if
        
        until PointOn == 4 or LC8_SiegeCatapult[18] not exists or 180 seconds
    end loop

    wait 5 seconds

    enable siege weapon LC8_SiegeCatapult[18] auto attack

    begin loop
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 5
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get HOUSE GATEHOUSE at {LC8_SiegeCatapult[18]} radius 250
                if GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE_F at {LC8_SiegeCatapult[18]} radius 250
                end if
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon LC8_SiegeCatapult[18] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[18]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[18] action queue
                elsif GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE at {LC8_SiegeCatapult[18]} radius 750
                    if GateHouse not exists
                        GateHouse = get HOUSE GATEHOUSE_F at {LC8_SiegeCatapult[18]} radius 750
                    end if
                    clear siege weapon LC8_SiegeCatapult[18] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[18]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[18] action queue
                else
                    GateHouse = get random abode of type GATEHOUSE in town PlayerTown
                    if GateHouse not exists
                        GateHouse = get random abode of type GATEHOUSE_F in town PlayerTown
                    end if
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon LC8_SiegeCatapult[18] action queue
                        Target = marker at get target from {LC8_SiegeCatapult[18]} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[18] action queue
                    else
                        ActionTimer = create timer for 0.025 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {LC8_SiegeCatapult[18]} radius 750
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC8_SiegeCatapult[18] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[18]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC8_SiegeCatapult[18] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            else
                House = get building ALTAR in PlayerTown min built 0.75
                if House exists and PLAYER of House == 0 and LC8_SiegeCatapult[18] can navigate to object oTownCentre
                    clear siege weapon LC8_SiegeCatapult[18] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[18]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC8_SiegeCatapult[18] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            end if
        end if

        until LC8_SiegeCatapult[18] not exists
    end loop
    
    if SiegeAttacking == 1 and UnderAttack != 0
        UnderAttack = UnderAttack - 1
    end if

    if LC8_SiegeCatapult[18] not exists and SiegeStucked == 0
        //CatapultDestroyed = 1
    end if
    
end loop

end script LC8_SiegeCatapult18Actions

begin script LC8_Platoon36Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC8_Platoon[36] exists
    begin loop

        PlayerCreature = get distance from {LC8_Platoon[36]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC8_Platoon[36] can navigate to {oCreature}
            clear LC8_Platoon[36] action queue
            begin loop
                PlayerCreature = get distance from {LC8_Platoon[36]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK using oCreature to LC8_Platoon[36] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[36]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC8_Platoon[36] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC8_Platoon[36] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[36]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC8_Platoon[36]} radius 150
        if PlayerPlatoon1 exists and LC8_Platoon[36] can navigate to {PlayerPlatoon1}
            clear LC8_Platoon[36] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[36]} radius 150
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK using PlayerPlatoon1 to LC8_Platoon[36] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[36]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC8_Platoon[36] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC8_Platoon[36] action queue
        elsif Catapult exists and LC8_Platoon[36] can navigate to {Catapult}
            clear LC8_Platoon[36] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC8_Platoon[36]} radius 150
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK using Catapult to LC8_Platoon[36] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[36]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[36]} radius 150
                if PlayerPlatoon1 exists and LC8_Platoon[36] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC8_Platoon[36] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC8_Platoon[36] action queue
            a = 0
        end if
        
        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in NearestSettlement min built 1.0
        if not LC8_Platoon[36] can navigate to object oTownCentre and LC8_SiegeCatapult[19] exists
            add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {LC8_SiegeCatapult[19]} to LC8_Platoon[36] action queue
            wait 5 seconds
        end if

        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in NearestSettlement min built 1.0
        //if get size of LC8_Platoon[36] action queue < 1
            if LC8_Platoon[36] can navigate to object oTownCentre
                wait number from 5 to 25 seconds
                a = 1
                clear LC8_Platoon[36] action queue
                Number = number from 3 to 5
                if Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[36] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[36] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[36] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[36] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[36] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[36] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[1] < 2
                        TownCapturePlatoons[1]++
                        set LC8_Platoon[36] attack NearestSettlement with severity 0.3 for takeover
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[36]} radius 150
                    TestCreature2 = get distance from {LC8_Platoon[36]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC8_Platoon[36]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC8_Platoon[36] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town NearestSettlement is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town NearestSettlement is under takeover from player 1
                            a = 0
                        elsif not LC8_Platoon[36] can navigate to object oTownCentre
                            a = 0
                        elsif LC8_Platoon[36] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town NearestSettlement is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC8_Platoon[36] not exists
                end loop
                if AttackMode == 0
                    TownCapturePlatoons[1]--
                end if
                clear LC8_Platoon[36] action queue
            else
                clear LC8_Platoon[36] action queue
            end if
        //end if

        until LC8_Platoon[36] not exists
    end loop
    if LC8_Platoon[36] not exists
        //PlatoonKilled = 1
        wait until LC8_Platoon[36] exists
    end if
end loop

end script LC8_Platoon36Actions

begin script LC8_Platoon37Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC8_Platoon[37] exists
    begin loop

        PlayerCreature = get distance from {LC8_Platoon[37]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC8_Platoon[37] can navigate to {oCreature}
            clear LC8_Platoon[37] action queue
            begin loop
                PlayerCreature = get distance from {LC8_Platoon[37]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC8_Platoon[37] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[37]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC8_Platoon[37] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC8_Platoon[37] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[37]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC8_Platoon[37]} radius 150
        if PlayerPlatoon1 exists and LC8_Platoon[37] can navigate to {PlayerPlatoon1}
            clear LC8_Platoon[37] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[37]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC8_Platoon[37] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[37]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC8_Platoon[37] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC8_Platoon[37] action queue
        elsif Catapult exists and LC8_Platoon[37] can navigate to {Catapult}
            clear LC8_Platoon[37] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC8_Platoon[37]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC8_Platoon[37] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[37]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[37]} radius 150
                if PlayerPlatoon1 exists and LC8_Platoon[37] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC8_Platoon[37] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC8_Platoon[37] action queue
            a = 0
        end if
        
        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in NearestSettlement min built 1.0
        if not LC8_Platoon[37] can navigate to object oTownCentre and LC8_SiegeCatapult[20] exists
            add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {LC8_SiegeCatapult[20]} to LC8_Platoon[37] action queue
            wait 5 seconds
        end if

        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in NearestSettlement min built 1.0
        //if get size of LC8_Platoon[37] action queue < 1
            if LC8_Platoon[37] can navigate to object oTownCentre
                wait number from 5 to 25 seconds
                a = 1
                clear LC8_Platoon[37] action queue
                Number = number from 3 to 5
                if Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[37] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[37] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[37] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[37] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[37] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[37] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[1] < 2
                        TownCapturePlatoons[1]++
                        set LC8_Platoon[37] attack NearestSettlement with severity 0.3 for takeover
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[37]} radius 150
                    TestCreature2 = get distance from {LC8_Platoon[37]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC8_Platoon[37]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC8_Platoon[37] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town NearestSettlement is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town NearestSettlement is under takeover from player 1
                            a = 0
                        elsif not LC8_Platoon[37] can navigate to object oTownCentre
                            a = 0
                        elsif LC8_Platoon[37] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town NearestSettlement is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC8_Platoon[37] not exists
                end loop
                if AttackMode == 0
                    TownCapturePlatoons[1]--
                end if
                clear LC8_Platoon[37] action queue
            else
                clear LC8_Platoon[37] action queue
            end if
        //end if

        until LC8_Platoon[37] not exists
    end loop
    if LC8_Platoon[37] not exists
        //PlatoonKilled = 1
        wait until LC8_Platoon[37] exists
    end if
end loop

end script LC8_Platoon37Actions

begin script LC8_SiegeCatapult19Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = 5
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 3
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC8_SiegeCatapult[19] exists
    wait 15 seconds

    clear siege weapon LC8_SiegeCatapult[19] action queue

    begin loop
        if get SiegeOnPointTimer time remaining <= 0
            SiegeWeaponPoint = marker at {LC8_SiegeCatapult[19]}
            SiegeOnPointTimer = create timer for 160 seconds
        elsif get SiegeOnPointTimer time remaining <= 5 and not {LC8_SiegeCatapult[19]} near {NearestSettlement} radius 400
            if {LC8_SiegeCatapult[19]} near {SiegeWeaponPoint} radius 10
                clear siege weapon LC8_SiegeCatapult[19] action queue
                delete LC8_SiegeCatapult[19]
                SiegeStucked = 1
            end if
        end if
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 7
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get random abode of type GATEHOUSE in town NearestSettlement
                if GateHouse not exists
                    GateHouse = get random abode of type GATEHOUSE_F in town NearestSettlement
                end if
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon LC8_SiegeCatapult[19] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[19]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[19] action queue
                else
                    GateHouse = get HOUSE GATEHOUSE at {LC8_SiegeCatapult[19]} radius 750
                    if GateHouse not exists
                        GateHouse = get HOUSE GATEHOUSE_F at {LC8_SiegeCatapult[19]} radius 750
                    end if
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon LC8_SiegeCatapult[19] action queue
                        Target = marker at get target from {LC8_SiegeCatapult[19]} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[19] action queue
                    else
                        ActionTimer = create timer for 0.025 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {NearestSettlement} radius 400
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC8_SiegeCatapult[19] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[19]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC8_SiegeCatapult[19] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            elsif NumPat1 == 4 or NumPat1 == 5
                House = get building ALTAR in NearestSettlement min built 0.75
                if House exists and PLAYER of House == 0 and LC8_SiegeCatapult[19] can navigate to object oTownCentre
                    clear siege weapon LC8_SiegeCatapult[19] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[19]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC8_SiegeCatapult[19] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            elsif NumPat1 == 6
                House = get building STORAGE_YARD in NearestSettlement min built 0.75
                if House exists and PLAYER of House == 0 and LC8_SiegeCatapult[19] can navigate to object oTownCentre
                    clear siege weapon LC8_SiegeCatapult[19] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[19]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC8_SiegeCatapult[19] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            else
                House = get building TEMPLE in NearestSettlement min built 0.75
                if House exists and PLAYER of House == 0 and LC8_SiegeCatapult[19] can navigate to object oTownCentre
                    clear siege weapon LC8_SiegeCatapult[19] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[19]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC8_SiegeCatapult[19] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            end if
        end if
        until LC8_SiegeCatapult[19] not exists
    end loop
    
end loop

end script LC8_SiegeCatapult19Actions

begin script LC8_SiegeCatapult20Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = 5
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 3
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC8_SiegeCatapult[20] exists
    wait 15 seconds

    clear siege weapon LC8_SiegeCatapult[20] action queue

    begin loop
        if get SiegeOnPointTimer time remaining <= 0
            SiegeWeaponPoint = marker at {LC8_SiegeCatapult[20]}
            SiegeOnPointTimer = create timer for 160 seconds
        elsif get SiegeOnPointTimer time remaining <= 5 and not {LC8_SiegeCatapult[20]} near {NearestSettlement} radius 400
            if {LC8_SiegeCatapult[20]} near {SiegeWeaponPoint} radius 10
                clear siege weapon LC8_SiegeCatapult[20] action queue
                delete LC8_SiegeCatapult[20]
                SiegeStucked = 1
            end if
        end if
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 7
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get random abode of type GATEHOUSE in town NearestSettlement
                if GateHouse not exists
                    GateHouse = get random abode of type GATEHOUSE_F in town NearestSettlement
                end if
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon LC8_SiegeCatapult[20] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[20]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[20] action queue
                else
                    GateHouse = get HOUSE GATEHOUSE at {LC8_SiegeCatapult[20]} radius 750
                    if GateHouse not exists
                        GateHouse = get HOUSE GATEHOUSE_F at {LC8_SiegeCatapult[20]} radius 750
                    end if
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon LC8_SiegeCatapult[20] action queue
                        Target = marker at get target from {LC8_SiegeCatapult[20]} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC8_SiegeCatapult[20] action queue
                    else
                        ActionTimer = create timer for 0.025 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {NearestSettlement} radius 400
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC8_SiegeCatapult[20] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[20]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC8_SiegeCatapult[20] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            elsif NumPat1 == 4 or NumPat1 == 5
                House = get building ALTAR in NearestSettlement min built 0.75
                if House exists and PLAYER of House == 0 and LC8_SiegeCatapult[20] can navigate to object oTownCentre
                    clear siege weapon LC8_SiegeCatapult[20] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[20]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC8_SiegeCatapult[20] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            elsif NumPat1 == 6
                House = get building STORAGE_YARD in NearestSettlement min built 0.75
                if House exists and PLAYER of House == 0 and LC8_SiegeCatapult[20] can navigate to object oTownCentre
                    clear siege weapon LC8_SiegeCatapult[20] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[20]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC8_SiegeCatapult[20] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            else
                House = get building TEMPLE in NearestSettlement min built 0.75
                if House exists and PLAYER of House == 0 and LC8_SiegeCatapult[20] can navigate to object oTownCentre
                    clear siege weapon LC8_SiegeCatapult[20] action queue
                    Target = marker at get target from {LC8_SiegeCatapult[20]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC8_SiegeCatapult[20] action queue
                else
                    ActionTimer = create timer for 0.025 seconds
                end if
            end if
        end if
        until LC8_SiegeCatapult[20] not exists
    end loop
    
end loop

end script LC8_SiegeCatapult20Actions

begin script LC8_Platoon38Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC8_Platoon[38] exists
    begin loop

        PlayerCreature = get distance from {LC8_Platoon[38]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC8_Platoon[38] can navigate to {oCreature}
            clear LC8_Platoon[38] action queue
            begin loop
                PlayerCreature = get distance from {LC8_Platoon[38]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC8_Platoon[38] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[38]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC8_Platoon[38] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC8_Platoon[38] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[38]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC8_Platoon[38]} radius 150
        if PlayerPlatoon1 exists and LC8_Platoon[38] can navigate to {PlayerPlatoon1}
            clear LC8_Platoon[38] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[38]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC8_Platoon[38] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[38]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC8_Platoon[38] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC8_Platoon[38] action queue
        elsif Catapult exists and LC8_Platoon[38] can navigate to {Catapult}
            clear LC8_Platoon[38] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC8_Platoon[38]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC8_Platoon[38] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[38]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[38]} radius 150
                if PlayerPlatoon1 exists and LC8_Platoon[38] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC8_Platoon[38] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC8_Platoon[38] action queue
            a = 0
        end if
        
        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in NearestSettlement min built 1.0
        if not LC8_Platoon[38] can navigate to object oTownCentre and LC8_SiegeCatapult[19] exists
            add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {LC8_SiegeCatapult[19]} + {20,0,20} to LC8_Platoon[38] action queue
            wait 5 seconds
        end if

        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in NearestSettlement min built 1.0
        //if get size of LC8_Platoon[38] action queue < 1
            if LC8_Platoon[38] can navigate to object oTownCentre
                wait number from 5 to 25 seconds
                a = 1
                clear LC8_Platoon[38] action queue
                Number = number from 3 to 5
                if Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[38] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[38] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[38] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[38] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[38] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[38] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[1] < 2
                        TownCapturePlatoons[1]++
                        set LC8_Platoon[38] attack NearestSettlement with severity 0.3 for takeover
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[38]} radius 150
                    TestCreature2 = get distance from {LC8_Platoon[38]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC8_Platoon[38]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC8_Platoon[38] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town NearestSettlement is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town NearestSettlement is under takeover from player 1
                            a = 0
                        elsif not LC8_Platoon[38] can navigate to object oTownCentre
                            a = 0
                        elsif LC8_Platoon[38] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town NearestSettlement is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC8_Platoon[38] not exists
                end loop
                if AttackMode == 0
                    TownCapturePlatoons[1]--
                end if
                clear LC8_Platoon[38] action queue
            else
                clear LC8_Platoon[38] action queue
            end if
        //end if

        until LC8_Platoon[38] not exists
    end loop
    if LC8_Platoon[38] not exists
        //PlatoonKilled = 1
        wait until LC8_Platoon[38] exists
    end if
end loop

end script LC8_Platoon38Actions

begin script LC8_Platoon39Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC8_Platoon[39] exists
    begin loop

        PlayerCreature = get distance from {LC8_Platoon[39]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC8_Platoon[39] can navigate to {oCreature}
            clear LC8_Platoon[39] action queue
            begin loop
                PlayerCreature = get distance from {LC8_Platoon[39]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC8_Platoon[39] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[39]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC8_Platoon[39] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC8_Platoon[39] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[39]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC8_Platoon[39]} radius 50
        if PlayerPlatoon1 exists and LC8_Platoon[39] can navigate to {PlayerPlatoon1}
            clear LC8_Platoon[39] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[39]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC8_Platoon[39] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[39]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC8_Platoon[39] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC8_Platoon[39] action queue
        elsif Catapult exists and LC8_Platoon[39] can navigate to {Catapult}
            clear LC8_Platoon[39] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC8_Platoon[39]} radius 50
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC8_Platoon[39] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[39]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[39]} radius 150
                if PlayerPlatoon1 exists and LC8_Platoon[39] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC8_Platoon[39] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC8_Platoon[39] action queue
            a = 0
        end if

        //if get size of LC8_Platoon[39] action queue < 1
            if PlatoonArrived[0] == 0
                clear LC8_Platoon[39] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {PortalPos[0]} to LC8_Platoon[39] action queue
            elsif LC8_Platoon[39] can navigate to object oTownCentre
                wait number from 5 to 25 seconds
                a = 1
                clear LC8_Platoon[39] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC8_Platoon[39] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[39] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[39] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[39] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[39] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[39] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[39] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[0] < 2
                        TownCapturePlatoons[0]++
                        set LC8_Platoon[39] attack PlayerTown with severity 0.3 for takeover
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[39]} radius 150
                    TestCreature2 = get distance from {LC8_Platoon[39]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC8_Platoon[39]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC8_Platoon[39] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC8_Platoon[39] can navigate to object oTownCentre
                            a = 0
                        elsif LC8_Platoon[39] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC8_Platoon[39] not exists
                end loop
                if AttackMode == 0
                    TownCapturePlatoons[0]--
                end if
                clear LC8_Platoon[39] action queue
            elsif LC8_Platoon[39] can navigate to {AttackPos[2]} + {20,0,20}
                clear LC8_Platoon[39] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[2]} + {20,0,20} to LC8_Platoon[39] action queue
            else
                clear LC8_Platoon[39] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[3]} + {20,0,20} to LC8_Platoon[39] action queue
            end if
        //end if

        until LC8_Platoon[39] not exists
    end loop
    if LC8_Platoon[39] not exists
        //PlatoonKilled = 1
        wait until LC8_Platoon[39] exists
    end if
end loop

end script LC8_Platoon39Actions

begin script LC8_Platoon40Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC8_Platoon[40] exists
    begin loop

        PlayerCreature = get distance from {LC8_Platoon[40]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC8_Platoon[40] can navigate to {oCreature}
            clear LC8_Platoon[40] action queue
            begin loop
                PlayerCreature = get distance from {LC8_Platoon[40]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC8_Platoon[40] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[40]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC8_Platoon[40] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC8_Platoon[40] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[40]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC8_Platoon[40]} radius 50
        if PlayerPlatoon1 exists and LC8_Platoon[40] can navigate to {PlayerPlatoon1}
            clear LC8_Platoon[40] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[40]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC8_Platoon[40] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[40]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC8_Platoon[40] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC8_Platoon[40] action queue
        elsif Catapult exists and LC8_Platoon[40] can navigate to {Catapult}
            clear LC8_Platoon[40] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC8_Platoon[40]} radius 50
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC8_Platoon[40] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[40]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[40]} radius 150
                if PlayerPlatoon1 exists and LC8_Platoon[40] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC8_Platoon[40] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC8_Platoon[40] action queue
            a = 0
        end if

        //if get size of LC8_Platoon[40] action queue < 1
            if PlatoonArrived[1] == 0
                clear LC8_Platoon[40] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {PortalPos[0]} to LC8_Platoon[40] action queue
            elsif LC8_Platoon[40] can navigate to object oTownCentre
                wait number from 5 to 25 seconds
                a = 1
                clear LC8_Platoon[40] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC8_Platoon[40] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[40] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[40] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[40] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[40] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[40] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[40] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[0] < 2
                        TownCapturePlatoons[0]++
                        set LC8_Platoon[40] attack PlayerTown with severity 0.3 for takeover
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[40]} radius 150
                    TestCreature2 = get distance from {LC8_Platoon[40]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC8_Platoon[40]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC8_Platoon[40] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC8_Platoon[40] can navigate to object oTownCentre
                            a = 0
                        elsif LC8_Platoon[40] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC8_Platoon[40] not exists
                end loop
                if AttackMode == 0
                    TownCapturePlatoons[0]--
                end if
                clear LC8_Platoon[40] action queue
            elsif LC8_Platoon[40] can navigate to {AttackPos[2]} + {-20,0,-20}
                clear LC8_Platoon[40] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[2]} + {-20,0,-20} to LC8_Platoon[40] action queue
            else
                clear LC8_Platoon[40] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[3]} + {-20,0,-20} to LC8_Platoon[40] action queue
            end if
        //end if

        until LC8_Platoon[40] not exists
    end loop
    if LC8_Platoon[40] not exists
        //PlatoonKilled = 1
        wait until LC8_Platoon[40] exists
    end if
end loop

end script LC8_Platoon40Actions

begin script LC8_Platoon41Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC8_Platoon[41] exists
    begin loop

        PlayerCreature = get distance from {LC8_Platoon[41]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC8_Platoon[41] can navigate to {oCreature}
            clear LC8_Platoon[41] action queue
            begin loop
                PlayerCreature = get distance from {LC8_Platoon[41]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK using oCreature to LC8_Platoon[41] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[41]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC8_Platoon[41] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC8_Platoon[41] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[41]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC8_Platoon[41]} radius 50
        if PlayerPlatoon1 exists and LC8_Platoon[41] can navigate to {PlayerPlatoon1}
            clear LC8_Platoon[41] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[41]} radius 150
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK using PlayerPlatoon1 to LC8_Platoon[41] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[41]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC8_Platoon[41] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC8_Platoon[41] action queue
        elsif Catapult exists and LC8_Platoon[41] can navigate to {Catapult}
            clear LC8_Platoon[41] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC8_Platoon[41]} radius 50
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK using Catapult to LC8_Platoon[41] action queue
                NumPat1 = get number of villagers in platoon LC8_Platoon[41]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[41]} radius 150
                if PlayerPlatoon1 exists and LC8_Platoon[41] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC8_Platoon[41] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC8_Platoon[41] action queue
            a = 0
        end if

        //if get size of LC8_Platoon[41] action queue < 1
            if PlatoonArrived[2] == 0
                clear LC8_Platoon[41] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {PortalPos[0]} to LC8_Platoon[41] action queue
            elsif LC8_Platoon[41] can navigate to object oTownCentre
                wait number from 5 to 25 seconds
                a = 1
                clear LC8_Platoon[41] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC8_Platoon[41] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[41] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[41] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[41] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[41] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[41] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC8_Platoon[41] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    if TownCapturePlatoons[0] < 2
                        TownCapturePlatoons[0]++
                        set LC8_Platoon[41] attack PlayerTown with severity 0.3 for takeover
                    end if
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[41]} radius 150
                    TestCreature2 = get distance from {LC8_Platoon[41]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC8_Platoon[41]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC8_Platoon[41] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC8_Platoon[41] can navigate to object oTownCentre
                            a = 0
                        elsif LC8_Platoon[41] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC8_Platoon[41] not exists
                end loop
                if AttackMode == 0
                    TownCapturePlatoons[0]--
                end if
                clear LC8_Platoon[41] action queue
            elsif LC8_Platoon[41] can navigate to {AttackPos[2]}
                clear LC8_Platoon[41] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[2]} to LC8_Platoon[41] action queue
            else
                clear LC8_Platoon[41] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[3]} to LC8_Platoon[41] action queue
            end if
        //end if

        until LC8_Platoon[41] not exists
    end loop
    if LC8_Platoon[41] not exists
        //PlatoonKilled = 1
        wait until LC8_Platoon[41] exists
    end if
end loop

end script LC8_Platoon41Actions

begin script LC8_Platoon18Actions

    oCreature = get player 0 creature
    HeTeste3 = 0
    TestCreature2 = 0
    NumPat = 0
    NumPat5 = 0
    PlayerPlatoon1 = 0
    WorrNum = 0
    JapaneseTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in MinorTown3 min built 1.0
    ProPlatoonsLocation = 0
    AIPlatoon1 = 0
    Armory = 0
    Town8 = get town with id 8
    RandomActionP3 = 0
    a = 1
    Timer = create timer for 0 seconds
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    oWall = 0
    PlayerCatapult1 = 0
    PlayerPlatoonInRange = 0
    TownCaptured = 0
    PlayerSettlement = 0
    
start

begin loop
    
    wait until LC8_Platoon[18] exists

    TestCreature2 = get distance from {LC8_Platoon[18]} to {oCreature}
    if TestCreature2 <= 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC8_Platoon[18] can navigate to {oCreature}
        clear LC8_Platoon[18] action queue
        begin loop
            TestCreature2 = get distance from {LC8_Platoon[18]} to {oCreature}
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC8_Platoon[18] action queue
            NumPat5 = get number of villagers in platoon LC8_Platoon[18]
            until NumPat5 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC8_Platoon[18] can navigate to {oCreature} or TestCreature2 > 200
        end loop
        clear LC8_Platoon[18] action queue
    end if
    
    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[18]} radius 200
    PlayerCatapult1 = get siege weapon of player 0 nearest {LC8_Platoon[18]} radius 155
    if PlayerPlatoon1 exists and LC8_Platoon[18] can navigate to {PlayerPlatoon1}
        clear LC8_Platoon[18] action queue
        begin loop
            PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[18]} radius 200
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC8_Platoon[18] action queue
            NumPat5 = get number of villagers in platoon LC8_Platoon[18]
            HeTeste3 = get number of villagers in platoon PlayerPlatoon1
            until NumPat5 == 0 or HeTeste3 == 0 or not LC8_Platoon[18] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
        end loop
        clear LC8_Platoon[18] action queue
    elsif PlayerCatapult1 exists and LC8_Platoon[18] can navigate to {PlayerCatapult1}
        clear LC8_Platoon[18] action queue
        a = 0
        begin loop
            PlayerCatapult1 = get siege weapon of player 0 nearest {LC8_Platoon[18]} radius 155
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using PlayerCatapult1 to LC8_Platoon[18] action queue
            NumPat5 = get number of villagers in platoon LC8_Platoon[18]
            PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[18]} radius 200
            if PlayerPlatoon1 exists and LC8_Platoon[18] can navigate to {PlayerPlatoon1}
                a = 1
            end if
            until NumPat5 == 0 or PlayerCatapult1 not exists or not LC8_Platoon[18] can navigate to {PlayerCatapult1} or a == 1 or PlayerCatapult1 not exists
        end loop
        clear LC8_Platoon[18] action queue
        a = 0
    end if

    if LC8_Platoon[18] can navigate to object JapaneseTownCentre and PLAYER of MinorTown3 != 1 and TownCaptured == 0
        a = 1
        clear LC8_Platoon[18] action queue
        if LC8_Platoon[18] can navigate to object JapaneseTownCentre and PLAYER of MinorTown3 != 1
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[18]} radius 150
                TestCreature2 = get distance from {LC8_Platoon[18]} to {oCreature}
                set LC8_Platoon[18] attack MinorTown3 with severity 0.7 for takeover
                if PlayerPlatoon1 exists
                    a = 0
                elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                    a = 0
                elsif not LC8_Platoon[18] can navigate to object JapaneseTownCentre
                    a = 0
                elsif LC8_Platoon[18] not exists
                    a = 0
                elsif PLAYER of MinorTown3 == 1
                    a = 0
                end if
                until a == 0 or LC8_Platoon[18] not exists
            end loop
        end if
        clear LC8_Platoon[18] action queue
    end if
    if LC8_Platoon[18] can navigate to {MinorTown3} + {-20,0,-20} and PLAYER of MinorTown3 == 1
        TownCaptured = 1
        clear LC8_Platoon[18] action queue
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {MinorTown3} + {-20,0,-20} to LC8_Platoon[18] action queue
    end if
    
end loop

end script LC8_Platoon18Actions

begin script LC8_Platoon19Actions

    oCreature = get player 0 creature
    HeTeste3 = 0
    TestCreature2 = 0
    NumPat = 0
    NumPat5 = 0
    PlayerPlatoon1 = 0
    WorrNum = 0
    JapaneseTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in MinorTown3 min built 1.0
    ProPlatoonsLocation = 0
    AIPlatoon1 = 0
    Armory = 0
    Town8 = get town with id 8
    RandomActionP3 = 0
    a = 1
    Timer = create timer for 0 seconds
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    oWall = 0
    PlayerCatapult1 = 0
    PlayerPlatoonInRange = 0
    TownCaptured = 0
    PlayerSettlement = 0
    
start

begin loop
    
    wait until LC8_Platoon[19] exists

    TestCreature2 = get distance from {LC8_Platoon[19]} to {oCreature}
    if TestCreature2 <= 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC8_Platoon[19] can navigate to {oCreature}
        clear LC8_Platoon[19] action queue
        begin loop
            TestCreature2 = get distance from {LC8_Platoon[19]} to {oCreature}
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC8_Platoon[19] action queue
            NumPat5 = get number of villagers in platoon LC8_Platoon[19]
            until NumPat5 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC8_Platoon[19] can navigate to {oCreature} or TestCreature2 > 200
        end loop
        clear LC8_Platoon[19] action queue
    end if
    
    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[19]} radius 200
    PlayerCatapult1 = get siege weapon of player 0 nearest {LC8_Platoon[19]} radius 155
    if PlayerPlatoon1 exists and LC8_Platoon[19] can navigate to {PlayerPlatoon1}
        clear LC8_Platoon[19] action queue
        begin loop
            PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[19]} radius 200
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC8_Platoon[19] action queue
            NumPat5 = get number of villagers in platoon LC8_Platoon[19]
            HeTeste3 = get number of villagers in platoon PlayerPlatoon1
            until NumPat5 == 0 or HeTeste3 == 0 or not LC8_Platoon[19] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
        end loop
        clear LC8_Platoon[19] action queue
    elsif PlayerCatapult1 exists and LC8_Platoon[19] can navigate to {PlayerCatapult1}
        clear LC8_Platoon[19] action queue
        a = 0
        begin loop
            PlayerCatapult1 = get siege weapon of player 0 nearest {LC8_Platoon[19]} radius 155
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using PlayerCatapult1 to LC8_Platoon[19] action queue
            NumPat5 = get number of villagers in platoon LC8_Platoon[19]
            PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[19]} radius 200
            if PlayerPlatoon1 exists and LC8_Platoon[19] can navigate to {PlayerPlatoon1}
                a = 1
            end if
            until NumPat5 == 0 or PlayerCatapult1 not exists or not LC8_Platoon[19] can navigate to {PlayerCatapult1} or a == 1 or PlayerCatapult1 not exists
        end loop
        clear LC8_Platoon[19] action queue
        a = 0
    end if

    if LC8_Platoon[19] can navigate to object JapaneseTownCentre and PLAYER of MinorTown3 != 1 and TownCaptured == 0
        a = 1
        clear LC8_Platoon[19] action queue
        if LC8_Platoon[19] can navigate to object JapaneseTownCentre and PLAYER of MinorTown3 != 1
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[19]} radius 150
                TestCreature2 = get distance from {LC8_Platoon[19]} to {oCreature}
                set LC8_Platoon[19] attack MinorTown3 with severity 0.7 for takeover
                if PlayerPlatoon1 exists
                    a = 0
                elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                    a = 0
                elsif not LC8_Platoon[19] can navigate to object JapaneseTownCentre
                    a = 0
                elsif LC8_Platoon[19] not exists
                    a = 0
                elsif PLAYER of MinorTown3 == 1
                    a = 0
                end if
                until a == 0 or LC8_Platoon[19] not exists
            end loop
        end if
        clear LC8_Platoon[19] action queue
    end if
    if LC8_Platoon[19] can navigate to {MinorTown3} + {20,0,20} and PLAYER of MinorTown3 == 1
        TownCaptured = 1
        clear LC8_Platoon[19] action queue
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {MinorTown3} + {20,0,20} to LC8_Platoon[19] action queue
    end if
    
end loop

end script LC8_Platoon19Actions

begin script LC8_Platoon20Actions

    oCreature = get player 0 creature
    HeTeste3 = 0
    TestCreature2 = 0
    NumPat = 0
    NumPat5 = 0
    PlayerPlatoon1 = 0
    WorrNum = 0
    JapaneseTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in MinorTown2 min built 1.0
    ProPlatoonsLocation = 0
    AIPlatoon1 = 0
    Armory = 0
    Town8 = get town with id 8
    RandomActionP3 = 0
    a = 1
    Timer = create timer for 0 seconds
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    oWall = 0
    PlayerCatapult1 = 0
    PlayerPlatoonInRange = 0
    TownCaptured = 0
    PlayerSettlement = 0
    
start

begin loop
    
    wait until LC8_Platoon[20] exists

    TestCreature2 = get distance from {LC8_Platoon[20]} to {oCreature}
    if TestCreature2 <= 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC8_Platoon[20] can navigate to {oCreature}
        clear LC8_Platoon[20] action queue
        begin loop
            TestCreature2 = get distance from {LC8_Platoon[20]} to {oCreature}
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC8_Platoon[20] action queue
            NumPat5 = get number of villagers in platoon LC8_Platoon[20]
            until NumPat5 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC8_Platoon[20] can navigate to {oCreature} or TestCreature2 > 200
        end loop
        clear LC8_Platoon[20] action queue
    end if
    
    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[20]} radius 200
    PlayerCatapult1 = get siege weapon of player 0 nearest {LC8_Platoon[20]} radius 155
    if PlayerPlatoon1 exists and LC8_Platoon[20] can navigate to {PlayerPlatoon1}
        clear LC8_Platoon[20] action queue
        begin loop
            PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[20]} radius 200
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC8_Platoon[20] action queue
            NumPat5 = get number of villagers in platoon LC8_Platoon[20]
            HeTeste3 = get number of villagers in platoon PlayerPlatoon1
            until NumPat5 == 0 or HeTeste3 == 0 or not LC8_Platoon[20] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
        end loop
        clear LC8_Platoon[20] action queue
    elsif PlayerCatapult1 exists and LC8_Platoon[20] can navigate to {PlayerCatapult1}
        clear LC8_Platoon[20] action queue
        a = 0
        begin loop
            PlayerCatapult1 = get siege weapon of player 0 nearest {LC8_Platoon[20]} radius 155
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using PlayerCatapult1 to LC8_Platoon[20] action queue
            NumPat5 = get number of villagers in platoon LC8_Platoon[20]
            PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[20]} radius 200
            if PlayerPlatoon1 exists and LC8_Platoon[20] can navigate to {PlayerPlatoon1}
                a = 1
            end if
            until NumPat5 == 0 or PlayerCatapult1 not exists or not LC8_Platoon[20] can navigate to {PlayerCatapult1} or a == 1 or PlayerCatapult1 not exists
        end loop
        clear LC8_Platoon[20] action queue
        a = 0
    end if

    if LC8_Platoon[20] can navigate to object JapaneseTownCentre and PLAYER of MinorTown2 != 1 and TownCaptured == 0
        a = 1
        clear LC8_Platoon[20] action queue
        if LC8_Platoon[20] can navigate to object JapaneseTownCentre and PLAYER of MinorTown2 != 1
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[20]} radius 150
                TestCreature2 = get distance from {LC8_Platoon[20]} to {oCreature}
                set LC8_Platoon[20] attack MinorTown2 with severity 0.7 for takeover
                if PlayerPlatoon1 exists
                    a = 0
                elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                    a = 0
                elsif not LC8_Platoon[20] can navigate to object JapaneseTownCentre
                    a = 0
                elsif LC8_Platoon[20] not exists
                    a = 0
                elsif PLAYER of MinorTown2 == 1
                    a = 0
                end if
                until a == 0 or LC8_Platoon[20] not exists
            end loop
        end if
        clear LC8_Platoon[20] action queue
    end if
    if LC8_Platoon[20] can navigate to {MinorTown2} + {20,0,20} and PLAYER of MinorTown2 == 1
        TownCaptured = 1
        clear LC8_Platoon[20] action queue
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {MinorTown2} + {20,0,20} to LC8_Platoon[20] action queue
    end if
    
end loop

end script LC8_Platoon20Actions

begin script LC8_Platoon21Actions

    oCreature = get player 0 creature
    HeTeste3 = 0
    TestCreature2 = 0
    NumPat = 0
    NumPat5 = 0
    PlayerPlatoon1 = 0
    WorrNum = 0
    JapaneseTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in MinorTown2 min built 1.0
    ProPlatoonsLocation = 0
    AIPlatoon1 = 0
    Armory = 0
    Town8 = get town with id 8
    RandomActionP3 = 0
    a = 1
    Timer = create timer for 0 seconds
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    oWall = 0
    PlayerCatapult1 = 0
    PlayerPlatoonInRange = 0
    TownCaptured = 0
    PlayerSettlement = 0
    
start

begin loop
    
    wait until LC8_Platoon[21] exists

    TestCreature2 = get distance from {LC8_Platoon[21]} to {oCreature}
    if TestCreature2 <= 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC8_Platoon[21] can navigate to {oCreature}
        clear LC8_Platoon[21] action queue
        begin loop
            TestCreature2 = get distance from {LC8_Platoon[21]} to {oCreature}
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC8_Platoon[21] action queue
            NumPat5 = get number of villagers in platoon LC8_Platoon[21]
            until NumPat5 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC8_Platoon[21] can navigate to {oCreature} or TestCreature2 > 200
        end loop
        clear LC8_Platoon[21] action queue
    end if
    
    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[21]} radius 200
    PlayerCatapult1 = get siege weapon of player 0 nearest {LC8_Platoon[21]} radius 155
    if PlayerPlatoon1 exists and LC8_Platoon[21] can navigate to {PlayerPlatoon1}
        clear LC8_Platoon[21] action queue
        begin loop
            PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[21]} radius 200
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC8_Platoon[21] action queue
            NumPat5 = get number of villagers in platoon LC8_Platoon[21]
            HeTeste3 = get number of villagers in platoon PlayerPlatoon1
            until NumPat5 == 0 or HeTeste3 == 0 or not LC8_Platoon[21] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
        end loop
        clear LC8_Platoon[21] action queue
    elsif PlayerCatapult1 exists and LC8_Platoon[21] can navigate to {PlayerCatapult1}
        clear LC8_Platoon[21] action queue
        a = 0
        begin loop
            PlayerCatapult1 = get siege weapon of player 0 nearest {LC8_Platoon[21]} radius 155
            add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using PlayerCatapult1 to LC8_Platoon[21] action queue
            NumPat5 = get number of villagers in platoon LC8_Platoon[21]
            PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[21]} radius 200
            if PlayerPlatoon1 exists and LC8_Platoon[21] can navigate to {PlayerPlatoon1}
                a = 1
            end if
            until NumPat5 == 0 or PlayerCatapult1 not exists or not LC8_Platoon[21] can navigate to {PlayerCatapult1} or a == 1 or PlayerCatapult1 not exists
        end loop
        clear LC8_Platoon[21] action queue
        a = 0
    end if

    if LC8_Platoon[21] can navigate to object JapaneseTownCentre and PLAYER of MinorTown2 != 1 and TownCaptured == 0
        a = 1
        clear LC8_Platoon[21] action queue
        if LC8_Platoon[21] can navigate to object JapaneseTownCentre and PLAYER of MinorTown2 != 1
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[21]} radius 150
                TestCreature2 = get distance from {LC8_Platoon[21]} to {oCreature}
                set LC8_Platoon[21] attack MinorTown2 with severity 0.7 for takeover
                if PlayerPlatoon1 exists
                    a = 0
                elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                    a = 0
                elsif not LC8_Platoon[21] can navigate to object JapaneseTownCentre
                    a = 0
                elsif LC8_Platoon[21] not exists
                    a = 0
                elsif PLAYER of MinorTown2 == 1
                    a = 0
                end if
                until a == 0 or LC8_Platoon[21] not exists
            end loop
        end if
        clear LC8_Platoon[21] action queue
    end if
    if LC8_Platoon[21] can navigate to {MinorTown2} + {-20,0,-20} and PLAYER of MinorTown2 == 1
        TownCaptured = 1
        clear LC8_Platoon[21] action queue
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {MinorTown2} + {-20,0,-20} to LC8_Platoon[21] action queue
    end if
    
end loop

end script LC8_Platoon21Actions

begin script LC8_Platoon43Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = 0
    Number = 0
    PlatoonFirstTime = 1
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    TownToAttack = 0
    
start

begin loop
    a = 0
    wait until LC8_Platoon[43] exists

    PlayerCreature = get distance from {LC8_Platoon[43]} to {oCreature}
    if PlayerCreature <= 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC8_Platoon[43] can navigate to {oCreature}
        clear LC8_Platoon[43] action queue
        begin loop
            PlayerCreature = get distance from {LC8_Platoon[43]} to {oCreature}
            add action PLATOON_AGENDA_ACTION_RANGED_ATTACK using oCreature to LC8_Platoon[43] action queue
            NumPat1 = get number of villagers in platoon LC8_Platoon[43]
            until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC8_Platoon[43] can navigate to {oCreature} or PlayerCreature > 200
        end loop
        clear LC8_Platoon[43] action queue
    end if
    
    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[43]} radius 200
    Catapult = get siege weapon of player 0 nearest {LC8_Platoon[43]} radius 155
    if PlayerPlatoon1 exists and LC8_Platoon[43] can navigate to {PlayerPlatoon1}
        clear LC8_Platoon[43] action queue
        begin loop
            PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[43]} radius 200
            add action PLATOON_AGENDA_ACTION_RANGED_ATTACK using PlayerPlatoon1 to LC8_Platoon[43] action queue
            NumPat1 = get number of villagers in platoon LC8_Platoon[43]
            HeTeste1 = get number of villagers in platoon PlayerPlatoon1
            until NumPat1 == 0 or HeTeste1 == 0 or not LC8_Platoon[43] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
        end loop
        clear LC8_Platoon[43] action queue
    elsif Catapult exists and LC8_Platoon[43] can navigate to {Catapult}
        clear LC8_Platoon[43] action queue
        a = 0
        begin loop
            Catapult = get siege weapon of player 0 nearest {LC8_Platoon[43]} radius 155
            add action PLATOON_AGENDA_ACTION_RANGED_ATTACK using Catapult to LC8_Platoon[43] action queue
            NumPat1 = get number of villagers in platoon LC8_Platoon[43]
            PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[43]} radius 200
            if PlayerPlatoon1 exists and LC8_Platoon[43] can navigate to {PlayerPlatoon1}
                a = 1
            end if
            until NumPat1 == 0 or Catapult not exists or not LC8_Platoon[43] can navigate to {Catapult} or a == 1 or Catapult not exists
        end loop
        clear LC8_Platoon[43] action queue
        a = 0
    end if

    PlayerSettlement = get nearest town at {LC8_Platoon[43]} for player 0 radius 500
    //Not a Armory, it's a towncentre.
    Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
    if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0 and HEALTH of Armory == 1.0
        if LC8_Platoon[43] can navigate to object Armory
            if TownCapturePlatoons[2] < 2
                TownCapturePlatoons[2]++
                clear LC8_Platoon[43] action queue
                set LC8_Platoon[43] attack PlayerSettlement with severity 0.3 for takeover
                a = 1
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[43]} radius 75
                    PlayerCreature = get distance from {LC8_Platoon[43]} to {oCreature}
                    if PlayerPlatoon1 exists
                        a = 0
                    elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                        a = 0
                    elsif not LC8_Platoon[43] can navigate to object Armory
                        a = 0
                    elsif LC8_Platoon[43] not exists
                        a = 0
                    end if
                    until a == 0 or LC8_Platoon[43] not exists or PLAYER of PlayerSettlement == 1
                end loop
                TownCapturePlatoons[2]--
            end if
            clear LC8_Platoon[43] action queue
        end if
    end if

    if PLAYER of MinorTown2 != 1
        TownToAttack = MinorTown2
    else
        TownToAttack = MinorTown3
    end if
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in TownToAttack min built 1.0
    if LC8_Platoon[43] can navigate to object oTownCentre and PLAYER of TownToAttack != 1
        //wait number from 5 to 25 seconds
        a = 1
        clear LC8_Platoon[43] action queue
        Number = 1
        if Number == 1 //Capture Town
            AttackMode = 0
            set LC8_Platoon[43] attack TownToAttack with severity 0.3 for takeover
        end if
        RecalculateTimer = create timer for 40 seconds
        begin loop
            PlayerPlatoon1 = get platoon of player 0 nearest {LC8_Platoon[43]} radius 150
            TestCreature2 = get distance from {LC8_Platoon[43]} to {MyCreature}
            NumPat1 = get number of villagers in platoon LC8_Platoon[43]
            //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC8_Platoon[43] can navigate to object TownToAttackCentre
                if PlayerPlatoon1 exists and not town TownToAttack is under takeover from player 1
                    a = 0
                elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town TownToAttack is under takeover from player 1
                    a = 0
                elsif not LC8_Platoon[43] can navigate to object oTownCentre
                    a = 0
                elsif LC8_Platoon[43] not exists
                    a = 0
                elsif AttackMode == 1 and HEALTH of MyCreature == 0
                    a = 0
                elsif AttackMode == 2 and Building not exists
                    a = 0
                elsif AttackMode == 2 and HEALTH of Building < 0.1
                    a = 0
                elsif AttackMode == 2 and Building == 0
                    a = 0
                elsif not town TownToAttack is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                    a = 0
                end if
            //end if
            until a == 0 or LC8_Platoon[43] not exists
        end loop
        clear LC8_Platoon[43] action queue
    elsif LC8_Platoon[43] can navigate to {1544.35,104.56,1523.21} and not {LC8_Platoon[43]} near {1544.35,104.56,1523.21} radius 25 and get size of LC8_Platoon[43] action queue < 1
        clear LC8_Platoon[43] action queue
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {1544.35,104.56,1523.21} to LC8_Platoon[43] action queue
    end if

end loop

end script LC8_Platoon43Actions
