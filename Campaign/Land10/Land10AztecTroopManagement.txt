///////////////////////////////////////////////////////////////////////////////
//    Land 10 Aztec Troop-Management
//    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
//
//    Start date:         18.08.16            By:    Boxhead
//    Update date:        31.10.16            By: Boxhead
///////////////////////////////////////////////////////////////////////////////

//-----------------------------------------------------------------------------
//    Globals
//-----------------------------------------------------------------------------

define LC10_NUM_OF_DEFENDERS                = 0 //Unused
define LC10_NUM_OF_PLATOONS                = 45
define LC10_NUM_OF_SIEGE_CATAPULTS         = 25
define LC10_NUM_OF_WALL_ARCHERS            = 20
//Army Types
define Melee                             = 0
define Ranged                            = 1
//Army Behaivours
define Attacker                            = 0
define Escort                            = 1
define Conqueror                        = 2 //Nearest Settlement Attacker
define Patrol                            = 3
define Special                            = 4

define script LC10_StaticPlatoonsActions(Pos,Type,Platoon)
define script Waypoints

global LC10_Defender[LC10_NUM_OF_DEFENDERS]
global LC10_Platoon[LC10_NUM_OF_PLATOONS]
global LC10_SiegeCatapult[LC10_NUM_OF_SIEGE_CATAPULTS]
global LC10_WallArcher[LC10_NUM_OF_WALL_ARCHERS]

global PlatoonPos[25]
global StaticSiegePos[10]
global AttackPos[5]
global SiegePlatoonPos[3]
global SiegeRoute1[5]
global SiegeRoute2[5]
global SiegeRoute3[5]
global SiegeRoute4[5]
global SiegeRoute5[3]
global SiegeRoute6[5]
global SiegeRoute7[3]
global PlayerWallPos[2]

global SiegeAttackPrePos[4]
global SiegeAttackPos[4]

global PatrolRouteA[4]
global WaypointsA = 0
global PatrolRouteB[4]
global WaypointsB = 0
global PatrolRouteC[4]
global WaypointsC = 0

//-----------------------------------------------------------------------------

//-----------------------------------------------------------------------------
//    Setting up waypoints for AI actions CHANGE PLATOONPOS2 AND 4
//-----------------------------------------------------------------------------

run script Waypoints

begin script Waypoints

start

    SiegeAttackPrePos[0] = marker at {1765.98,44.97,1253.20}

    SiegeAttackPos[0] = marker at {2063.16,55.61,1297.50}

    PlayerWallPos[0] = marker at {1296.29,151.23,864.95}
    PlayerWallPos[1] = marker at {1660.86,158.43,799.39}

    //AztecCapital
    PlatoonPos[0] = marker at {1529.20,133.53,2250.18}
    PlatoonPos[1] = marker at {1529.26,133.53,2235.90}

    //AztecTown1
    PlatoonPos[2] = marker at {1367.21,94.66,1804.67}
    PlatoonPos[3] = marker at {1362.27,99.45,1887.78}

    //AztecTown2
    PlatoonPos[4] = marker at {1188.63,94.67,1296.29}
    PlatoonPos[5] = marker at {1318.62,84.02,1262.36}

    //AztecPrison
    PlatoonPos[6] = marker at {1556.80,185.07,740.00}
    PlatoonPos[7] = marker at {1582.10,184.93,773.35}
    PlatoonPos[8] = marker at {1652.13,187.21,706.89}
    PlatoonPos[9] = marker at {1696.87,197.50,709.12}

    //Attack Wave Initial
    PlatoonPos[10] = marker at {1239.18,85.19,1947.17}
    PlatoonPos[11] = marker at {1225.43,90.23,1923.02}
    PlatoonPos[12] = marker at {1250.56,93.23,1918.68}

    //Attack Wave Volcano
    PlatoonPos[13] = marker at {1662.64,92.87,1947.28}
    PlatoonPos[14] = marker at {1633.83,93.42,1942.07}
    PlatoonPos[15] = marker at {1642.66,94.46,1959.25}

    AttackPos[0] = marker at {1294.74,135.53,870.82}//FrontAttackpos
    AttackPos[1] = marker at {1187.61,98.44,1158.94}//FrontFallback
    AttackPos[2] = marker at {1479.41,185.66,749.19}//BackdoorAttackpos
    AttackPos[3] = marker at {1690.66,169.07,1037.93}//BackdoorFallback

    //AztecCapital to PlayerTown
    SiegeRoute1[0] = marker at {1386.62,129.15,2087.15}//Not variable
    SiegeRoute1[1] = marker at {1102.40,90.56,1856.61}
    SiegeRoute1[2] = marker at {1020.85,94.99,1466.56}
    SiegeRoute1[3] = marker at {1187.85,98.44,1195.50}
    SiegeRoute1[4] = marker at {1303.06,129.02,884.10}

    SiegeRoute2[0] = marker at {SiegeRoute1[0]}//Not variable
    SiegeRoute2[1] = marker at {SiegeRoute1[1]} + {-20,0,-20}
    SiegeRoute2[2] = marker at {SiegeRoute1[2]} + {-20,0,-20}
    SiegeRoute2[3] = marker at {SiegeRoute1[3]} + {-20,0,-20}
    SiegeRoute2[4] = marker at {SiegeRoute1[4]} + {-20,0,-20}

    SiegeRoute6[0] = marker at {SiegeRoute1[0]}//Not variable
    SiegeRoute6[1] = marker at {SiegeRoute1[1]} + {20,0,20}
    SiegeRoute6[2] = marker at {SiegeRoute1[2]} + {20,0,20}
    SiegeRoute6[3] = marker at {SiegeRoute1[3]} + {20,0,20}
    SiegeRoute6[4] = marker at {SiegeRoute1[4]} + {20,0,20}

    SiegeRoute7[0] = marker at {SiegeRoute1[0]}//Not variable
    SiegeRoute7[1] = marker at {SiegeRoute1[1]} + {-20,0,0}
    SiegeRoute7[2] = marker at {SiegeRoute1[2]} + {-20,0,0}
    SiegeRoute7[3] = marker at {SiegeRoute1[3]} + {-20,0,0}
    SiegeRoute7[4] = marker at {SiegeRoute1[4]} + {-20,0,0}

    //AztecCapital to PlayerTown Volcano Route
    SiegeRoute3[0] = marker at {1561.33,124.46,2078.58}//Not variable
    SiegeRoute3[1] = marker at {1710.82,95.41,1948.76}
    SiegeRoute3[2] = marker at {1831.66,135.48,1385.86}
    SiegeRoute3[3] = marker at {1695.72,171.22,1000.29}
    SiegeRoute3[4] = marker at {1430.42,186.13,734.22}

    SiegeRoute4[0] = marker at {SiegeRoute3[0]}//Not variable
    SiegeRoute4[1] = marker at {SiegeRoute3[1]} + {-20,0,-20}
    SiegeRoute4[2] = marker at {SiegeRoute3[2]} + {-20,0,-20}
    SiegeRoute4[3] = marker at {SiegeRoute3[3]} + {-20,0,-20}
    SiegeRoute4[4] = marker at {SiegeRoute3[4]} + {-20,0,-20}

    //AztecTown1/2 to PlayerTown
    SiegeRoute5[0] = marker at {1094.04,97.98,1314.44}//Not variable
    SiegeRoute5[1] = marker at {1181.98,98.44,1118.83}
    SiegeRoute5[2] = marker at {1304.47,123.06,909.00}

    SiegePlatoonPos[0] = marker at {1373.81,126.01,2060.98}

    PatrolRouteA[0] = marker at {1356.79,108.25,1978.64}
    PatrolRouteA[1] = marker at {1499.70,97.81,1912.74}
    PatrolRouteA[2] = marker at {11604.90,93.43,1911.42}
    PatrolRouteA[3] = marker at {1761.94,98.98,1966.80}

    StaticSiegePos[0] = marker at {429.74,222.68,1854.82}

    WaypointsA = create SCRIPT_OBJECT_TYPE_WAYPOINTROUTE at {0, 0, 0}

    add {PatrolRouteA[0]} to waypoint list WaypointsA
    add {PatrolRouteA[1]} to waypoint list WaypointsA
    add {PatrolRouteA[2]} to waypoint list WaypointsA
    add {PatrolRouteA[3]} to waypoint list WaypointsA

end script Waypoints

//-----------------------------------------------------------------------------

begin script LC10_StaticPlatoonsActions(Pos,Type,Platoon)

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    Catapult = 0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    PlayerSettlement = 0

start

if Platoon == LC10_Platoon[3] or Platoon == LC10_Platoon[4] or Platoon == LC10_Platoon[5] or Platoon == LC10_Platoon[6]
    wait until IntroFinished == 1
end if

begin loop

    if Type == Melee
        PlayerCreature = get distance from {Platoon} to {oCreature}
        if PlayerCreature <= 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and Platoon can navigate to {oCreature}
            clear Platoon action queue
            begin loop
                PlayerCreature = get distance from {Platoon} to {oCreature}
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to Platoon action queue
                NumPat1 = get number of villagers in platoon Platoon
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not Platoon can navigate to {oCreature} or PlayerCreature > 200
            end loop
            clear Platoon action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {Platoon} radius 200
        Catapult = get siege weapon of player 0 nearest {Platoon} radius 155
        if PlayerPlatoon1 exists and Platoon can navigate to {PlayerPlatoon1}
            clear Platoon action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {Platoon} radius 200
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to Platoon action queue
                NumPat1 = get number of villagers in platoon Platoon
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not Platoon can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear Platoon action queue
        elsif Catapult exists and Platoon can navigate to {Catapult}
            clear Platoon action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {Platoon} radius 155
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to Platoon action queue
                NumPat1 = get number of villagers in platoon Platoon
                PlayerPlatoon1 = get platoon of player 0 nearest {Platoon} radius 200
                if PlayerPlatoon1 exists and Platoon can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not Platoon can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear Platoon action queue
            a = 0
        end if

    elsif Type == Ranged
        PlayerCreature = get distance from {Platoon} to {oCreature}
        if PlayerCreature <= 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and Platoon can navigate to {oCreature}
            clear Platoon action queue
            begin loop
                PlayerCreature = get distance from {Platoon} to {oCreature}
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using oCreature to Platoon action queue
                NumPat1 = get number of villagers in platoon Platoon
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not Platoon can navigate to {oCreature} or PlayerCreature > 200
            end loop
            clear Platoon action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {Platoon} radius 200
        Catapult = get siege weapon of player 0 nearest {Platoon} radius 155
        if PlayerPlatoon1 exists and Platoon can navigate to {PlayerPlatoon1}
            clear Platoon action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {Platoon} radius 200
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using PlayerPlatoon1 to Platoon action queue
                NumPat1 = get number of villagers in platoon Platoon
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not Platoon can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear Platoon action queue
        elsif Catapult exists and Platoon can navigate to {Catapult}
            clear Platoon action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {Platoon} radius 155
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using Catapult to Platoon action queue
                NumPat1 = get number of villagers in platoon Platoon
                PlayerPlatoon1 = get platoon of player 0 nearest {Platoon} radius 200
                if PlayerPlatoon1 exists and Platoon can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not Platoon can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear Platoon action queue
            a = 0
        end if
    end if

    if get size of Platoon action queue < 1 and {Platoon} not near {Pos} radius 25
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {Pos} to Platoon action queue
    end if

    until Platoon not exists
end loop

end script LC10_StaticPlatoonsActions

begin script LC10_Platoon2Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    PlayerSettlement = 0
    
start

begin loop    

    if LC10_Platoon[2] not exists
        //PlatoonKilled = 1
        wait until LC10_Platoon[2] exists
    end if
        
    PlayerCreature = get distance from {LC10_Platoon[2]} to {oCreature}
    if PlayerCreature <= 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC10_Platoon[2] can navigate to {oCreature}
        clear LC10_Platoon[2] action queue
        begin loop
            PlayerCreature = get distance from {LC10_Platoon[2]} to {oCreature}
            add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using oCreature to LC10_Platoon[2] action queue
            NumPat1 = get number of villagers in platoon LC10_Platoon[2]
            until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC10_Platoon[2] can navigate to {oCreature} or PlayerCreature > 200
        end loop
        clear LC10_Platoon[2] action queue
    end if
        
    PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[2]} radius 200
    Catapult = get siege weapon of player 0 nearest {LC10_Platoon[2]} radius 155
    if PlayerPlatoon1 exists and LC10_Platoon[2] can navigate to {PlayerPlatoon1}
        clear LC10_Platoon[2] action queue
        begin loop
            PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[2]} radius 200
            add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using PlayerPlatoon1 to LC10_Platoon[2] action queue
            NumPat1 = get number of villagers in platoon LC10_Platoon[2]
            HeTeste1 = get number of villagers in platoon PlayerPlatoon1
            until NumPat1 == 0 or HeTeste1 == 0 or not LC10_Platoon[2] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
        end loop
        clear LC10_Platoon[2] action queue
    elsif Catapult exists and LC10_Platoon[2] can navigate to {Catapult}
        clear LC10_Platoon[2] action queue
        a = 0
        begin loop
            Catapult = get siege weapon of player 0 nearest {LC10_Platoon[2]} radius 155
            add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using Catapult to LC10_Platoon[2] action queue
            NumPat1 = get number of villagers in platoon LC10_Platoon[2]
            PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[2]} radius 200
            if PlayerPlatoon1 exists and LC10_Platoon[2] can navigate to {PlayerPlatoon1}
                a = 1
            end if
            until NumPat1 == 0 or Catapult not exists or not LC10_Platoon[2] can navigate to {Catapult} or a == 1 or Catapult not exists
        end loop
        clear LC10_Platoon[2] action queue
        a = 0
    end if
        
    if get size of LC10_Platoon[2] action queue < 1
        move LC10_Platoon[2] along WaypointsA with patrol WAYPOINTROUTE_TRAVERSAL_TYPE_CIRCULAR
    end if
        
end loop

end script LC10_Platoon2Actions

begin script LC10_Platoon7Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    FirstAttack = 1
    
start

begin loop
    a = 0
    if FirstAttack == 0
        wait until LC10_Platoon[7] exists and LC10_Platoon[8] exists and LC10_Platoon[9] exists and LC10_Platoon[10] exists and LC10_SiegeCatapult[0] exists and LC10_SiegeCatapult[1] exists and LC10_SiegeCatapult[7] exists and LC10_SiegeCatapult[8] exists and ({LC10_SiegeCatapult[0]} near {AztecCapital} radius 800) and ({LC10_SiegeCatapult[1]} near {AztecCapital} radius 800) and ({LC10_SiegeCatapult[7]} near {AztecCapital} radius 800) and ({LC10_SiegeCatapult[8]} near {AztecCapital} radius 800)
    else
        FirstAttack = 0
        wait until PrisonDestroyed == 2 or 360 seconds
    end if
    begin loop

        PlayerCreature = get distance from {LC10_Platoon[7]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC10_Platoon[7] can navigate to {oCreature}
            clear LC10_Platoon[7] action queue
            begin loop
                PlayerCreature = get distance from {LC10_Platoon[7]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC10_Platoon[7] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[7]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC10_Platoon[7] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC10_Platoon[7] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[7]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC10_Platoon[7]} radius 50
        if PlayerPlatoon1 exists and LC10_Platoon[7] can navigate to {PlayerPlatoon1}
            clear LC10_Platoon[7] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[7]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC10_Platoon[7] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[7]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC10_Platoon[7] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC10_Platoon[7] action queue
        elsif Catapult exists and LC10_Platoon[7] can navigate to {Catapult}
            clear LC10_Platoon[7] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC10_Platoon[7]} radius 50
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC10_Platoon[7] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[7]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[7]} radius 150
                if PlayerPlatoon1 exists and LC10_Platoon[7] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC10_Platoon[7] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC10_Platoon[7] action queue
            a = 0
        end if

        PlayerSettlement = get nearest town at {LC10_Platoon[7]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0
            if LC10_Platoon[7] can navigate to object Armory
                clear LC10_Platoon[7] action queue
                set LC10_Platoon[7] attack PlayerSettlement with severity 0.3 for takeover
                a = 1
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[7]} radius 150
                    PlayerCreature = get distance from {LC10_Platoon[7]} to {oCreature}
                    if PlayerPlatoon1 exists
                        a = 0
                    elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                        a = 0
                    elsif not LC10_Platoon[7] can navigate to object Armory
                        a = 0
                    elsif LC10_Platoon[7] not exists
                        a = 0
                    end if
                    until a == 0 or LC10_Platoon[7] not exists or PLAYER of PlayerSettlement == 1
                end loop
                clear LC10_Platoon[7] action queue
            end if
        end if

        //if get size of LC10_Platoon[7] action queue < 1
            if LC10_Platoon[7] can navigate to object oTownCentre and PLAYER of PlayerTown == 0
                wait number from 5 to 25 seconds
                a = 1
                clear LC10_Platoon[7] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC10_Platoon[7] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[7] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[7] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[7] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[7] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[7] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[7] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    set LC10_Platoon[7] attack PlayerTown with severity 0.3 for takeover
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[7]} radius 150
                    TestCreature2 = get distance from {LC10_Platoon[7]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC10_Platoon[7]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC10_Platoon[7] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC10_Platoon[7] can navigate to object oTownCentre
                            a = 0
                        elsif LC10_Platoon[7] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC10_Platoon[7] not exists
                end loop
                clear LC10_Platoon[7] action queue
            elsif LC10_Platoon[7] can navigate to {AttackPos[0]} + {-20,0,-20}
                clear LC10_Platoon[7] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[0]} + {-20,0,-20} to LC10_Platoon[7] action queue
            else
                clear LC10_Platoon[7] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[1]} + {-20,0,-20} to LC10_Platoon[7] action queue
            end if
        //end if

        until LC10_Platoon[7] not exists
    end loop
    if LC10_Platoon[7] not exists
        //PlatoonKilled = 1
        wait until LC10_Platoon[7] exists
    end if
end loop

end script LC10_Platoon7Actions

begin script LC10_Platoon8Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    FirstAttack = 1
    
start

begin loop
    a = 0
    if FirstAttack == 0
        wait until LC10_Platoon[7] exists and LC10_Platoon[8] exists and LC10_Platoon[9] exists and LC10_Platoon[10] exists and LC10_SiegeCatapult[0] exists and LC10_SiegeCatapult[1] exists and LC10_SiegeCatapult[7] exists and LC10_SiegeCatapult[8] exists and ({LC10_SiegeCatapult[0]} near {AztecCapital} radius 800) and ({LC10_SiegeCatapult[1]} near {AztecCapital} radius 800) and ({LC10_SiegeCatapult[7]} near {AztecCapital} radius 800) and ({LC10_SiegeCatapult[8]} near {AztecCapital} radius 800)
    else
        FirstAttack = 0
        wait until PrisonDestroyed == 2 or 360 seconds
    end if
    begin loop

        PlayerCreature = get distance from {LC10_Platoon[8]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC10_Platoon[8] can navigate to {oCreature}
            clear LC10_Platoon[8] action queue
            begin loop
                PlayerCreature = get distance from {LC10_Platoon[8]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC10_Platoon[8] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[8]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC10_Platoon[8] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC10_Platoon[8] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[8]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC10_Platoon[8]} radius 50
        if PlayerPlatoon1 exists and LC10_Platoon[8] can navigate to {PlayerPlatoon1}
            clear LC10_Platoon[8] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[8]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC10_Platoon[8] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[8]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC10_Platoon[8] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC10_Platoon[8] action queue
        elsif Catapult exists and LC10_Platoon[8] can navigate to {Catapult}
            clear LC10_Platoon[8] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC10_Platoon[8]} radius 50
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC10_Platoon[8] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[8]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[8]} radius 150
                if PlayerPlatoon1 exists and LC10_Platoon[8] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC10_Platoon[8] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC10_Platoon[8] action queue
            a = 0
        end if

        PlayerSettlement = get nearest town at {LC10_Platoon[8]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0
            if LC10_Platoon[8] can navigate to object Armory
                clear LC10_Platoon[8] action queue
                set LC10_Platoon[8] attack PlayerSettlement with severity 0.3 for takeover
                a = 1
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[8]} radius 150
                    PlayerCreature = get distance from {LC10_Platoon[8]} to {oCreature}
                    if PlayerPlatoon1 exists
                        a = 0
                    elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                        a = 0
                    elsif not LC10_Platoon[8] can navigate to object Armory
                        a = 0
                    elsif LC10_Platoon[8] not exists
                        a = 0
                    end if
                    until a == 0 or LC10_Platoon[8] not exists or PLAYER of PlayerSettlement == 1
                end loop
                clear LC10_Platoon[8] action queue
            end if
        end if

        //if get size of LC10_Platoon[8] action queue < 1
            if LC10_Platoon[8] can navigate to object oTownCentre and PLAYER of PlayerTown == 0
                wait number from 5 to 25 seconds
                a = 1
                clear LC10_Platoon[8] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC10_Platoon[8] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[8] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[8] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[8] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[8] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[8] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[8] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    set LC10_Platoon[8] attack PlayerTown with severity 0.3 for takeover
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[8]} radius 150
                    TestCreature2 = get distance from {LC10_Platoon[8]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC10_Platoon[8]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC10_Platoon[8] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC10_Platoon[8] can navigate to object oTownCentre
                            a = 0
                        elsif LC10_Platoon[8] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC10_Platoon[8] not exists
                end loop
                clear LC10_Platoon[8] action queue
            elsif LC10_Platoon[8] can navigate to {AttackPos[0]} + {20,0,20}
                clear LC10_Platoon[8] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[0]} + {20,0,20} to LC10_Platoon[8] action queue
            else
                clear LC10_Platoon[8] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[1]} + {20,0,20} to LC10_Platoon[8] action queue
            end if
        //end if

        until LC10_Platoon[8] not exists
    end loop
    if LC10_Platoon[8] not exists
        //PlatoonKilled = 1
        wait until LC10_Platoon[8] exists
    end if
end loop

end script LC10_Platoon8Actions

begin script LC10_Platoon9Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    FirstAttack = 1
    
start

begin loop
    a = 0
    if FirstAttack == 0
        wait until LC10_Platoon[7] exists and LC10_Platoon[8] exists and LC10_Platoon[9] exists and LC10_Platoon[10] exists and LC10_SiegeCatapult[0] exists and LC10_SiegeCatapult[1] exists and LC10_SiegeCatapult[7] exists and LC10_SiegeCatapult[8] exists and ({LC10_SiegeCatapult[0]} near {AztecCapital} radius 800) and ({LC10_SiegeCatapult[1]} near {AztecCapital} radius 800) and ({LC10_SiegeCatapult[7]} near {AztecCapital} radius 800) and ({LC10_SiegeCatapult[8]} near {AztecCapital} radius 800)
    else
        FirstAttack = 0
        wait until PrisonDestroyed == 2 or 360 seconds
    end if
    begin loop

        PlayerCreature = get distance from {LC10_Platoon[9]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC10_Platoon[9] can navigate to {oCreature}
            clear LC10_Platoon[9] action queue
            begin loop
                PlayerCreature = get distance from {LC10_Platoon[9]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using oCreature to LC10_Platoon[9] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[9]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC10_Platoon[9] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC10_Platoon[9] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[9]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC10_Platoon[9]} radius 50
        if PlayerPlatoon1 exists and LC10_Platoon[9] can navigate to {PlayerPlatoon1}
            clear LC10_Platoon[9] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[9]} radius 150
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using PlayerPlatoon1 to LC10_Platoon[9] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[9]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC10_Platoon[9] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC10_Platoon[9] action queue
        elsif Catapult exists and LC10_Platoon[9] can navigate to {Catapult}
            clear LC10_Platoon[9] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC10_Platoon[9]} radius 50
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using Catapult to LC10_Platoon[9] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[9]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[9]} radius 150
                if PlayerPlatoon1 exists and LC10_Platoon[9] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC10_Platoon[9] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC10_Platoon[9] action queue
            a = 0
        end if

        PlayerSettlement = get nearest town at {LC10_Platoon[9]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0
            if LC10_Platoon[9] can navigate to object Armory
                clear LC10_Platoon[9] action queue
                set LC10_Platoon[9] attack PlayerSettlement with severity 0.3 for takeover
                a = 1
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[9]} radius 150
                    PlayerCreature = get distance from {LC10_Platoon[9]} to {oCreature}
                    if PlayerPlatoon1 exists
                        a = 0
                    elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                        a = 0
                    elsif not LC10_Platoon[9] can navigate to object Armory
                        a = 0
                    elsif LC10_Platoon[9] not exists
                        a = 0
                    end if
                    until a == 0 or LC10_Platoon[9] not exists or PLAYER of PlayerSettlement == 1
                end loop
                clear LC10_Platoon[9] action queue
            end if
        end if

        //if get size of LC10_Platoon[9] action queue < 1
            if LC10_Platoon[9] can navigate to object oTownCentre and PLAYER of PlayerTown == 0
                wait number from 5 to 25 seconds
                a = 1
                clear LC10_Platoon[9] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC10_Platoon[9] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[9] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[9] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[9] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[9] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[9] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[9] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    set LC10_Platoon[9] attack PlayerTown with severity 0.3 for takeover
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[9]} radius 150
                    TestCreature2 = get distance from {LC10_Platoon[9]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC10_Platoon[9]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC10_Platoon[9] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC10_Platoon[9] can navigate to object oTownCentre
                            a = 0
                        elsif LC10_Platoon[9] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC10_Platoon[9] not exists
                end loop
                clear LC10_Platoon[9] action queue
            elsif LC10_Platoon[9] can navigate to {AttackPos[0]} + {40,0,40}
                clear LC10_Platoon[9] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[0]} + {40,0,40} to LC10_Platoon[9] action queue
            else
                clear LC10_Platoon[9] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[1]} + {40,0,40} to LC10_Platoon[9] action queue
            end if
        //end if

        until LC10_Platoon[9] not exists
    end loop
    if LC10_Platoon[9] not exists
        //PlatoonKilled = 1
        wait until LC10_Platoon[9] exists
    end if
end loop

end script LC10_Platoon9Actions

begin script LC10_Platoon10Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    FirstAttack = 0
    
start

begin loop
    a = 0
    if FirstAttack == 0
        wait until LC10_Platoon[7] exists and LC10_Platoon[8] exists and LC10_Platoon[9] exists and LC10_Platoon[10] exists and LC10_SiegeCatapult[0] exists and LC10_SiegeCatapult[1] exists and LC10_SiegeCatapult[7] exists and LC10_SiegeCatapult[8] exists and ({LC10_SiegeCatapult[0]} near {AztecCapital} radius 800) and ({LC10_SiegeCatapult[1]} near {AztecCapital} radius 800) and ({LC10_SiegeCatapult[7]} near {AztecCapital} radius 800) and ({LC10_SiegeCatapult[8]} near {AztecCapital} radius 800)
    else
        FirstAttack = 0
        wait until PrisonDestroyed == 2 or 360 seconds
    end if
    begin loop

        PlayerCreature = get distance from {LC10_Platoon[10]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC10_Platoon[10] can navigate to {oCreature}
            clear LC10_Platoon[10] action queue
            begin loop
                PlayerCreature = get distance from {LC10_Platoon[10]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using oCreature to LC10_Platoon[10] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[10]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC10_Platoon[10] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC10_Platoon[10] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[10]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC10_Platoon[10]} radius 50
        if PlayerPlatoon1 exists and LC10_Platoon[10] can navigate to {PlayerPlatoon1}
            clear LC10_Platoon[10] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[10]} radius 150
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using PlayerPlatoon1 to LC10_Platoon[10] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[10]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC10_Platoon[10] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC10_Platoon[10] action queue
        elsif Catapult exists and LC10_Platoon[10] can navigate to {Catapult}
            clear LC10_Platoon[10] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC10_Platoon[10]} radius 50
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using Catapult to LC10_Platoon[10] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[10]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[10]} radius 150
                if PlayerPlatoon1 exists and LC10_Platoon[10] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC10_Platoon[10] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC10_Platoon[10] action queue
            a = 0
        end if

        PlayerSettlement = get nearest town at {LC10_Platoon[10]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0
            if LC10_Platoon[10] can navigate to object Armory
                clear LC10_Platoon[10] action queue
                set LC10_Platoon[10] attack PlayerSettlement with severity 0.3 for takeover
                a = 1
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[10]} radius 150
                    PlayerCreature = get distance from {LC10_Platoon[10]} to {oCreature}
                    if PlayerPlatoon1 exists
                        a = 0
                    elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                        a = 0
                    elsif not LC10_Platoon[10] can navigate to object Armory
                        a = 0
                    elsif LC10_Platoon[10] not exists
                        a = 0
                    end if
                    until a == 0 or LC10_Platoon[10] not exists or PLAYER of PlayerSettlement == 1
                end loop
                clear LC10_Platoon[10] action queue
            end if
        end if

        //if get size of LC10_Platoon[10] action queue < 1
            if LC10_Platoon[10] can navigate to object oTownCentre and PLAYER of PlayerTown == 0
                wait number from 5 to 25 seconds
                a = 1
                clear LC10_Platoon[10] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC10_Platoon[10] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[10] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[10] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[10] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[10] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[10] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[10] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    set LC10_Platoon[10] attack PlayerTown with severity 0.3 for takeover
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[10]} radius 150
                    TestCreature2 = get distance from {LC10_Platoon[10]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC10_Platoon[10]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC10_Platoon[10] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC10_Platoon[10] can navigate to object oTownCentre
                            a = 0
                        elsif LC10_Platoon[10] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC10_Platoon[10] not exists
                end loop
                clear LC10_Platoon[10] action queue
            elsif LC10_Platoon[10] can navigate to {AttackPos[0]}
                clear LC10_Platoon[10] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[0]} to LC10_Platoon[10] action queue
            else
                clear LC10_Platoon[10] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[1]} to LC10_Platoon[10] action queue
            end if
        //end if

        until LC10_Platoon[10] not exists
    end loop
    if LC10_Platoon[10] not exists
        //PlatoonKilled = 1
        wait until LC10_Platoon[10] exists
    end if
end loop

end script LC10_Platoon10Actions

begin script LC10_SiegeCatapult0Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = create timer for 0 seconds
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 0
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC10_Platoon[7] exists and LC10_Platoon[8] exists and LC10_Platoon[9] exists and LC10_Platoon[10] exists and LC10_SiegeCatapult[0] exists and LC10_SiegeCatapult[1] exists and LC10_SiegeCatapult[7] exists and LC10_SiegeCatapult[8] exists and ({LC10_SiegeCatapult[0]} near {AztecCapital} radius 800) and ({LC10_SiegeCatapult[1]} near {AztecCapital} radius 800) and ({LC10_SiegeCatapult[7]} near {AztecCapital} radius 800) and ({LC10_SiegeCatapult[8]} near {AztecCapital} radius 800)
    wait 2 seconds
    begin loop
        PlayerCreature = get distance from {LC10_SiegeCatapult[0]} to {oCreature}
        PlayerPlatoon1 = get platoon of player 0 nearest {LC10_SiegeCatapult[0]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC10_SiegeCatapult[0]} radius 150
        
        if PlayerCreature > 10 and PlayerPlatoon1 not exists and Catapult not exists
            if PlayerPlatoon1 not exists
                a = 1
            elsif PlayerCreature > 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                a = 1
            elsif Catapult not exists
                a = 1
            end if
        end if
        
        if PlayerCreature <= 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
            clear siege weapon LC10_SiegeCatapult[0] action queue
            a = 0
        elsif PlayerPlatoon1 exists and LC10_SiegeCatapult[0] can navigate to {PlayerPlatoon1}
            clear siege weapon LC10_SiegeCatapult[0] action queue
            a = 0
        elsif Catapult exists and LC10_SiegeCatapult[0] can navigate to {Catapult}
            clear siege weapon LC10_SiegeCatapult[0] action queue
            a = 0
        elsif PointOn != 5 and a == 1
            begin loop
                if LC10_SiegeCatapult[0] exists
                    if get SiegeOnPointTimer time remaining <= 0
                        SiegeWeaponPoint = marker at {LC10_SiegeCatapult[0]}
                        SiegeOnPointTimer = create timer for 40 seconds
                    elsif get SiegeOnPointTimer time remaining <= 5
                        if {LC10_SiegeCatapult[0]} near {SiegeWeaponPoint} radius 10
                            clear siege weapon LC10_SiegeCatapult[0] action queue
                            delete LC10_SiegeCatapult[0]
                            SiegeStucked = 1
                        end if
                    end if
                    if get CatapultMoveTimer1 time remaining <= 0
                        if get size of LC10_SiegeCatapult[0] action queue < 1

                            if PointOn == 0
                                if LC10_SiegeCatapult[0] can navigate to {SiegeRoute1[0]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute1[0]} to siege weapon LC10_SiegeCatapult[0] action queue
                                end if
                    
                            elsif PointOn == 1
                                if LC10_SiegeCatapult[0] can navigate to {SiegeRoute1[1]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute1[1]} to siege weapon LC10_SiegeCatapult[0] action queue
                                end if

                            elsif PointOn == 2
                                if LC10_SiegeCatapult[0] can navigate to {SiegeRoute1[2]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute1[2]} to siege weapon LC10_SiegeCatapult[0] action queue
                                end if

                            elsif PointOn == 3
                                if LC10_SiegeCatapult[0] can navigate to {SiegeRoute1[3]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute1[3]} to siege weapon LC10_SiegeCatapult[0] action queue
                                end if

                            elsif PointOn == 4
                                if LC10_SiegeCatapult[0] can navigate to {SiegeRoute1[4]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute1[4]} to siege weapon LC10_SiegeCatapult[0] action queue
                                end if

                            CatapultMoveTimer1 = create timer for 10 seconds
                            
                            end if
                        end if
                    end if        

                    if {LC10_SiegeCatapult[0]} near {SiegeRoute1[0]} radius 15 and PointOn != 1 or 60 seconds
                        PointOn = 1
                    elsif {LC10_SiegeCatapult[0]} near {SiegeRoute1[1]} radius 15 and PointOn != 2 or 60 seconds
                        PointOn = 2
                    elsif {LC10_SiegeCatapult[0]} near {SiegeRoute1[2]} radius 15 and PointOn != 3 or 60 seconds
                        PointOn = 3
                    elsif {LC10_SiegeCatapult[0]} near {SiegeRoute1[3]} radius 15 and PointOn != 4 or 60 seconds
                        PointOn = 4
                    elsif {LC10_SiegeCatapult[0]} near {SiegeRoute1[4]} radius 15 and PointOn != 5 or 60 seconds
                        PointOn = 5
                    elsif not LC10_SiegeCatapult[0] can navigate to {SiegeRoute1[4]} and {LC10_SiegeCatapult[0]} near {SiegeRoute1[3]} radius 15 and PointOn != 5
                        PointOn = 5
                    end if
                end if
            until LC10_SiegeCatapult[0] not exists or PointOn == 5 or 180 seconds
            end loop
        end if
        
        until PointOn == 5 or LC10_SiegeCatapult[0] not exists or 180 seconds
    end loop

    wait 5 seconds

    enable siege weapon LC10_SiegeCatapult[0] auto attack

    begin loop
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 5
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get HOUSE GATEHOUSE at {SiegeWeapon} radius 250
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon SiegeWeapon action queue
                    Target = marker at get target from {SiegeWeapon} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon SiegeWeapon action queue
                elsif GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE at {SiegeWeapon} radius 750
                    clear siege weapon SiegeWeapon action queue
                    Target = marker at get target from {SiegeWeapon} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon SiegeWeapon action queue
                else
                    GateHouse = get random abode of type GATEHOUSE in town PlayerTown
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon SiegeWeapon action queue
                        Target = marker at get target from {SiegeWeapon} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon SiegeWeapon action queue
                    else
                        ActionTimer = create timer for 2 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {LC10_SiegeCatapult[0]} radius 750
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC10_SiegeCatapult[0] action queue
                    Target = marker at get target from {LC10_SiegeCatapult[0]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC10_SiegeCatapult[0] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            else
                House = get building ALTAR in PlayerTown min built 0.75
                if House exists and PLAYER of House == 0 and LC10_SiegeCatapult[0] can navigate to object oTownCentre
                    clear siege weapon LC10_SiegeCatapult[0] action queue
                    Target = marker at get target from {LC10_SiegeCatapult[0]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC10_SiegeCatapult[0] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            end if
        end if

        until LC10_SiegeCatapult[0] not exists
    end loop
    
    if SiegeAttacking == 1 and UnderAttack != 0
        UnderAttack = UnderAttack - 1
    end if

    if LC10_SiegeCatapult[0] not exists and SiegeStucked == 0
        //CatapultDestroyed = 1
    end if
    
end loop

end script LC10_SiegeCatapult0Actions

begin script LC10_SiegeCatapult1Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = create timer for 0 seconds
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 0
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC10_Platoon[7] exists and LC10_Platoon[8] exists and LC10_Platoon[9] exists and LC10_Platoon[10] exists and LC10_SiegeCatapult[0] exists and LC10_SiegeCatapult[1] exists and LC10_SiegeCatapult[7] exists and LC10_SiegeCatapult[8] exists and ({LC10_SiegeCatapult[0]} near {AztecCapital} radius 800) and ({LC10_SiegeCatapult[1]} near {AztecCapital} radius 800) and ({LC10_SiegeCatapult[7]} near {AztecCapital} radius 800) and ({LC10_SiegeCatapult[8]} near {AztecCapital} radius 800)
    wait 2 seconds
    begin loop
        PlayerCreature = get distance from {LC10_SiegeCatapult[1]} to {oCreature}
        PlayerPlatoon1 = get platoon of player 0 nearest {LC10_SiegeCatapult[1]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC10_SiegeCatapult[1]} radius 150
        
        if PlayerCreature > 10 and PlayerPlatoon1 not exists and Catapult not exists
            if PlayerPlatoon1 not exists
                a = 1
            elsif PlayerCreature > 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                a = 1
            elsif Catapult not exists
                a = 1
            end if
        end if
        
        if PlayerCreature <= 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
            clear siege weapon LC10_SiegeCatapult[1] action queue
            a = 0
        elsif PlayerPlatoon1 exists and LC10_SiegeCatapult[1] can navigate to {PlayerPlatoon1}
            clear siege weapon LC10_SiegeCatapult[1] action queue
            a = 0
        elsif Catapult exists and LC10_SiegeCatapult[1] can navigate to {Catapult}
            clear siege weapon LC10_SiegeCatapult[1] action queue
            a = 0
        elsif PointOn != 5 and a == 1
            begin loop
                if LC10_SiegeCatapult[1] exists
                    if get SiegeOnPointTimer time remaining <= 0
                        SiegeWeaponPoint = marker at {LC10_SiegeCatapult[1]}
                        SiegeOnPointTimer = create timer for 40 seconds
                    elsif get SiegeOnPointTimer time remaining <= 5
                        if {LC10_SiegeCatapult[1]} near {SiegeWeaponPoint} radius 10
                            clear siege weapon LC10_SiegeCatapult[1] action queue
                            delete LC10_SiegeCatapult[1]
                            SiegeStucked = 1
                        end if
                    end if
                    if get CatapultMoveTimer1 time remaining <= 0
                        if get size of LC10_SiegeCatapult[1] action queue < 1

                            if PointOn == 0
                                if LC10_SiegeCatapult[1] can navigate to {SiegeRoute2[0]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute2[0]} to siege weapon LC10_SiegeCatapult[1] action queue
                                end if
                    
                            elsif PointOn == 1
                                if LC10_SiegeCatapult[1] can navigate to {SiegeRoute2[1]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute2[1]} to siege weapon LC10_SiegeCatapult[1] action queue
                                end if

                            elsif PointOn == 2
                                if LC10_SiegeCatapult[1] can navigate to {SiegeRoute2[2]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute2[2]} to siege weapon LC10_SiegeCatapult[1] action queue
                                end if

                            elsif PointOn == 3
                                if LC10_SiegeCatapult[1] can navigate to {SiegeRoute2[3]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute2[3]} to siege weapon LC10_SiegeCatapult[1] action queue
                                end if

                            elsif PointOn == 4
                                if LC10_SiegeCatapult[1] can navigate to {SiegeRoute2[4]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute2[4]} to siege weapon LC10_SiegeCatapult[1] action queue
                                end if

                            CatapultMoveTimer1 = create timer for 10 seconds
                            
                            end if
                        end if
                    end if        

                    if {LC10_SiegeCatapult[1]} near {SiegeRoute2[0]} radius 15 and PointOn != 1 or 60 seconds
                        PointOn = 1
                    elsif {LC10_SiegeCatapult[1]} near {SiegeRoute2[1]} radius 15 and PointOn != 2 or 60 seconds
                        PointOn = 2
                    elsif {LC10_SiegeCatapult[1]} near {SiegeRoute2[2]} radius 15 and PointOn != 3 or 60 seconds
                        PointOn = 3
                    elsif {LC10_SiegeCatapult[1]} near {SiegeRoute2[3]} radius 15 and PointOn != 4 or 60 seconds
                        PointOn = 4
                    elsif {LC10_SiegeCatapult[1]} near {SiegeRoute2[4]} radius 15 and PointOn != 5 or 60 seconds
                        PointOn = 5
                    elsif not LC10_SiegeCatapult[1] can navigate to {SiegeRoute2[4]} and {LC10_SiegeCatapult[1]} near {SiegeRoute2[3]} radius 15 and PointOn != 5
                        PointOn = 5
                    end if
                end if
            until LC10_SiegeCatapult[1] not exists or PointOn == 5 or 180 seconds
            end loop
        end if
        
        until PointOn == 5 or LC10_SiegeCatapult[1] not exists or 180 seconds
    end loop

    wait 5 seconds

    enable siege weapon LC10_SiegeCatapult[1] auto attack

    begin loop
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 5
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get HOUSE GATEHOUSE at {SiegeWeapon} radius 250
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon SiegeWeapon action queue
                    Target = marker at get target from {SiegeWeapon} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon SiegeWeapon action queue
                elsif GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE at {SiegeWeapon} radius 750
                    clear siege weapon SiegeWeapon action queue
                    Target = marker at get target from {SiegeWeapon} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon SiegeWeapon action queue
                else
                    GateHouse = get random abode of type GATEHOUSE in town PlayerTown
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon SiegeWeapon action queue
                        Target = marker at get target from {SiegeWeapon} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon SiegeWeapon action queue
                    else
                        ActionTimer = create timer for 2 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {LC10_SiegeCatapult[1]} radius 750
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC10_SiegeCatapult[1] action queue
                    Target = marker at get target from {LC10_SiegeCatapult[1]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC10_SiegeCatapult[1] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            else
                House = get building ALTAR in PlayerTown min built 0.75
                if House exists and PLAYER of House == 0 and LC10_SiegeCatapult[1] can navigate to object oTownCentre
                    clear siege weapon LC10_SiegeCatapult[1] action queue
                    Target = marker at get target from {LC10_SiegeCatapult[1]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC10_SiegeCatapult[1] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            end if
        end if

        until LC10_SiegeCatapult[1] not exists
    end loop
    
    if SiegeAttacking == 1 and UnderAttack != 0
        UnderAttack = UnderAttack - 1
    end if

    if LC10_SiegeCatapult[1] not exists and SiegeStucked == 0
        //CatapultDestroyed = 1
    end if
    
end loop

end script LC10_SiegeCatapult1Actions

begin script LC10_SiegeCatapult7Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = create timer for 0 seconds
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 0
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC10_Platoon[7] exists and LC10_Platoon[8] exists and LC10_Platoon[9] exists and LC10_Platoon[10] exists and LC10_SiegeCatapult[0] exists and LC10_SiegeCatapult[1] exists and LC10_SiegeCatapult[7] exists and LC10_SiegeCatapult[8] exists and ({LC10_SiegeCatapult[0]} near {AztecCapital} radius 800) and ({LC10_SiegeCatapult[1]} near {AztecCapital} radius 800) and ({LC10_SiegeCatapult[7]} near {AztecCapital} radius 800) and ({LC10_SiegeCatapult[8]} near {AztecCapital} radius 800)
    wait 2 seconds
    begin loop
        PlayerCreature = get distance from {LC10_SiegeCatapult[7]} to {oCreature}
        PlayerPlatoon1 = get platoon of player 0 nearest {LC10_SiegeCatapult[7]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC10_SiegeCatapult[7]} radius 150
        
        if PlayerCreature > 10 and PlayerPlatoon1 not exists and Catapult not exists
            if PlayerPlatoon1 not exists
                a = 1
            elsif PlayerCreature > 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                a = 1
            elsif Catapult not exists
                a = 1
            end if
        end if
        
        if PlayerCreature <= 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
            clear siege weapon LC10_SiegeCatapult[7] action queue
            a = 0
        elsif PlayerPlatoon1 exists and LC10_SiegeCatapult[7] can navigate to {PlayerPlatoon1}
            clear siege weapon LC10_SiegeCatapult[7] action queue
            a = 0
        elsif Catapult exists and LC10_SiegeCatapult[7] can navigate to {Catapult}
            clear siege weapon LC10_SiegeCatapult[7] action queue
            a = 0
        elsif PointOn != 5 and a == 1
            begin loop
                if LC10_SiegeCatapult[7] exists
                    if get SiegeOnPointTimer time remaining <= 0
                        SiegeWeaponPoint = marker at {LC10_SiegeCatapult[7]}
                        SiegeOnPointTimer = create timer for 40 seconds
                    elsif get SiegeOnPointTimer time remaining <= 5
                        if {LC10_SiegeCatapult[7]} near {SiegeWeaponPoint} radius 10
                            clear siege weapon LC10_SiegeCatapult[7] action queue
                            delete LC10_SiegeCatapult[7]
                            SiegeStucked = 1
                        end if
                    end if
                    if get CatapultMoveTimer1 time remaining <= 0
                        if get size of LC10_SiegeCatapult[7] action queue < 1

                            if PointOn == 0
                                if LC10_SiegeCatapult[7] can navigate to {SiegeRoute6[0]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute6[0]} to siege weapon LC10_SiegeCatapult[7] action queue
                                end if
                    
                            elsif PointOn == 1
                                if LC10_SiegeCatapult[7] can navigate to {SiegeRoute6[1]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute6[1]} to siege weapon LC10_SiegeCatapult[7] action queue
                                end if

                            elsif PointOn == 2
                                if LC10_SiegeCatapult[7] can navigate to {SiegeRoute6[2]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute6[2]} to siege weapon LC10_SiegeCatapult[7] action queue
                                end if

                            elsif PointOn == 3
                                if LC10_SiegeCatapult[7] can navigate to {SiegeRoute6[3]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute6[3]} to siege weapon LC10_SiegeCatapult[7] action queue
                                end if

                            elsif PointOn == 4
                                if LC10_SiegeCatapult[7] can navigate to {SiegeRoute6[4]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute6[4]} to siege weapon LC10_SiegeCatapult[7] action queue
                                end if

                            CatapultMoveTimer1 = create timer for 10 seconds
                            
                            end if
                        end if
                    end if        

                    if {LC10_SiegeCatapult[7]} near {SiegeRoute6[0]} radius 15 and PointOn != 1 or 60 seconds
                        PointOn = 1
                    elsif {LC10_SiegeCatapult[7]} near {SiegeRoute6[1]} radius 15 and PointOn != 2 or 60 seconds
                        PointOn = 2
                    elsif {LC10_SiegeCatapult[7]} near {SiegeRoute6[2]} radius 15 and PointOn != 3 or 60 seconds
                        PointOn = 3
                    elsif {LC10_SiegeCatapult[7]} near {SiegeRoute6[3]} radius 15 and PointOn != 4 or 60 seconds
                        PointOn = 4
                    elsif {LC10_SiegeCatapult[7]} near {SiegeRoute6[4]} radius 15 and PointOn != 5 or 60 seconds
                        PointOn = 5
                    elsif not LC10_SiegeCatapult[7] can navigate to {SiegeRoute6[4]} and {LC10_SiegeCatapult[7]} near {SiegeRoute6[3]} radius 15 and PointOn != 5
                        PointOn = 5
                    end if
                end if
            until LC10_SiegeCatapult[7] not exists or PointOn == 5 or 180 seconds
            end loop
        end if
        
        until PointOn == 5 or LC10_SiegeCatapult[7] not exists or 180 seconds
    end loop

    wait 5 seconds

    enable siege weapon LC10_SiegeCatapult[7] auto attack

    begin loop
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 5
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get HOUSE GATEHOUSE at {SiegeWeapon} radius 250
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon SiegeWeapon action queue
                    Target = marker at get target from {SiegeWeapon} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon SiegeWeapon action queue
                elsif GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE at {SiegeWeapon} radius 750
                    clear siege weapon SiegeWeapon action queue
                    Target = marker at get target from {SiegeWeapon} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon SiegeWeapon action queue
                else
                    GateHouse = get random abode of type GATEHOUSE in town PlayerTown
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon SiegeWeapon action queue
                        Target = marker at get target from {SiegeWeapon} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon SiegeWeapon action queue
                    else
                        ActionTimer = create timer for 2 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {LC10_SiegeCatapult[7]} radius 750
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC10_SiegeCatapult[7] action queue
                    Target = marker at get target from {LC10_SiegeCatapult[7]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC10_SiegeCatapult[7] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            else
                House = get building ALTAR in PlayerTown min built 0.75
                if House exists and PLAYER of House == 0 and LC10_SiegeCatapult[7] can navigate to object oTownCentre
                    clear siege weapon LC10_SiegeCatapult[7] action queue
                    Target = marker at get target from {LC10_SiegeCatapult[7]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC10_SiegeCatapult[7] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            end if
        end if

        until LC10_SiegeCatapult[7] not exists
    end loop
    
    if SiegeAttacking == 1 and UnderAttack != 0
        UnderAttack = UnderAttack - 1
    end if

    if LC10_SiegeCatapult[7] not exists and SiegeStucked == 0
        //CatapultDestroyed = 1
    end if
    
end loop

end script LC10_SiegeCatapult7Actions

begin script LC10_SiegeCatapult8Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = create timer for 0 seconds
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 0
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC10_Platoon[7] exists and LC10_Platoon[8] exists and LC10_Platoon[9] exists and LC10_Platoon[10] exists and LC10_SiegeCatapult[0] exists and LC10_SiegeCatapult[1] exists and LC10_SiegeCatapult[7] exists and LC10_SiegeCatapult[8] exists and ({LC10_SiegeCatapult[0]} near {AztecCapital} radius 800) and ({LC10_SiegeCatapult[1]} near {AztecCapital} radius 800) and ({LC10_SiegeCatapult[7]} near {AztecCapital} radius 800) and ({LC10_SiegeCatapult[8]} near {AztecCapital} radius 800)
    wait 2 seconds
    begin loop
        PlayerCreature = get distance from {LC10_SiegeCatapult[8]} to {oCreature}
        PlayerPlatoon1 = get platoon of player 0 nearest {LC10_SiegeCatapult[8]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC10_SiegeCatapult[8]} radius 150
        
        if PlayerCreature > 10 and PlayerPlatoon1 not exists and Catapult not exists
            if PlayerPlatoon1 not exists
                a = 1
            elsif PlayerCreature > 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                a = 1
            elsif Catapult not exists
                a = 1
            end if
        end if
        
        if PlayerCreature <= 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
            clear siege weapon LC10_SiegeCatapult[8] action queue
            a = 0
        elsif PlayerPlatoon1 exists and LC10_SiegeCatapult[8] can navigate to {PlayerPlatoon1}
            clear siege weapon LC10_SiegeCatapult[8] action queue
            a = 0
        elsif Catapult exists and LC10_SiegeCatapult[8] can navigate to {Catapult}
            clear siege weapon LC10_SiegeCatapult[8] action queue
            a = 0
        elsif PointOn != 5 and a == 1
            begin loop
                if LC10_SiegeCatapult[8] exists
                    if get SiegeOnPointTimer time remaining <= 0
                        SiegeWeaponPoint = marker at {LC10_SiegeCatapult[8]}
                        SiegeOnPointTimer = create timer for 40 seconds
                    elsif get SiegeOnPointTimer time remaining <= 5
                        if {LC10_SiegeCatapult[8]} near {SiegeWeaponPoint} radius 10
                            clear siege weapon LC10_SiegeCatapult[8] action queue
                            delete LC10_SiegeCatapult[8]
                            SiegeStucked = 1
                        end if
                    end if
                    if get CatapultMoveTimer1 time remaining <= 0
                        if get size of LC10_SiegeCatapult[8] action queue < 1

                            if PointOn == 0
                                if LC10_SiegeCatapult[8] can navigate to {SiegeRoute7[0]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute7[0]} to siege weapon LC10_SiegeCatapult[8] action queue
                                end if
                    
                            elsif PointOn == 1
                                if LC10_SiegeCatapult[8] can navigate to {SiegeRoute7[1]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute7[1]} to siege weapon LC10_SiegeCatapult[8] action queue
                                end if

                            elsif PointOn == 2
                                if LC10_SiegeCatapult[8] can navigate to {SiegeRoute7[2]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute7[2]} to siege weapon LC10_SiegeCatapult[8] action queue
                                end if

                            elsif PointOn == 3
                                if LC10_SiegeCatapult[8] can navigate to {SiegeRoute7[3]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute7[3]} to siege weapon LC10_SiegeCatapult[8] action queue
                                end if

                            elsif PointOn == 4
                                if LC10_SiegeCatapult[8] can navigate to {SiegeRoute7[4]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute7[4]} to siege weapon LC10_SiegeCatapult[8] action queue
                                end if

                            CatapultMoveTimer1 = create timer for 10 seconds
                            
                            end if
                        end if
                    end if        

                    if {LC10_SiegeCatapult[8]} near {SiegeRoute7[0]} radius 15 and PointOn != 1 or 60 seconds
                        PointOn = 1
                    elsif {LC10_SiegeCatapult[8]} near {SiegeRoute7[1]} radius 15 and PointOn != 2 or 60 seconds
                        PointOn = 2
                    elsif {LC10_SiegeCatapult[8]} near {SiegeRoute7[2]} radius 15 and PointOn != 3 or 60 seconds
                        PointOn = 3
                    elsif {LC10_SiegeCatapult[8]} near {SiegeRoute7[3]} radius 15 and PointOn != 4 or 60 seconds
                        PointOn = 4
                    elsif {LC10_SiegeCatapult[8]} near {SiegeRoute7[4]} radius 15 and PointOn != 5 or 60 seconds
                        PointOn = 5
                    elsif not LC10_SiegeCatapult[8] can navigate to {SiegeRoute7[4]} and {LC10_SiegeCatapult[8]} near {SiegeRoute7[3]} radius 15 and PointOn != 5
                        PointOn = 5
                    end if
                end if
            until LC10_SiegeCatapult[8] not exists or PointOn == 5 or 180 seconds
            end loop
        end if
        
        until PointOn == 5 or LC10_SiegeCatapult[8] not exists or 180 seconds
    end loop

    wait 5 seconds

    enable siege weapon LC10_SiegeCatapult[8] auto attack

    begin loop
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 5
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get HOUSE GATEHOUSE at {SiegeWeapon} radius 250
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon SiegeWeapon action queue
                    Target = marker at get target from {SiegeWeapon} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon SiegeWeapon action queue
                elsif GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE at {SiegeWeapon} radius 750
                    clear siege weapon SiegeWeapon action queue
                    Target = marker at get target from {SiegeWeapon} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon SiegeWeapon action queue
                else
                    GateHouse = get random abode of type GATEHOUSE in town PlayerTown
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon SiegeWeapon action queue
                        Target = marker at get target from {SiegeWeapon} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon SiegeWeapon action queue
                    else
                        ActionTimer = create timer for 2 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {LC10_SiegeCatapult[8]} radius 750
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC10_SiegeCatapult[8] action queue
                    Target = marker at get target from {LC10_SiegeCatapult[8]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC10_SiegeCatapult[8] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            else
                House = get building ALTAR in PlayerTown min built 0.75
                if House exists and PLAYER of House == 0 and LC10_SiegeCatapult[8] can navigate to object oTownCentre
                    clear siege weapon LC10_SiegeCatapult[8] action queue
                    Target = marker at get target from {LC10_SiegeCatapult[8]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC10_SiegeCatapult[8] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            end if
        end if

        until LC10_SiegeCatapult[8] not exists
    end loop
    
    if SiegeAttacking == 1 and UnderAttack != 0
        UnderAttack = UnderAttack - 1
    end if

    if LC10_SiegeCatapult[8] not exists and SiegeStucked == 0
        //CatapultDestroyed = 1
    end if
    
end loop

end script LC10_SiegeCatapult8Actions

begin script LC10_Platoon11Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    FirstAttack = 0
    
start

begin loop
    a = 0
    begin loop

        PlayerCreature = get distance from {LC10_Platoon[11]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC10_Platoon[11] can navigate to {oCreature}
            clear LC10_Platoon[11] action queue
            begin loop
                PlayerCreature = get distance from {LC10_Platoon[11]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC10_Platoon[11] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[11]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC10_Platoon[11] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC10_Platoon[11] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[11]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC10_Platoon[11]} radius 50
        if PlayerPlatoon1 exists and LC10_Platoon[11] can navigate to {PlayerPlatoon1}
            clear LC10_Platoon[11] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[11]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC10_Platoon[11] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[11]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC10_Platoon[11] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC10_Platoon[11] action queue
        elsif Catapult exists and LC10_Platoon[11] can navigate to {Catapult}
            clear LC10_Platoon[11] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC10_Platoon[11]} radius 50
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC10_Platoon[11] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[11]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[11]} radius 150
                if PlayerPlatoon1 exists and LC10_Platoon[11] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC10_Platoon[11] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC10_Platoon[11] action queue
            a = 0
        end if

        PlayerSettlement = get nearest town at {LC10_Platoon[11]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0
            if LC10_Platoon[11] can navigate to object Armory
                clear LC10_Platoon[11] action queue
                set LC10_Platoon[11] attack PlayerSettlement with severity 0.3 for takeover
                a = 1
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[11]} radius 150
                    PlayerCreature = get distance from {LC10_Platoon[11]} to {oCreature}
                    if PlayerPlatoon1 exists
                        a = 0
                    elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                        a = 0
                    elsif not LC10_Platoon[11] can navigate to object Armory
                        a = 0
                    elsif LC10_Platoon[11] not exists
                        a = 0
                    end if
                    until a == 0 or LC10_Platoon[11] not exists or PLAYER of PlayerSettlement == 1
                end loop
                clear LC10_Platoon[11] action queue
            end if
        end if

        if VolcanoActive == 1 and get size of LC10_Platoon[11] action queue < 1 and {LC10_Platoon[11]} not near {PlatoonPos[13]} radius 25
            add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {PlatoonPos[13]} to LC10_Platoon[11] action queue
            wait until LC10_Platoon[11] exists and LC10_Platoon[12] exists and LC10_Platoon[13] exists and LC10_SiegeCatapult[2] exists and LC10_SiegeCatapult[3] exists and ({LC10_SiegeCatapult[2]} near {AztecCapital} radius 800) and ({LC10_SiegeCatapult[3]} near {AztecCapital} radius 800)
        end if
        //if get size of LC10_Platoon[11] action queue < 1
            if VolcanoActive == 0 or {LC10_Platoon[11]} near {PlayerTown} radius 1000
                if LC10_Platoon[11] can navigate to object oTownCentre and PLAYER of PlayerTown == 0
                    wait number from 5 to 25 seconds
                    a = 1
                    clear LC10_Platoon[11] action queue
                    Number = number from 1 to 4
                    if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                        AttackMode = 1
                        set LC10_Platoon[11] attack PlayerTown with severity 0.2
                    elsif Number == 3 or Number == 4 //Destroy value buildings
                        AttackMode = 2
                        Building = 0
                        Timer = create timer for 2 seconds
                        begin loop
                            Number = number from 1 to 8
                            if Number == 1 or Number == 2 or Number == 3
                                Building = get building ALTAR in PlayerTown min built 0.75
                                if Building exists
                                    add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[11] action queue
                                else
                                    Building = 0
                                end if
                            elsif Number == 4
                                Building = get building TEMPLE in PlayerTown min built 0.75
                                if Building exists
                                    add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[11] action queue
                                else
                                    Building = 0
                                end if
                            elsif Number == 5
                                Building = get building CREATURE_PEN in PlayerTown min built 0.75
                                if Building exists
                                    add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[11] action queue
                                else
                                    Building = 0
                                end if
                            elsif Number == 6
                                Building = get building UNIVERSITY in PlayerTown min built 0.75
                                if Building exists
                                    add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[11] action queue
                                else
                                    Building = 0
                                end if
                            elsif Number == 7
                                Building = get building BATHHOUSE in PlayerTown min built 0.75
                                if Building exists
                                    add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[11] action queue
                                else
                                    Building = 0
                                end if
                            elsif Number == 8
                                Building = get building AMPITHEATRE in PlayerTown min built 0.75
                                if Building exists
                                    add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[11] action queue
                                else
                                    Building = 0
                                end if
                            end if
                            until Building != 0 or get Timer time remaining <= 0
                        end loop
                    else //Capture Town
                        AttackMode = 0
                        set LC10_Platoon[11] attack PlayerTown with severity 0.3 for takeover
                    end if
                    RecalculateTimer = create timer for 40 seconds
                    begin loop
                        PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[11]} radius 150
                        TestCreature2 = get distance from {LC10_Platoon[11]} to {MyCreature}
                        NumPat1 = get number of villagers in platoon LC10_Platoon[11]
                        //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC10_Platoon[11] can navigate to object PlayerTownCentre
                            if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                                a = 0
                            elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                                a = 0
                            elsif not LC10_Platoon[11] can navigate to object oTownCentre
                                a = 0
                            elsif LC10_Platoon[11] not exists
                                a = 0
                            elsif AttackMode == 1 and HEALTH of MyCreature == 0
                                a = 0
                            elsif AttackMode == 2 and Building not exists
                                a = 0
                            elsif AttackMode == 2 and HEALTH of Building < 0.1
                                a = 0
                            elsif AttackMode == 2 and Building == 0
                                a = 0
                            elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                                a = 0
                            end if
                        //end if
                        until a == 0 or LC10_Platoon[11] not exists
                    end loop
                    clear LC10_Platoon[11] action queue
                elsif LC10_Platoon[11] can navigate to {AttackPos[2]}
                    clear LC10_Platoon[11] action queue
                    add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[2]} to LC10_Platoon[11] action queue
                else
                    clear LC10_Platoon[11] action queue
                    add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[3]} to LC10_Platoon[11] action queue
                end if
            end if
        //end if

        until LC10_Platoon[11] not exists
    end loop
    if LC10_Platoon[11] not exists
        //PlatoonKilled = 1
        wait until LC10_Platoon[11] exists
    end if
end loop

end script LC10_Platoon11Actions

begin script LC10_Platoon12Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    FirstAttack = 0
    
start

begin loop
    a = 0
    begin loop

        PlayerCreature = get distance from {LC10_Platoon[12]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC10_Platoon[12] can navigate to {oCreature}
            clear LC10_Platoon[12] action queue
            begin loop
                PlayerCreature = get distance from {LC10_Platoon[12]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC10_Platoon[12] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[12]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC10_Platoon[12] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC10_Platoon[12] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[12]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC10_Platoon[12]} radius 50
        if PlayerPlatoon1 exists and LC10_Platoon[12] can navigate to {PlayerPlatoon1}
            clear LC10_Platoon[12] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[12]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC10_Platoon[12] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[12]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC10_Platoon[12] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC10_Platoon[12] action queue
        elsif Catapult exists and LC10_Platoon[12] can navigate to {Catapult}
            clear LC10_Platoon[12] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC10_Platoon[12]} radius 50
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC10_Platoon[12] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[12]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[12]} radius 150
                if PlayerPlatoon1 exists and LC10_Platoon[12] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC10_Platoon[12] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC10_Platoon[12] action queue
            a = 0
        end if

        PlayerSettlement = get nearest town at {LC10_Platoon[12]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0
            if LC10_Platoon[12] can navigate to object Armory
                clear LC10_Platoon[12] action queue
                set LC10_Platoon[12] attack PlayerSettlement with severity 0.3 for takeover
                a = 1
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[12]} radius 150
                    PlayerCreature = get distance from {LC10_Platoon[12]} to {oCreature}
                    if PlayerPlatoon1 exists
                        a = 0
                    elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                        a = 0
                    elsif not LC10_Platoon[12] can navigate to object Armory
                        a = 0
                    elsif LC10_Platoon[12] not exists
                        a = 0
                    end if
                    until a == 0 or LC10_Platoon[12] not exists or PLAYER of PlayerSettlement == 1
                end loop
                clear LC10_Platoon[12] action queue
            end if
        end if

        if VolcanoActive == 1 and get size of LC10_Platoon[12] action queue < 1 and {LC10_Platoon[12]} not near {PlatoonPos[14]} radius 25
            add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {PlatoonPos[14]} to LC10_Platoon[12] action queue
            wait until LC10_Platoon[12] exists and LC10_Platoon[12] exists and LC10_Platoon[13] exists and LC10_SiegeCatapult[2] exists and LC10_SiegeCatapult[3] exists and ({LC10_SiegeCatapult[2]} near {AztecCapital} radius 800) and ({LC10_SiegeCatapult[3]} near {AztecCapital} radius 800)
        end if
        //if get size of LC10_Platoon[12] action queue < 1
            if VolcanoActive == 0 or {LC10_Platoon[12]} near {PlayerTown} radius 1000
                if LC10_Platoon[12] can navigate to object oTownCentre and PLAYER of PlayerTown == 0
                    wait number from 5 to 25 seconds
                    a = 1
                    clear LC10_Platoon[12] action queue
                    Number = number from 1 to 4
                    if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                        AttackMode = 1
                        set LC10_Platoon[12] attack PlayerTown with severity 0.2
                    elsif Number == 3 or Number == 4 //Destroy value buildings
                        AttackMode = 2
                        Building = 0
                        Timer = create timer for 2 seconds
                        begin loop
                            Number = number from 1 to 8
                            if Number == 1 or Number == 2 or Number == 3
                                Building = get building ALTAR in PlayerTown min built 0.75
                                if Building exists
                                    add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[12] action queue
                                else
                                    Building = 0
                                end if
                            elsif Number == 4
                                Building = get building TEMPLE in PlayerTown min built 0.75
                                if Building exists
                                    add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[12] action queue
                                else
                                    Building = 0
                                end if
                            elsif Number == 5
                                Building = get building CREATURE_PEN in PlayerTown min built 0.75
                                if Building exists
                                    add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[12] action queue
                                else
                                    Building = 0
                                end if
                            elsif Number == 6
                                Building = get building UNIVERSITY in PlayerTown min built 0.75
                                if Building exists
                                    add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[12] action queue
                                else
                                    Building = 0
                                end if
                            elsif Number == 7
                                Building = get building BATHHOUSE in PlayerTown min built 0.75
                                if Building exists
                                    add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[12] action queue
                                else
                                    Building = 0
                                end if
                            elsif Number == 8
                                Building = get building AMPITHEATRE in PlayerTown min built 0.75
                                if Building exists
                                    add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[12] action queue
                                else
                                    Building = 0
                                end if
                            end if
                            until Building != 0 or get Timer time remaining <= 0
                        end loop
                    else //Capture Town
                        AttackMode = 0
                        set LC10_Platoon[12] attack PlayerTown with severity 0.3 for takeover
                    end if
                    RecalculateTimer = create timer for 40 seconds
                    begin loop
                        PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[12]} radius 150
                        TestCreature2 = get distance from {LC10_Platoon[12]} to {MyCreature}
                        NumPat1 = get number of villagers in platoon LC10_Platoon[12]
                        //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC10_Platoon[12] can navigate to object PlayerTownCentre
                            if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                                a = 0
                            elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                                a = 0
                            elsif not LC10_Platoon[12] can navigate to object oTownCentre
                                a = 0
                            elsif LC10_Platoon[12] not exists
                                a = 0
                            elsif AttackMode == 1 and HEALTH of MyCreature == 0
                                a = 0
                            elsif AttackMode == 2 and Building not exists
                                a = 0
                            elsif AttackMode == 2 and HEALTH of Building < 0.1
                                a = 0
                            elsif AttackMode == 2 and Building == 0
                                a = 0
                            elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                                a = 0
                            end if
                        //end if
                        until a == 0 or LC10_Platoon[12] not exists
                    end loop
                    clear LC10_Platoon[12] action queue
                elsif LC10_Platoon[12] can navigate to {AttackPos[2]} + {20,0,20}
                    clear LC10_Platoon[12] action queue
                    add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[2]} + {20,0,20} to LC10_Platoon[12] action queue
                else
                    clear LC10_Platoon[12] action queue
                    add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[3]} + {20,0,20} to LC10_Platoon[12] action queue
                end if
            end if
        //end if

        until LC10_Platoon[12] not exists
    end loop
    if LC10_Platoon[12] not exists
        //PlatoonKilled = 1
        wait until LC10_Platoon[12] exists
    end if
end loop

end script LC10_Platoon12Actions

begin script LC10_Platoon13Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    FirstAttack = 0
    
start

begin loop
    a = 0
    begin loop

        PlayerCreature = get distance from {LC10_Platoon[13]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC10_Platoon[13] can navigate to {oCreature}
            clear LC10_Platoon[13] action queue
            begin loop
                PlayerCreature = get distance from {LC10_Platoon[13]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using oCreature to LC10_Platoon[13] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[13]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC10_Platoon[13] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC10_Platoon[13] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[13]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC10_Platoon[13]} radius 50
        if PlayerPlatoon1 exists and LC10_Platoon[13] can navigate to {PlayerPlatoon1}
            clear LC10_Platoon[13] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[13]} radius 150
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using PlayerPlatoon1 to LC10_Platoon[13] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[13]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC10_Platoon[13] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC10_Platoon[13] action queue
        elsif Catapult exists and LC10_Platoon[13] can navigate to {Catapult}
            clear LC10_Platoon[13] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC10_Platoon[13]} radius 50
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using Catapult to LC10_Platoon[13] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[13]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[13]} radius 150
                if PlayerPlatoon1 exists and LC10_Platoon[13] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC10_Platoon[13] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC10_Platoon[13] action queue
            a = 0
        end if

        PlayerSettlement = get nearest town at {LC10_Platoon[13]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0
            if LC10_Platoon[13] can navigate to object Armory
                clear LC10_Platoon[13] action queue
                set LC10_Platoon[13] attack PlayerSettlement with severity 0.3 for takeover
                a = 1
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[13]} radius 150
                    PlayerCreature = get distance from {LC10_Platoon[13]} to {oCreature}
                    if PlayerPlatoon1 exists
                        a = 0
                    elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                        a = 0
                    elsif not LC10_Platoon[13] can navigate to object Armory
                        a = 0
                    elsif LC10_Platoon[13] not exists
                        a = 0
                    end if
                    until a == 0 or LC10_Platoon[13] not exists or PLAYER of PlayerSettlement == 1
                end loop
                clear LC10_Platoon[13] action queue
            end if
        end if

        if VolcanoActive == 1 and get size of LC10_Platoon[13] action queue < 1 and {LC10_Platoon[13]} not near {PlatoonPos[15]} radius 25
            add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {PlatoonPos[15]} to LC10_Platoon[13] action queue
            wait until LC10_Platoon[11] exists and LC10_Platoon[12] exists and LC10_Platoon[13] exists and LC10_SiegeCatapult[2] exists and LC10_SiegeCatapult[3] exists and ({LC10_SiegeCatapult[2]} near {AztecCapital} radius 800) and ({LC10_SiegeCatapult[3]} near {AztecCapital} radius 800)
        end if
        //if get size of LC10_Platoon[13] action queue < 1
            if VolcanoActive == 0 or {LC10_Platoon[13]} near {PlayerTown} radius 1000
                if LC10_Platoon[13] can navigate to object oTownCentre and PLAYER of PlayerTown == 0
                    wait number from 5 to 25 seconds
                    a = 1
                    clear LC10_Platoon[13] action queue
                    Number = number from 1 to 4
                    if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                        AttackMode = 1
                        set LC10_Platoon[13] attack PlayerTown with severity 0.2
                    elsif Number == 3 or Number == 4 //Destroy value buildings
                        AttackMode = 2
                        Building = 0
                        Timer = create timer for 2 seconds
                        begin loop
                            Number = number from 1 to 8
                            if Number == 1 or Number == 2 or Number == 3
                                Building = get building ALTAR in PlayerTown min built 0.75
                                if Building exists
                                    add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[13] action queue
                                else
                                    Building = 0
                                end if
                            elsif Number == 4
                                Building = get building TEMPLE in PlayerTown min built 0.75
                                if Building exists
                                    add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[13] action queue
                                else
                                    Building = 0
                                end if
                            elsif Number == 5
                                Building = get building CREATURE_PEN in PlayerTown min built 0.75
                                if Building exists
                                    add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[13] action queue
                                else
                                    Building = 0
                                end if
                            elsif Number == 6
                                Building = get building UNIVERSITY in PlayerTown min built 0.75
                                if Building exists
                                    add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[13] action queue
                                else
                                    Building = 0
                                end if
                            elsif Number == 7
                                Building = get building BATHHOUSE in PlayerTown min built 0.75
                                if Building exists
                                    add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[13] action queue
                                else
                                    Building = 0
                                end if
                            elsif Number == 8
                                Building = get building AMPITHEATRE in PlayerTown min built 0.75
                                if Building exists
                                    add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[13] action queue
                                else
                                    Building = 0
                                end if
                            end if
                            until Building != 0 or get Timer time remaining <= 0
                        end loop
                    else //Capture Town
                        AttackMode = 0
                        set LC10_Platoon[13] attack PlayerTown with severity 0.3 for takeover
                    end if
                    RecalculateTimer = create timer for 40 seconds
                    begin loop
                        PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[13]} radius 150
                        TestCreature2 = get distance from {LC10_Platoon[13]} to {MyCreature}
                        NumPat1 = get number of villagers in platoon LC10_Platoon[13]
                        //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC10_Platoon[13] can navigate to object PlayerTownCentre
                            if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                                a = 0
                            elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                                a = 0
                            elsif not LC10_Platoon[13] can navigate to object oTownCentre
                                a = 0
                            elsif LC10_Platoon[13] not exists
                                a = 0
                            elsif AttackMode == 1 and HEALTH of MyCreature == 0
                                a = 0
                            elsif AttackMode == 2 and Building not exists
                                a = 0
                            elsif AttackMode == 2 and HEALTH of Building < 0.1
                                a = 0
                            elsif AttackMode == 2 and Building == 0
                                a = 0
                            elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                                a = 0
                            end if
                        //end if
                        until a == 0 or LC10_Platoon[13] not exists
                    end loop
                    clear LC10_Platoon[13] action queue
                elsif LC10_Platoon[13] can navigate to {AttackPos[2]} + {-20,0,-20}
                    clear LC10_Platoon[13] action queue
                    add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[2]} + {-20,0,-20} to LC10_Platoon[13] action queue
                else
                    clear LC10_Platoon[13] action queue
                    add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[3]} + {-20,0,-20} to LC10_Platoon[13] action queue
                end if
            end if
        //end if

        until LC10_Platoon[13] not exists
    end loop
    if LC10_Platoon[13] not exists
        //PlatoonKilled = 1
        wait until LC10_Platoon[13] exists
    end if
end loop

end script LC10_Platoon13Actions

begin script LC10_SiegeCatapult2Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = create timer for 0 seconds
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 0
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC10_Platoon[11] exists and LC10_Platoon[12] exists and LC10_Platoon[13] exists and LC10_SiegeCatapult[2] exists and LC10_SiegeCatapult[3] exists and VolcanoActive == 0
    wait 2 seconds
    begin loop
        PlayerCreature = get distance from {LC10_SiegeCatapult[2]} to {oCreature}
        PlayerPlatoon1 = get platoon of player 0 nearest {LC10_SiegeCatapult[2]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC10_SiegeCatapult[2]} radius 150
        
        if PlayerCreature > 10 and PlayerPlatoon1 not exists and Catapult not exists
            if PlayerPlatoon1 not exists
                a = 1
            elsif PlayerCreature > 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                a = 1
            elsif Catapult not exists
                a = 1
            end if
        end if
        
        if PlayerCreature <= 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
            clear siege weapon LC10_SiegeCatapult[2] action queue
            a = 0
        elsif PlayerPlatoon1 exists and LC10_SiegeCatapult[2] can navigate to {PlayerPlatoon1}
            clear siege weapon LC10_SiegeCatapult[2] action queue
            a = 0
        elsif Catapult exists and LC10_SiegeCatapult[2] can navigate to {Catapult}
            clear siege weapon LC10_SiegeCatapult[2] action queue
            a = 0
        elsif PointOn != 5 and a == 1
            begin loop
                if LC10_SiegeCatapult[2] exists
                    if get SiegeOnPointTimer time remaining <= 0
                        SiegeWeaponPoint = marker at {LC10_SiegeCatapult[2]}
                        SiegeOnPointTimer = create timer for 40 seconds
                    elsif get SiegeOnPointTimer time remaining <= 5
                        if {LC10_SiegeCatapult[2]} near {SiegeWeaponPoint} radius 10
                            clear siege weapon LC10_SiegeCatapult[2] action queue
                            delete LC10_SiegeCatapult[2]
                            SiegeStucked = 1
                        end if
                    end if
                    if get CatapultMoveTimer1 time remaining <= 0
                        if get size of LC10_SiegeCatapult[2] action queue < 1

                            if PointOn == 0
                                if LC10_SiegeCatapult[2] can navigate to {SiegeRoute3[0]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute3[0]} to siege weapon LC10_SiegeCatapult[2] action queue
                                end if
                    
                            elsif PointOn == 1
                                if LC10_SiegeCatapult[2] can navigate to {SiegeRoute3[1]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute3[1]} to siege weapon LC10_SiegeCatapult[2] action queue
                                end if

                            elsif PointOn == 2
                                if LC10_SiegeCatapult[2] can navigate to {SiegeRoute3[2]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute3[2]} to siege weapon LC10_SiegeCatapult[2] action queue
                                end if

                            elsif PointOn == 3
                                if LC10_SiegeCatapult[2] can navigate to {SiegeRoute3[3]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute3[3]} to siege weapon LC10_SiegeCatapult[2] action queue
                                end if

                            elsif PointOn == 4
                                if LC10_SiegeCatapult[2] can navigate to {SiegeRoute3[4]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute3[4]} to siege weapon LC10_SiegeCatapult[2] action queue
                                end if

                            CatapultMoveTimer1 = create timer for 10 seconds
                            
                            end if
                        end if
                    end if        

                    if {LC10_SiegeCatapult[2]} near {SiegeRoute3[0]} radius 15 and PointOn != 1 or 60 seconds
                        PointOn = 1
                    elsif {LC10_SiegeCatapult[2]} near {SiegeRoute3[1]} radius 15 and PointOn != 2 or 60 seconds
                        PointOn = 2
                    elsif {LC10_SiegeCatapult[2]} near {SiegeRoute3[2]} radius 15 and PointOn != 3 or 60 seconds
                        PointOn = 3
                    elsif {LC10_SiegeCatapult[2]} near {SiegeRoute3[3]} radius 15 and PointOn != 4 or 60 seconds
                        PointOn = 4
                    elsif {LC10_SiegeCatapult[2]} near {SiegeRoute3[4]} radius 15 and PointOn != 5 or 60 seconds
                        PointOn = 5
                    elsif not LC10_SiegeCatapult[2] can navigate to {SiegeRoute3[4]} and {LC10_SiegeCatapult[2]} near {SiegeRoute3[3]} radius 15 and PointOn != 5
                        PointOn = 5
                    end if
                end if
            until LC10_SiegeCatapult[2] not exists or PointOn == 5 or 180 seconds
            end loop
        end if
        
        until PointOn == 5 or LC10_SiegeCatapult[2] not exists or 180 seconds
    end loop

    wait 5 seconds

    enable siege weapon LC10_SiegeCatapult[2] auto attack

    begin loop
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 5
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get HOUSE GATEHOUSE at {SiegeWeapon} radius 250
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon SiegeWeapon action queue
                    Target = marker at get target from {SiegeWeapon} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon SiegeWeapon action queue
                elsif GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE at {SiegeWeapon} radius 750
                    clear siege weapon SiegeWeapon action queue
                    Target = marker at get target from {SiegeWeapon} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon SiegeWeapon action queue
                else
                    GateHouse = get random abode of type GATEHOUSE in town PlayerTown
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon SiegeWeapon action queue
                        Target = marker at get target from {SiegeWeapon} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon SiegeWeapon action queue
                    else
                        ActionTimer = create timer for 2 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {LC10_SiegeCatapult[2]} radius 750
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC10_SiegeCatapult[2] action queue
                    Target = marker at get target from {LC10_SiegeCatapult[2]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC10_SiegeCatapult[2] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            else
                House = get building ALTAR in PlayerTown min built 0.75
                if House exists and PLAYER of House == 0 and LC10_SiegeCatapult[2] can navigate to object oTownCentre
                    clear siege weapon LC10_SiegeCatapult[2] action queue
                    Target = marker at get target from {LC10_SiegeCatapult[2]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC10_SiegeCatapult[2] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            end if
        end if

        until LC10_SiegeCatapult[2] not exists
    end loop
    
    if SiegeAttacking == 1 and UnderAttack != 0
        UnderAttack = UnderAttack - 1
    end if

    if LC10_SiegeCatapult[2] not exists and SiegeStucked == 0
        //CatapultDestroyed = 1
    end if
    
end loop

end script LC10_SiegeCatapult2Actions

begin script LC10_SiegeCatapult3Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = create timer for 0 seconds
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 0
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC10_Platoon[11] exists and LC10_Platoon[12] exists and LC10_Platoon[13] exists and LC10_SiegeCatapult[2] exists and LC10_SiegeCatapult[3] exists and VolcanoActive == 0
    wait 2 seconds
    begin loop
        PlayerCreature = get distance from {LC10_SiegeCatapult[3]} to {oCreature}
        PlayerPlatoon1 = get platoon of player 0 nearest {LC10_SiegeCatapult[3]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC10_SiegeCatapult[3]} radius 150
        
        if PlayerCreature > 10 and PlayerPlatoon1 not exists and Catapult not exists
            if PlayerPlatoon1 not exists
                a = 1
            elsif PlayerCreature > 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                a = 1
            elsif Catapult not exists
                a = 1
            end if
        end if
        
        if PlayerCreature <= 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
            clear siege weapon LC10_SiegeCatapult[3] action queue
            a = 0
        elsif PlayerPlatoon1 exists and LC10_SiegeCatapult[3] can navigate to {PlayerPlatoon1}
            clear siege weapon LC10_SiegeCatapult[3] action queue
            a = 0
        elsif Catapult exists and LC10_SiegeCatapult[3] can navigate to {Catapult}
            clear siege weapon LC10_SiegeCatapult[3] action queue
            a = 0
        elsif PointOn != 5 and a == 1
            begin loop
                if LC10_SiegeCatapult[3] exists
                    if get SiegeOnPointTimer time remaining <= 0
                        SiegeWeaponPoint = marker at {LC10_SiegeCatapult[3]}
                        SiegeOnPointTimer = create timer for 40 seconds
                    elsif get SiegeOnPointTimer time remaining <= 5
                        if {LC10_SiegeCatapult[3]} near {SiegeWeaponPoint} radius 10
                            clear siege weapon LC10_SiegeCatapult[3] action queue
                            delete LC10_SiegeCatapult[3]
                            SiegeStucked = 1
                        end if
                    end if
                    if get CatapultMoveTimer1 time remaining <= 0
                        if get size of LC10_SiegeCatapult[3] action queue < 1

                            if PointOn == 0
                                if LC10_SiegeCatapult[3] can navigate to {SiegeRoute4[0]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute4[0]} to siege weapon LC10_SiegeCatapult[3] action queue
                                end if
                    
                            elsif PointOn == 1
                                if LC10_SiegeCatapult[3] can navigate to {SiegeRoute4[1]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute4[1]} to siege weapon LC10_SiegeCatapult[3] action queue
                                end if

                            elsif PointOn == 2
                                if LC10_SiegeCatapult[3] can navigate to {SiegeRoute4[2]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute4[2]} to siege weapon LC10_SiegeCatapult[3] action queue
                                end if

                            elsif PointOn == 3
                                if LC10_SiegeCatapult[3] can navigate to {SiegeRoute4[3]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute4[3]} to siege weapon LC10_SiegeCatapult[3] action queue
                                end if

                            elsif PointOn == 4
                                if LC10_SiegeCatapult[3] can navigate to {SiegeRoute4[4]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute4[4]} to siege weapon LC10_SiegeCatapult[3] action queue
                                end if

                            CatapultMoveTimer1 = create timer for 10 seconds
                            
                            end if
                        end if
                    end if        

                    if {LC10_SiegeCatapult[3]} near {SiegeRoute4[0]} radius 15 and PointOn != 1 or 60 seconds
                        PointOn = 1
                    elsif {LC10_SiegeCatapult[3]} near {SiegeRoute4[1]} radius 15 and PointOn != 2 or 60 seconds
                        PointOn = 2
                    elsif {LC10_SiegeCatapult[3]} near {SiegeRoute4[2]} radius 15 and PointOn != 3 or 60 seconds
                        PointOn = 3
                    elsif {LC10_SiegeCatapult[3]} near {SiegeRoute4[3]} radius 15 and PointOn != 4 or 60 seconds
                        PointOn = 4
                    elsif {LC10_SiegeCatapult[3]} near {SiegeRoute4[4]} radius 15 and PointOn != 5 or 60 seconds
                        PointOn = 5
                    elsif not LC10_SiegeCatapult[3] can navigate to {SiegeRoute4[4]} and {LC10_SiegeCatapult[3]} near {SiegeRoute4[3]} radius 15 and PointOn != 5
                        PointOn = 5
                    end if
                end if
            until LC10_SiegeCatapult[3] not exists or PointOn == 5 or 180 seconds
            end loop
        end if
        
        until PointOn == 5 or LC10_SiegeCatapult[3] not exists or 180 seconds
    end loop

    wait 5 seconds

    enable siege weapon LC10_SiegeCatapult[3] auto attack

    begin loop
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 5
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get HOUSE GATEHOUSE at {SiegeWeapon} radius 250
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon SiegeWeapon action queue
                    Target = marker at get target from {SiegeWeapon} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon SiegeWeapon action queue
                elsif GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE at {SiegeWeapon} radius 750
                    clear siege weapon SiegeWeapon action queue
                    Target = marker at get target from {SiegeWeapon} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon SiegeWeapon action queue
                else
                    GateHouse = get random abode of type GATEHOUSE in town PlayerTown
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon SiegeWeapon action queue
                        Target = marker at get target from {SiegeWeapon} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon SiegeWeapon action queue
                    else
                        ActionTimer = create timer for 2 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {LC10_SiegeCatapult[3]} radius 750
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC10_SiegeCatapult[3] action queue
                    Target = marker at get target from {LC10_SiegeCatapult[3]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC10_SiegeCatapult[3] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            else
                House = get building ALTAR in PlayerTown min built 0.75
                if House exists and PLAYER of House == 0 and LC10_SiegeCatapult[3] can navigate to object oTownCentre
                    clear siege weapon LC10_SiegeCatapult[3] action queue
                    Target = marker at get target from {LC10_SiegeCatapult[3]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC10_SiegeCatapult[3] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            end if
        end if

        until LC10_SiegeCatapult[3] not exists
    end loop
    
    if SiegeAttacking == 1 and UnderAttack != 0
        UnderAttack = UnderAttack - 1
    end if

    if LC10_SiegeCatapult[3] not exists and SiegeStucked == 0
        //CatapultDestroyed = 1
    end if
    
end loop

end script LC10_SiegeCatapult3Actions

begin script LC10_Platoon22Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC10_Platoon[22] exists
    begin loop

        PlayerCreature = get distance from {LC10_Platoon[22]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC10_Platoon[22] can navigate to {oCreature}
            clear LC10_Platoon[22] action queue
            begin loop
                PlayerCreature = get distance from {LC10_Platoon[22]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using oCreature to LC10_Platoon[22] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[22]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC10_Platoon[22] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC10_Platoon[22] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[22]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC10_Platoon[22]} radius 150
        if PlayerPlatoon1 exists and LC10_Platoon[22] can navigate to {PlayerPlatoon1}
            clear LC10_Platoon[22] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[22]} radius 150
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using PlayerPlatoon1 to LC10_Platoon[22] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[22]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC10_Platoon[22] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC10_Platoon[22] action queue
        elsif Catapult exists and LC10_Platoon[22] can navigate to {Catapult}
            clear LC10_Platoon[22] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC10_Platoon[22]} radius 150
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using Catapult to LC10_Platoon[22] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[22]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[22]} radius 150
                if PlayerPlatoon1 exists and LC10_Platoon[22] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC10_Platoon[22] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC10_Platoon[22] action queue
            a = 0
        end if
        
        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in NearestSettlement min built 1.0
        if not LC10_Platoon[22] can navigate to object oTownCentre and LC10_SiegeCatapult[4] exists
            add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {LC10_SiegeCatapult[4]} to LC10_Platoon[22] action queue
            wait 5 seconds
        end if

        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in NearestSettlement min built 1.0
        //if get size of LC10_Platoon[22] action queue < 1
            if LC10_Platoon[22] can navigate to object oTownCentre
                wait number from 5 to 25 seconds
                a = 1
                clear LC10_Platoon[22] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC10_Platoon[22] attack NearestSettlement with severity 0.2 for takeover
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[22] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[22] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[22] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[22] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[22] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[22] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    set LC10_Platoon[22] attack NearestSettlement with severity 0.3 for takeover
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[22]} radius 150
                    TestCreature2 = get distance from {LC10_Platoon[22]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC10_Platoon[22]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC10_Platoon[22] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town NearestSettlement is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town NearestSettlement is under takeover from player 1
                            a = 0
                        elsif not LC10_Platoon[22] can navigate to object oTownCentre
                            a = 0
                        elsif LC10_Platoon[22] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town NearestSettlement is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC10_Platoon[22] not exists
                end loop
                clear LC10_Platoon[22] action queue
            else
                clear LC10_Platoon[22] action queue
            end if
        //end if

        until LC10_Platoon[22] not exists
    end loop
    if LC10_Platoon[22] not exists
        //PlatoonKilled = 1
        wait until LC10_Platoon[22] exists
    end if
end loop

end script LC10_Platoon22Actions

begin script LC10_Platoon23Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC10_Platoon[23] exists
    begin loop

        PlayerCreature = get distance from {LC10_Platoon[23]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC10_Platoon[23] can navigate to {oCreature}
            clear LC10_Platoon[23] action queue
            begin loop
                PlayerCreature = get distance from {LC10_Platoon[23]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC10_Platoon[23] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[23]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC10_Platoon[23] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC10_Platoon[23] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[23]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC10_Platoon[23]} radius 150
        if PlayerPlatoon1 exists and LC10_Platoon[23] can navigate to {PlayerPlatoon1}
            clear LC10_Platoon[23] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[23]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC10_Platoon[23] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[23]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC10_Platoon[23] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC10_Platoon[23] action queue
        elsif Catapult exists and LC10_Platoon[23] can navigate to {Catapult}
            clear LC10_Platoon[23] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC10_Platoon[23]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC10_Platoon[23] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[23]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[23]} radius 150
                if PlayerPlatoon1 exists and LC10_Platoon[23] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC10_Platoon[23] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC10_Platoon[23] action queue
            a = 0
        end if
        
        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in NearestSettlement min built 1.0
        if not LC10_Platoon[23] can navigate to object oTownCentre and LC10_SiegeCatapult[4] exists
            add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {LC10_SiegeCatapult[4]} + {20,0,20} to LC10_Platoon[23] action queue
            wait 5 seconds
        end if

        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in NearestSettlement min built 1.0
        //if get size of LC10_Platoon[23] action queue < 1
            if LC10_Platoon[23] can navigate to object oTownCentre
                wait number from 5 to 25 seconds
                a = 1
                clear LC10_Platoon[23] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC10_Platoon[23] attack NearestSettlement with severity 0.2 for takeover
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[23] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[23] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[23] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[23] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[23] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[23] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    set LC10_Platoon[23] attack NearestSettlement with severity 0.3 for takeover
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[23]} radius 150
                    TestCreature2 = get distance from {LC10_Platoon[23]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC10_Platoon[23]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC10_Platoon[23] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town NearestSettlement is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town NearestSettlement is under takeover from player 1
                            a = 0
                        elsif not LC10_Platoon[23] can navigate to object oTownCentre
                            a = 0
                        elsif LC10_Platoon[23] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town NearestSettlement is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC10_Platoon[23] not exists
                end loop
                clear LC10_Platoon[23] action queue
            else
                clear LC10_Platoon[23] action queue
            end if
        //end if

        until LC10_Platoon[23] not exists
    end loop
    if LC10_Platoon[23] not exists
        //PlatoonKilled = 1
        wait until LC10_Platoon[23] exists
    end if
end loop

end script LC10_Platoon23Actions

begin script LC10_Platoon24Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC10_Platoon[24] exists
    begin loop

        PlayerCreature = get distance from {LC10_Platoon[24]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC10_Platoon[24] can navigate to {oCreature}
            clear LC10_Platoon[24] action queue
            begin loop
                PlayerCreature = get distance from {LC10_Platoon[24]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC10_Platoon[24] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[24]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC10_Platoon[24] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC10_Platoon[24] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[24]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC10_Platoon[24]} radius 150
        if PlayerPlatoon1 exists and LC10_Platoon[24] can navigate to {PlayerPlatoon1}
            clear LC10_Platoon[24] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[24]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC10_Platoon[24] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[24]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC10_Platoon[24] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC10_Platoon[24] action queue
        elsif Catapult exists and LC10_Platoon[24] can navigate to {Catapult}
            clear LC10_Platoon[24] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC10_Platoon[24]} radius 150
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Catapult to LC10_Platoon[24] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[24]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[24]} radius 150
                if PlayerPlatoon1 exists and LC10_Platoon[24] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC10_Platoon[24] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC10_Platoon[24] action queue
            a = 0
        end if
        
        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in NearestSettlement min built 1.0
        if not LC10_Platoon[24] can navigate to object oTownCentre and LC10_SiegeCatapult[5] exists
            add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {LC10_SiegeCatapult[5]} + {20,0,20} to LC10_Platoon[24] action queue
            wait 5 seconds
        end if

        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in NearestSettlement min built 1.0
        //if get size of LC10_Platoon[24] action queue < 1
            if LC10_Platoon[24] can navigate to object oTownCentre
                wait number from 5 to 25 seconds
                a = 1
                clear LC10_Platoon[24] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC10_Platoon[24] attack NearestSettlement with severity 0.2 for takeover
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[24] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[24] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[24] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[24] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[24] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[24] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    set LC10_Platoon[24] attack NearestSettlement with severity 0.3 for takeover
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[24]} radius 150
                    TestCreature2 = get distance from {LC10_Platoon[24]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC10_Platoon[24]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC10_Platoon[24] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town NearestSettlement is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town NearestSettlement is under takeover from player 1
                            a = 0
                        elsif not LC10_Platoon[24] can navigate to object oTownCentre
                            a = 0
                        elsif LC10_Platoon[24] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town NearestSettlement is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC10_Platoon[24] not exists
                end loop
                clear LC10_Platoon[24] action queue
            else
                clear LC10_Platoon[24] action queue
            end if
        //end if

        until LC10_Platoon[24] not exists
    end loop
    if LC10_Platoon[24] not exists
        //PlatoonKilled = 1
        wait until LC10_Platoon[24] exists
    end if
end loop

end script LC10_Platoon24Actions

begin script LC10_Platoon25Actions

    TestPlatoonGuards = 0
    DistanceG = 0
    disvolcano = 0
    Position1 = 0
    Position2 = 0
    Position3 = 0
    Position4 = 0
    PlayerCreature = 0
    PlayerPlatoon1 = 0
    TestSiege = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    HomeTown = get town with id 4
    Catapult = 0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in HomeTown min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in HomeTown min built 1.0
    PlayerPlatoon1Distance = 0
    PlayerCatapultDistance = 0
    a = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    Number = 0
    PlayerSettlement = 0
    AttackMode = 0
    Building = 0
    TestCreature2 = 0
    Timer = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 0
    wait until LC10_Platoon[25] exists
    begin loop

        PlayerCreature = get distance from {LC10_Platoon[25]} to {oCreature}
        if PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC10_Platoon[25] can navigate to {oCreature}
            clear LC10_Platoon[25] action queue
            begin loop
                PlayerCreature = get distance from {LC10_Platoon[25]} to {oCreature}
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using oCreature to LC10_Platoon[25] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[25]
                until NumPat1 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC10_Platoon[25] can navigate to {oCreature} or PlayerCreature > 150
            end loop
            clear LC10_Platoon[25] action queue
        end if
        
        PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[25]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC10_Platoon[25]} radius 150
        if PlayerPlatoon1 exists and LC10_Platoon[25] can navigate to {PlayerPlatoon1}
            clear LC10_Platoon[25] action queue
            begin loop
                PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[25]} radius 150
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using PlayerPlatoon1 to LC10_Platoon[25] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[25]
                HeTeste1 = get number of villagers in platoon PlayerPlatoon1
                until NumPat1 == 0 or HeTeste1 == 0 or not LC10_Platoon[25] can navigate to {PlayerPlatoon1} or PlayerPlatoon1 not exists
            end loop
            clear LC10_Platoon[25] action queue
        elsif Catapult exists and LC10_Platoon[25] can navigate to {Catapult}
            clear LC10_Platoon[25] action queue
            a = 0
            begin loop
                Catapult = get siege weapon of player 0 nearest {LC10_Platoon[25]} radius 150
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using Catapult to LC10_Platoon[25] action queue
                NumPat1 = get number of villagers in platoon LC10_Platoon[25]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[25]} radius 150
                if PlayerPlatoon1 exists and LC10_Platoon[25] can navigate to {PlayerPlatoon1}
                    a = 1
                end if
                until NumPat1 == 0 or Catapult not exists or not LC10_Platoon[25] can navigate to {Catapult} or a == 1 or Catapult not exists
            end loop
            clear LC10_Platoon[25] action queue
            a = 0
        end if
        
        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in NearestSettlement min built 1.0
        if not LC10_Platoon[25] can navigate to object oTownCentre and LC10_SiegeCatapult[5] exists
            add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {LC10_SiegeCatapult[5]} to LC10_Platoon[25] action queue
            wait 5 seconds
        end if

        oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in NearestSettlement min built 1.0
        //if get size of LC10_Platoon[25] action queue < 1
            if LC10_Platoon[25] can navigate to object oTownCentre
                wait number from 5 to 25 seconds
                a = 1
                clear LC10_Platoon[25] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC10_Platoon[25] attack NearestSettlement with severity 0.2 for takeover
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[25] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[25] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[25] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[25] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[25] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in NearestSettlement min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[25] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    set LC10_Platoon[25] attack NearestSettlement with severity 0.3 for takeover
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[25]} radius 150
                    TestCreature2 = get distance from {LC10_Platoon[25]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC10_Platoon[25]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC10_Platoon[25] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town NearestSettlement is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town NearestSettlement is under takeover from player 1
                            a = 0
                        elsif not LC10_Platoon[25] can navigate to object oTownCentre
                            a = 0
                        elsif LC10_Platoon[25] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town NearestSettlement is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC10_Platoon[25] not exists
                end loop
                clear LC10_Platoon[25] action queue
            else
                clear LC10_Platoon[25] action queue
            end if
        //end if

        until LC10_Platoon[25] not exists
    end loop
    if LC10_Platoon[25] not exists
        //PlatoonKilled = 1
        wait until LC10_Platoon[25] exists
    end if
end loop

end script LC10_Platoon25Actions

begin script LC10_SiegeCatapult4Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = 5
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 3
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC10_SiegeCatapult[4] exists
    wait 15 seconds

    clear siege weapon LC10_SiegeCatapult[4] action queue

    begin loop
        if get SiegeOnPointTimer time remaining <= 0
            SiegeWeaponPoint = marker at {LC10_SiegeCatapult[4]}
            SiegeOnPointTimer = create timer for 160 seconds
        elsif get SiegeOnPointTimer time remaining <= 5 and not {LC10_SiegeCatapult[4]} near {NearestSettlement} radius 400
            if {LC10_SiegeCatapult[4]} near {SiegeWeaponPoint} radius 10
                clear siege weapon LC10_SiegeCatapult[4] action queue
                delete LC10_SiegeCatapult[4]
                SiegeStucked = 1
            end if
        end if
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 7
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get random abode of type GATEHOUSE in town NearestSettlement
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon LC10_SiegeCatapult[4] action queue
                    Target = marker at get target from {LC10_SiegeCatapult[4]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC10_SiegeCatapult[4] action queue
                else
                    GateHouse = get HOUSE GATEHOUSE at {LC10_SiegeCatapult[4]} radius 750
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon LC10_SiegeCatapult[4] action queue
                        Target = marker at get target from {LC10_SiegeCatapult[4]} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC10_SiegeCatapult[4] action queue
                    else
                        ActionTimer = create timer for 2 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {NearestSettlement} radius 400
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC10_SiegeCatapult[4] action queue
                    Target = marker at get target from {LC10_SiegeCatapult[4]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC10_SiegeCatapult[4] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            elsif NumPat1 == 4 or NumPat1 == 5
                House = get building ALTAR in NearestSettlement min built 0.75
                if House exists and PLAYER of House == 0 and LC10_SiegeCatapult[4] can navigate to object oTownCentre
                    clear siege weapon LC10_SiegeCatapult[4] action queue
                    Target = marker at get target from {LC10_SiegeCatapult[4]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC10_SiegeCatapult[4] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            elsif NumPat1 == 6
                House = get building STORAGE_YARD in NearestSettlement min built 0.75
                if House exists and PLAYER of House == 0 and LC10_SiegeCatapult[4] can navigate to object oTownCentre
                    clear siege weapon LC10_SiegeCatapult[4] action queue
                    Target = marker at get target from {LC10_SiegeCatapult[4]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC10_SiegeCatapult[4] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            else
                House = get building TEMPLE in NearestSettlement min built 0.75
                if House exists and PLAYER of House == 0 and LC10_SiegeCatapult[4] can navigate to object oTownCentre
                    clear siege weapon LC10_SiegeCatapult[4] action queue
                    Target = marker at get target from {LC10_SiegeCatapult[4]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC10_SiegeCatapult[4] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            end if
        end if
        until LC10_SiegeCatapult[4] not exists
    end loop
    
end loop

end script LC10_SiegeCatapult4Actions

begin script LC10_SiegeCatapult5Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = 5
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 3
    SiegeAttacking = 0
    SiegeStucked = 0
    wait until LC10_SiegeCatapult[5] exists
    wait 15 seconds

    clear siege weapon LC10_SiegeCatapult[5] action queue

    begin loop
        if get SiegeOnPointTimer time remaining <= 0
            SiegeWeaponPoint = marker at {LC10_SiegeCatapult[5]}
            SiegeOnPointTimer = create timer for 160 seconds
        elsif get SiegeOnPointTimer time remaining <= 5 and not {LC10_SiegeCatapult[5]} near {NearestSettlement} radius 400
            if {LC10_SiegeCatapult[5]} near {SiegeWeaponPoint} radius 10
                clear siege weapon LC10_SiegeCatapult[5] action queue
                delete LC10_SiegeCatapult[5]
                SiegeStucked = 1
            end if
        end if
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 7
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get random abode of type GATEHOUSE in town NearestSettlement
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon LC10_SiegeCatapult[5] action queue
                    Target = marker at get target from {LC10_SiegeCatapult[5]} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC10_SiegeCatapult[5] action queue
                else
                    GateHouse = get HOUSE GATEHOUSE at {LC10_SiegeCatapult[5]} radius 750
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon LC10_SiegeCatapult[5] action queue
                        Target = marker at get target from {LC10_SiegeCatapult[5]} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon LC10_SiegeCatapult[5] action queue
                    else
                        ActionTimer = create timer for 2 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {NearestSettlement} radius 400
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC10_SiegeCatapult[5] action queue
                    Target = marker at get target from {LC10_SiegeCatapult[5]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC10_SiegeCatapult[5] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            elsif NumPat1 == 4 or NumPat1 == 5
                House = get building ALTAR in NearestSettlement min built 0.75
                if House exists and PLAYER of House == 0 and LC10_SiegeCatapult[5] can navigate to object oTownCentre
                    clear siege weapon LC10_SiegeCatapult[5] action queue
                    Target = marker at get target from {LC10_SiegeCatapult[5]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC10_SiegeCatapult[5] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            elsif NumPat1 == 6
                House = get building STORAGE_YARD in NearestSettlement min built 0.75
                if House exists and PLAYER of House == 0 and LC10_SiegeCatapult[5] can navigate to object oTownCentre
                    clear siege weapon LC10_SiegeCatapult[5] action queue
                    Target = marker at get target from {LC10_SiegeCatapult[5]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC10_SiegeCatapult[5] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            else
                House = get building TEMPLE in NearestSettlement min built 0.75
                if House exists and PLAYER of House == 0 and LC10_SiegeCatapult[5] can navigate to object oTownCentre
                    clear siege weapon LC10_SiegeCatapult[5] action queue
                    Target = marker at get target from {LC10_SiegeCatapult[5]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC10_SiegeCatapult[5] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            end if
        end if
        until LC10_SiegeCatapult[5] not exists
    end loop
    
end loop

end script LC10_SiegeCatapult5Actions

begin script LC10_Platoon28Actions

    oCreature = get player 0 creature
    HeTeste3 = 0
    TestCreature2 = 0
    NumPat = 0
    NumPat5 = 0
    PlayerPlatoon1 = 0
    WorrNum = 0
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in oTown min built 1.0
    ProPlatoonsLocation = 0
    AIPlatoon1 = 0
    Armory = 0
    Town8 = get town with id 8
    RandomActionP3 = 0
    a = 1
    Timer = create timer for 0 seconds
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    oWall = 0
    PlayerCatapult1 = 0
    PlayerPlatoonInRange = 0
    FirstSiege = 1
    Number = 0
    NumPat1 = 0
    PlayerSettlement = 0
    PlayerCreature = 0
    AttackMode = 0
    Building = 0
    RecalculateTimer = create timer for 0 seconds
    
start

begin loop
    a = 1
    wait until LC10_SiegeCatapult[6] exists and LC10_Platoon[28] exists
    disable platoon LC10_Platoon[28] camp
    begin loop
        TestCreature2 = get distance from {LC10_Platoon[28]} to {oCreature}
        if TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC10_Platoon[28] can navigate to {oCreature}
            clear LC10_Platoon[28] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using oCreature to LC10_Platoon[28] action queue
                NumPat5 = get number of villagers in platoon LC10_Platoon[28]
                TestCreature2 = get distance from {LC10_Platoon[28]} to {oCreature}
                until NumPat5 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC10_Platoon[28] can navigate to {oCreature} or TestCreature2 > 150
            end loop
        end if
        PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[28]} radius 150
        PlayerCatapult1 = get siege weapon of player 0 nearest {LC10_Platoon[28]} radius 100
        if PlayerPlatoon1 exists and LC10_Platoon[28] can navigate to {PlayerPlatoon1}
            clear LC10_Platoon[28] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using PlayerPlatoon1 to LC10_Platoon[28] action queue
                NumPat5 = get number of villagers in platoon LC10_Platoon[28]
                HeTeste3 = get number of villagers in platoon PlayerPlatoon1
                until NumPat5 == 0 or HeTeste3 == 0 or not LC10_Platoon[28] can navigate to {PlayerPlatoon1}
            end loop
        elsif PlayerCatapult1 exists and LC10_Platoon[28] can navigate to {PlayerCatapult1}
            clear LC10_Platoon[28] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using PlayerCatapult1 to LC10_Platoon[28] action queue
                NumPat5 = get number of villagers in platoon LC10_Platoon[28]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[28]} radius 150
                if PlayerPlatoon1 exists and LC10_Platoon[28] can navigate to {PlayerPlatoon1}
                    PlayerPlatoonInRange = 1
                end if
                until NumPat5 == 0 or PlayerCatapult1 not exists or not LC10_Platoon[28] can navigate to {PlayerCatapult1} or PlayerPlatoonInRange == 1
            end loop
            PlayerPlatoonInRange = 0
        end if
        PlayerSettlement = get nearest town at {LC10_Platoon[28]} for player 0 radius 500
        //Not a Armory, it's a towncentre.
        Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
        if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0
            if LC10_Platoon[28] can navigate to object Armory
                clear LC10_Platoon[28] action queue
                set LC10_Platoon[28] attack PlayerSettlement with severity 0.3 for takeover
                a = 1
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[28]} radius 75
                    PlayerCreature = get distance from {LC10_Platoon[28]} to {oCreature}
                    if PlayerPlatoon1 exists
                        a = 0
                    elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                        a = 0
                    elsif not LC10_Platoon[28] can navigate to object Armory
                        a = 0
                    elsif LC10_Platoon[28] not exists
                        a = 0
                    end if
                    until a == 0 or LC10_Platoon[28] not exists or PLAYER of PlayerSettlement == 1
                end loop
                clear LC10_Platoon[28] action queue
            end if
        end if
        if LC10_SiegeCatapult[6] exists
            clear LC10_Platoon[28] action queue
            add action PLATOON_AGENDA_ACTION_DEFEND_OBJECT using LC10_SiegeCatapult[6] to LC10_Platoon[28] action queue
            begin loop
                TestCreature2 = get distance from {LC10_Platoon[28]} to {oCreature}
                PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[28]} radius 150
                PlayerSettlement = get nearest town at {LC10_Platoon[28]} for player 0 radius 500
                Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
                if Armory exists //Armory needs to exist, else game will crash
                    if PlayerSettlement == PlayerTown or not LC10_Platoon[28] can navigate to object Armory
                        PlayerSettlement = 0
                    end if
                end if
                until TestCreature2 <= 150 or PlayerPlatoon1 exists or LC10_Platoon[28] not exists or PlayerSettlement exists
            end loop
        end if
        until LC10_SiegeCatapult6IsAttacking == 1 or LC10_SiegeCatapult[6] not exists or LC10_Platoon[28] not exists
    end loop
    
    if LC10_SiegeCatapult[6] exists
        begin loop //Attack
            TestCreature2 = get distance from {LC10_Platoon[28]} to {oCreature}
            if TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC10_Platoon[28] can navigate to {oCreature}
                clear LC10_Platoon[28] action queue
                begin loop
                    add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using oCreature to LC10_Platoon[28] action queue
                    NumPat5 = get number of villagers in platoon LC10_Platoon[28]
                    TestCreature2 = get distance from {LC10_Platoon[28]} to {oCreature}
                    until NumPat5 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC10_Platoon[28] can navigate to {oCreature} or TestCreature2 > 150
                end loop
            end if
            PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[28]} radius 150
            PlayerCatapult1 = get siege weapon of player 0 nearest {LC10_Platoon[28]} radius 100
            if PlayerPlatoon1 exists and LC10_Platoon[28] can navigate to {PlayerPlatoon1}
                clear LC10_Platoon[28] action queue
                begin loop
                    add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using PlayerPlatoon1 to LC10_Platoon[28] action queue
                    NumPat5 = get number of villagers in platoon LC10_Platoon[28]
                    HeTeste3 = get number of villagers in platoon PlayerPlatoon1
                    until NumPat5 == 0 or HeTeste3 == 0 or not LC10_Platoon[28] can navigate to {PlayerPlatoon1}
                end loop
            elsif PlayerCatapult1 exists and LC10_Platoon[28] can navigate to {PlayerCatapult1}
                clear LC10_Platoon[28] action queue
                begin loop
                    add action PLATOON_AGENDA_ACTION_RANGED_ATTACK_MAINTAINING_DISTANCE using PlayerCatapult1 to LC10_Platoon[28] action queue
                    NumPat5 = get number of villagers in platoon LC10_Platoon[28]
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[28]} radius 150
                    if PlayerPlatoon1 exists and LC10_Platoon[28] can navigate to {PlayerPlatoon1}
                        PlayerPlatoonInRange = 1
                    end if
                    until NumPat5 == 0 or PlayerCatapult1 not exists or not LC10_Platoon[28] can navigate to {PlayerCatapult1} or PlayerPlatoonInRange == 1
                end loop
                PlayerPlatoonInRange = 0
            end if
            PlayerSettlement = get nearest town at {LC10_Platoon[28]} for player 0 radius 500
            //Not a Armory, it's a towncentre.
            Armory = get building ABODE_NUMBER_TOWN_CENTRE in PlayerSettlement min built 1.0
            if Armory exists and PlayerSettlement != PlayerTown and PLAYER of PlayerSettlement == 0
                if LC10_Platoon[28] can navigate to object Armory
                    clear LC10_Platoon[28] action queue
                    set LC10_Platoon[28] attack PlayerSettlement with severity 0.3 for takeover
                    a = 1
                    begin loop
                        PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[28]} radius 75
                        PlayerCreature = get distance from {LC10_Platoon[28]} to {oCreature}
                        if PlayerPlatoon1 exists
                            a = 0
                        elsif PlayerCreature <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                            a = 0
                        elsif not LC10_Platoon[28] can navigate to object Armory
                            a = 0
                        elsif LC10_Platoon[28] not exists
                            a = 0
                        end if
                        until a == 0 or LC10_Platoon[28] not exists or PLAYER of PlayerSettlement == 1
                    end loop
                    clear LC10_Platoon[28] action queue
                end if
            end if
            if LC10_Platoon[28] can navigate to object oTownCentre and PLAYER of PlayerTown == 0
                //wait number from 5 to 25 seconds
                a = 1
                clear LC10_Platoon[28] action queue
                Number = number from 1 to 4
                if Number == 2 and HEALTH of MyCreature > 0 //Hunt down platoons or destroy buildings
                    AttackMode = 1
                    set LC10_Platoon[28] attack PlayerTown with severity 0.2
                elsif Number == 3 or Number == 4 //Destroy value buildings
                    AttackMode = 2
                    Building = 0
                    Timer = create timer for 2 seconds
                    begin loop
                        Number = number from 1 to 8
                        if Number == 1 or Number == 2 or Number == 3
                            Building = get building ALTAR in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[28] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 4
                            Building = get building TEMPLE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[28] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 5
                            Building = get building CREATURE_PEN in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[28] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 6
                            Building = get building UNIVERSITY in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[28] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 7
                            Building = get building BATHHOUSE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[28] action queue
                            else
                                Building = 0
                            end if
                        elsif Number == 8
                            Building = get building AMPITHEATRE in PlayerTown min built 0.75
                            if Building exists
                                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using Building to LC10_Platoon[28] action queue
                            else
                                Building = 0
                            end if
                        end if
                        until Building != 0 or get Timer time remaining <= 0
                    end loop
                else //Capture Town
                    AttackMode = 0
                    set LC10_Platoon[28] attack PlayerTown with severity 0.3 for takeover
                end if
                RecalculateTimer = create timer for 40 seconds
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[28]} radius 150
                    TestCreature2 = get distance from {LC10_Platoon[28]} to {MyCreature}
                    NumPat1 = get number of villagers in platoon LC10_Platoon[28]
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC10_Platoon[28] can navigate to object PlayerTownCentre
                        if PlayerPlatoon1 exists and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of MyCreature > 0.00 and not town PlayerTown is under takeover from player 1
                            a = 0
                        elsif not LC10_Platoon[28] can navigate to object oTownCentre
                            a = 0
                        elsif LC10_Platoon[28] not exists
                            a = 0
                        elsif AttackMode == 1 and HEALTH of MyCreature == 0
                            a = 0
                        elsif AttackMode == 2 and Building not exists
                            a = 0
                        elsif AttackMode == 2 and HEALTH of Building < 0.1
                            a = 0
                        elsif AttackMode == 2 and Building == 0
                            a = 0
                        elsif not town PlayerTown is under takeover from player 1 and get RecalculateTimer time remaining <= 0
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC10_Platoon[28] not exists
                end loop
                clear LC10_Platoon[28] action queue
            elsif LC10_Platoon[28] can navigate to {AttackPos[0]} + {20,0,20}
                clear LC10_Platoon[28] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[0]} + {20,0,20} to LC10_Platoon[28] action queue
            else
                clear LC10_Platoon[28] action queue
                add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AttackPos[1]} + {20,0,20} to LC10_Platoon[28] action queue
            end if
            until LC10_Platoon[28] not exists
        end loop
    else
        add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {SiegePlatoonPos[0]} to LC10_Platoon[28] action queue
    end if
    FirstSiege = 0
end loop

end script LC10_Platoon28Actions

begin script LC10_SiegeCatapult6Actions

    PlayerCreature = 0
    PlayerPlatoon1 = 0
    oCreature = get player 0 creature
    NumPat1 = 0
    HeTeste1 = 0
    WorrNum = 0
    Town0 = get town with id 0
    Town5 = get town with id 5
    oTown = get town with id 0
    oTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in Town0 min built 1.0
    Armory = get building ABODE_NUMBER_MELEE_ARMOURY in Town5 min built 1.0
    ArmoryRanged = get building ABODE_NUMBER_RANGED_ARMOURY in Town5 min built 1.0
    Player1Town = 0
    a = 1
    AISiege = 0    
    WaypointMain[7]
    WaypointRouteMain = 0
    Counter = 0
    Town8 = get town with id 8
    Catapult = 0
    AttackingTown = 2
    NumPat5 = 0
    h = 1
    Player0Town0 = 0
    Timer = create timer for 0 seconds
    oWall = 0
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    AIPlatoon = 0
    Target = 0
    PointOn = 0
    CatapultMoveTimer1 = 5
    AttackTimer = 0
    ActionTimer = create timer for 0 seconds
    Wall1 = 0
    Wall2 = 0
    House = 0
    SiegeOnPointTimer = create timer for 0 seconds
    SiegeWeaponPoint = 0
    SiegeStucked = 0
    GateHouse = 0
    SiegeAttacking = 0
    AttackTownTimer = create timer for 0 seconds
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    PointOn = 0
    SiegeAttacking = 0
    SiegeStucked = 0
    LC10_SiegeCatapult6IsAttacking = 0
    wait until LC10_SiegeCatapult[6] exists and LC10_Platoon[28] exists
    wait 2 seconds
    begin loop
        PlayerCreature = get distance from {LC10_SiegeCatapult[6]} to {oCreature}
        PlayerPlatoon1 = get platoon of player 0 nearest {LC10_SiegeCatapult[6]} radius 150
        Catapult = get siege weapon of player 0 nearest {LC10_SiegeCatapult[6]} radius 150
        
        if PlayerCreature > 10 and PlayerPlatoon1 not exists and Catapult not exists
            if PlayerPlatoon1 not exists
                a = 1
            elsif PlayerCreature > 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                a = 1
            elsif Catapult not exists
                a = 1
            end if
        end if
        
        if PlayerCreature <= 10 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
            clear siege weapon LC10_SiegeCatapult[6] action queue
            a = 0
        elsif PlayerPlatoon1 exists and LC10_SiegeCatapult[6] can navigate to {PlayerPlatoon1}
            clear siege weapon LC10_SiegeCatapult[6] action queue
            a = 0
        elsif Catapult exists and LC10_SiegeCatapult[6] can navigate to {Catapult}
            clear siege weapon LC10_SiegeCatapult[6] action queue
            a = 0
        elsif PointOn != 3 and a == 1
            begin loop
                if LC10_SiegeCatapult[6] exists 
                    if get SiegeOnPointTimer time remaining <= 0
                        SiegeWeaponPoint = marker at {LC10_SiegeCatapult[6]}
                        SiegeOnPointTimer = create timer for 160 seconds
                    elsif get SiegeOnPointTimer time remaining <= 5
                        if {LC10_SiegeCatapult[6]} near {SiegeWeaponPoint} radius 10
                            clear siege weapon LC10_SiegeCatapult[6] action queue
                            delete LC10_SiegeCatapult[6]
                            SiegeStucked = 1
                        end if
                    end if
                    if get CatapultMoveTimer1 time remaining <= 0
                        if get size of LC10_SiegeCatapult[6] action queue < 1

                            if PointOn == 0
                                if LC10_SiegeCatapult[6] can navigate to {SiegeRoute5[0]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute5[0]} to siege weapon LC10_SiegeCatapult[6] action queue
                                end if
                    
                            elsif PointOn == 1
                                if LC10_SiegeCatapult[6] can navigate to {SiegeRoute5[1]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute5[1]} to siege weapon LC10_SiegeCatapult[6] action queue
                                end if

                            elsif PointOn == 2
                                if LC10_SiegeCatapult[6] can navigate to {SiegeRoute5[2]}
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute5[2]} to siege weapon LC10_SiegeCatapult[6] action queue
                                else
                                    add action SIEGEWEAPON_AGENDA_ACTION_MOVE_TO_POS using {SiegeRoute5[1]} to siege weapon LC10_SiegeCatapult[6] action queue
                                end if

                            CatapultMoveTimer1 = create timer for 10 seconds
                            
                            end if
                        end if
                    end if        

                    if {LC10_SiegeCatapult[6]} near {SiegeRoute5[0]} radius 15 and PointOn != 1 or 60 seconds
                        PointOn = 1
                    elsif {LC10_SiegeCatapult[6]} near {SiegeRoute5[1]} radius 15 and PointOn != 2 or 60 seconds
                        PointOn = 2
                    elsif {LC10_SiegeCatapult[6]} near {SiegeRoute5[2]} radius 15 and PointOn != 3 or 60 seconds
                        PointOn = 3
                    elsif not LC10_SiegeCatapult[6] can navigate to {SiegeRoute5[2]} and {LC10_SiegeCatapult[6]} near {SiegeRoute5[1]} radius 15 and PointOn != 3
                        PointOn = 3
                    end if
                end if
            until LC10_SiegeCatapult[6] not exists or PointOn == 3 or 180 seconds
            end loop
        end if
        
        until PointOn == 3 or LC10_SiegeCatapult[6] not exists or 180 seconds
    end loop
    
    LC10_SiegeCatapult6IsAttacking = 1
    
    wait 5 seconds

    enable siege weapon LC10_SiegeCatapult[6] auto attack

    begin loop
        if get ActionTimer time remaining <= 0
            ActionTimer = create timer for 60 seconds
            NumPat1 = number from 1 to 5
            if NumPat1 == 1 or NumPat1 == 2
                GateHouse = get HOUSE GATEHOUSE at {SiegeWeapon} radius 250
                if GateHouse exists and PLAYER of GateHouse == 0
                    clear siege weapon SiegeWeapon action queue
                    Target = marker at get target from {SiegeWeapon} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon SiegeWeapon action queue
                elsif GateHouse not exists
                    GateHouse = get HOUSE GATEHOUSE at {SiegeWeapon} radius 750
                    clear siege weapon SiegeWeapon action queue
                    Target = marker at get target from {SiegeWeapon} to {GateHouse} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon SiegeWeapon action queue
                else
                    GateHouse = get random abode of type GATEHOUSE in town PlayerTown
                    if GateHouse exists and PLAYER of GateHouse == 0
                        clear siege weapon SiegeWeapon action queue
                        Target = marker at get target from {SiegeWeapon} to {GateHouse} distance 10 angle 180
                        add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using GateHouse to siege weapon SiegeWeapon action queue
                    else
                        ActionTimer = create timer for 2 seconds
                    end if
                end if
            elsif NumPat1 == 3
                Wall1 = get wall segment nearest {LC10_SiegeCatapult[6]} radius 750
                if Wall1 exists and PLAYER of Wall1 == 0
                    clear siege weapon LC10_SiegeCatapult[6] action queue
                    Target = marker at get target from {LC10_SiegeCatapult[6]} to {Wall1} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using Wall1 to siege weapon LC10_SiegeCatapult[6] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            else
                House = get building ALTAR in PlayerTown min built 0.75
                if House exists and PLAYER of House == 0 and LC10_SiegeCatapult[6] can navigate to object oTownCentre
                    clear siege weapon LC10_SiegeCatapult[6] action queue
                    Target = marker at get target from {LC10_SiegeCatapult[6]} to {House} distance 10 angle 180
                    add action SIEGEWEAPON_AGENDA_ACTION_ATTACK_THING using House to siege weapon LC10_SiegeCatapult[6] action queue
                else
                    ActionTimer = create timer for 2 seconds
                end if
            end if
        end if

        until LC10_SiegeCatapult[6] not exists
    end loop
    
    if SiegeAttacking == 1 and UnderAttack != 0
        UnderAttack = UnderAttack - 1
    end if
    
end loop

end script LC10_SiegeCatapult6Actions

begin script LC10_Platoon14Actions

    oCreature = get player 0 creature
    HeTeste3 = 0
    TestCreature2 = 0
    NumPat = 0
    NumPat5 = 0
    PlayerPlatoon1 = 0
    WorrNum = 0
    AztecTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in AztecTown1 min built 1.0
    ProPlatoonsLocation = 0
    AIPlatoon1 = 0
    Armory = 0
    Town8 = get town with id 8
    RandomActionP3 = 0
    a = 1
    Timer = create timer for 0 seconds
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    oWall = 0
    PlayerCatapult1 = 0
    PlayerPlatoonInRange = 0
    TownCaptured = 0
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    wait until LC10_Platoon[14] exists
    
    begin loop //Attack
        TestCreature2 = get distance from {LC10_Platoon[14]} to {oCreature}
        if TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC10_Platoon[14] can navigate to {oCreature}
            clear LC10_Platoon[14] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC10_Platoon[14] action queue
                NumPat5 = get number of villagers in platoon LC10_Platoon[14]
                TestCreature2 = get distance from {LC10_Platoon[14]} to {oCreature}
                until NumPat5 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC10_Platoon[14] can navigate to {oCreature} or TestCreature2 > 150
            end loop
        end if

        PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[14]} radius 150
        PlayerCatapult1 = get siege weapon of player 0 nearest {LC10_Platoon[14]} radius 150
        if PlayerPlatoon1 exists and LC10_Platoon[14] can navigate to {PlayerPlatoon1}
            clear LC10_Platoon[14] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC10_Platoon[14] action queue
                NumPat5 = get number of villagers in platoon LC10_Platoon[14]
                HeTeste3 = get number of villagers in platoon PlayerPlatoon1
                until NumPat5 == 0 or HeTeste3 == 0 or not LC10_Platoon[14] can navigate to {PlayerPlatoon1}
            end loop
        elsif PlayerCatapult1 exists and LC10_Platoon[14] can navigate to {PlayerCatapult1}
            clear LC10_Platoon[14] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using PlayerCatapult1 to LC10_Platoon[14] action queue
                NumPat5 = get number of villagers in platoon LC10_Platoon[14]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[14]} radius 150
                if PlayerPlatoon1 exists and LC10_Platoon[14] can navigate to {PlayerPlatoon1}
                    PlayerPlatoonInRange = 1
                end if
                until NumPat5 == 0 or PlayerCatapult1 not exists or not LC10_Platoon[14] can navigate to {PlayerCatapult1} or PlayerPlatoonInRange == 1
            end loop
            PlayerPlatoonInRange = 0
        end if

        AztecTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in AztecTown1 min built 1.0
        if LC10_Platoon[14] can navigate to object AztecTownCentre and PLAYER of AztecTown1 != 1 and TownCaptured == 0
            //wait number from 5 to 25 seconds
            a = 1
            clear LC10_Platoon[14] action queue
            wait 1 seconds
            if LC10_Platoon[14] can navigate to object AztecTownCentre and PLAYER of AztecTown1 != 1 and TownCaptured == 0
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[14]} radius 150
                    TestCreature2 = get distance from {LC10_Platoon[14]} to {oCreature}
                    set LC10_Platoon[14] attack AztecTown1 with severity 0.7 for takeover
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC10_Platoon[14] can navigate to object AztecTownCentre
                        if PlayerPlatoon1 exists
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                            a = 0
                        elsif not LC10_Platoon[14] can navigate to object AztecTownCentre
                            a = 0
                        elsif LC10_Platoon[14] not exists
                            a = 0
                        elsif PLAYER of AztecTown1 == 1
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC10_Platoon[14] not exists or PLAYER of AztecTown1 == 1
                end loop
            end if
            clear LC10_Platoon[14] action queue
        elsif LC10_Platoon[14] can navigate to {AztecTown1} + {20,0,20} and PLAYER of AztecTown1 == 1 and not {LC10_Platoon[14]} near {AztecTown1} + {20,0,20} radius 15
            TownCaptured = 1
            clear LC10_Platoon[14] action queue
            add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AztecTown1} + {20,0,20} to LC10_Platoon[14] action queue
        end if

        until LC10_Platoon[14] not exists
    end loop
end loop

end script LC10_Platoon14Actions

begin script LC10_Platoon15Actions

    oCreature = get player 0 creature
    HeTeste3 = 0
    TestCreature2 = 0
    NumPat = 0
    NumPat5 = 0
    PlayerPlatoon1 = 0
    WorrNum = 0
    AztecTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in AztecTown2 min built 1.0
    ProPlatoonsLocation = 0
    AIPlatoon1 = 0
    Armory = 0
    Town8 = get town with id 8
    RandomActionP3 = 0
    a = 1
    Timer = create timer for 0 seconds
    GreekGateHouse1 = 0
    GreekGateHouse2 = 0
    oWall = 0
    PlayerCatapult1 = 0
    PlayerPlatoonInRange = 0
    TownCaptured = 0
    PlayerSettlement = 0
    
start

begin loop
    a = 1
    wait until LC10_Platoon[15] exists
    
    begin loop //Attack
        TestCreature2 = get distance from {LC10_Platoon[15]} to {oCreature}
        if TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00 and LC10_Platoon[15] can navigate to {oCreature}
            clear LC10_Platoon[15] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_MOVING_OBJECT using oCreature to LC10_Platoon[15] action queue
                NumPat5 = get number of villagers in platoon LC10_Platoon[15]
                TestCreature2 = get distance from {LC10_Platoon[15]} to {oCreature}
                until NumPat5 == 0 or SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature == 0.00 or not LC10_Platoon[15] can navigate to {oCreature} or TestCreature2 > 150
            end loop
        end if

        PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[15]} radius 150
        PlayerCatapult1 = get siege weapon of player 0 nearest {LC10_Platoon[15]} radius 150
        if PlayerPlatoon1 exists and LC10_Platoon[15] can navigate to {PlayerPlatoon1}
            clear LC10_Platoon[15] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_PLATOON using PlayerPlatoon1 to LC10_Platoon[15] action queue
                NumPat5 = get number of villagers in platoon LC10_Platoon[15]
                HeTeste3 = get number of villagers in platoon PlayerPlatoon1
                until NumPat5 == 0 or HeTeste3 == 0 or not LC10_Platoon[15] can navigate to {PlayerPlatoon1}
            end loop
        elsif PlayerCatapult1 exists and LC10_Platoon[15] can navigate to {PlayerCatapult1}
            clear LC10_Platoon[15] action queue
            begin loop
                add action PLATOON_AGENDA_ACTION_MELEE_ATTACK_THING using PlayerCatapult1 to LC10_Platoon[15] action queue
                NumPat5 = get number of villagers in platoon LC10_Platoon[15]
                PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[15]} radius 150
                if PlayerPlatoon1 exists and LC10_Platoon[15] can navigate to {PlayerPlatoon1}
                    PlayerPlatoonInRange = 1
                end if
                until NumPat5 == 0 or PlayerCatapult1 not exists or not LC10_Platoon[15] can navigate to {PlayerCatapult1} or PlayerPlatoonInRange == 1
            end loop
            PlayerPlatoonInRange = 0
        end if

        AztecTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in AztecTown2 min built 1.0
        if LC10_Platoon[15] can navigate to object AztecTownCentre and PLAYER of AztecTown2 != 1 and TownCaptured == 0
            //wait number from 5 to 25 seconds
            a = 1
            clear LC10_Platoon[15] action queue
            wait 1 seconds
            if LC10_Platoon[15] can navigate to object AztecTownCentre and PLAYER of AztecTown2 != 1 and TownCaptured == 0
                begin loop
                    PlayerPlatoon1 = get platoon of player 0 nearest {LC10_Platoon[15]} radius 150
                    TestCreature2 = get distance from {LC10_Platoon[15]} to {oCreature}
                    set LC10_Platoon[15] attack AztecTown2 with severity 0.7 for takeover
                    //if PlayerPlatoon1 exists or TestCreature2 <= 150 or not LC10_Platoon[15] can navigate to object AztecTownCentre
                        if PlayerPlatoon1 exists
                            a = 0
                        elsif TestCreature2 <= 150 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                            a = 0
                        elsif not LC10_Platoon[15] can navigate to object AztecTownCentre
                            a = 0
                        elsif LC10_Platoon[15] not exists
                            a = 0
                        elsif PLAYER of AztecTown2 == 1
                            a = 0
                        end if
                    //end if
                    until a == 0 or LC10_Platoon[15] not exists or PLAYER of AztecTown2 == 1
                end loop
            end if
            clear LC10_Platoon[15] action queue
        elsif LC10_Platoon[15] can navigate to {AztecTown2} + {-20,0,-20} and PLAYER of AztecTown2 == 1 and not {LC10_Platoon[15]} near {AztecTown2} + {-20,0,-20} radius 15
            TownCaptured = 1
            clear LC10_Platoon[15] action queue
            add action PLATOON_AGENDA_ACTION_MOVE_TO_POS_AGGRESSIVE using {AztecTown2} + {-20,0,-20} to LC10_Platoon[15] action queue
        end if

        until LC10_Platoon[15] not exists
    end loop
end loop

end script LC10_Platoon15Actions