///////////////////////////////////////////////////////////////////////////////
//    Land 10 Aztec-Strategy
//    ~~~~~~~~~~~~~~~~~~~~~~~~~~~
//
//    Start date:    29.03.18            By: Boxhead
//    Update date:    04.04.18            By: Boxhead
///////////////////////////////////////////////////////////////////////////////

define script LC10_Aztec_Capital_Impressiveness
define script LC10_TownConversion
define script LC10_Tribute
define script LC10_GatehouseManager
define script LC10_Speeches
define script LC10_Aztec_Capital
define script LC10_DefendPlatoons
define script LC10_SirenResourceManager
define script LC10_AztecCapitalRessourceManager
define script LC10_AztecCapitalVillagerManager
define script LC10_AztecTown1RessourceManager
define script LC10_AztecTown1VillagerManager
define script LC10_AztecTown2RessourceManager
define script LC10_AztecTown2VillagerManager
define script PrisonCondition
define script LC10_GetNearestSettlement
define script LC10_AttackNearestTownTimer
define script DisableLocalPlatoonResponse

begin script LC10_Aztec_Capital_Impressiveness

    Threshold = 0

start

    Threshold = get town MinorTown1 impressiveness
    Threshold = Threshold / 3
    set migration threshold from MinorTown1 to PlayerTown MINOR_TOWN1_IMPRESSIVENESS - Threshold

    Threshold = get town AztecTown1 impressiveness
    Threshold = Threshold / 3
    set migration threshold from AztecTown1 to PlayerTown AZTEC_TOWN1_IMPRESSIVENESS - Threshold

    Threshold = get town AztecTown2 impressiveness
    Threshold = Threshold / 3
    set migration threshold from AztecTown2 to PlayerTown AZTEC_TOWN2_IMPRESSIVENESS - Threshold

    Threshold = get town AztecCapital impressiveness
    Threshold = Threshold / 3
    set migration threshold from AztecCapital to PlayerTown AZTEC_CAPITAL_IMPRESSIVENESS - Threshold

    if PLAYER of MinorTown1 == 0
        enable migration from AztecTown1 to MinorTown1
        enable migration from AztecTown2 to MinorTown1
        enable migration from AztecCapital to MinorTown1
        
    elsif PLAYER of MinorTown1 >= 1
        disable migration from AztecTown1 to MinorTown1
        disable migration from AztecTown2 to MinorTown1
        disable migration from AztecCapital to MinorTown1
    end if

    if PLAYER of AztecTown1 == 0
        enable migration from MinorTown1 to AztecTown1
        enable migration from AztecTown2 to AztecTown1
        enable migration from AztecCapital to AztecTown1
        
    elsif PLAYER of AztecTown1 >= 1
        disable migration from MinorTown1 to AztecTown1
        disable migration from AztecTown2 to AztecTown1
        disable migration from AztecCapital to AztecTown1
    end if

    if PLAYER of AztecTown2 == 0
        enable migration from MinorTown1 to AztecTown2
        enable migration from AztecTown1 to AztecTown2
        enable migration from AztecCapital to AztecTown2
        
    elsif PLAYER of AztecTown2 >= 1
        disable migration from MinorTown1 to AztecTown2
        disable migration from AztecTown1 to AztecTown2
        disable migration from AztecCapital to AztecTown2
    end if

    if PLAYER of AztecCapital == 0
        enable migration from MinorTown1 to AztecCapital
        enable migration from AztecTown1 to AztecCapital
        enable migration from AztecTown2 to AztecCapital
        
    elsif PLAYER of AztecCapital >= 1
        disable migration from MinorTown1 to AztecCapital
        disable migration from AztecTown1 to AztecCapital
        disable migration from AztecTown2 to AztecCapital
    end if

end script LC10_Aztec_Capital_Impressiveness

begin script LC10_TownConversion

    isConverted1 = 0
    isConverted2 = 0
    isConverted3 = 0
    isConverted4 = 0
    a = 0
    b = 0
    c = 0
    d = 0
    
start

begin loop

    isConverted1 = variable get town MinorTown1 method of last conversion
    isConverted2 = variable get town AztecTown1 method of last conversion
    isConverted3 = variable get town AztecTown2 method of last conversion
    isConverted4 = variable get town AztecCapital method of last conversion

    if isConverted1 != 0 and a == 0
        if PLAYER of MinorTown1 == 0 or get town MinorTown1 is migrating to == PlayerTown
            a = 1
            TownsConverted = TownsConverted + 1
            if isConverted1 == 1
                TownsAggressiveConverted = TownsAggressiveConverted + 1
            elsif isConverted1 == 2
                TownsPeacefulConverted = TownsPeacefulConverted + 1
            end if
        end if
    end if

    if isConverted1 != 0
        if PLAYER of AztecCapital == 1
            disable migration from MinorTown1 to AztecTown1
            disable migration from MinorTown1 to AztecTown2
            disable migration from MinorTown1 to AztecCapital
            disable migration from MinorTown1 to PlayerTown
        else
            enable migration from MinorTown1 to AztecTown1
            enable migration from MinorTown1 to AztecTown2
            enable migration from MinorTown1 to AztecCapital
            enable migration from MinorTown1 to PlayerTown
        end if
    end if
    
    if isConverted2 != 0 and b == 0
        if PLAYER of AztecTown1 == 0 or get town AztecTown1 is migrating to == PlayerTown
            b = 1
            TownsConverted = TownsConverted + 1
            if isConverted2 == 1
                TownsAggressiveConverted = TownsAggressiveConverted + 1
            elsif isConverted2 == 2
                TownsPeacefulConverted = TownsPeacefulConverted + 1
            end if
        end if
    end if
    
    if isConverted2 != 0
        if PLAYER of AztecCapital == 1
            disable migration from AztecTown1 to MinorTown1
            disable migration from AztecTown1 to AztecTown2
            disable migration from AztecTown1 to AztecCapital
            disable migration from AztecTown1 to PlayerTown
        else
            enable migration from AztecTown1 to MinorTown1
            enable migration from AztecTown1 to AztecTown2
            enable migration from AztecTown1 to AztecCapital
            enable migration from AztecTown1 to PlayerTown
        end if
    end if

    if isConverted3 != 0 and c == 0
        if PLAYER of AztecTown2 == 0 or get town AztecTown2 is migrating to == PlayerTown
            c = 1
            TownsConverted = TownsConverted + 1
            if isConverted3 == 1
                TownsAggressiveConverted = TownsAggressiveConverted + 1
            elsif isConverted3 == 2
                TownsPeacefulConverted = TownsPeacefulConverted + 1
            end if
        end if
    end if

    if isConverted3 != 0
        if PLAYER of AztecCapital == 1
            disable migration from AztecTown2 to MinorTown1
            disable migration from AztecTown2 to AztecTown1
            disable migration from AztecTown2 to AztecCapital
            disable migration from AztecTown2 to PlayerTown
        else
            enable migration from AztecTown2 to MinorTown1
            enable migration from AztecTown2 to AztecTown1
            enable migration from AztecTown2 to AztecCapital
            enable migration from AztecTown2 to PlayerTown
        end if
    end if
    
    if isConverted4 != 0 and d == 0
        if PLAYER of AztecCapital == 0 or get town AztecCapital is migrating to == PlayerTown
            d = 1
            TownsConverted = TownsConverted + 1
            if isConverted4 == 1
                TownsAggressiveConverted = TownsAggressiveConverted + 1
            elsif isConverted4 == 2
                TownsPeacefulConverted = TownsPeacefulConverted + 1
            end if
        end if
    end if    
    
    if isConverted4 != 0
        if PLAYER of AztecCapital == 1
            disable migration from AztecCapital to MinorTown1
            disable migration from AztecCapital to AztecTown1
            disable migration from AztecCapital to AztecTown2
            disable migration from AztecCapital to PlayerTown
        else
            enable migration from AztecCapital to MinorTown1
            enable migration from AztecCapital to AztecTown1
            enable migration from AztecCapital to AztecTown2
            enable migration from AztecCapital to PlayerTown
        end if
    end if

end loop

end script LC10_TownConversion

begin script LC10_Tribute

    mig1 = 0
    mig2 = 0
    mig3 = 0
    mig4 = 0
    mig5 = 0
    mig6 = 0
    mig7 = 0
    mig8 = 0
    mig9 = 0
    mig10 = 0
    mig11 = 0
    mig12 = 0
    a = 0

start

begin loop

    if (variable get town MinorTown1 status == variable MIGRATION_MIGRATED) and mig1 == 0 and get town MinorTown1 has migrated to == PlayerTown
        mig1 = 1
        MigrationsAccepted = MigrationsAccepted + 1
    end if

    if (variable get town AztecTown1 status == variable MIGRATION_MIGRATED) and mig2 == 0 and get town AztecTown1 has migrated to == PlayerTown
        mig2 = 1
        MigrationsAccepted = MigrationsAccepted + 1
    end if
    
    if (variable get town AztecTown2 status == variable MIGRATION_MIGRATED) and mig3 == 0 and get town AztecTown2 has migrated to == PlayerTown
        mig3 = 1
        MigrationsAccepted = MigrationsAccepted + 1
    end if
    
    if (variable get town AztecCapital status == variable MIGRATION_MIGRATED) and mig4 == 0 and get town AztecCapital has migrated to == PlayerTown
        mig4 = 1
        MigrationsAccepted = MigrationsAccepted + 1
    end if

    if MigrationsAccepted >= 1 and a == 0
        a = 1
        increment tribute by 15000
    end if
    
    if MigrationsAccepted >= 2 and a == 1
        a = 2
        increment tribute by 20000
    end if
    
    if MigrationsAccepted >= 3 and a == 2
        a = 3
        increment tribute by 20000
    end if
    
    if MigrationsAccepted >= 4 and a == 3
        a = 4
        increment tribute by 25000
    end if
    
end loop

end script LC10_Tribute

begin script LC10_GatehouseManager

    GateHouseT11 = 0
    GateHouseT12 = 0

    Counter = 0
    Cnt = 0

    oCreature = get player 0 creature

    PlayerPlatoonT11 = 0
    CatapultT11 = 0
    TestCreatureT11 = 0
    PlayerPlatoonT12 = 0
    CatapultT12 = 0
    TestCreatureT12 = 0

    EnemyNearDoorT11 = 0
    EnemyNearDoorT12 = 0

start

begin loop

    GateHouseT11 = get SCRIPT_OBJECT_TYPE_ABODE ABODE_NUMBER_GATEHOUSE_F at {1384.29,129.16,2093.11} radius 15
    GateHouseT12 = get SCRIPT_OBJECT_TYPE_ABODE ABODE_NUMBER_GATEHOUSE_F at {1563.97,124.22,2064.95} radius 15
    
    oCreature = get player 0 creature

    if PLAYER of AztecCapital == 1

        if not town AztecCapital is under takeover from player 0
            PlayerPlatoonT11 = get platoon of player 0 nearest {GateHouseT11} radius 100
            CatapultT11 = get siege weapon of player 0 nearest {GateHouseT11} radius 100
            TestCreatureT11 = get distance from {GateHouseT11} to {oCreature}
            
            if PlayerPlatoonT11 exists
                EnemyNearDoorT11 = 1
            elsif CatapultT11 exists
                EnemyNearDoorT11 = 1
            elsif TestCreatureT11 < 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                EnemyNearDoorT11 = 1
            else
                EnemyNearDoorT11 = 0
            end if
            
            if EnemyNearDoorT11 == 1
                set gate GateHouseT11 close
            else
                set gate GateHouseT11 open
            end if


            PlayerPlatoonT12 = get platoon of player 0 nearest {GateHouseT12} radius 100
            CatapultT12 = get siege weapon of player 0 nearest {GateHouseT12} radius 100
            TestCreatureT12 = get distance from {GateHouseT12} to {oCreature}
            
            if PlayerPlatoonT12 exists
                EnemyNearDoorT12 = 1
            elsif CatapultT12 exists
                EnemyNearDoorT12 = 1
            elsif TestCreatureT12 < 200 and SCRIPT_OBJECT_PROPERTY_TYPE_HEALTH of oCreature > 0.00
                EnemyNearDoorT12 = 1
            else
                EnemyNearDoorT12 = 0
            end if
            
            if EnemyNearDoorT12 == 1
                set gate GateHouseT12 close
            else
                set gate GateHouseT12 open
            end if
        else
            set gate GateHouseT11 open
            set gate GateHouseT12 open
        end if

    end if

end loop

end script LC10_GatehouseManager

begin script LC10_Speeches

    LoseDialogue1 = 0
    
    Number = 0
    
    AttackTimer = create timer for 0 seconds
    LoseTimer = create timer for 0 seconds
    
    a = 0
    b = 0
    c = 0
    d = 0
    e = 0
    f = 0
    g = 0
    h = 0
    i = 0
    j = 0
    jj = 0
    k = 0
    l = 0
    m = 0
    n = 0
    o = 0
    p = 0
    q = 0
    r = 0
    s = 0
    t = 0
    w = 0
    v = 0
    astory = 0
    bstory = 0
    
    aa = 0
    ab = 0
    ac = 0
    ad = 0
    ae = 0
    af = 0
    ag = 0
    ah = 0
    ai = 0
    aj = 0
    ak = 0
    al = 0
    am = 0
    
    StoryDialogue = 0
    StoryDialogueTimer = create timer for 200 seconds
    
    EvilDialogue = 0
    GoodDialogue = 0
    
    Platoon = 0
    Catapult = 0

    PlayerPlatoon = 0

    UnderAttackTimer = create timer for 0 seconds

    PrisonCreatureReminder = 0
    PrisonDialogue = 0

    AztecTown1Dialogue = 0
    AztecTown2Dialogue = 0

    VolcanoDangerousTimer = create timer for 0 seconds

start

begin loop

    if VolcanoDangerousActive == 1 and get VolcanoDangerousTimer time remaining <= 0
        GB_DialogueIsRunning = 1
        VolcanoDangerousTimer = create timer for 90 seconds
        Number = number from 1 to 4
        if Number == 1
            begin dialogue
                eject evil spirit
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_EA_06"
                wait until read
                send evil spirit home
            end dialogue
        elsif Number == 2
            begin dialogue
                eject evil spirit
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_EA_17"
                wait until read
                send evil spirit home
            end dialogue
        elsif Number == 3
            begin dialogue
                eject good spirit
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_GA_03"
                wait until read
                send good spirit home
            end dialogue
        else
            begin dialogue
                eject good spirit
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_GA_10"
                wait until read
                send good spirit home
            end dialogue
        end if
        GB_DialogueIsRunning = 0
    end if

    if TownsPeacefulConverted >= 1 and a == 0
        GB_DialogueIsRunning = 1
        a = 1
        begin dialogue
            say "BW2T_SCRIPT_10FINAL_AZTEC_GENERAL_10"
            wait until read
        end dialogue
        GB_DialogueIsRunning = 0
    end if

    if TownsAggressiveConverted >= 1 and d == 0
        GB_DialogueIsRunning = 1
        d = 1
        begin dialogue
            say "BW2T_SCRIPT_10FINAL_AZTEC_GENERAL_90"
            wait until read
        end dialogue
        GB_DialogueIsRunning = 0
    end if

    if TownsConverted >= 2 and b == 0
        GB_DialogueIsRunning = 1
        b = 1
        begin dialogue
            say "BW2T_SCRIPT_10FINAL_AZTEC_GENERAL_30"
            wait until read
        end dialogue
        GB_DialogueIsRunning = 0
    end if

    if TownsConverted >= 3 and b == 0
        GB_DialogueIsRunning = 1
        b = 1
        begin dialogue
            say "BW2T_SCRIPT_10FINAL_AZTEC_GENERAL_50"
            wait until read
        end dialogue
        GB_DialogueIsRunning = 0
    end if

    if get building ABODE_A in AztecCapital min built 1.0 exists and ac == 0 and GB_DialogueIsRunning == 0
        GB_DialogueIsRunning = 1
        ac = 1
        begin dialogue
            say "BW2T_SCRIPT_10FINAL_AZTEC_ABODE"
            wait until read
        end dialogue
        GB_DialogueIsRunning = 0
    end if
    
    if get building ABODE_NUMBER_MELEE_ARMOURY in AztecCapital min built 1.0 exists and aa == 0 and GB_DialogueIsRunning == 0
        GB_DialogueIsRunning = 1
        aa = 1
        begin dialogue
            say "BW2T_SCRIPT_10FINAL_AZTEC_MELEE_BARRACKS_1"
            wait until read
        end dialogue
        GB_DialogueIsRunning = 0
    end if

    if get building ABODE_NUMBER_RANGED_ARMOURY in AztecCapital min built 1.0 exists and ab == 0 and GB_DialogueIsRunning == 0
        GB_DialogueIsRunning = 1
        ab = 1
        begin dialogue
            say "BW2T_SCRIPT_10FINAL_AZTEC_ARCHER_ARMOURY"
            wait until read
        end dialogue
        GB_DialogueIsRunning = 0
    end if
    
    if get building PRISON in AztecCapital min built 1.0 exists and ad == 0 and GB_DialogueIsRunning == 0
        GB_DialogueIsRunning = 1
        ad = 1
        begin dialogue
            say "BW2T_SCRIPT_10FINAL_AZTEC_PRISON_1"
            wait until read
        end dialogue
        GB_DialogueIsRunning = 0
    end if
    
    if get building SMELTER in AztecCapital min built 1.0 exists and ae == 0 and GB_DialogueIsRunning == 0
        GB_DialogueIsRunning = 1
        ae = 1
        begin dialogue
            say "BW2T_SCRIPT_10FINAL_AZTEC_SMELTER_1"
            wait until read
        end dialogue
        GB_DialogueIsRunning = 0
    end if
    
    if get building CRECHE in AztecCapital min built 1.0 exists and af == 0 and GB_DialogueIsRunning == 0
        GB_DialogueIsRunning = 1
        af = 1
        begin dialogue
            say "BW2T_SCRIPT_10FINAL_AZTEC_NURSERY_1"
            wait until read
        end dialogue
        GB_DialogueIsRunning = 0
    end if
    
    if get building STORAGE_YARD in AztecCapital min built 1.0 exists and ag == 0 and GB_DialogueIsRunning == 0
        GB_DialogueIsRunning = 1
        ag = 1
        begin dialogue
            say "BW2T_SCRIPT_10FINAL_AZTEC_STORAGE_PIT_1"
            wait until read
        end dialogue
        GB_DialogueIsRunning = 0
    end if
    
    if get building PUB in AztecCapital min built 1.0 exists and ai == 0 and GB_DialogueIsRunning == 0
        GB_DialogueIsRunning = 1
        ai = 1
        begin dialogue
            say "BW2T_SCRIPT_10FINAL_AZTEC_TAVERN_1"
            wait until read
        end dialogue
        GB_DialogueIsRunning = 0
    end if
    
    if get building WALLTOWER_TECH0 in AztecCapital min built 1.0 exists and aj == 0 and GB_DialogueIsRunning == 0
        GB_DialogueIsRunning = 1
        aj = 1
        begin dialogue
            say "BW2T_SCRIPT_10FINAL_AZTEC_WALLS_1"
            wait until read
        end dialogue
        GB_DialogueIsRunning = 0
    end if
    
    if get building GATEHOUSE_F in AztecCapital min built 1.0 exists and ak == 0 and GB_DialogueIsRunning == 0
        GB_DialogueIsRunning = 1
        ak = 1
        begin dialogue
            say "BW2T_SCRIPT_10FINAL_AZTEC_GATEHOUSES"
            wait until read
        end dialogue
        GB_DialogueIsRunning = 0
    end if

    if PLAYER of AztecTown1 == 1 and AztecTown1Dialogue == 0
        GB_DialogueIsRunning = 1
        AztecTown1Dialogue = 1
        begin dialogue
            say "BW2T_SCRIPT_10FINAL_AZTECS_TAKE_TOWN_VIA_ARMIES_1"
            wait until read
        end dialogue
        GB_DialogueIsRunning = 0
    end if

    if PLAYER of AztecTown2 == 1 and AztecTown2Dialogue == 0
        GB_DialogueIsRunning = 1
        AztecTown2Dialogue = 1
        begin dialogue
            say "BW2T_SCRIPT_10FINAL_AZTECS_TAKE_TOWN_VIA_ARMIES_4"
            wait until read
        end dialogue
        GB_DialogueIsRunning = 0
    end if

    if FireSiren == 1
        GB_DialogueIsRunning = 1
        FireSiren = 2
        begin dialogue
            say "BW2T_SCRIPT_09FINAL_EPIC_SIREN_READY"
            wait until read
        end dialogue
        GB_DialogueIsRunning = 0
    end if

    if PrisonDestroyed == 1
        begin dialogue
            wait 3 seconds
            say "BW2T_SCRIPT_10FINAL_ADVISORS_AZTEC_ANGER_10"
            wait until read
            say "BW2T_SCRIPT_10FINAL_ADVISORS_AZTEC_ANGER_50"
            wait until read
            eject good spirit
            wait 0.6 seconds
            say "BW2T_SCRIPT_10FINAL_ADVISORS_AZTEC_ANGER_60"
            wait until read
            eject evil spirit
            wait 0.3 seconds
            say "BW2T_SCRIPT_10FINAL_ADVISORS_AZTEC_ANGER_70"
            wait until read
            send good spirit home
            send evil spirit home
            wait 10 seconds
            PrisonDestroyed = 2
            say "BW2T_SCRIPT_10FINAL_ADVISORS_AZTEC_ANGER_80"
            wait until read
        end dialogue
    end if

    if PrisonCreatureReminder == 0 and IntroFinished == 1
        PrisonCreatureReminder = 1
        wait 15 seconds
        GB_DialogueIsRunning = 1
        begin dialogue
            eject evil spirit
            say "BW2T_SCRIPT_10FINAL_ADVISORS_INTRO_8"
            wait until read
            send evil spirit home
        end dialogue
        GB_DialogueIsRunning = 0
    end if

    if UnderAttack >= 1 and get AttackTimer time remaining <= 0 and GB_DialogueIsRunning == 0
        GB_DialogueIsRunning = 1
        UnderAttack = 0
        Number = number from 1 to 14
        if Number == 1
            begin dialogue
                eject evil spirit
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_EA_01"
                wait until read
                send evil spirit home
            end dialogue
        end if
        if Number == 2
            begin dialogue
                eject evil spirit
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_EA_02"
                wait until read
                send evil spirit home
            end dialogue
        end if
        if Number == 3
            begin dialogue
                eject evil spirit
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_EA_05"
                wait until read
                send evil spirit home
            end dialogue
        end if
        if Number == 4
            begin dialogue
                eject evil spirit
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_EA_06"
                wait until read
                send evil spirit home
            end dialogue
        end if
        if Number == 5
            begin dialogue
                eject evil spirit
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_EA_07"
                wait until read
                send evil spirit home
            end dialogue
        end if
        if Number == 6
            begin dialogue
                eject evil spirit
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_EA_08"
                wait until read
                send evil spirit home
            end dialogue
        end if
        if Number == 7
            begin dialogue
                eject evil spirit
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_EA_18"
                wait until read
                send evil spirit home
            end dialogue
        end if
        if Number == 8
            begin dialogue
                eject good spirit
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_GA_01"
                wait until read
                send good spirit home
            end dialogue
        end if
        if Number == 9
            begin dialogue
                eject good spirit
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_GA_02"
                wait until read
                send good spirit home
            end dialogue
        end if
        if Number == 10
            begin dialogue
                eject good spirit
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_GA_05"
                wait until read
                send good spirit home
            end dialogue
        end if
        if Number == 11
            begin dialogue
                eject good spirit
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_GA_06"
                wait until read
                send good spirit home
            end dialogue
        end if
        if Number == 12
            begin dialogue
                eject good spirit
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_GA_07"
                wait until read
                send good spirit home
            end dialogue
        end if
        if Number == 13
            begin dialogue
                eject good spirit
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_GA_09"
                wait until read
                send good spirit home
            end dialogue
        end if
        if Number == 14
            begin dialogue
                eject good spirit
                say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_GA_10"
                wait until read
                send good spirit home
            end dialogue
        end if
        GB_DialogueIsRunning = 0
        AttackTimer = create timer for 45 seconds
    end if
    
    if PLAYER of PlayerTown != 0 and PLAYER of MinorTown1 != 0 and PLAYER of AztecTown1 != 0 and PLAYER of AztecTown2 != 0 and PLAYER of AztecCapital != 0  and get LoseTimer time remaining <= 0 and GB_DialogueIsRunning == 0
        GB_DialogueIsRunning = 1
        LoseDialogue1 = number from 1 to 5
        if LoseDialogue1 == 1
            begin dialogue
                eject good spirit
                say "BW2T_SCRIPT_GENERIC_ADVISORS_SUGGEST_RESTART_10"
                wait until read
                send good spirit home
            end dialogue
        end if
        
        if LoseDialogue1 == 2
            begin dialogue
                eject evil spirit
                say "BW2T_SCRIPT_GENERIC_ADVISORS_SUGGEST_RESTART_20"
                wait until read
                send evil spirit home
            end dialogue
        end if
        
        if LoseDialogue1 == 3
            begin dialogue
                eject good spirit
                say "BW2T_SCRIPT_GENERIC_ADVISORS_SUGGEST_RESTART_30"
                wait until read
                send good spirit home
            end dialogue
        end if
        
        if LoseDialogue1 == 4
            begin dialogue
                eject evil spirit
                say "BW2T_SCRIPT_GENERIC_ADVISORS_SUGGEST_RESTART_40"
                wait until read
                send evil spirit home
            end dialogue
        end if
        
        if LoseDialogue1 == 5
            begin dialogue
                eject evil spirit
                say "BW2T_SCRIPT_GENERIC_ADVISORS_SUGGEST_RESTART_50"
                wait until read
                send evil spirit home
            end dialogue
        end if
        
        GB_DialogueIsRunning = 0
        LoseTimer = create timer for 75 seconds
    end if

end loop

end script LC10_Speeches

begin script LC10_Aztec_Capital
    
    Number = 0

    AttackingPlatoons = 0

    NearestSettlementTownCentre = 0

    PlayerPlatoon = 0

    PlannedWall[11]
    PlannedWallPos[11]
    PlannedWallTimer = create timer for 900 * BuilderModifier seconds
    WallCounter = 0

    Wall[5]

    RoadPos[37]
    Road = 0

    Group0_Timer = create timer for 30 seconds
    Group1_Timer = create timer for 150 seconds
    Group2_Timer = create timer for 360 seconds
    Group3_Timer = create timer for 480 seconds
    Group4_Timer = create timer for 600 * BuilderModifier seconds
    Group5_Timer = create timer for 900 * BuilderModifier seconds
    Group6_Timer = create timer for 1220 * BuilderModifier seconds
    Group7_Timer = create timer for 1600 * BuilderModifier seconds
    Group8_Timer = create timer for 2200 * BuilderModifier seconds
    //Group10 in villager manager

    a = 0
    b = 0
    c = 0
    d = 0
    e = 0
    f = 0
    g = 0
    h = 0
    i = 0

    Platoon = 0
    SirenWarning = 0
    SirenTimer = create timer for 0 seconds
    SIRENDELAY = 1750
    SirenSpell = 0
    NumberofPlatoons = 0

    Influence = 0

start


    AttackNearestTownTimer = create timer for 0 seconds

    LC10_RecruitTimer1 = create timer for 60 seconds
    LC10_RecruitTimer2 = create timer for 60 seconds
    LC10_RecruitTimer3 = create timer for 60 seconds

    //AztecCapital Walls
    PlannedWallPos[0] = marker at {1330.29,138.50,2115.20}
    PlannedWallPos[1] = marker at {1347.80,134.53,2108.92}
    PlannedWallPos[2] = marker at {1371.39,129.53,2100.91}
    PlannedWallPos[3] = marker at {1402.57,129.21,2084.79}
    PlannedWallPos[4] = marker at {1431.46,129.41,2071.14}
    PlannedWallPos[5] = marker at {1514.77,127.36,2066.21}
    PlannedWallPos[6] = marker at {1544.23,123.97,2066.47}
    PlannedWallPos[7] = marker at {1577.52,124.70,2069.02}
    PlannedWallPos[8] = marker at {1601.76,127.94,2067.24}
    PlannedWallPos[9] = marker at {1764.29,120.99,2110.25}
    PlannedWallPos[10] = marker at {1841.82,120.38,2120.93}

    //Planned Roads
    RoadPos[0] = marker at {1653.74,131.95,2242.15}//Group 1
    RoadPos[1] = marker at {1655.09,131.94,2230.96}//Group 1
    RoadPos[2] = marker at {1661.53,131.86,2220.92}//Group 1
    RoadPos[3] = marker at {1730.31,132.15,2238.21}//Group 1
    RoadPos[4] = marker at {1571.42,133.53,2166.19}//Group 1
    RoadPos[5] = marker at {1575.97,133.47,2250.30}//Group 2
    RoadPos[6] = marker at {1560.99,133.49,2258.60}//Group 2
    RoadPos[7] = marker at {1545.70,133.50,2243.92}//Group 2
    RoadPos[8] = marker at {1551.17,133.49,2227.93}//Group 2
    RoadPos[9] = marker at {1529.72,133.53,2244.18}//Group 2
    RoadPos[10] = marker at {1514.32,133.66,2252.95}//Group 2
    RoadPos[11] = marker at {1491.18,133.69,2261.07}//Group 2
    RoadPos[12] = marker at {1485.18,133.69,2253.25}//Group 2
    RoadPos[13] = marker at {1493.79,133.66,2228.72}//Group 2
    RoadPos[14] = marker at {1468.31,133.72,2246.30}//Group 2
    RoadPos[15] = marker at {1439.24,133.72,2262.01}//Group 2
    RoadPos[16] = marker at {1451.65,133.72,2254.96}//Group 2
    RoadPos[17] = marker at {1421.19,133.72,2254.59}//Group 2
    RoadPos[18] = marker at {1427.90,133.72,2230.08}//Group 2
    RoadPos[19] = marker at {1395.87,133.72,2247.13}//Group 3
    RoadPos[20] = marker at {1336.77,133.75,2246.83}//Group 3
    RoadPos[21] = marker at {1307.01,133.72,2266.27}//Group 3
    RoadPos[22] = marker at {1361.81,133.72,2276.94}//Group 3
    RoadPos[23] = marker at {1348.60,133.75,2300.59}//Group 3
    RoadPos[24] = marker at {1404.07,134.22,2298.75}//Group 3
    RoadPos[25] = marker at {1500.87,133.81,2281.72}//Group 3
    RoadPos[26] = marker at {1435.09,133.72,2209.05}//Group 4
    RoadPos[27] = marker at {1499.29,133.67,2212.45}//Group 4
    RoadPos[28] = marker at {1559.07,133.46,2211.97}//Group 4
    RoadPos[29] = marker at {1558.48,133.44,2181.31}//Group 4
    RoadPos[30] = marker at {1526.29,133.47,2178.21}//Group 4
    RoadPos[31] = marker at {1465.33,133.60,2180.65}//Group 4
    RoadPos[32] = marker at {1434.98,133.69,2181.57}//Group 4
    RoadPos[33] = marker at {1482.91,133.67,2190.73}//Group 4
    RoadPos[34] = marker at {1480.55,133.56,2167.85}//Group 4
    RoadPos[35] = marker at {1414.64,132.72,2136.37}//Group 5
    RoadPos[36] = marker at {1557.67,133.70,2130.39}//Group 5

    if Difficulty >= 4
        add resource WOOD 2000 to PlayerTown
        add resource ORE 2000 to PlayerTown
        add resource FOOD 1000 to PlayerTown
    elsif Difficulty == 3
        add resource WOOD 3000 to PlayerTown
        add resource ORE 3000 to PlayerTown
        add resource FOOD 2000 to PlayerTown
    elsif Difficulty == 2
        add resource WOOD 4000 to PlayerTown
        add resource ORE 4000 to PlayerTown
        add resource FOOD 3000 to PlayerTown
    elsif Difficulty == 1
        add resource WOOD 5000 to PlayerTown
        add resource ORE 5000 to PlayerTown
        add resource FOOD 5000 to PlayerTown
    end if

    add resource WOOD 30000 to AztecCapital
    add resource ORE 30000 to AztecCapital
    add resource FOOD 30000 to AztecCapital

    //----Create town static defenders platoons----//

    //--AztecCapital--//
    LC10_Platoon[0] = create platoon ARMY_UNIT_TYPE_MELEE_5 at {PlatoonPos[0]} with 30 * RecruitSizeModifier men and 0 women
    attach LC10_Platoon[0] to AztecCapital
    PLAYER of LC10_Platoon[0] = 1
    run background script LC10_StaticPlatoonsActions(PlatoonPos[0],Melee,LC10_Platoon[0])
    enable platoon LC10_Platoon[0] respond to town AztecCapital attack
    enable platoon LC10_Platoon[0] camp
    set LC10_Platoon[0] focus to {PlayerTown}

    LC10_Platoon[1] = create platoon PLATOON_INFO_AZTEC_RANGED_5 at {PlatoonPos[1]} with 30 * RecruitSizeModifier men and 0 women
    attach LC10_Platoon[1] to AztecCapital
    PLAYER of LC10_Platoon[1] = 1
    run background script LC10_StaticPlatoonsActions(PlatoonPos[1],Ranged,LC10_Platoon[1])
    enable platoon LC10_Platoon[1] respond to town AztecCapital attack
    enable platoon LC10_Platoon[1] camp
    set LC10_Platoon[1] focus to {PlayerTown}

    //----Create patrol platoons----//

    LC10_Platoon[2] = create platoon PLATOON_INFO_AZTEC_RANGED_5 at {PatrolRouteA[0]} with 30 * RecruitSizeModifier men and 0 women
    attach LC10_Platoon[2] to AztecCapital
    PLAYER of LC10_Platoon[2] = 1
    run background script LC10_Platoon2Actions
    enable platoon LC10_Platoon[2] respond to town AztecCapital attack
    enable platoon LC10_Platoon[2] camp
    set LC10_Platoon[2] focus to {PlayerTown}

    LC10_Platoon[29] = create platoon PLATOON_INFO_AZTEC_RANGED_5 at {PatrolRouteA[0]} with 30 * RecruitSizeModifier men and 0 women
    attach LC10_Platoon[29] to AztecCapital
    PLAYER of LC10_Platoon[29] = 1
    run background script LC10_Platoon29Actions
    enable platoon LC10_Platoon[29] respond to town AztecCapital attack
    enable platoon LC10_Platoon[29] camp
    set LC10_Platoon[29] focus to {PlayerTown}

    //----Create prison platoons----//
    LC10_Platoon[3] = create platoon ARMY_UNIT_TYPE_MELEE_5 at {PlatoonPos[6]} with 20 * RecruitSizeModifier men and 0 women
    attach LC10_Platoon[3] to AztecCapital
    PLAYER of LC10_Platoon[3] = 1
    run background script LC10_StaticPlatoonsActions(PlatoonPos[6],Melee,LC10_Platoon[3])
    enable platoon LC10_Platoon[3] respond to town AztecCapital attack
    enable platoon LC10_Platoon[3] camp
    set LC10_Platoon[3] focus to {PlayerTown}

    LC10_Platoon[4] = create platoon ARMY_UNIT_TYPE_MELEE_5 at {PlatoonPos[7]} with 20 * RecruitSizeModifier men and 0 women
    attach LC10_Platoon[4] to AztecCapital
    PLAYER of LC10_Platoon[4] = 1
    run background script LC10_StaticPlatoonsActions(PlatoonPos[7],Melee,LC10_Platoon[4])
    enable platoon LC10_Platoon[4] respond to town AztecCapital attack
    enable platoon LC10_Platoon[4] camp
    set LC10_Platoon[4] focus to {PlayerTown}

    LC10_Platoon[5] = create platoon ARMY_UNIT_TYPE_MELEE_5 at {PlatoonPos[8]} with 20 * RecruitSizeModifier men and 0 women
    attach LC10_Platoon[5] to AztecCapital
    PLAYER of LC10_Platoon[5] = 1
    run background script LC10_StaticPlatoonsActions(PlatoonPos[8],Melee,LC10_Platoon[5])
    enable platoon LC10_Platoon[5] respond to town AztecCapital attack
    enable platoon LC10_Platoon[5] camp
    set LC10_Platoon[5] focus to {PlayerTown}

    LC10_Platoon[6] = create platoon ARMY_UNIT_TYPE_MELEE_5 at {PlatoonPos[9]} with 20 * RecruitSizeModifier men and 0 women
    attach LC10_Platoon[6] to AztecCapital
    PLAYER of LC10_Platoon[6] = 1
    run background script LC10_StaticPlatoonsActions(PlatoonPos[9],Melee,LC10_Platoon[6])
    enable platoon LC10_Platoon[6] respond to town AztecCapital attack
    enable platoon LC10_Platoon[6] camp
    set LC10_Platoon[6] focus to {PlayerTown}

    //----Create attack wave----//

    LC10_Platoon[7] = create platoon ARMY_UNIT_TYPE_MELEE_5 at {PlatoonPos[10]} with 20 * RecruitSizeModifier men and 0 women
    attach LC10_Platoon[7] to AztecCapital
    PLAYER of LC10_Platoon[7] = 1
    enable platoon LC10_Platoon[7] respond to town AztecCapital attack
    enable platoon LC10_Platoon[7] camp
    set LC10_Platoon[7] focus to {PlayerTown}

    LC10_Platoon[8] = create platoon ARMY_UNIT_TYPE_MELEE_5 at {PlatoonPos[11]} with 20 * RecruitSizeModifier men and 0 women
    attach LC10_Platoon[8] to AztecCapital
    PLAYER of LC10_Platoon[8] = 1
    enable platoon LC10_Platoon[8] respond to town AztecCapital attack
    enable platoon LC10_Platoon[8] camp
    set LC10_Platoon[8] focus to {PlayerTown}

    LC10_Platoon[9] = create platoon PLATOON_INFO_AZTEC_RANGED_5 at {PlatoonPos[12]} with 20 * RecruitSizeModifier men and 0 women
    attach LC10_Platoon[9] to AztecCapital
    PLAYER of LC10_Platoon[9] = 1
    enable platoon LC10_Platoon[9] respond to town AztecCapital attack
    enable platoon LC10_Platoon[9] camp
    set LC10_Platoon[9] focus to {PlayerTown}

    wait until IntroFinished == 1

    run background script LC10_Platoon7Actions
    run background script LC10_Platoon8Actions
    run background script LC10_Platoon9Actions
    run background script LC10_Platoon10Actions
    run background script LC10_Platoon11Actions
    run background script LC10_Platoon12Actions
    run background script LC10_Platoon13Actions
    run background script LC10_Platoon14Actions
    run background script LC10_Platoon15Actions
    run background script LC10_Platoon22Actions
    run background script LC10_Platoon23Actions
    run background script LC10_Platoon24Actions
    run background script LC10_Platoon25Actions
    run background script LC10_Platoon28Actions
    run background script LC10_SiegeCatapult0Actions
    run background script LC10_SiegeCatapult1Actions
    run background script LC10_SiegeCatapult2Actions
    run background script LC10_SiegeCatapult3Actions
    run background script LC10_SiegeCatapult4Actions
    run background script LC10_SiegeCatapult5Actions
    run background script LC10_SiegeCatapult6Actions
    run background script LC10_SiegeCatapult7Actions
    run background script LC10_SiegeCatapult8Actions

    begin loop

        //MainWalls
        Wall[0] = get wall segment nearest {1358.96,132.96,2104.30} radius 15
        Wall[1] = get wall segment nearest {1417.14,128.55,2078.57} radius 15
        Wall[2] = get wall segment nearest {1529.43,126.07,2066.51} radius 15
        Wall[3] = get wall segment nearest {1588.33,125.67,2066.52} radius 15
        Wall[4] = get wall segment nearest {1808.68,118.56,2115.12} radius 15
        //MainWalls

        NearestSettlementTownCentre = get building ABODE_NUMBER_TOWN_CENTRE in NearestSettlement min built 1.0
        if LC10_Platoon[0] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC10_RecruitTimer1 time remaining <= 0
            LC10_Platoon[0] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 20 * RecruitSizeModifier
            LC10_RecruitTimer1 = create timer for 180 * RecruitModifier seconds
            enable platoon LC10_Platoon[0] respond to town AztecCapital attack
            wait until not LC10_Platoon[0] recruiting
            run background script LC10_StaticPlatoonsActions(PlatoonPos[0],Melee,LC10_Platoon[0])

        elsif LC10_Platoon[1] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC10_RecruitTimer1 time remaining <= 0
            LC10_Platoon[1] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 20 * RecruitSizeModifier
            LC10_RecruitTimer1 = create timer for 180 * RecruitModifier seconds
            enable platoon LC10_Platoon[1] respond to town AztecCapital attack
            wait until not LC10_Platoon[1] recruiting
            run background script LC10_StaticPlatoonsActions(PlatoonPos[1],Melee,LC10_Platoon[1])

        elsif LC10_WallArcher[0] not exists and Wall[0] exists and PLAYER of Wall[0] == 1 and HEALTH of Wall[0] == 1.0 and not town AztecCapital is under takeover from player 0 and get LC10_RecruitTimer1 time remaining <= 0
            LC10_WallArcher[0] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 20 * RecruitSizeModifier
            LC10_RecruitTimer1 = create timer for 60 * RecruitModifier seconds
            wait until not LC10_WallArcher[0] recruiting
            enable platoon LC10_WallArcher[0] respond to town AztecCapital attack
            add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[0] to LC10_WallArcher[0] action queue

        elsif LC10_WallArcher[1] not exists and Wall[1] exists and PLAYER of Wall[1] == 1 and HEALTH of Wall[1] == 1.0 and not town AztecCapital is under takeover from player 0 and get LC10_RecruitTimer1 time remaining <= 0
            LC10_WallArcher[1] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 20 * RecruitSizeModifier
            LC10_RecruitTimer1 = create timer for 60 * RecruitModifier seconds
            wait until not LC10_WallArcher[1] recruiting
            enable platoon LC10_WallArcher[1] respond to town AztecCapital attack
            add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[1] to LC10_WallArcher[1] action queue
        
        elsif LC10_WallArcher[2] not exists and Wall[2] exists and PLAYER of Wall[2] == 1 and HEALTH of Wall[2] == 1.0 and not town AztecCapital is under takeover from player 0 and get LC10_RecruitTimer1 time remaining <= 0
            LC10_WallArcher[2] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 20 * RecruitSizeModifier
            LC10_RecruitTimer1 = create timer for 60 * RecruitModifier seconds
            wait until not LC10_WallArcher[2] recruiting
            enable platoon LC10_WallArcher[2] respond to town AztecCapital attack
            add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[2] to LC10_WallArcher[2] action queue

        elsif LC10_WallArcher[3] not exists and Wall[3] exists and PLAYER of Wall[3] == 1 and HEALTH of Wall[3] == 1.0 and not town AztecCapital is under takeover from player 0 and get LC10_RecruitTimer1 time remaining <= 0
            LC10_WallArcher[3] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 20 * RecruitSizeModifier
            LC10_RecruitTimer1 = create timer for 60 * RecruitModifier seconds
            wait until not LC10_WallArcher[3] recruiting
            enable platoon LC10_WallArcher[3] respond to town AztecCapital attack
            add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[3] to LC10_WallArcher[3] action queue

        elsif LC10_WallArcher[4] not exists and Wall[4] exists and PLAYER of Wall[4] == 1 and HEALTH of Wall[4] == 1.0 and not town AztecCapital is under takeover from player 0 and get LC10_RecruitTimer1 time remaining <= 0
            LC10_WallArcher[4] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 20 * RecruitSizeModifier
            LC10_RecruitTimer1 = create timer for 60 * RecruitModifier seconds
            wait until not LC10_WallArcher[4] recruiting
            enable platoon LC10_WallArcher[4] respond to town AztecCapital attack
            add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[4] to LC10_WallArcher[4] action queue

        //Take over AztecTown1
        elsif LC10_Platoon[14] not exists and PLAYER of AztecCapital == 1 and PLAYER of AztecTown1 != 0 and not town AztecCapital is under takeover from player 0 and get LC10_RecruitTimer1 time remaining <= 0
            LC10_Platoon[14] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 75 * RecruitSizeModifier
            LC10_RecruitTimer1 = create timer for 180 * RecruitModifier seconds
            enable platoon LC10_Platoon[14] respond to town AztecCapital attack
            wait until not LC10_Platoon[14] recruiting

        //Take over AztecTown2
        elsif LC10_Platoon[15] not exists and PLAYER of AztecCapital == 1 and PLAYER of AztecTown2 != 0 and not town AztecCapital is under takeover from player 0 and get LC10_RecruitTimer1 time remaining <= 0 and TownsConverted >= 1
            LC10_Platoon[15] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 50 * RecruitSizeModifier
            LC10_RecruitTimer1 = create timer for 180 * RecruitModifier seconds
            enable platoon LC10_Platoon[15] respond to town AztecCapital attack
            wait until not LC10_Platoon[15] recruiting

        //Attack Nearest Settlement
        elsif LC10_Platoon[22] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get AttackNearestTownTimer time remaining <= 0 and AttackingPlatoons == 1
            LC10_Platoon[22] = recruit ARMY_UNIT_TYPE_RANGED_4 town AztecCapital platoon of size 30 * RecruitSizeModifier
            LC10_RecruitTimer1 = create timer for 200 * RecruitModifier seconds
            enable platoon LC10_Platoon[22] respond to town AztecCapital attack
            wait until not LC10_Platoon[22] recruiting

        elsif LC10_Platoon[23] not exists and LC10_Platoon[22] exists and {LC10_Platoon[22]} near {AztecCapital} radius 550 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get AttackNearestTownTimer time remaining <= 0 and AttackingPlatoons == 1
            LC10_Platoon[23] = recruit ARMY_UNIT_TYPE_MELEE_4 town AztecCapital platoon of size 40 * RecruitSizeModifier
            LC10_RecruitTimer1 = create timer for 200 * RecruitModifier seconds
            enable platoon LC10_Platoon[23] respond to town AztecCapital attack
            wait until not LC10_Platoon[23] recruiting

        elsif LC10_Platoon[24] not exists and LC10_Platoon[22] exists and {LC10_Platoon[22]} near {AztecCapital} radius 550 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get AttackNearestTownTimer time remaining <= 0 and AttackingPlatoons == 1
            LC10_Platoon[24] = recruit ARMY_UNIT_TYPE_MELEE_4 town AztecCapital platoon of size 50 * RecruitSizeModifier
            LC10_RecruitTimer1 = create timer for 200 * RecruitModifier seconds
            enable platoon LC10_Platoon[24] respond to town AztecCapital attack
            wait until not LC10_Platoon[24] recruiting

        elsif LC10_Platoon[25] not exists and LC10_Platoon[22] exists and {LC10_Platoon[22]} near {AztecCapital} radius 550 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get AttackNearestTownTimer time remaining <= 0 and AttackingPlatoons == 1
            LC10_Platoon[25] = recruit ARMY_UNIT_TYPE_RANGED_4 town AztecCapital platoon of size 60 * RecruitSizeModifier
            LC10_RecruitTimer1 = create timer for 200 * RecruitModifier seconds
            enable platoon LC10_Platoon[25] respond to town AztecCapital attack
            wait until not LC10_Platoon[25] recruiting

        elsif LC10_SiegeCatapult[4] not exists and LC10_Platoon[22] exists and {LC10_Platoon[22]} near {AztecCapital} radius 550 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get AttackNearestTownTimer time remaining <= 0 and AttackingPlatoons == 1
            LC10_SiegeCatapult[4] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_5 town AztecCapital siege weapon
            LC10_RecruitTimer1 = create timer for 200 * RecruitModifier seconds

        elsif LC10_SiegeCatapult[5] not exists and LC10_Platoon[22] exists and {LC10_Platoon[22]} near {AztecCapital} radius 550 and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get AttackNearestTownTimer time remaining <= 0 and AttackingPlatoons == 1
            LC10_SiegeCatapult[5] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_5 town AztecCapital siege weapon
            LC10_RecruitTimer1 = create timer for 200 * RecruitModifier seconds

        //Attack PlayerTown Volcano Route //Behaivor: Wait in front of Capital and move out if volcano isn't active
        elsif LC10_Platoon[11] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC10_RecruitTimer1 time remaining <= 0 and VolcanoActive == 1
            LC10_Platoon[11] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 30 * RecruitSizeModifier
            LC10_RecruitTimer1 = create timer for 120 * RecruitModifier seconds
            enable platoon LC10_Platoon[11] respond to town AztecCapital attack
            wait until not LC10_Platoon[11] recruiting

        elsif LC10_Platoon[12] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC10_RecruitTimer1 time remaining <= 0 and VolcanoActive == 1
            LC10_Platoon[12] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 30 * RecruitSizeModifier
            LC10_RecruitTimer1 = create timer for 120 * RecruitModifier seconds
            enable platoon LC10_Platoon[12] respond to town AztecCapital attack
            wait until not LC10_Platoon[12] recruiting

        elsif LC10_Platoon[13] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC10_RecruitTimer1 time remaining <= 0 and VolcanoActive == 1
            LC10_Platoon[13] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 30 * RecruitSizeModifier
            LC10_RecruitTimer1 = create timer for 120 * RecruitModifier seconds
            enable platoon LC10_Platoon[13] respond to town AztecCapital attack
            wait until not LC10_Platoon[13] recruiting

        elsif LC10_SiegeCatapult[2] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC10_RecruitTimer1 time remaining <= 0 and VolcanoActive == 1
            LC10_SiegeCatapult[2] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_6 town AztecCapital siege weapon
            LC10_RecruitTimer1 = create timer for 100 * RecruitModifier seconds

        elsif LC10_SiegeCatapult[3] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC10_RecruitTimer1 time remaining <= 0 and VolcanoActive == 1
            LC10_SiegeCatapult[3] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_6 town AztecCapital siege weapon
            LC10_RecruitTimer1 = create timer for 100 * RecruitModifier seconds

        //Attack PlayerTown
        elsif LC10_Platoon[7] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC10_RecruitTimer1 time remaining <= 0
            LC10_Platoon[7] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 80 * RecruitSizeModifier
            LC10_RecruitTimer1 = create timer for 140 * RecruitModifier seconds
            enable platoon LC10_Platoon[7] respond to town AztecCapital attack
            wait until not LC10_Platoon[7] recruiting

        elsif LC10_Platoon[8] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC10_RecruitTimer1 time remaining <= 0
            LC10_Platoon[8] = recruit ARMY_UNIT_TYPE_MELEE_5 town AztecCapital platoon of size 80 * RecruitSizeModifier
            LC10_RecruitTimer1 = create timer for 140 * RecruitModifier seconds
            enable platoon LC10_Platoon[8] respond to town AztecCapital attack
            wait until not LC10_Platoon[8] recruiting

        elsif LC10_Platoon[9] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC10_RecruitTimer1 time remaining <= 0
            LC10_Platoon[9] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 80 * RecruitSizeModifier
            LC10_RecruitTimer1 = create timer for 140 * RecruitModifier seconds
            enable platoon LC10_Platoon[9] respond to town AztecCapital attack
            wait until not LC10_Platoon[9] recruiting

        elsif LC10_Platoon[10] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC10_RecruitTimer1 time remaining <= 0
            LC10_Platoon[10] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecCapital platoon of size 80 * RecruitSizeModifier
            LC10_RecruitTimer1 = create timer for 140 * RecruitModifier seconds
            enable platoon LC10_Platoon[10] respond to town AztecCapital attack
            wait until not LC10_Platoon[10] recruiting

        elsif LC10_SiegeCatapult[0] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC10_RecruitTimer1 time remaining <= 0
            LC10_SiegeCatapult[0] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_6 town AztecCapital siege weapon
            LC10_RecruitTimer1 = create timer for 100 * RecruitModifier seconds

        elsif LC10_SiegeCatapult[1] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC10_RecruitTimer1 time remaining <= 0
            LC10_SiegeCatapult[1] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_6 town AztecCapital siege weapon
            LC10_RecruitTimer1 = create timer for 100 * RecruitModifier seconds

        elsif LC10_SiegeCatapult[7] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC10_RecruitTimer1 time remaining <= 0
            LC10_SiegeCatapult[7] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_6 town AztecCapital siege weapon
            LC10_RecruitTimer1 = create timer for 100 * RecruitModifier seconds

        elsif LC10_SiegeCatapult[8] not exists and PLAYER of AztecCapital == 1 and not town AztecCapital is under takeover from player 0 and get LC10_RecruitTimer1 time remaining <= 0
            LC10_SiegeCatapult[8] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_6 town AztecCapital siege weapon
            LC10_RecruitTimer1 = create timer for 100 * RecruitModifier seconds

        //AztecTown1
        elsif LC10_Platoon[14] not exists and PLAYER of AztecTown1 == 1 and not town AztecTown1 is under takeover from player 0 and get LC10_RecruitTimer2 time remaining <= 0
            LC10_Platoon[14] = recruit ARMY_UNIT_TYPE_MELEE_4 town AztecTown1 platoon of size 50 * RecruitSizeModifier
            LC10_RecruitTimer2 = create timer for 180 * RecruitModifier seconds
            enable platoon LC10_Platoon[14] respond to town AztecTown1 attack
            wait until not LC10_Platoon[14] recruiting
            run background script LC10_StaticPlatoonsActions(PlatoonPos[2],Melee,LC10_Platoon[14])

        elsif LC10_Platoon[26] not exists and PLAYER of AztecTown1 == 1 and not town AztecTown1 is under takeover from player 0 and get LC10_RecruitTimer2 time remaining <= 0
            LC10_Platoon[26] = recruit ARMY_UNIT_TYPE_RANGED_4 town AztecTown1 platoon of size 30 * RecruitSizeModifier
            LC10_RecruitTimer2 = create timer for 180 * RecruitModifier seconds
            enable platoon LC10_Platoon[26] respond to town AztecTown1 attack
            wait until not LC10_Platoon[26] recruiting
            run background script LC10_StaticPlatoonsActions(PlatoonPos[3],Ranged,LC10_Platoon[26])

        //Attack PlayerTown //Small Attack; Large Delay
        elsif LC10_Platoon[28] not exists and PLAYER of AztecTown1 == 1 and not town AztecTown1 is under takeover from player 0 and get LC10_RecruitTimer2 time remaining <= 0 and PLAYER of AztecTown2 != 1
            LC10_Platoon[28] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecTown1 platoon of size 40 * RecruitSizeModifier
            LC10_RecruitTimer2 = create timer for 360 * RecruitModifier seconds
            enable platoon LC10_Platoon[28] respond to town AztecTown1 attack
            wait until not LC10_Platoon[28] recruiting

        elsif LC10_SiegeCatapult[6] not exists and PLAYER of AztecTown1 == 1 and not town AztecTown1 is under takeover from player 0 and get LC10_RecruitTimer2 time remaining <= 0 and PLAYER of AztecTown2 != 1
            LC10_SiegeCatapult[6] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_6 town AztecTown1 siege weapon
            LC10_RecruitTimer2 = create timer for 250 * RecruitModifier seconds

        //AztecTown2
        elsif LC10_Platoon[15] not exists and PLAYER of AztecTown2 == 1 and not town AztecTown2 is under takeover from player 0 and get LC10_RecruitTimer3 time remaining <= 0
            LC10_Platoon[15] = recruit ARMY_UNIT_TYPE_MELEE_4 town AztecTown2 platoon of size 30 * RecruitSizeModifier
            LC10_RecruitTimer3 = create timer for 180 * RecruitModifier seconds
            enable platoon LC10_Platoon[15] respond to town AztecTown2 attack
            wait until not LC10_Platoon[15] recruiting
            run background script LC10_StaticPlatoonsActions(PlatoonPos[4],Melee,LC10_Platoon[15])

        elsif LC10_Platoon[27] not exists and PLAYER of AztecTown2 == 1 and not town AztecTown2 is under takeover from player 0 and get LC10_RecruitTimer3 time remaining <= 0
            LC10_Platoon[27] = recruit ARMY_UNIT_TYPE_RANGED_4 town AztecTown2 platoon of size 30 * RecruitSizeModifier
            LC10_RecruitTimer3 = create timer for 180 * RecruitModifier seconds
            enable platoon LC10_Platoon[27] respond to town AztecTown2 attack
            wait until not LC10_Platoon[27] recruiting
            run background script LC10_StaticPlatoonsActions(PlatoonPos[5],Melee,LC10_Platoon[27])

        //Attack PlayerTown //Small Attack; Large Delay
        elsif LC10_Platoon[28] not exists and PLAYER of AztecTown2 == 1 and not town AztecTown2 is under takeover from player 0 and get LC10_RecruitTimer3 time remaining <= 0
            LC10_Platoon[28] = recruit ARMY_UNIT_TYPE_RANGED_5 town AztecTown2 platoon of size 40 * RecruitSizeModifier
            LC10_RecruitTimer3 = create timer for 300 * RecruitModifier seconds
            enable platoon LC10_Platoon[28] respond to town AztecTown2 attack
            wait until not LC10_Platoon[28] recruiting

        elsif LC10_SiegeCatapult[6] not exists and PLAYER of AztecTown2 == 1 and not town AztecTown2 is under takeover from player 0 and get LC10_RecruitTimer3 time remaining <= 0
            LC10_SiegeCatapult[6] = recruit SIEGE_BALANCE_TYPE_CATAPULT_LEVEL_6 town AztecTown2 siege weapon
            LC10_RecruitTimer3 = create timer for 200 * RecruitModifier seconds

        end if

        if get Group0_Timer time remaining <= 0 and a == 0 and PLAYER of AztecCapital == 1
            a = 1
            build all town AztecCapital buildings in group 0
        end if

        if get Group1_Timer time remaining <= 0 and b == 0 and PLAYER of AztecCapital == 1
            b = 1
            build all town AztecCapital buildings in group 1
            Road = build building at {RoadPos[0]} desire 1
            release Road
            Road = build building at {RoadPos[1]} desire 1
            release Road
            Road = build building at {RoadPos[2]} desire 1
            release Road
            Road = build building at {RoadPos[3]} desire 1
            release Road
            Road = build building at {RoadPos[4]} desire 1
            release Road
        end if

        if get Group2_Timer time remaining <= 0 and c == 0 and PLAYER of AztecCapital == 1
            c = 1
            build all town AztecCapital buildings in group 2
            Road = build building at {RoadPos[5]} desire 1
            release Road
            Road = build building at {RoadPos[6]} desire 1
            release Road
            Road = build building at {RoadPos[7]} desire 1
            release Road
            Road = build building at {RoadPos[8]} desire 1
            release Road
            Road = build building at {RoadPos[9]} desire 1
            release Road
            Road = build building at {RoadPos[10]} desire 1
            release Road
            Road = build building at {RoadPos[11]} desire 1
            release Road
            Road = build building at {RoadPos[12]} desire 1
            release Road
            Road = build building at {RoadPos[13]} desire 1
            release Road
            Road = build building at {RoadPos[14]} desire 1
            release Road
            Road = build building at {RoadPos[15]} desire 1
            release Road
            Road = build building at {RoadPos[16]} desire 1
            release Road
            Road = build building at {RoadPos[17]} desire 1
            release Road
            Road = build building at {RoadPos[18]} desire 1
            release Road
        end if

        if get Group3_Timer time remaining <= 0 and d == 0 and PLAYER of AztecCapital == 1
            d = 1
            build all town AztecCapital buildings in group 3
            Road = build building at {RoadPos[19]} desire 1
            release Road
            Road = build building at {RoadPos[20]} desire 1
            release Road
            Road = build building at {RoadPos[21]} desire 1
            release Road
            Road = build building at {RoadPos[22]} desire 1
            release Road
            Road = build building at {RoadPos[23]} desire 1
            release Road
            Road = build building at {RoadPos[24]} desire 1
            release Road
            Road = build building at {RoadPos[25]} desire 1
            release Road
        end if

        if get Group4_Timer time remaining <= 0 and e == 0 and PLAYER of AztecCapital == 1
            e = 1
            build all town AztecCapital buildings in group 4
            Road = build building at {RoadPos[26]} desire 1
            release Road
            Road = build building at {RoadPos[27]} desire 1
            release Road
            Road = build building at {RoadPos[28]} desire 1
            release Road
            Road = build building at {RoadPos[29]} desire 1
            release Road
            Road = build building at {RoadPos[30]} desire 1
            release Road
            Road = build building at {RoadPos[31]} desire 1
            release Road
            Road = build building at {RoadPos[32]} desire 1
            release Road
            Road = build building at {RoadPos[33]} desire 1
            release Road
            Road = build building at {RoadPos[34]} desire 1
            release Road
            run background script LC10_SirenResourceManager
        end if

        if get Group5_Timer time remaining <= 0 and f == 0 and PLAYER of AztecCapital == 1
            f = 1
            build all town AztecCapital buildings in group 5
            Road = build building at {RoadPos[35]} desire 1
            release Road
            Road = build building at {RoadPos[36]} desire 1
            release Road
        end if

        if get Group6_Timer time remaining <= 0 and g == 0 and PLAYER of AztecCapital == 1
            g = 1
            build all town AztecCapital buildings in group 6
        end if

        if get Group7_Timer time remaining <= 0 and h == 0 and PLAYER of AztecCapital == 1
            h = 1
            build all town AztecCapital buildings in group 7
        end if

        if get Group8_Timer time remaining <= 0 and i == 0 and PLAYER of AztecCapital == 1
            i = 1
            build all town AztecCapital buildings in group 8
        end if

        if get PlannedWallTimer time remaining <= 0 and PLAYER of AztecCapital == 1
            if WallCounter < 11
                PlannedWall[WallCounter] = build building at {PlannedWallPos[WallCounter]} desire 1.0
                add resource RESOURCE_TYPE_ORE number from 8250 to 8750 to PlannedWall[WallCounter]
                WallCounter++
            end if
        end if

        if get SirenTimer time remaining <= 300 and CHARGE of AIEpic != 1.0 and PLAYER of AztecCapital == 1
            CHARGE of AIEpic = 1.0
        end if

        Platoon = get platoon of player 0 nearest {AztecCapital} radius 500
        NumberofPlatoons = get number of platoon of player 0 at {AztecCapital} radius 500
        if CinemaIsRunning == 0
            if get number of villagers in platoon Platoon > 79 or NumberofPlatoons >= 3 or town AztecTown1 is under takeover from player 0 or town AztecTown2 is under takeover from player 0 or {Platoon} near {AztecCapital} radius 200
                if HEALTH of AIEpic == 1.0 and get SirenTimer time remaining <= 0 and PLAYER of AztecCapital == 1
                    if town AztecTown1 is under takeover from player 0
                        Platoon = get platoon of player 0 nearest {AztecTown1} radius 500
                    end if
                    if town AztecTown2 is under takeover from player 0
                        Platoon = get platoon of player 0 nearest {AztecTown2} radius 500
                    end if
                    Influence = get player 0 influence at {Platoon}
                    if Influence < 1
                        enable predefined sky "SIREN" time 9
                        SirenTimer = create timer for SIRENDELAY * EpicModifier seconds
                        SIRENDELAY += 500
                        SirenWarning = create visual effect VISUAL_EFFECT_EPIC_TARGET_WARNING at {Platoon} + {0.000,10.000,0.000} time 15 target {Platoon} + {0.000,10.000,0.000}
                        if FireSiren != 2
                            FireSiren = 1
                        end if
                        SirenSpell = create siren at {Platoon} player 1
                        run background script Land10Siren(AIEpic, SirenSpell)
                        CHARGE of AIEpic = 0
                    end if
                end if
            end if
        end if

        if PLAYER of AztecCapital == 0 or PLAYER of AztecTown1 == 0 or PLAYER of AztecTown2 == 0 or PLAYER of MinorTown1 == 0 or PLAYER of AztecCapital != 1
            //Take over a town and start attacking the player a lot    
            if NearestSettlement != 0 and PLAYER of NearestSettlement == 0
                AttackingPlatoons = 1
            end if

        elsif PLAYER of NearestSettlement == 1 and AttackingPlatoons == 1
            //Attack PlayerTown with remaining troops
            AttackingPlatoons = 0
        end if

    end loop

end script LC10_Aztec_Capital

begin script LC10_DefendPlatoons

    PlayerPlatoon = 0
    DefendRecruitTimer1 = create timer for 0 seconds
    DefendRecruitTimer2 = create timer for 0 seconds
    DefendRecruitTimer3 = create timer for 0 seconds

start

    begin loop
        PlayerPlatoon = get platoon of player 0 nearest {AztecCapital} radius 300
        if PlayerPlatoon exists and LC10_Platoon[16] not exists and LC10_Platoon[17] not exists and get DefendRecruitTimer1 time remaining <= 0 and PLAYER of AztecCapital == 1 //Makes a couple of defend platoons
            LC10_Platoon[16] = recruit ARMY_UNIT_TYPE_MELEE_4 town AztecCapital platoon of size 25 * RecruitSizeModifier
            enable platoon LC10_Platoon[16] respond to town AztecCapital attack
            wait until not LC10_Platoon[16] recruiting
            
            LC10_Platoon[17] = recruit ARMY_UNIT_TYPE_RANGED_4 town AztecCapital platoon of size 25 * RecruitSizeModifier
            enable platoon LC10_Platoon[17] respond to town AztecCapital attack
            wait until not LC10_Platoon[17] recruiting
            
            DefendRecruitTimer1 = create timer for 180 * RecruitModifier seconds
        end if

        PlayerPlatoon = get platoon of player 0 nearest {AztecTown1} radius 300
        if PlayerPlatoon exists and LC10_Platoon[18] not exists and LC10_Platoon[19] not exists and get DefendRecruitTimer2 time remaining <= 0 and PLAYER of AztecTown1 == 1 //Makes a couple of defend platoons
            LC10_Platoon[18] = recruit ARMY_UNIT_TYPE_MELEE_4 town AztecTown1 platoon of size 20 * RecruitSizeModifier
            enable platoon LC10_Platoon[18] respond to town AztecTown1 attack
            wait until not LC10_Platoon[18] recruiting
            
            LC10_Platoon[19] = recruit ARMY_UNIT_TYPE_RANGED_4 town AztecTown1 platoon of size 20 * RecruitSizeModifier
            enable platoon LC10_Platoon[19] respond to town AztecTown1 attack
            wait until not LC10_Platoon[19] recruiting
            
            DefendRecruitTimer2 = create timer for 180 * RecruitModifier seconds
        end if

        PlayerPlatoon = get platoon of player 0 nearest {AztecTown2} radius 300
        if PlayerPlatoon exists and LC10_Platoon[20] not exists and LC10_Platoon[21] not exists and get DefendRecruitTimer3 time remaining <= 0 and PLAYER of AztecTown2 == 1 //Makes a couple of defend platoons
            LC10_Platoon[20] = recruit ARMY_UNIT_TYPE_MELEE_4 town AztecTown2 platoon of size 20 * RecruitSizeModifier
            enable platoon LC10_Platoon[20] respond to town AztecTown2 attack
            wait until not LC10_Platoon[20] recruiting
            
            LC10_Platoon[21] = recruit ARMY_UNIT_TYPE_RANGED_4 town AztecTown2 platoon of size 20 * RecruitSizeModifier
            enable platoon LC10_Platoon[21] respond to town AztecTown2 attack
            wait until not LC10_Platoon[21] recruiting
            
            DefendRecruitTimer3 = create timer for 180 * RecruitModifier seconds
        end if
    end loop

end script LC10_DefendPlatoons

begin script LC10_SirenResourceManager

    Counter = 0
    Tree = 0

start

begin loop
    AIEpic = get SCRIPT_OBJECT_TYPE_WONDER EPIC_WONDER_NUMBER_SIREN at {1757.94,132.16,2238.52} radius 150
    
until AIEpic exists
end loop

disable AIEpic hurt by fire

begin loop
    
    while Counter < 100 and not {AIEpic} viewed
        add resource ORE number from 40 to 50 to AIEpic
        add resource WOOD number from 70 to 80 to AIEpic
        
        wait number from 2 to 6 seconds
        
        Counter++
    end while
    
    until Counter == 100
end loop

wait until HEALTH of AIEpic >= 1.0

//Players like to destroy epics using a burning tree, so delete the tree
begin loop
    Tree = get MOBILE_OBJECT at {AIEpic} radius 20
    if Tree on fire and Tree is HELD
        empty player hand
        delete Tree
    end if
end loop

end script LC10_SirenResourceManager

begin script LC10_AztecCapitalRessourceManager

    StoragePit = 0
    StoragePitPos = marker at {1332.43,133.72,2270.72}

start

begin loop

    wait 5 seconds

    StoragePit = get HOUSE ABODE_NUMBER_STORAGE_PIT at {StoragePitPos} radius 15
    if StoragePit exists
        if PLAYER of AztecCapital == 1
            if (get town AztecCapital RESOURCE_TYPE_WOOD total < 33000)
                add resource RESOURCE_TYPE_WOOD number from 500 to 1000 to AztecCapital
            elsif (get town AztecCapital RESOURCE_TYPE_ORE total < 33000)
                add resource RESOURCE_TYPE_ORE number from 100 to 500 to AztecCapital
            elsif (get town AztecCapital RESOURCE_TYPE_FOOD total < 33000)
                add resource RESOURCE_TYPE_FOOD number from 500 to 1500 to AztecCapital
            end if
        end if
    else
        if PLAYER of AztecCapital == 1
            if (get town AztecCapital RESOURCE_TYPE_WOOD total < 15000)
                add resource RESOURCE_TYPE_WOOD number from 500 to 1000 to AztecCapital
            elsif (get town AztecCapital RESOURCE_TYPE_ORE total < 15000)
                add resource RESOURCE_TYPE_ORE number from 100 to 500 to AztecCapital
            elsif (get town AztecCapital RESOURCE_TYPE_FOOD total < 15000)
                add resource RESOURCE_TYPE_FOOD number from 500 to 1500 to AztecCapital
            end if
        end if
    end if
    until PLAYER of AztecCapital != 1
end loop    

end script LC10_AztecCapitalRessourceManager

begin script LC10_AztecCapitalVillagerManager

    Counter = 0
    Villager = 0
    HousesBuilt = 0

start

begin loop

    wait 1450 * BuilderModifier seconds
    Counter = 0

    if PLAYER of AztecCapital == 1
        if HousesBuilt == 0
            HousesBuilt = 1
            build all town AztecCapital buildings in group 10
        end if
        begin loop
            Villager = create random villager of tribe TRIBE_TYPE_AZTEC at {AztecCapital} + {number from -12 to 12, 0, number from -12 to 12}//create VILLAGER VILLAGER_INFO_JAPANESE_FORESTER_MALE at {1013.581, 132.333, 2002.798} + {number from -3 to 3, 0, number from -3 to 3}
            attach Villager to AztecCapital
            release Villager
            
            wait number from 6 to 10 seconds
            Counter++
            until Counter >= 20 or PLAYER of AztecCapital != 1
        end loop
    end if

end loop

end script LC10_AztecCapitalVillagerManager

begin script LC10_AztecTown1RessourceManager

start

begin loop

    wait 5 seconds

    if PLAYER of AztecTown1 == 1
        if (get town AztecTown1 RESOURCE_TYPE_ORE total < 17500)
            add resource RESOURCE_TYPE_ORE number from 100 to 500 to AztecTown1
        elsif (get town AztecTown1 RESOURCE_TYPE_WOOD total < 17500)
            add resource RESOURCE_TYPE_WOOD number from 500 to 1000 to AztecTown1
        elsif (get town AztecTown1 RESOURCE_TYPE_FOOD total < 17500)
            add resource RESOURCE_TYPE_FOOD number from 500 to 1500 to AztecTown1
        end if
    end if

end loop    

end script LC10_AztecTown1RessourceManager

begin script LC10_AztecTown1VillagerManager

    Counter = 0
    Villager = 0
    HousesBuilt = 0

start

begin loop

    wait 1450 * BuilderModifier seconds
    Counter = 0

    if PLAYER of AztecTown1 == 1
        if HousesBuilt == 0
            HousesBuilt = 1
            build all town AztecTown1 buildings in group 10
        end if
        begin loop
            Villager = create random villager of tribe TRIBE_TYPE_NORSE at {AztecTown1} + {number from -12 to 12, 0, number from -12 to 12}//create VILLAGER VILLAGER_INFO_JAPANESE_FORESTER_MALE at {1013.581, 132.333, 2002.798} + {number from -3 to 3, 0, number from -3 to 3}
            attach Villager to AztecTown1
            release Villager
            
            wait number from 6 to 10 seconds
            Counter++
            until Counter >= 20 or PLAYER of AztecTown1 != 1
        end loop
    end if

end loop

end script LC10_AztecTown1VillagerManager

begin script LC10_AztecTown2RessourceManager

start

begin loop

    wait 5 seconds

    if PLAYER of AztecTown2 == 1
        if (get town AztecTown2 RESOURCE_TYPE_ORE total < 12500)
            add resource RESOURCE_TYPE_ORE number from 100 to 500 to AztecTown2
        elsif (get town AztecTown2 RESOURCE_TYPE_WOOD total < 12500)
            add resource RESOURCE_TYPE_WOOD number from 500 to 1000 to AztecTown2
        elsif (get town AztecTown2 RESOURCE_TYPE_FOOD total < 12500)
            add resource RESOURCE_TYPE_FOOD number from 500 to 1500 to AztecTown2
        end if
    end if

end loop    

end script LC10_AztecTown2RessourceManager

begin script LC10_AztecTown2VillagerManager

    Counter = 0
    Villager = 0
    HousesBuilt = 0

start

begin loop

    wait 1450 * BuilderModifier seconds
    Counter = 0

    if PLAYER of AztecTown2 == 1
        if HousesBuilt == 0
            HousesBuilt = 1
            build all town AztecTown2 buildings in group 10
        end if
        begin loop
            Villager = create random villager of tribe TRIBE_TYPE_NORSE at {AztecTown2} + {number from -12 to 12, 0, number from -12 to 12}//create VILLAGER VILLAGER_INFO_JAPANESE_FORESTER_MALE at {1013.581, 132.333, 2002.798} + {number from -3 to 3, 0, number from -3 to 3}
            attach Villager to AztecTown2
            release Villager
            
            wait number from 6 to 10 seconds
            Counter++
            until Counter >= 20 or PLAYER of AztecTown2 != 1
        end loop
    end if

end loop

end script LC10_AztecTown2VillagerManager

begin script PrisonCondition

    RecruitTimer = create timer for 0 seconds

start

//Also recruit some defenders here
begin loop
    if LC10_Platoon[5] not exists and get RecruitTimer time remaining <= 0
        LC10_Platoon[5] = recruit ARMY_UNIT_TYPE_MELEE_4 town AztecPrison platoon of size 20 * RecruitSizeModifier
        RecruitTimer = create timer for 180 * RecruitModifier seconds
        enable platoon LC10_Platoon[5] respond to town AztecPrison attack
        wait until not LC10_Platoon[5] recruiting

    elsif LC10_Platoon[6] not exists and get RecruitTimer time remaining <= 0
        LC10_Platoon[6] = recruit ARMY_UNIT_TYPE_MELEE_4 town AztecPrison platoon of size 20 * RecruitSizeModifier
        RecruitTimer = create timer for 180 * RecruitModifier seconds
        enable platoon LC10_Platoon[6] respond to town AztecPrison attack
        wait until not LC10_Platoon[6] recruiting

    end if

    until LC10_Platoon[3] not exists and LC10_Platoon[4] not exists and LC10_Platoon[5] not exists and LC10_Platoon[6] not exists
end loop

PrisonDestroyed = 1
start migration from AztecPrison to PlayerTown
set player 0 objective TRIBUTE_OBJECTIVE_LAND_2 value 1

end script PrisonCondition

begin script LC10_GetNearestSettlement

    NearestTown = 0

start

begin loop
    if PLAYER of AztecCapital == 0
        NearestTown = AztecCapital

    elsif PLAYER of AztecTown1 == 0
        NearestTown = AztecTown1

    elsif PLAYER of AztecTown2 == 0
        NearestTown = AztecTown2

    elsif PLAYER of MinorTown1 == 0
        NearestTown = MinorTown1

    else
        NearestTown = PlayerTown

    end if

    NearestSettlement = NearestTown
    wait 45 seconds
end loop

end script LC10_GetNearestSettlement

begin script LC10_AttackNearestTownTimer

start

begin loop

    if get AttackNearestTownTimer time remaining <= 0
        wait 45 seconds
        AttackNearestTownTimer = create timer for 1250 * RecruitModifier seconds
    end if

end loop

end script LC10_AttackNearestTownTimer

begin script DisableLocalPlatoonResponse

    Counter = 0

start

begin loop
    if Counter > 99
        Counter = 0
        wait 30 seconds
    end if
    if LC10_Platoon[Counter] exists
        disable platoon LC10_Platoon[Counter] respond to local platoon attack
    end if
    if LC10_WallArcher[Counter] exists
        disable platoon LC10_WallArcher[Counter] respond to local platoon attack
    end if
    Counter++
end loop

end script DisableLocalPlatoonResponse