///////////////////////////////////////////////////////////////////////////////
//          Town Influence Extender
//    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
//
//    This script makes town influence extending, depending on how many 
//    villagers are living in the specified town.
//
///////////////////////////////////////////////////////////////////////////////

define script TownInfluenceCombiner(PlayerID)
define script TownInfluenceExtender
define script TownInfluenceScriptmanager

run script TownInfluenceScriptmanager


begin script TownInfluenceScriptmanager

start

    //run background script TownInfluenceCombiner(0) Unused Crashy, not working
    run background script TownInfluenceExtender

end script TownInfluenceScriptmanager


begin script TownInfluenceCombiner(PlayerID)

    Building = 0
    Counter = 0
    Counter2 = 0
    MainTown = 0
    Town[16]
    TownSize = 0
    Villager = 0

start

if PlayerID == 0
    MainTown = get town with id 0
elsif PlayerID == 1

elsif PlayerID == 2

elsif PlayerID == 3

end if

wait 5 seconds

set player 0 town get town with id 8 capture reason LAST_CAPTURE_AGGRESSIVE

begin loop
    if Counter > 14
        Counter = 0
    end if
    Town[Counter] = get town with id Counter
    if Town[Counter] != MainTown and PLAYER of Town[Counter] == PlayerID
        TownSize = size of Town[Counter]
        force while TownSize > size of Town[Counter]
            Villager = get living villager at {Town[Counter]} radius 250
            PLAYER of Villager = PlayerID
            attach Villager to MainTown
            TownSize--
        end while
        Counter2 = 0
        begin loop
            Building = 0
            Building = get building ABODE_A in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building ABODE_B in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building ABODE_C in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building ABODE_D in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building ABODE_E in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building SKYSCRAPER in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building MELEE_ARMOURY in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building RANGED_ARMOURY in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building ABODE_NUMBER_ALTAR in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building ABODE_NUMBER_STORAGE_PIT in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building ABODE_NUMBER_CRECHE in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building ABODE_NUMBER_SHRINE in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building ABODE_NUMBER_TEMPLE in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building ABODE_NUMBER_PUB in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building ABODE_NUMBER_CREATURE_PEN in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building ABODE_NUMBER_WORKSHOP in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building ABODE_NUMBER_STUDY in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building ABODE_NUMBER_UNIVERSITY in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building ABODE_NUMBER_PRISON in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building ABODE_NUMBER_AMPITHEATRE in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building ABODE_NUMBER_GRAVEYARD in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building ABODE_NUMBER_OLD_PERSONS_HOME in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building ABODE_NUMBER_BATHHOUSE in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building ABODE_NUMBER_SMELTER in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building ABODE_NUMBER_GRANARY in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building ABODE_NUMBER_LUMBERMILL in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building ABODE_NUMBER_MARKET_POT in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building ABODE_NUMBER_MARKET_STATUE in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building ABODE_NUMBER_MARKET_PLANT in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building ABODE_NUMBER_WALLTOWER_TECH0 in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building ABODE_NUMBER_WALLTOWER_TECH1 in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building ABODE_NUMBER_GATEHOUSE in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building ABODE_NUMBER_GATEHOUSE_F in Town[Counter] min built 0.0
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = get WONDER EPIC_WONDER_NUMBER_HURRICANE in Town[Counter]
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get WONDER EPIC_WONDER_NUMBER_SIREN in Town[Counter]
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get WONDER EPIC_WONDER_NUMBER_EARTHQUAKE in Town[Counter]
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get WONDER EPIC_WONDER_NUMBER_VOLCANO in Town[Counter]
            if Building exists
                PLAYER of Building = PlayerID
                attach Building to MainTown
            end if
            Building = 0
            Building = get building TOWN_CENTRE in Town[Counter] min built 0.0
            if Building exists
                if PLAYER of Town[Counter] == 0
                    //set player 1 town Town[Counter] capture reason LAST_CAPTURE_AGGRESSIVE
                    //wait 5 seconds
                end if
                attach Building to MainTown
            end if
            Counter2++
            until Counter2 > 250
        end loop
    end if
    Counter++
end loop

end script TownInfluenceCombiner


begin script TownInfluenceExtender

    Triggers[9]
    PlayerThreshold = 0
    TownCounter = 0
    Town[15]//15 Towns max. supported
    TownInfluence[15]
    TownEnemyInfluence[15]
    TownSize = 0

start

begin loop

    if TownCounter >= 14
        TownCounter = 0
    end if

    if get total of stat STATS_EVT_BUILDINGS_BUILT > 10 and Triggers[0] == 0
        Triggers[0] = 1
        PlayerThreshold += 4
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 20 and Triggers[0] == 1
        Triggers[0] = 2
        PlayerThreshold += 4
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 30 and Triggers[0] == 2
        Triggers[0] = 3
        PlayerThreshold += 4
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 40 and Triggers[0] == 3
        Triggers[0] = 4
        PlayerThreshold += 4
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 50 and Triggers[0] == 4
        Triggers[0] = 5
        PlayerThreshold += 4
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 60 and Triggers[0] == 5
        Triggers[0] = 6
        PlayerThreshold += 4
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 70 and Triggers[0] == 6
        Triggers[0] = 7
        PlayerThreshold += 4
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 80 and Triggers[0] == 7
        Triggers[0] = 8
        PlayerThreshold += 4
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 90 and Triggers[0] == 8
        Triggers[0] = 9
        PlayerThreshold += 4
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 100 and Triggers[0] == 9
        Triggers[0] = 10
        PlayerThreshold += 4
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 110 and Triggers[0] == 10
        Triggers[0] = 11
        PlayerThreshold += 4
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 120 and Triggers[0] == 11
        Triggers[0] = 12
        PlayerThreshold += 4
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 130 and Triggers[0] == 12
        Triggers[0] = 13
        PlayerThreshold += 4
    elsif get total of stat STATS_EVT_BUILDINGS_BUILT > 140 and Triggers[0] == 13
        Triggers[0] = 14
        PlayerThreshold += 4
    end if

    Town[TownCounter] = get town with id TownCounter
    if PLAYER of Town[TownCounter] == 0
        if size of Town[TownCounter] >= 15 and TownInfluence[TownCounter] == 0
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (3 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 15 and TownInfluence[TownCounter] == 1
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (0 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 30 and TownInfluence[TownCounter] == 1
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (6 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 30 and TownInfluence[TownCounter] == 2
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (3 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 45 and TownInfluence[TownCounter] == 2
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (9 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 45 and TownInfluence[TownCounter] == 3
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (6 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 60 and TownInfluence[TownCounter] == 3
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (12 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 60 and TownInfluence[TownCounter] == 4
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (9 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 75 and TownInfluence[TownCounter] == 4
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (15 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 75 and TownInfluence[TownCounter] == 5
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (12 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 90 and TownInfluence[TownCounter] == 5
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (18 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 90 and TownInfluence[TownCounter] == 6
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (15 + PlayerThreshold) / 1

        end if
    
        if size of Town[TownCounter] >= 105 and TownInfluence[TownCounter] == 6
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (21 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 105 and TownInfluence[TownCounter] == 7
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (18 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 120 and TownInfluence[TownCounter] == 7
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (63 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 120 and TownInfluence[TownCounter] == 8
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (21 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 135 and TownInfluence[TownCounter] == 8
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (66 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 135 and TownInfluence[TownCounter] == 9
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (63 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 150 and TownInfluence[TownCounter] == 9
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (69 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 150 and TownInfluence[TownCounter] == 10
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (66 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 165 and TownInfluence[TownCounter] == 10
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (72 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 165 and TownInfluence[TownCounter] == 11
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (69 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 180 and TownInfluence[TownCounter] == 11
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (75 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 180 and TownInfluence[TownCounter] == 12
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (72 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 195 and TownInfluence[TownCounter] == 12
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (78 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 195 and TownInfluence[TownCounter] == 13
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (75 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 210 and TownInfluence[TownCounter] == 13
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (81 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 210 and TownInfluence[TownCounter] == 14
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (78 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 225 and TownInfluence[TownCounter] == 14
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (84 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 225 and TownInfluence[TownCounter] == 15
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (81 + PlayerThreshold) / 1

        end if
    
        if size of Town[TownCounter] >= 240 and TownInfluence[TownCounter] == 15
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (126 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 240 and TownInfluence[TownCounter] == 16
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (84 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 255 and TownInfluence[TownCounter] == 16
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (129 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 255 and TownInfluence[TownCounter] == 17
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (126 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 270 and TownInfluence[TownCounter] == 17
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (132 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 270 and TownInfluence[TownCounter] == 18
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (129 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 285 and TownInfluence[TownCounter] == 18
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (135 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 285 and TownInfluence[TownCounter] == 19
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (132 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 300 and TownInfluence[TownCounter] == 19
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (138 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 300 and TownInfluence[TownCounter] == 20
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (135 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 315 and TownInfluence[TownCounter] == 20
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (141 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 315 and TownInfluence[TownCounter] == 21
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (138 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 330 and TownInfluence[TownCounter] == 21
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (144 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 330 and TownInfluence[TownCounter] == 22
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (141 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 345 and TownInfluence[TownCounter] == 22
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (147 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 345 and TownInfluence[TownCounter] == 23
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (144 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 360 and TownInfluence[TownCounter] == 23
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (184 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 360 and TownInfluence[TownCounter] == 24
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (147 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 375 and TownInfluence[TownCounter] == 24
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (187 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 375 and TownInfluence[TownCounter] == 25
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (184 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 390 and TownInfluence[TownCounter] == 25
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (190 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 390 and TownInfluence[TownCounter] == 26
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (187 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 405 and TownInfluence[TownCounter] == 26
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (193 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 405 and TownInfluence[TownCounter] == 27
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (190 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 420 and TownInfluence[TownCounter] == 27
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (196 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 420 and TownInfluence[TownCounter] == 28
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (193 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 435 and TownInfluence[TownCounter] == 28
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (199 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 435 and TownInfluence[TownCounter] == 29
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (196 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 450 and TownInfluence[TownCounter] == 29
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (203 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 450 and TownInfluence[TownCounter] == 30
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (199 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 465 and TownInfluence[TownCounter] == 30
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (206 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 465 and TownInfluence[TownCounter] == 31
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (203 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 480 and TownInfluence[TownCounter] == 31
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (258 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 480 and TownInfluence[TownCounter] == 32
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (206 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 495 and TownInfluence[TownCounter] == 32
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (261 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 495 and TownInfluence[TownCounter] == 33
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (258 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 510 and TownInfluence[TownCounter] == 33
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (264 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 510 and TownInfluence[TownCounter] == 34
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (261 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 525 and TownInfluence[TownCounter] == 34
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (267 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 525 and TownInfluence[TownCounter] == 35
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (264 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 540 and TownInfluence[TownCounter] == 35
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (270 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 540 and TownInfluence[TownCounter] == 36
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (267 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 555 and TownInfluence[TownCounter] == 36
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (273 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 555 and TownInfluence[TownCounter] == 37
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (270 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 570 and TownInfluence[TownCounter] == 37
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (276 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 570 and TownInfluence[TownCounter] == 38
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (273 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 585 and TownInfluence[TownCounter] == 38
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (279 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 585 and TownInfluence[TownCounter] == 39
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (276 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 600 and TownInfluence[TownCounter] == 39
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (345 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 600 and TownInfluence[TownCounter] == 40
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (279 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 615 and TownInfluence[TownCounter] == 40
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (348 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 615 and TownInfluence[TownCounter] == 41
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (345 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 630 and TownInfluence[TownCounter] == 41
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (351 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 630 and TownInfluence[TownCounter] == 42
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (348 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 645 and TownInfluence[TownCounter] == 42
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (354 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 645 and TownInfluence[TownCounter] == 43
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (351 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 660 and TownInfluence[TownCounter] == 43
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (357 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 660 and TownInfluence[TownCounter] == 44
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (354 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 675 and TownInfluence[TownCounter] == 44
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (360 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 675 and TownInfluence[TownCounter] == 45
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (357 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 690 and TownInfluence[TownCounter] == 45
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (363 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 690 and TownInfluence[TownCounter] == 46
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (360 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 705 and TownInfluence[TownCounter] == 46
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (366 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 705 and TownInfluence[TownCounter] == 47
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (363 + PlayerThreshold) / 1

        end if

        if size of Town[TownCounter] >= 720 and TownInfluence[TownCounter] == 47
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by (369 + PlayerThreshold) / 1

        elsif size of Town[TownCounter] < 720 and TownInfluence[TownCounter] == 48
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by (366 + PlayerThreshold) / 1

        end if
    else //Reset if town has been captured
        TownInfluence[TownCounter] = 0
    end if

    if PLAYER of Town[TownCounter] >= 1 and PLAYER of Town[TownCounter] < 7
        if size of Town[TownCounter] >= 15 and TownInfluence[TownCounter] == 0
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 3 / 3

        elsif size of Town[TownCounter] < 15 and TownInfluence[TownCounter] == 1
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 0 / 3

        end if

        if size of Town[TownCounter] >= 30 and TownInfluence[TownCounter] == 1
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 6 / 3

        elsif size of Town[TownCounter] < 30 and TownInfluence[TownCounter] == 2
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 3 / 3

        end if

        if size of Town[TownCounter] >= 45 and TownInfluence[TownCounter] == 2
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 9 / 3

        elsif size of Town[TownCounter] < 45 and TownInfluence[TownCounter] == 3
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 6 / 3

        end if

        if size of Town[TownCounter] >= 60 and TownInfluence[TownCounter] == 3
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 12 / 3

        elsif size of Town[TownCounter] < 60 and TownInfluence[TownCounter] == 4
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 9 / 3

        end if

        if size of Town[TownCounter] >= 75 and TownInfluence[TownCounter] == 4
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 15 / 3

        elsif size of Town[TownCounter] < 75 and TownInfluence[TownCounter] == 5
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 12 / 3

        end if

        if size of Town[TownCounter] >= 90 and TownInfluence[TownCounter] == 5
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 18 / 3

        elsif size of Town[TownCounter] < 90 and TownInfluence[TownCounter] == 6
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 15 / 3

        end if
    
        if size of Town[TownCounter] >= 105 and TownInfluence[TownCounter] == 6
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 21 / 3

        elsif size of Town[TownCounter] < 105 and TownInfluence[TownCounter] == 7
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 18 / 3

        end if

        if size of Town[TownCounter] >= 120 and TownInfluence[TownCounter] == 7
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 63 / 3

        elsif size of Town[TownCounter] < 120 and TownInfluence[TownCounter] == 8
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 21 / 3

        end if

        if size of Town[TownCounter] >= 135 and TownInfluence[TownCounter] == 8
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 66 / 3

        elsif size of Town[TownCounter] < 135 and TownInfluence[TownCounter] == 9
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 63 / 3

        end if

        if size of Town[TownCounter] >= 150 and TownInfluence[TownCounter] == 9
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 69 / 3

        elsif size of Town[TownCounter] < 150 and TownInfluence[TownCounter] == 10
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 66 / 3

        end if

        if size of Town[TownCounter] >= 165 and TownInfluence[TownCounter] == 10
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 72 / 3

        elsif size of Town[TownCounter] < 165 and TownInfluence[TownCounter] == 11
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 69 / 3

        end if

        if size of Town[TownCounter] >= 180 and TownInfluence[TownCounter] == 11
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 75 / 3

        elsif size of Town[TownCounter] < 180 and TownInfluence[TownCounter] == 12
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 72 / 3

        end if

        if size of Town[TownCounter] >= 195 and TownInfluence[TownCounter] == 12
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 78 / 3

        elsif size of Town[TownCounter] < 195 and TownInfluence[TownCounter] == 13
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 75 / 3

        end if

        if size of Town[TownCounter] >= 210 and TownInfluence[TownCounter] == 13
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 81 / 3

        elsif size of Town[TownCounter] < 210 and TownInfluence[TownCounter] == 14
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 78 / 3

        end if

        if size of Town[TownCounter] >= 225 and TownInfluence[TownCounter] == 14
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 84 / 3

        elsif size of Town[TownCounter] < 225 and TownInfluence[TownCounter] == 15
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 81 / 3

        end if
    
        if size of Town[TownCounter] >= 240 and TownInfluence[TownCounter] == 15
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 126 / 3

        elsif size of Town[TownCounter] < 240 and TownInfluence[TownCounter] == 16
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 84 / 3

        end if

        if size of Town[TownCounter] >= 255 and TownInfluence[TownCounter] == 16
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 129 / 3

        elsif size of Town[TownCounter] < 255 and TownInfluence[TownCounter] == 17
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 126 / 3

        end if

        if size of Town[TownCounter] >= 270 and TownInfluence[TownCounter] == 17
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 132 / 3

        elsif size of Town[TownCounter] < 270 and TownInfluence[TownCounter] == 18
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 129 / 3

        end if

        if size of Town[TownCounter] >= 285 and TownInfluence[TownCounter] == 18
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 135 / 3

        elsif size of Town[TownCounter] < 285 and TownInfluence[TownCounter] == 19
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 132 / 3

        end if

        if size of Town[TownCounter] >= 300 and TownInfluence[TownCounter] == 19
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 138 / 3

        elsif size of Town[TownCounter] < 300 and TownInfluence[TownCounter] == 20
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 135 / 3

        end if

        if size of Town[TownCounter] >= 315 and TownInfluence[TownCounter] == 20
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 141 / 3

        elsif size of Town[TownCounter] < 315 and TownInfluence[TownCounter] == 21
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 138 / 3

        end if

        if size of Town[TownCounter] >= 330 and TownInfluence[TownCounter] == 21
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 144 / 3

        elsif size of Town[TownCounter] < 330 and TownInfluence[TownCounter] == 22
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 141 / 3

        end if

        if size of Town[TownCounter] >= 345 and TownInfluence[TownCounter] == 22
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 147 / 3

        elsif size of Town[TownCounter] < 345 and TownInfluence[TownCounter] == 23
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 144 / 3

        end if

        if size of Town[TownCounter] >= 360 and TownInfluence[TownCounter] == 23
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 184 / 3

        elsif size of Town[TownCounter] < 360 and TownInfluence[TownCounter] == 24
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 147 / 3

        end if

        if size of Town[TownCounter] >= 375 and TownInfluence[TownCounter] == 24
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 187 / 3

        elsif size of Town[TownCounter] < 375 and TownInfluence[TownCounter] == 25
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 184 / 3

        end if

        if size of Town[TownCounter] >= 390 and TownInfluence[TownCounter] == 25
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 190 / 3

        elsif size of Town[TownCounter] < 390 and TownInfluence[TownCounter] == 26
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 187 / 3

        end if

        if size of Town[TownCounter] >= 405 and TownInfluence[TownCounter] == 26
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 193 / 3

        elsif size of Town[TownCounter] < 405 and TownInfluence[TownCounter] == 27
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 190 / 3

        end if

        if size of Town[TownCounter] >= 420 and TownInfluence[TownCounter] == 27
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 196 / 3

        elsif size of Town[TownCounter] < 420 and TownInfluence[TownCounter] == 28
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 193 / 3

        end if

        if size of Town[TownCounter] >= 435 and TownInfluence[TownCounter] == 28
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 199 / 3

        elsif size of Town[TownCounter] < 435 and TownInfluence[TownCounter] == 29
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 196 / 3

        end if

        if size of Town[TownCounter] >= 450 and TownInfluence[TownCounter] == 29
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 203 / 3

        elsif size of Town[TownCounter] < 450 and TownInfluence[TownCounter] == 30
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 199 / 3

        end if

        if size of Town[TownCounter] >= 465 and TownInfluence[TownCounter] == 30
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 206 / 3

        elsif size of Town[TownCounter] < 465 and TownInfluence[TownCounter] == 31
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 203 / 3

        end if

        if size of Town[TownCounter] >= 480 and TownInfluence[TownCounter] == 31
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 258 / 3

        elsif size of Town[TownCounter] < 480 and TownInfluence[TownCounter] == 32
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 206 / 3

        end if

        if size of Town[TownCounter] >= 495 and TownInfluence[TownCounter] == 32
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 261 / 3

        elsif size of Town[TownCounter] < 495 and TownInfluence[TownCounter] == 33
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 258 / 3

        end if

        if size of Town[TownCounter] >= 510 and TownInfluence[TownCounter] == 33
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 264 / 3

        elsif size of Town[TownCounter] < 510 and TownInfluence[TownCounter] == 34
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 261 / 3

        end if

        if size of Town[TownCounter] >= 525 and TownInfluence[TownCounter] == 34
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 267 / 3

        elsif size of Town[TownCounter] < 525 and TownInfluence[TownCounter] == 35
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 264 / 3

        end if

        if size of Town[TownCounter] >= 540 and TownInfluence[TownCounter] == 35
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 270 / 3

        elsif size of Town[TownCounter] < 540 and TownInfluence[TownCounter] == 36
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 267 / 3

        end if

        if size of Town[TownCounter] >= 555 and TownInfluence[TownCounter] == 36
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 273 / 3

        elsif size of Town[TownCounter] < 555 and TownInfluence[TownCounter] == 37
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 270 / 3

        end if

        if size of Town[TownCounter] >= 570 and TownInfluence[TownCounter] == 37
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 276 / 3

        elsif size of Town[TownCounter] < 570 and TownInfluence[TownCounter] == 38
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 273 / 3

        end if

        if size of Town[TownCounter] >= 585 and TownInfluence[TownCounter] == 38
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 279 / 3

        elsif size of Town[TownCounter] < 585 and TownInfluence[TownCounter] == 39
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 276 / 3

        end if

        if size of Town[TownCounter] >= 600 and TownInfluence[TownCounter] == 39
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 345 / 3

        elsif size of Town[TownCounter] < 600 and TownInfluence[TownCounter] == 40
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 279 / 3

        end if

        if size of Town[TownCounter] >= 615 and TownInfluence[TownCounter] == 40
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 348 / 3

        elsif size of Town[TownCounter] < 615 and TownInfluence[TownCounter] == 41
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 345 / 3

        end if

        if size of Town[TownCounter] >= 630 and TownInfluence[TownCounter] == 41
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 351 / 3

        elsif size of Town[TownCounter] < 630 and TownInfluence[TownCounter] == 42
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 348 / 3

        end if

        if size of Town[TownCounter] >= 645 and TownInfluence[TownCounter] == 42
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 354 / 3

        elsif size of Town[TownCounter] < 645 and TownInfluence[TownCounter] == 43
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 351 / 3

        end if

        if size of Town[TownCounter] >= 660 and TownInfluence[TownCounter] == 43
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 357 / 3

        elsif size of Town[TownCounter] < 660 and TownInfluence[TownCounter] == 44
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 354 / 3

        end if

        if size of Town[TownCounter] >= 675 and TownInfluence[TownCounter] == 44
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 360 / 3

        elsif size of Town[TownCounter] < 675 and TownInfluence[TownCounter] == 45
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 357 / 3

        end if

        if size of Town[TownCounter] >= 690 and TownInfluence[TownCounter] == 45
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 363 / 3

        elsif size of Town[TownCounter] < 690 and TownInfluence[TownCounter] == 46
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 360 / 3

        end if

        if size of Town[TownCounter] >= 705 and TownInfluence[TownCounter] == 46
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 366 / 3

        elsif size of Town[TownCounter] < 705 and TownInfluence[TownCounter] == 47
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 363 / 3

        end if

        if size of Town[TownCounter] >= 720 and TownInfluence[TownCounter] == 47
            TownInfluence[TownCounter] += 1
            extend town Town[TownCounter] influence by 369 / 3

        elsif size of Town[TownCounter] < 720 and TownInfluence[TownCounter] == 48
            TownInfluence[TownCounter] -= 1
            extend town Town[TownCounter] influence by 366 / 3

        end if

    else //Reset if town has been captured
        TownEnemyInfluence[TownCounter] = 0
    end if

    TownCounter++
end loop

end script TownInfluenceExtender